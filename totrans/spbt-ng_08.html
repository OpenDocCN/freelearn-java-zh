<html><head></head><body>
		<div id="_idContainer067">
			<h1 class="chapter-number" id="_idParaDest-134"><a id="_idTextAnchor144"/>8</h1>
			<h1 id="_idParaDest-135"><a id="_idTextAnchor145"/>Logging Events in Spring Boot</h1>
			<p>In the previous chapter, we discussed the ideas, features, and implementation of <strong class="bold">Cross-Origin Resource Sharing</strong> (<strong class="bold">CORS</strong>) in securing our application. We also learned about <strong class="bold">JSON Web Tokens</strong> (<strong class="bold">JWTs</strong>) and how to generate one by creating <span class="No-Break">authentication endpoints.</span></p>
			<p>This chapter will focus on logging events in our Spring Boot application. We will discuss the popular packages for logging in to and configuring Spring Boot, where to save them, and what to do with logs as we develop <span class="No-Break">our application.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Getting started with SLF4J <span class="No-Break">and Log4j2</span></li>
				<li>Setting up SLF4J <span class="No-Break">and Log4j2</span></li>
				<li><span class="No-Break">Using logs</span></li>
			</ul>
			<h1 id="_idParaDest-136"><a id="_idTextAnchor146"/>Technical requirements</h1>
			<p>The finished version of this chapter’s code may be seen at the following <span class="No-Break">link: </span><a href="https://github.com/PacktPublishing/Spring-Boot-and-Angular/tree/main/Chapter-08/superheroes"><span class="No-Break">https://github.com/PacktPublishing/Spring-Boot-and-Angular/tree/main/Chapter-08/superheroes</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-137"><a id="_idTextAnchor147"/>Getting started with SLF4J and Log4j2</h1>
			<p><strong class="bold">Logging</strong> is considered one<a id="_idIndexMarker581"/> of the most important aspects of developing an application. Its importance tends to be underrated <a id="_idIndexMarker582"/>and, worse, we forget to apply it to<a id="_idIndexMarker583"/> <span class="No-Break">our applications.</span></p>
			<p>Event logging is used in most tech<a id="_idIndexMarker584"/> industries, especially those providing enterprise applications. It is applied with a given standard to prevent complex debugging and allow for an easier understanding of the code we are reading. A well-written and structured log can benefit developers, especially when maintaining or debugging code from another developer. Instead of searching exhaustively for an error, records will expedite the debugging process, providing information on where and why the error occurred, and what has happened in <span class="No-Break">our application.</span></p>
			<p>Logging has also evolved with<a id="_idIndexMarker585"/> improvements in languages and frameworks; in backend development, several logging frameworks have been developed to provide more flexible logging capabilities. Some of the example frameworks that we will discuss are SLF4J and Log4j2 for Java Spring Boot. Before proceeding, let’s discuss the features of a <span class="No-Break">logging framework.</span></p>
			<h2 id="_idParaDest-138"><a id="_idTextAnchor148"/>Features of a logging framework</h2>
			<p>A logging framework contains the following<a id="_idIndexMarker586"/> three features for us to display and capture events in <span class="No-Break">our application:</span></p>
			<ul>
				<li><strong class="bold">Logger</strong>: Gets the <a id="_idIndexMarker587"/>messages and <span class="No-Break">the metadata</span></li>
				<li><strong class="bold">Formatter</strong>: Formats <a id="_idIndexMarker588"/>messages retrieved from <span class="No-Break">the logger</span></li>
				<li><strong class="bold">Handler</strong>: Responsible for <a id="_idIndexMarker589"/>printing the messages in the debug console or inserting them in the database for <span class="No-Break">the developer</span></li>
			</ul>
			<p>A logging framework also displays messages with different severity levels, allowing the developer to quickly identify which event<a id="_idIndexMarker590"/> has occurred. The severity levels in a logging framework are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="bold">FATAL</strong>: Level 1; considered a critical issue that can cause an application to pause <span class="No-Break">or terminate</span></li>
				<li><strong class="bold">ERROR</strong>: Runtime errors in <span class="No-Break">the application</span></li>
				<li><strong class="bold">WARNING</strong>: Logs that usually display <span class="No-Break">deprecated APIs</span></li>
				<li><strong class="bold">INFO</strong>: Logs that display events on the runtime of <span class="No-Break">the application</span></li>
				<li><strong class="bold">DEBUG</strong>: Logs that display information on the flow of <span class="No-Break">the application</span></li>
				<li><strong class="bold">TRACE</strong>: Logs that display more detailed information on the flow of <span class="No-Break">the application</span></li>
			</ul>
			<h1 id="_idParaDest-139"><a id="_idTextAnchor149"/>Logging using SLF4J</h1>
			<p>One of the popular logging frameworks being used with Java is <strong class="bold">Simple Logging Façade for Java</strong>, or <strong class="bold">SLF4J</strong>. It is one<a id="_idIndexMarker591"/> of the most widely used frameworks since it allows users to use any <a id="_idIndexMarker592"/>logging frameworks, such as Log4j, Logback, the <strong class="source-inline">java.util.logging</strong> package, or Java’s own logging engine, JUL, using only a single dependency. This means that we can switch from one logging framework to another depending on what <span class="No-Break">is needed.</span></p>
			<p>There are several advantages to <span class="No-Break">using SLF4J:</span></p>
			<ul>
				<li>SLF4J enables us to<a id="_idIndexMarker593"/> switch from one framework to another at runtime <span class="No-Break">or deployment.</span></li>
				<li>SLF4J has a migrator tool that allows us to migrate existing projects using the Java Class Library from Log4j <span class="No-Break">to SLF4J.</span></li>
				<li>SLF4J supports parameterized logging messages to bind dynamic values for <span class="No-Break">our logs.</span></li>
				<li>SLF4J decouples the application from the logging framework. We do not need to worry about which logging framework is being used when developing <span class="No-Break">our application.</span></li>
			</ul>
			<h2 id="_idParaDest-140"><a id="_idTextAnchor150"/>Methods and classes of SLF4J</h2>
			<p>SLF4J provides several classes and <a id="_idIndexMarker594"/>methods for displaying messages with severity levels, profiling the time of execution, or simply returning the instance of the logger. Let’s discuss the provided methods <span class="No-Break">and classes.</span></p>
			<h3>Logger interface</h3>
			<p>The logger interface is mainly <a id="_idIndexMarker595"/>used to display the messages or logs provided with the severity level. This is also the entry point of the <span class="No-Break">SLF4J API.</span></p>
			<ul>
				<li><strong class="source-inline">void debug(String message)</strong>: Logs the message at the <span class="No-Break"><strong class="bold">DEBUG</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">void error(String message)</strong>: Logs the message at the <span class="No-Break"><strong class="bold">ERROR</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">void info(String message)</strong>: Logs the message at the <span class="No-Break"><strong class="bold">INFO</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">void trace(String message)</strong>: Logs the message at the <span class="No-Break"><strong class="bold">TRACE</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">void warn(String message)</strong>: Logs the message at the <span class="No-Break"><strong class="bold">WARN</strong></span><span class="No-Break"> level</span></li>
			</ul>
			<h3>The LoggerFactory class</h3>
			<p>The <strong class="source-inline">LoggerFactory</strong> class is the SLF4J <a id="_idIndexMarker596"/>utility class, commonly used to create loggers using frameworks such as JUL <span class="No-Break">and Log4j.</span></p>
			<p><strong class="source-inline">Logger getLogger(String name)</strong> generates the logger object with a specified name. The following example uses the <span class="No-Break"><strong class="source-inline">getLogger()</strong></span><span class="No-Break"> method:</span></p>
			<pre class="source-code">
private static final org.SLF4J.Logger log = org.SLF4J.LoggerFactory.getLogger(LogClass.class);</pre>
			<h3>The Profiler class</h3>
			<p>The <strong class="source-inline">Profiler</strong> class is mainly <a id="_idIndexMarker597"/>used to identify the execution time of a specific task in<a id="_idIndexMarker598"/> our application, also known as the <strong class="bold">poor </strong><span class="No-Break"><strong class="bold">man’s profiler</strong></span><span class="No-Break">.</span></p>
			<p>Various methods may <span class="No-Break">be used:</span></p>
			<ul>
				<li><strong class="source-inline">void start(string name)</strong> creates a new child stopwatch with a specific name and stops the previously <span class="No-Break">created stopwatches.</span></li>
				<li><strong class="source-inline">TimeInstrument stop()</strong> stops the recent child and global stopwatches and will return the current <span class="No-Break">time execution.</span></li>
				<li><strong class="source-inline">void log()</strong> logs the details of the current time instruments with <span class="No-Break">the logger.</span></li>
				<li><strong class="source-inline">void print()</strong> prints the details of the current <span class="No-Break">time instrument.</span></li>
			</ul>
			<h2 id="_idParaDest-141"><a id="_idTextAnchor151"/>Features of SLF4J</h2>
			<p>SLF4J has several features that <a id="_idIndexMarker599"/>make logs more helpful in debugging. It provides support for parameterized logging, which allows us to display dynamic values in our messages. Another feature is profiling, which is commonly used to measure different attributes such as the memory and execution time of specific tasks in <span class="No-Break">an application.</span></p>
			<p>Let’s discuss the concept and implementation of <span class="No-Break">each feature.</span></p>
			<h3>Parameterized logging</h3>
			<p>To use parameterized logging in SLF4J, we will include placeholders <strong class="source-inline">{}</strong> in the message where we want to pass <span class="No-Break">the </span><span class="No-Break"><a id="_idIndexMarker600"/></span><span class="No-Break">value.</span></p>
			<p>Let’s have a look at the <span class="No-Break">following example:</span></p>
			<pre class="source-code">
public class LoggerExample {
   public static void main(String[] args) {
      //Creating the Logger object
      Logger logger =
        LoggerFactory.getLogger(LoggerExample.class);
      String name = "seiji";
      //Logger using info level
      logger.info("Hello {}, here is your log", name);
   }</pre>
			<p>In the preceding example, we have created a parameter in our message to display the value of the <strong class="source-inline">name</strong> variable. Once we execute the application, the output will be <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
INFO: Hello seiji, here is your log</pre>
			<p>Parameterized logging also supports multiple parameters in messages, as in the <span class="No-Break">following example:</span></p>
			<pre class="source-code">
public class LoggerExample {
   public static void main(String[] args) {
      //Creating the Logger object
      Logger logger =
      LoggerFactory.getLogger(LoggerExample.class);
      Integer x = 3;
      Integer y = 5;
      //Logging the information
      logger.info("The two numbers are {} and {}", x, y);
      logger.info("The sum of the two number is" + (x +
                   y));
   }</pre>
			<p>In the preceding example, we<a id="_idIndexMarker601"/> can display the <strong class="source-inline">x</strong> and <strong class="source-inline">y</strong> variables in a single log. We can also execute operations directly in our messages. The output would be <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
INFO: The two numbers are 3 and 5
INFO: The sum of the two numbers is 8</pre>
			<h3>Profiling</h3>
			<p>SLF4J also provides profiling, which is <a id="_idIndexMarker602"/>used to measure the memory, usage, and execution time of specific tasks in an application. The profiling feature can be used by a class <span class="No-Break">named </span><span class="No-Break"><strong class="source-inline">Profiler</strong></span><span class="No-Break">.</span></p>
			<p>To implement a profiler in our code, we have to execute the <span class="No-Break">following steps:</span></p>
			<ol>
				<li><strong class="bold">Create a new Profiler class</strong>: We need to create a new instance of <strong class="source-inline">Profiler</strong> with a specific name. Once we have done so, remember that we have started a global stopwatch. The following example shows how to create a <span class="No-Break">new </span><span class="No-Break"><strong class="source-inline">Profiler</strong></span><span class="No-Break">:</span><pre class="console">
Profiler profiler = new Profiler("ExampleProfiler");</pre></li>
				<li><strong class="bold">Start a child stopwatch</strong>: We use the child stopwatch if we want to measure specific methods in our app. To create one, we will call the <strong class="source-inline">start()</strong> method. Remember that starting a child stopwatch terminates other running stopwatches. This example shows how to start <span class="No-Break">a stopwatch:</span><pre class="console">
profiler.start("Example1");</pre><pre class="console">
class.methodExample();</pre></li>
				<li><strong class="bold">Stop the stopwatches</strong>: We call the <strong class="source-inline">stop()</strong> method to stop the running stopwatch and global stopwatch. This will also return the <span class="No-Break">Time instrument:</span><pre class="console">
TimeInstrument tm = profiler.stop();</pre></li>
				<li><strong class="bold">Print the contents of the instrument</strong>: We execute the <strong class="source-inline">print()</strong> method to display the contents and information of the <span class="No-Break">Time instrument.</span></li>
			</ol>
			<p>Now we have learned the <a id="_idIndexMarker603"/>concepts, features, and advantages of SLF4J, we will discuss a framework <span class="No-Break">called Log4j2.</span></p>
			<h1 id="_idParaDest-142"><a id="_idTextAnchor152"/>Logging using Log4j2</h1>
			<p><strong class="bold">Log4j2</strong> is one of the most<a id="_idIndexMarker604"/> common logging frameworks used with Java. Since SLF4J is an<a id="_idIndexMarker605"/> abstraction of logging frameworks, Log4j2 can be used with SLF4J. Log4j2 is very flexible and offers different ways to store log information for debugging; it also supports asynchronous logging and displays logs with a severity level to quickly identify the importance <span class="No-Break">of messages.</span></p>
			<p>Let’s discuss the following features <span class="No-Break">of Log4j2:</span></p>
			<ul>
				<li>The <span class="No-Break">Log4j2 Logger</span></li>
				<li><span class="No-Break">Log4j2 Appenders</span></li>
				<li><span class="No-Break">Log4j2 Layouts</span></li>
				<li><span class="No-Break">Log4j2 Markers</span></li>
				<li><span class="No-Break">Log4j2 Filters</span></li>
			</ul>
			<h2 id="_idParaDest-143"><a id="_idTextAnchor153"/>The Log4j2 Logger</h2>
			<p>The <strong class="bold">Logger</strong> is the main feature used by our<a id="_idIndexMarker606"/> application to create <strong class="source-inline">LogRecord</strong> instances. This means the logger is responsible for dispatching the messages. To create a Log4j2 Logger, we only need the <span class="No-Break">following code:</span></p>
			<pre class="source-code">
Logger log = LogManager.getLogger(ExampleClass.class);</pre>
			<p>After creating a new Logger, we can now use it to call several methods, such as <strong class="source-inline">info()</strong>, to <span class="No-Break">dispatch messages.</span></p>
			<h2 id="_idParaDest-144"><a id="_idTextAnchor154"/>Log4j2 Appenders</h2>
			<p><strong class="bold">Appenders</strong> are responsible for placing the<a id="_idIndexMarker607"/> logs dispatched by the Logger. In Log4j2, there are a wide range of Appenders that help us decide where to store <span class="No-Break">our logs.</span></p>
			<p>Here are some of the Appenders that are available <span class="No-Break">from Log4j2:</span></p>
			<ul>
				<li><strong class="source-inline">ConsoleAppender</strong>: Writes logs to the console (<strong class="source-inline">System.out</strong> or <strong class="source-inline">System.err</strong>). This is the <span class="No-Break">default Appender.</span></li>
				<li><strong class="source-inline">FileAppender</strong>: Writes logs to a file <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">FileManager</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">JDBCAppender</strong>: Writes logs to a database using a <span class="No-Break">JDBC driver.</span></li>
				<li><strong class="source-inline">HTTPAppender</strong>: Writes logs to a specific <span class="No-Break">HTTP endpoint.</span></li>
				<li><strong class="source-inline">KafkaAppender</strong>: Writes logs to <span class="No-Break">Apache Kafka.</span></li>
				<li><strong class="source-inline">AsyncAppender</strong>: Encapsulates another Appender and uses another thread to write logs, making it <span class="No-Break">asynchronous logging.</span></li>
				<li><strong class="source-inline">SyslogAppender</strong>: Writes logs to a <span class="No-Break">syslog destination.</span></li>
			</ul>
			<p>You can visit the Log4j2 documentation for other available Appenders at the following <span class="No-Break">link: </span><span class="No-Break">https://logging.apache.org/log4j/2.x/manual/appenders.html</span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-145"><a id="_idTextAnchor155"/>Log4j2 Layouts</h2>
			<p>Appenders use <strong class="bold">Layouts</strong> to format the output<a id="_idIndexMarker608"/> of a LogEvent. Log4j2 has different Layouts we can choose from to format <span class="No-Break">our logs:</span></p>
			<ul>
				<li><strong class="bold">Pattern</strong>: The default Layout used by Log4j2 uses a string pattern to display the logs. For example, the <strong class="source-inline">%d{HH:mm: ss} %msg%n;</strong> pattern would give the <span class="No-Break">following result:</span><pre class="console">
14:25:30 Example log message</pre></li>
				<li><strong class="bold">CSV</strong>: The Layout for generating logs using <span class="No-Break">CSV format.</span></li>
				<li><strong class="bold">HTML</strong>: The Layout for generating logs in <span class="No-Break">HTML format.</span></li>
				<li><strong class="bold">JSON</strong>: The Layout for generating logs in <span class="No-Break">JSON format.</span></li>
				<li><strong class="bold">XML</strong>: The Layout for generating logs in <span class="No-Break">XML format.</span></li>
				<li><strong class="bold">YAML</strong>: The Layout for generating logs in <span class="No-Break">YML format.</span></li>
				<li><strong class="bold">Syslog</strong>: The Layout for generating logs into a <span class="No-Break">syslog-compatible format.</span></li>
				<li><strong class="bold">Serialized</strong>: Serializes the<a id="_idIndexMarker609"/> logs into a byte array using <span class="No-Break">Java serialization.</span></li>
			</ul>
			<h2 id="_idParaDest-146"><a id="_idTextAnchor156"/>Log4j2 Markers</h2>
			<p><strong class="bold">Markers</strong> are objects commonly used to<a id="_idIndexMarker610"/> mark a single log statement to identify whether we need to execute certain actions to specific logs. For example, we can mark a single log statement using the <strong class="source-inline">IMPORTANT</strong> Marker, which can indicate to the Appender that it needs to store the log in a <span class="No-Break">different destination.</span></p>
			<p>Let’s have a look at an example of how to create and <span class="No-Break">use Markers:</span></p>
			<pre class="source-code">
public class Log4j2Marker {
    private static Logger LOGGER =
      LoggerFactory.getLogger(Log4j2Marker.class);
    private static final Marker IMPORTANT =
      MarkerFactory.getMarker("IMPORTANT");
    public static void main(String[] args) {
        LOGGER.info("Message without a marker");
        LOGGER.info(IMPORTANT,"Message with marker"
    }
}</pre>
			<p>In the preceding example, we can create <a id="_idIndexMarker611"/>a new Marker using the <strong class="source-inline">MarkerFactory.getLogger()</strong> method. To use the new Marker, we can apply it to a specific logger that indicates a particular action needed for <span class="No-Break">significant events.</span></p>
			<h2 id="_idParaDest-147"><a id="_idTextAnchor157"/>Log4j2 Filters</h2>
			<p>Log4j2 Filters are another valuable feature <a id="_idIndexMarker612"/>for use in displaying loggers. This gives us the capability to control log events that we want to say or publish based on the given criteria. In executing a Filter, we can set it with the <strong class="source-inline">ACCEPT</strong>, <strong class="source-inline">DENY</strong>, or <strong class="source-inline">NEUTRAL</strong> values. Here are some of the Filters we can use to <span class="No-Break">display loggers:</span></p>
			<ul>
				<li><strong class="bold">Threshold</strong>: Applies filtering to log events using the <span class="No-Break">severity level</span></li>
				<li><strong class="bold">Time</strong>: Applies filtering to log events with a given <span class="No-Break">time range</span></li>
				<li><strong class="bold">Regex</strong>: Filters the log events based on a given <span class="No-Break">regex pattern</span></li>
				<li><strong class="bold">Marker</strong>: Filters the log events based on the <span class="No-Break">given Marker</span></li>
				<li><strong class="bold">Composite</strong>: Provides a mechanism to combine <span class="No-Break">multiple filters</span></li>
				<li><strong class="bold">Dynamic Threshold</strong>: Applies filtering to log events using the severity level and includes <span class="No-Break">additional attributes</span></li>
			</ul>
			<p>In the following section, we will configure the logging frameworks in <span class="No-Break">our project.</span></p>
			<h1 id="_idParaDest-148"><a id="_idTextAnchor158"/>Setting up SLF4J and Log4j2</h1>
			<p>We will now implement <a id="_idIndexMarker613"/>several logging<a id="_idIndexMarker614"/> frameworks, including <strong class="bold">Logback</strong> and <strong class="bold">Log4j2</strong>, in our Spring Boot application. Remember that SLF4J is <span class="No-Break">already included.</span></p>
			<h2 id="_idParaDest-149"><a id="_idTextAnchor159"/>Configuring Logback</h2>
			<p><strong class="bold">Logback</strong> is the default logger <a id="_idIndexMarker615"/>used by Spring Applications, so no dependencies need to be installed to use it. The <strong class="source-inline">spring-boot-starter-logging</strong> dependency is already included once we create our Spring Boot application. The first step we need to take is to make our Logback <span class="No-Break">configuration file.</span></p>
			<p>In our project, under the <strong class="source-inline">resources</strong> folder, we will add the <strong class="source-inline">logback-spring.xml</strong> file. This is where we will place our Logback configuration. The following is an <span class="No-Break">example configuration:</span></p>
			<pre class="source-code">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;property name="LOGS" value="./logs" /&gt;
    &lt;!—Please refer to the logback-spring.xml of
       the GitHub repo. Thank you. --&gt;
    &lt;!-- LOG everything at INFO level --&gt;
    &lt;root level="info"&gt;
        &lt;appender-ref ref="RollingFile" /&gt;
        &lt;appender-ref ref="Console" /&gt;
    &lt;/root&gt;
    &lt;logger name="com.example" level="trace"
     additivity="false"&gt;
        &lt;appender-ref ref="RollingFile" /&gt;
        &lt;appender-ref ref="Console" /&gt;
    &lt;/logger&gt;
&lt;/configuration&gt;</pre>
			<p>In the preceding XML, several configurations were defined to format our log events. We have created two Appenders – <strong class="source-inline">Console</strong> and <strong class="source-inline">RollingFile</strong>. Configuring the two appender tags will create logs in System.out and <span class="No-Break">File Output.</span></p>
			<p>We have also used a pattern that<a id="_idIndexMarker616"/> modifies the look and format of the log display. In this example, we have used the <strong class="source-inline">%black(%d{ISO8601}) %highlight(%-5level) [%blue(%t)] %yellow(%C{1.}): %msg%n%throwable</strong> pattern to display the logs in <strong class="source-inline">System.Out</strong>. It shows the date in black, the severity level in highlight, the thread name in blue, the class name in yellow, and the message assigned to <span class="No-Break">the logs.</span></p>
			<p>After successfully configuring Logback, we can run the application and see the logs in <span class="No-Break">our console:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer065">
					<img alt="Figure 8.1 – Log events using Logback" src="image/B18159_08_01.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.1 – Log events using Logback</p>
			<p>We will now use the Log4j2 framework for <span class="No-Break">our logs.</span></p>
			<h2 id="_idParaDest-150"><a id="_idTextAnchor160"/>Configuring Log4j2</h2>
			<p>We can also use a different framework for <a id="_idIndexMarker617"/>logging events in our application. In this example, we will use Log4j2 to handle <span class="No-Break">our logs:</span></p>
			<ol>
				<li value="1">The first step is to add the <strong class="source-inline">Log4j2</strong> dependency to our <strong class="source-inline">pom.xml</strong> file. To do this, we will add the <span class="No-Break">following code:</span><pre class="console">
&lt;dependency&gt;</pre><pre class="console">
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</pre><pre class="console">
   &lt;artifactId&gt;spring-boot-starter-Log4j2&lt;/artifactId&gt;</pre><pre class="console">
&lt;/dependency&gt;</pre></li>
				<li>After successfully adding the dependency, we must exclude the <strong class="source-inline">spring-boot-starter-logging</strong> dependency in our Spring Boot application, allowing us to override Logback and use the Log4j2 framework in <span class="No-Break">logging events.</span></li>
			</ol>
			<p>To do so, we must add the<a id="_idIndexMarker618"/> following XML code to the dependencies under the <span class="No-Break"><strong class="source-inline">org.springframework.boot</strong></span><span class="No-Break"> group:</span></p>
			<pre class="console">
&lt;exclusions&gt;
   &lt;exclusion&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;
        spring-boot-starter-logging&lt;/artifactId&gt;
   &lt;/exclusion&gt;
&lt;/exclusions&gt;</pre>
			<ol>
				<li value="3">After including the <strong class="source-inline">Log4j2</strong> dependency, we will add a file named <strong class="source-inline">log4j2-spring.xml</strong> to the <strong class="source-inline">resources</strong> folder and add the following <span class="No-Break">XML configuration:</span><pre class="console">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;</pre><pre class="console">
&lt;Configuration&gt;</pre><pre class="console">
    &lt;!—Please refer to the log4j2-spring.xml  of the</pre><pre class="console">
       GitHub repo. --&gt;</pre><pre class="console">
    &lt;Loggers&gt;</pre><pre class="console">
        &lt;Root level="info"&gt;</pre><pre class="console">
            &lt;AppenderRef ref="Console" /&gt;</pre><pre class="console">
            &lt;AppenderRef ref="RollingFile" /&gt;</pre><pre class="console">
        &lt;/Root&gt;</pre><pre class="console">
        &lt;Logger name="com.example"</pre><pre class="console">
          level="trace"&gt;&lt;/Logger&gt;</pre><pre class="console">
    &lt;/Loggers&gt;</pre><pre class="console">
&lt;/Configuration&gt;</pre></li>
			</ol>
			<p>The preceding configuration is almost the same as the one we have implemented using Logback. We<a id="_idIndexMarker619"/> have also created two Appenders – <strong class="source-inline">Console</strong> and <strong class="source-inline">RollingFile</strong>; the only significant difference is the pattern for the log events. We have now successfully configured Log4j2. When we run our application, we will see the following <span class="No-Break">log output:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer066">
					<img alt="Figure 8.2 – Log events using Log4j2" src="image/B18159_08_02.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.2 – Log events using Log4j2</p>
			<p>Having configured and modified the configuration of our logs using the Log4j2 framework, we will now use it to add logs to <span class="No-Break">our code.</span></p>
			<h1 id="_idParaDest-151"><a id="_idTextAnchor161"/>Using logs</h1>
			<p>We can now use the log frameworks<a id="_idIndexMarker620"/> we have configured in our Spring Boot application to define logs on the different parts of our code. To do so, we must first create a new <span class="No-Break">logger instance.</span></p>
			<p>An example would be creating a log when a user attempts to get a list of all anti-heroes. In <strong class="source-inline">AntiHeroeController</strong>, we will add the following code to create a new <span class="No-Break">logger instance:</span></p>
			<pre class="source-code">
private static final Logger LOGGER = LoggerFactory.getLogger(AntiHeroController.class);</pre>
			<p>We must also be aware that <strong class="source-inline">LoggerFactory</strong> and <strong class="source-inline">Logger</strong> should be under the SLF4J dependency. It is always recommended to use <strong class="bold">SLF4J</strong> as this is an abstraction of logging frameworks and <a id="_idIndexMarker621"/>makes it easier to switch <span class="No-Break">between them.</span></p>
			<p>In this case, our import should be <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;</pre>
			<p>Once we have created a new logger instance, we can now use it in our methods, for example, if we want to display a log when the user attempts to get a list <span class="No-Break">of anti-heroes.</span></p>
			<p>To accomplish this, under the <strong class="source-inline">getAntiHeroes()</strong> method, we will add the <span class="No-Break">following code:</span></p>
			<pre class="source-code">
public List&lt;AntiHeroDto&gt; getAntiHeroes(Pageable pageable) {
    int toSkip = pageable.getPageSize() *
                 pageable.getPageNumber();
    //SLF4J
    LOGGER.info("Using SLF4J: Getting anti hero
                list - getAntiHeroes()");
    // Mapstruct is another dto mapper, but it's not
    // straightforward
    var antiHeroList = StreamSupport
              .stream(
                service.findAllAntiHeroes().spliterator(),
                false)
            .skip(toSkip).limit(pageable.getPageSize())
            .collect(Collectors.toList());
    return antiHeroList
            .stream()
            .map(this::convertToDto)
            .collect(Collectors.toList());
}</pre>
			<p>In the preceding example, we have invoked <strong class="source-inline">info(String message)</strong>. Every time the user calls the get anti-heroes <a id="_idIndexMarker622"/>endpoint, the log will be displayed. We can also invoke the <span class="No-Break">following methods:</span></p>
			<ul>
				<li><strong class="source-inline">trace()</strong>: Displays the log events on the <span class="No-Break"><strong class="bold">TRACE</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">debug()</strong>: Displays the log events on the <span class="No-Break"><strong class="bold">DEBUG</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">warn()</strong>: Displays the log events on the <span class="No-Break"><strong class="bold">WARN</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">error()</strong>: Displays the log events on the <span class="No-Break"><strong class="bold">ERROR</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">getName()</strong>: Retrieves the name of <span class="No-Break">the logger</span></li>
				<li><strong class="source-inline">isInfoEnabled()</strong>: Checks whether the logger is enabled on the <span class="No-Break"><strong class="bold">INFO</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">isDebugEnabled()</strong>: Checks whether the logger is enabled on the <span class="No-Break"><strong class="bold">DEBUG</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">isWarnEnabled()</strong>: Checks whether the logger is enabled on the <span class="No-Break"><strong class="bold">WARN</strong></span><span class="No-Break"> level</span></li>
				<li><strong class="source-inline">isErrorEnabled()</strong>: Checks whether the logger is enabled on the <span class="No-Break"><strong class="bold">ERROR</strong></span><span class="No-Break"> level</span></li>
			</ul>
			<h2 id="_idParaDest-152"><a id="_idTextAnchor162"/>Annotations in Lombok</h2>
			<p>Now let’s see how Lombok, a library<a id="_idIndexMarker623"/> in our Spring Boot application, can help us. Lombok can simplify <a id="_idIndexMarker624"/>our code by using annotations, but it also offers annotations for SLF4J and Log4j2 <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="source-inline">@log4j2</strong>: This annotation will generate a new Log4j2 instance in our class. The following example code will <span class="No-Break">be generated:</span><pre class="console">
public class LogExample {</pre><pre class="console">
       private static final org.SLF4J.Logger log =</pre><pre class="console">
         org.SLF4J.LoggerFactory.getLogger(</pre><pre class="console">
          LogExample.class);</pre><pre class="console">
   }</pre></li>
				<li><strong class="source-inline">@slf4j</strong>: This annotation will generate a new SLF4J instance in our class. The following example code will <span class="No-Break">be generated:</span><pre class="console">
public class LogExample {</pre><pre class="console">
  private static final org.SLF4J.Logger log =</pre><pre class="console">
     org.SLF4J.LoggerFactory.getLogger(</pre><pre class="console">
       LogExample.class);</pre><pre class="console">
   }</pre></li>
				<li>The <strong class="source-inline">slf4j</strong> annotation is recommended as it allows the switching of <span class="No-Break">logging frameworks.</span></li>
			</ul>
			<p>Once we have used the annotations in our class, we don’t need to create a new instance and we can use the log directly in <span class="No-Break">our methods:</span></p>
			<pre class="console">
//LOMBOK SLF4J
log.info("Using SLF4J Lombok: Getting anti-hero list - getAntiHeroes()");</pre>
			<h1 id="_idParaDest-153"><a id="_idTextAnchor163"/>Summary</h1>
			<p>This chapter has explained the concept and importance of loggers and how they can help developers in debugging and maintaining applications. It has introduced Log4j2, a third-party framework for Spring Boot that offers several features, such as <strong class="bold">Appenders</strong>, <strong class="bold">Filters</strong>, and <strong class="bold">Markers</strong>, which can assist in categorizing and formatting log events for developers. It has also introduced the concept of SLF4J, which is an abstraction of logging frameworks that allows us to switch between different frameworks at runtime <span class="No-Break">or deployment.</span></p>
			<p>In the following chapter, we will learn about the concepts and integration of unit testing in our Spring <span class="No-Break">Boot application.</span></p>
		</div>
	</body></html>