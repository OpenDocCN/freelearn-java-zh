<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Reporting and Documentation"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Reporting and Documentation</h1></div></div></div><p>In this chapter, we will see how we can use the Maven Site plugin, as well as configure various reports on a site. We will cover the following recipes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Documenting with the Maven Site plugin</li><li class="listitem" style="list-style-type: disc">Generating Javadocs for a site</li><li class="listitem" style="list-style-type: disc">Generating source cross-reference for a site</li><li class="listitem" style="list-style-type: disc">Generating unit test reports for a site</li><li class="listitem" style="list-style-type: disc">Generating code coverage reports for a site</li><li class="listitem" style="list-style-type: disc">Generating code quality reports for a site</li><li class="listitem" style="list-style-type: disc">Generating selective reports</li><li class="listitem" style="list-style-type: disc">Deploying a site</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec68"/>Introduction</h1></div></div></div><p>One of the most powerful features of Maven is the ability to create documentation for the project. It is useful to have a self-documenting project that can be published to a website without additional effort. Maven provides the ability to generate this documentation, known as a site report, and publish it to a website.</p><p>Many Maven plugins use the Site feature to generate project documentation. In fact, Maven itself uses the Site plugin to generate its website.</p></div></div>
<div class="section" title="Documenting with the Maven Site plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec69"/>Documenting with the Maven Site plugin</h1></div></div></div><p>Along with the <code class="literal">clean</code> and <code class="literal">default</code> lifecycle, Maven<a id="id393" class="indexterm"/> also consists of a <code class="literal">site</code> <a id="id394" class="indexterm"/>lifecycle. Like <code class="literal">clean</code>, <code class="literal">site</code> is implemented by a Maven plugin, in this case, the Maven Site plugin.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec168"/>Getting ready</h2></div></div></div><p>Maven is set up on your system and is verified for work. To do this, refer to the first three recipes of <a class="link" href="ch01.html" title="Chapter 1. Getting Started">Chapter 1</a>, <span class="emphasis"><em>Getting Started</em></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec169"/>How to do it...</h2></div></div></div><p>Use the following steps to generate<a id="id395" class="indexterm"/> documentation using the Maven Site plugin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open one of the <a id="id396" class="indexterm"/>Maven projects for which we need to generate a site report (for instance, <code class="literal">project-with-documentation</code>).</li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">Observe the output as shown in the following screenshot:<div class="mediaobject"><img src="graphics/6124OS_07_01.jpg" alt="How to do it..."/></div></li><li class="listitem">Open the <code class="literal">index.html</code> file generated in the <code class="literal">target/site</code> folder:<div class="mediaobject"><img src="graphics/6124OS_07_02.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec170"/>How it works...</h2></div></div></div><p>
<code class="literal">Site</code> is one of the Maven <a id="id397" class="indexterm"/>lifecycles. When the <code class="literal">mvn site</code> command is run, it <a id="id398" class="indexterm"/>invokes the <code class="literal">site</code> phase of the <code class="literal">site</code> lifecycle. The <code class="literal">site</code> goal of the Maven Site plugin is bound to this phase and is invoked.</p><p>The <code class="literal">site</code> goal performs a series of steps to generate the report. It uses various elements in the pom file related to this. Let us look at the various items in the default report:</p><div class="mediaobject"><img src="graphics/6124OS_07_03.jpg" alt="How it works..."/></div><p>In addition to this, the <code class="literal">site</code> command<a id="id399" class="indexterm"/> generates reports based on the contents of <a id="id400" class="indexterm"/>the <code class="literal">reporting</code> section of the pom:</p><div class="informalexample"><pre class="programlisting">&lt;reporting&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;artifactId&gt;maven-project-info-reports-plugin&lt;/artifactId&gt;
      &lt;version&gt;2.0.1&lt;/version&gt;
      &lt;reportSets&gt;
        &lt;reportSet&gt;&lt;/reportSet&gt;
      &lt;/reportSets&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/reporting&gt;</pre></div><p>A number of Maven plugins can generate reports defined and configured under the <code class="literal">reporting</code> element. We will see many reports in the following sections.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec171"/>There's more...</h2></div></div></div><p>We have only<a id="id401" class="indexterm"/> seen what the default <code class="literal">site</code> command offers. The Maven Site plugin offers various configurations to make many more customizations. Some of them are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Create a different documentation format: The default format of the site is APT (almost plain text), a wiki-like format</li><li class="listitem" style="list-style-type: disc">Override the default navigation tree: This is required if you want to insert additional content in the site</li><li class="listitem" style="list-style-type: disc">Creating skins: This is needed if you want to style the site reports differently</li></ul></div><p>Let us see how to do some of these:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the <code class="literal">site.xml</code> file with the following content to the <code class="literal">src\site</code> folder of the <code class="literal">project-with-documentation</code> project folder:<div class="informalexample"><pre class="programlisting">&lt;project   xsi:schemaLocation="http://maven.apache.org/DECORATION/1.6.0 http://maven.apache.org/xsd/decoration-1.6.0.xsd" name="Project with Documentation"&gt;
    &lt;bannerLeft&gt;
        &lt;name&gt;Left Banner&lt;/name&gt;
        &lt;src&gt;images/packt.png&lt;/src&gt;
        &lt;href&gt;http://www.packtpub.com&lt;/href&gt;
    &lt;/bannerLeft&gt;
    &lt;body&gt;
        &lt;menu name="Project with Documentation"&gt;
            &lt;item name="Overview" href="index.html"/&gt;
        &lt;/menu&gt;
        &lt;menu ref="reports"/&gt;
    &lt;/body&gt;
&lt;/project&gt;</pre></div></li><li class="listitem">Add the image named <code class="literal">packt.png</code> to the <code class="literal">src\site\resources\images</code> folder.</li><li class="listitem">Now, add the <code class="literal">index.apt</code> file in the <code class="literal">src\site\apt</code> folder with the following content:<div class="informalexample"><pre class="programlisting">Welcome to Project with Documentation. This is a maven project created as part of apache maven cookbook by Packt Publishing.

What is Project with Documentation?

This maven project contains examples of how to use the site feature of maven.</pre></div></li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn clean site</strong></span>
</pre></div></li><li class="listitem">View the <a id="id402" class="indexterm"/>generated site report:<div class="mediaobject"><img src="graphics/6124OS_07_04.jpg" alt="There's more..."/></div></li></ol></div><p>You can see a customized site page with the logo and the content that we specified.</p></div></div>
<div class="section" title="Generating Javadocs for a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec70"/>Generating Javadocs for a site</h1></div></div></div><p>Documentation for <a id="id403" class="indexterm"/>Java projects is created using Javadocs. Maven provides <a id="id404" class="indexterm"/>support not only to generate Javadocs, but also to publish them as part of the site. Plugins configured within the <code class="literal">reporting</code> element will generate content for the site. When they are configured within the <code class="literal">build</code> element, they can generate reports independent of site.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec172"/>How to do it...</h2></div></div></div><p>Use the following steps to generate Javadocs for a site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the Maven project <code class="literal">project-with-documentation</code>.</li><li class="listitem">Add the following section in the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;reporting&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
      &lt;version&gt;2.10.1&lt;/version&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/reporting&gt;</pre></div></li><li class="listitem">Run the <a id="id405" class="indexterm"/>following<a id="id406" class="indexterm"/> command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">See the report generated:<div class="mediaobject"><img src="graphics/6124OS_07_05.jpg" alt="How to do it..."/></div></li><li class="listitem">Click on the <span class="strong"><strong>JavaDocs</strong></span> link:<div class="mediaobject"><img src="graphics/6124OS_07_06.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec173"/>How it works...</h2></div></div></div><p>We added the<a id="id407" class="indexterm"/> Javadoc plugin to the <code class="literal">reporting</code> section of <code class="literal">pom</code>. When <a id="id408" class="indexterm"/>the Site plugin runs, it examines this section and runs the reports configured there. In this case, it found <code class="literal">javadoc</code> and ran the relevant plugin to generate the Javadoc reports for the project.</p><p>Maven links the report from the site page in the <span class="strong"><strong>Project Reports</strong></span> section.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec174"/>There's more...</h2></div></div></div><p>What if we do not want to document the test classes, but only the source? We can configure the plugin to do this by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the following code to the <code class="literal">reporting</code> section where we set the value of <code class="literal">report</code> element to <code class="literal">javadoc</code>:<div class="informalexample"><pre class="programlisting">        &lt;reportSets&gt;
          &lt;reportSet&gt;
            &lt;reports&gt;
              &lt;report&gt;javadoc&lt;/report&gt;
            &lt;/reports&gt;
           &lt;/reportSet&gt;
        &lt;/reportSets&gt;</pre></div></li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">Open the <a id="id409" class="indexterm"/>resulting Site web page. Only the <span class="strong"><strong>JavaDocs</strong></span> link is<a id="id410" class="indexterm"/> present on the site. The <span class="strong"><strong>Test JavaDocs</strong></span> link is no longer present.</li></ol></div></div></div>
<div class="section" title="Generating source cross-reference for a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec71"/>Generating source cross-reference for a site</h1></div></div></div><p>In the previous chapter, we <a id="id411" class="indexterm"/>saw how the Maven JXR plugin generates<a id="id412" class="indexterm"/> source cross-reference. When publishing a project, it is useful to provide a way to refer to sources in addition to Javadocs. Let us see how to make that part of the site report.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec175"/>How to do it...</h2></div></div></div><p>Use the following steps to generate source cross-reference for a site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the Maven project <code class="literal">project with documentation</code>.</li><li class="listitem">Add the following code to the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-jxr-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.5&lt;/version&gt;
&lt;/plugin&gt;</pre></div></li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">Open the generated site report:<div class="mediaobject"><img src="graphics/6124OS_07_07.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec176"/>How it works...</h2></div></div></div><p>Adding the Maven <a id="id413" class="indexterm"/>JXR plugin to the <code class="literal">reporting</code> section of <a id="id414" class="indexterm"/>pom automatically creates the project source cross-reference. By default, both source and test cross-references are generated. Like Javadoc, the <code class="literal">reportSet</code> element can be configured if we do not want a cross-reference for test classes.</p></div></div>
<div class="section" title="Generating unit test reports for a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec72"/>Generating unit test reports for a site</h1></div></div></div><p>When we have unit tests for our<a id="id415" class="indexterm"/> project, it will be good to see the test reports <a id="id416" class="indexterm"/>in the site documentation. Let us see how to do this.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec177"/>How to do it...</h2></div></div></div><p>Use the following steps to generate unit test reports for a site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the Maven project for which you want to generate the site documentation (for instance, <code class="literal">project-with-documentation</code>).</li><li class="listitem">Add the following code in the reporting section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-surefire-report-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.18&lt;/version&gt;
&lt;/plugin&gt;</pre></div></li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">Observe the generated site report:<div class="mediaobject"><img src="graphics/6124OS_07_08.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec178"/>How it works...</h2></div></div></div><p>If you recall, we use the <a id="id417" class="indexterm"/>Maven Surefire plugin to run tests. Surefire<a id="id418" class="indexterm"/> provides a Surefire Report plugin. When this plugin is added to the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file, it includes the test report in the site documentation.</p><p>The reports are identical, irrespective of whether JUnit or TestNG is used for unit testing.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip11"/>Tip</h3><p>In addition to the format of the report for the site, TestNG generates additional reports in a different format. These are available in the <code class="literal">target</code> folder but are not part of the site documentation.</p></div></div></div></div>
<div class="section" title="Generating code coverage reports for a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec73"/>Generating code coverage reports for a site</h1></div></div></div><p>Let us now include code coverage from the unit tests of our project in the site documentation.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec179"/>How to do it...</h2></div></div></div><p>Use the following steps to <a id="id419" class="indexterm"/>generate code coverage reports for <a id="id420" class="indexterm"/>a site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the Maven project for which you want to do this (for instance, <code class="literal">project-with-documentation</code>).</li><li class="listitem">Add the following code in the <code class="literal">&lt;build&gt;</code> section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">    &lt;plugin&gt;
      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
      &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;0.7.2.201409121644&lt;/version&gt;
      &lt;executions&gt;
          &lt;execution&gt;
          &lt;id&gt;default-prepare-agent&lt;/id&gt;
          &lt;goals&gt;
              &lt;goal&gt;prepare-agent&lt;/goal&gt;
          &lt;/goals&gt;
          &lt;/execution&gt;
      &lt;/executions&gt;
    &lt;/plugin&gt;</pre></div></li><li class="listitem">Add the following code in the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;plugin&gt;
    &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
    &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;0.7.2.201409121644&lt;/version&gt;
&lt;/plugin&gt;</pre></div></li><li class="listitem">Run the following Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn test site</strong></span>
</pre></div></li><li class="listitem">Observe the site report as shown in following screenshot:<div class="mediaobject"><img src="graphics/6124OS_07_09.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec180"/>How it works...</h2></div></div></div><p>The JaCoCo unit test <a id="id421" class="indexterm"/>coverage report shows up in site<a id="id422" class="indexterm"/> documentation on account of the following issues:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">As the <code class="literal">prepare-agent</code> goal of the JaCoCo plugin is added to the <code class="literal">build</code> section, Maven runs the JaCoCo agent</li><li class="listitem" style="list-style-type: disc">As the <code class="literal">test</code> goal is run, Maven runs the test and the agent analyzes the tests for coverage</li><li class="listitem" style="list-style-type: disc">As the JaCoCo plugin is added to the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file, the coverage report is generated and linked to the site documentation</li><li class="listitem" style="list-style-type: disc">As you can see, the same plugin is added to the <code class="literal">build</code> and <code class="literal">reporting</code> section and does different things</li></ul></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec181"/>There's more...</h2></div></div></div><p>If you were to use Cobertura<a id="id423" class="indexterm"/> instead of JaCoCo to generate<a id="id424" class="indexterm"/> test coverage, you could do the following:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Remove the lines related to JaCoCo in the <code class="literal">build</code> and <code class="literal">reporting</code> sections.</li><li class="listitem">Add the following code to the reporting section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;cobertura-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.6&lt;/version&gt;
      &lt;/plugin&gt;</pre></div></li><li class="listitem">Run the following Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site</strong></span>
</pre></div></li><li class="listitem">Open the site <a id="id425" class="indexterm"/>documentation:<div class="mediaobject"><img src="graphics/6124OS_07_10.jpg" alt="There's more..."/></div></li></ol></div><p>You will notice two <a id="id426" class="indexterm"/>things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">We didn't need to specify anything in the <code class="literal">build</code> section</li><li class="listitem" style="list-style-type: disc">We didn't need to run the <code class="literal">test</code> goal explicitly; the Maven Cobertura plugin did this.</li></ul></div></div></div>
<div class="section" title="Generating code quality reports for a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec74"/>Generating code quality reports for a site</h1></div></div></div><p>We have seen how to use various <a id="id427" class="indexterm"/>code quality tools to perform static code<a id="id428" class="indexterm"/> analysis. Let us now see how we can update our site documentation with reports from these tools.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec182"/>How to do it...</h2></div></div></div><p>Use the following steps to generate code quality reports for a site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the project for which we want to generate the site report.</li><li class="listitem">Add the following code to the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.3&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-checkstyle-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.13&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;findbugs-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.0.0&lt;/version&gt;
      &lt;/plugin&gt;&gt;</pre></div></li><li class="listitem">Run the<a id="id429" class="indexterm"/> following<a id="id430" class="indexterm"/> Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn test site</strong></span>
</pre></div></li><li class="listitem">Open the generated site report:<div class="mediaobject"><img src="graphics/6124OS_07_11.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec183"/>How it works...</h2></div></div></div><p>For each of the code quality tools specified in the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file, the <code class="literal">site</code> goal runs the specified tool, generates the report, and links to the site documentation.</p><p>Clicking on each of the links takes the user to the specific report.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec184"/>There's more...</h2></div></div></div><p>If you have chosen to use SonarQube for analysis and want to link the Sonar report<a id="id431" class="indexterm"/> to the site documentation, then you can <a id="id432" class="indexterm"/>do the following:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the following code in the reporting section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;plugin&gt;
  &lt;groupId&gt;org.codehaus.sonar-plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-report&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
&lt;/plugin&gt;</pre></div></li><li class="listitem">Generate the site by running the following Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn test site</strong></span>
</pre></div></li><li class="listitem">Open the site report:<div class="mediaobject"><img src="graphics/6124OS_07_12.jpg" alt="There's more..."/></div></li></ol></div><p>A new <span class="strong"><strong>Sonar</strong></span> link is present in <span class="strong"><strong>Project Reports</strong></span>, which automatically redirects to the default Sonar installation. The link can be customized to the appropriate URL, if it is different.</p></div></div>
<div class="section" title="Generating selective reports"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec75"/>Generating selective reports</h1></div></div></div><p>We have seen that by <a id="id433" class="indexterm"/>default the <code class="literal">site</code> command generates some <span class="strong"><strong>Project Information</strong></span>. Some of it, for instance <span class="strong"><strong>Mailing Lists</strong></span>, may be nonexistent or irrelevant to the project. Let us see how we can avoid generating these. The Maven Project Info Reports plugin is the plugin that provides the standard reports from pom. It can be configured to exclude specific reports.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec185"/>How to do it...</h2></div></div></div><p>Use the following steps to generate selective site report:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the project <a id="id434" class="indexterm"/>for which you want to generate the site report.</li><li class="listitem">Add the following code to the <code class="literal">reporting</code> section of the <code class="literal">pom.xml</code> file:<div class="informalexample"><pre class="programlisting">  &lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-project-info-reports-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.7&lt;/version&gt;
    &lt;reportSets&gt;
      &lt;reportSet&gt;
        &lt;reports&gt;
          &lt;report&gt;dependencies&lt;/report&gt;
          &lt;report&gt;project-team&lt;/report&gt;
          &lt;report&gt;license&lt;/report&gt;
          &lt;report&gt;scm&lt;/report&gt;
        &lt;/reports&gt;
      &lt;/reportSet&gt;
    &lt;/reportSets&gt;
  &lt;/plugin&gt;</pre></div></li><li class="listitem">Run the following Maven <code class="literal">site</code> command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn test site</strong></span>
</pre></div></li><li class="listitem">Open the generated report:<div class="mediaobject"><img src="graphics/6124OS_07_13.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec186"/>How it works...</h2></div></div></div><p>We explicitly specified the<a id="id435" class="indexterm"/> reports that we wanted to see in <span class="strong"><strong>Project Information</strong></span>. Due to this, only those reports are generated and displayed.</p><p>This allows us to avoid generating and displaying reports that are not applicable to the project.</p></div></div>
<div class="section" title="Deploying a site"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec76"/>Deploying a site</h1></div></div></div><p>Once a site report is <a id="id436" class="indexterm"/>generated, it needs to be published. While this can be done manually, Maven also provides facilities to do this. Let us see how.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec187"/>Getting ready</h2></div></div></div><p>To publish a site, you need to have access to the web server where the site has to be deployed.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec188"/>How to do it...</h2></div></div></div><p>To deploy a site, use the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the following code to your <code class="literal">pom.xml</code> file. This could also be added in <code class="literal">settings.xml</code>:<div class="informalexample"><pre class="programlisting">  &lt;distributionManagement&gt;
    &lt;site&gt;
      &lt;id&gt;myorg&lt;/id&gt;
      &lt;url&gt;scp://www.myorg.com/project/&lt;/url&gt;
    &lt;/site&gt;
  &lt;/distributionManagement&gt;</pre></div></li><li class="listitem">For the corresponding ID, add the relevant username and password in your <code class="literal">settings.xml</code> file:<div class="informalexample"><pre class="programlisting">&lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;myorg&lt;/id&gt;
      &lt;username&gt;username&lt;/username&gt;
      &lt;password&gt;password&lt;/password&gt;
      &lt;filePermissions&gt;664&lt;/filePermissions&gt;
      &lt;directoryPermissions&gt;775&lt;/directoryPermissions&gt;
    &lt;/server&gt;
  &lt;/servers&gt;</pre></div></li><li class="listitem">Run the following Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site-deploy</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec189"/>How it works...</h2></div></div></div><p>When the <code class="literal">site-deploy</code> goal is run, Maven<a id="id437" class="indexterm"/> first builds the site. Then, it uses the entry set in the <code class="literal">distributionManagement</code> element to determine how the site needs to be deployed. The first part of the URL is the protocol to be used to transfer the file. In this case, it is <code class="literal">scp</code>. It uses the credentials specified in the <code class="literal">settings.xml</code> file and transfers the file to the destination.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec190"/>There's more...</h2></div></div></div><p>If you want to test your site<a id="id438" class="indexterm"/> before deploying, you can easily do so in the following way:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Run the following Maven command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn site:run</strong></span>
</pre></div></li><li class="listitem">Open the browser and go to <code class="literal">http://localhost:8080</code>:<div class="mediaobject"><img src="graphics/6124OS_07_14.jpg" alt="There's more..."/></div></li></ol></div><p>The run goal of the Maven Site plugin deploys the site in a<a id="id439" class="indexterm"/> <span class="strong"><strong>jetty server</strong></span>, which is started by default by port <code class="literal">8080</code>. This allows you to view the site report and verify it before publishing.</p></div></div></body></html>