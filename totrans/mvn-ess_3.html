<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Maven Archetypes"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Maven Archetypes</h1></div></div></div><p>The word <span class="strong"><strong>archetype</strong></span> has its roots in Greek literature. It's derived from two Greek words, <span class="strong"><strong>archein</strong></span> and <span class="strong"><strong>typos</strong></span>. The word archein means original or old, while typos means patterns.</p><p>The word archetype means <a id="id104" class="indexterm"/>original patterns. The famous psychologist, Carl Gustav Jung introduced the archetype concept in psychology. Jung argued that there are 12 different archetypes that represent human motivation, and he further divided them into three categories: ego, soul, and self. The innocent, regular guy, hero, and caregiver fall under the ego type. The explorer, rebel, lover, and creator fall under the soul type. The self type includes jester, sage, magician, and ruler. The concept behind Maven archetypes does not deviate a lot from what Jung explained in psychology.</p><p>The following figure shows the relationship between a Maven project, a project archetype, and projects generated from the archetype:</p><div class="mediaobject"><img src="graphics/B02157_03_01.jpg" alt="Maven Archetypes"/></div><p>When we create a Java project, we need to structure it in different ways based on the type of the project. If it's a Java EE web application, then we need to have a <code class="literal">WEB-INF</code> directory and a <code class="literal">web.xml</code> file. If it's a Maven plugin project, we need to have a <code class="literal">Mojo</code> class that extends from <code class="literal">org.apache.maven.plugin.AbstractMojo</code>. As each type of project has its own predefined structure, why would everyone have to build the same structure again and again? Why not start with a template? Each project can have its own template, and developers can extend the template to suite their requirements. Maven archetypes address this concern. Each archetype is a project template.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note16"/>Note</h3><p>A list of Maven <a id="id105" class="indexterm"/>archetypes can be found at <a class="ulink" href="http://maven-repository.com/archetypes">http://maven-repository.com/archetypes</a>.</p></div></div><p>In this chapter, we will discuss the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Maven archetype plugin</li><li class="listitem" style="list-style-type: disc">The most used archetypes</li></ul></div><div class="section" title="Archetype quickstart"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec24"/>Archetype quickstart</h1></div></div></div><p>The Maven <a id="id106" class="indexterm"/>
<code class="literal">archetype</code> is a plugin in itself. We will discuss plugins in detail in <a class="link" href="ch04.html" title="Chapter 4. Maven Plugins">Chapter 4</a>, <span class="emphasis"><em>Maven Plugins</em></span>. The <code class="literal">generate</code> goal of the <code class="literal">archetype</code> plugin has been used to generate a Maven project from an archetype. Let's start with a simple example:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate </strong></span>
<span class="strong"><strong>            -DgroupId=com.packt.samples  </strong></span>
<span class="strong"><strong>            -DartifactId=com.packt.samples.archetype </strong></span>
<span class="strong"><strong>            -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>            -DinteractiveMode=false</strong></span>
</pre></div><p>This command will invoke the <code class="literal">generate</code> goal of the Maven <code class="literal">archetype</code> plugin to create a simple Java project. You will see that the following project structure has been created with a sample POM file. The name of the root or the base directory is derived from the value of the <code class="literal">artifactId</code> parameter:</p><div class="informalexample"><pre class="programlisting">com.packt.samples.archetype 
               |-pom.xml
               |-src
               |-main/java/com/packt/samples/App.java
               |-test/java/com/packt/samples/AppTest.java    </pre></div><p>The sample POM file will only have a dependency to the <code class="literal">junit</code> JAR file, with <code class="literal">test</code> as the scope:</p><div class="informalexample"><pre class="programlisting">&lt;project&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.packt.samples&lt;/groupId&gt;
  &lt;artifactId&gt;com.packt.samples.archetype&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
  &lt;name&gt;com.packt.samples.archetype&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/project&gt;</pre></div><p>The generated <code class="literal">App.java</code> class will have the following template code. The name of the package is derived from the provided <code class="literal">groupId</code> parameter. If we want a different value as the package name, then <a id="id107" class="indexterm"/>we need to pass this value in the command itself as <code class="literal">-Dpackage=com.packt.samples.application</code>:</p><div class="informalexample"><pre class="programlisting">package com.packt.samples;

/**
 * Hello world!
 *
 */
public class App 
{
    public static void main( String[] args )
    {
        System.out.println( "Hello World!" );
    }
}</pre></div><p>This is the simplest way to get started with a Maven project. In the previous example, we used the non-interactive mode by setting <code class="literal">interactiveMode=false</code>. This will force the plugin to use whatever values we passed in the command itself, along with the default values.</p><p>To invoke the plugin in the interactive mode, just type <code class="literal">mvn archetype:generate</code>. This will prompt for user inputs as the plugin proceeds with its execution. The very first one is to ask for a filter or a number for the type of the archetype. The filter can be specified in the format of <code class="literal">[groupdId:]artifactId</code>, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 471:</strong></span>
</pre></div><p>When you type the filter criteria, for example, <code class="literal">org.apache.maven.archetypes:maven-archetype-quickstart</code>, the plugin will display the number associated with it, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 471: org.apache.maven.archetypes:maven-archetype-quickstart</strong></span>

<span class="strong"><strong>Choose archetype:</strong></span>
<span class="strong"><strong>1: remote -&gt; org.apache.maven.archetypes:maven-archetype-quickstart (An archetype which contains a sample Maven project.)</strong></span>

<span class="strong"><strong>Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 1:</strong></span>
</pre></div><p>In this case, there is only one <code class="literal">archetype</code> which matches the filter, and the number associated with it is <code class="literal">1</code>. If you press <span class="emphasis"><em>Enter</em></span> against the last line in the previous output, or just type <code class="literal">1</code>, the plugin <a id="id108" class="indexterm"/>will start to proceed with the <code class="literal">org.apache.maven.archetypes:maven-archetype-quickstart</code> archetype.</p><p>Something that you might have already noticed is that as soon as you type <code class="literal">mvn archetype:generate</code>, the plugin displays a long list of Maven archetypes supported by the plugin, and each archetype has a number associated with it. You can avoid this long list by specifying a filter criterion with the command itself, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate </strong></span>
<span class="strong"><strong>  –Dfilter=org.apache.maven.archetypes:maven-archetype-quickstart</strong></span>

<span class="strong"><strong>Choose archetype:</strong></span>
<span class="strong"><strong>1: remote -&gt; org.apache.maven.archetypes:maven-archetype-quickstart (An archetype which contains a sample Maven project.)</strong></span>

<span class="strong"><strong>Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 1:</strong></span>
</pre></div></div></div>
<div class="section" title="Batch mode"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Batch mode</h1></div></div></div><p>The <code class="literal">archetype</code> <a id="id109" class="indexterm"/>plugin can operate in the batch mode either by setting the <code class="literal">interactiveMode</code> argument to <code class="literal">false</code> or passing <code class="literal">-B</code> as an argument. When operating in the batch mode, you need to clearly specify which archetype you are going to use with the arguments <code class="literal">archetypeGroupId</code>, <code class="literal">archetypeArtifactId</code>, and <code class="literal">archetypeVersion</code>. You also need to clearly identify the resultant artifact with the <code class="literal">groupId</code>, <code class="literal">artifactId</code>, <code class="literal">version</code>, and <code class="literal">package</code> arguments, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B </strong></span>
<span class="strong"><strong>                     -DarchetypeGroupId=org.apache.maven.archetypes </strong></span>
<span class="strong"><strong>                     -DarchetypeArtifactId=maven-archetype-quickstart </strong></span>
<span class="strong"><strong>                     -DarchetypeVersion=1.0 </strong></span>
<span class="strong"><strong>                     -DgroupId=com.packt.samples  </strong></span>
<span class="strong"><strong>                     -DartifactId=com.packt.samples.archetype </strong></span>
<span class="strong"><strong>                     -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>                     -Dpackage=1.5</strong></span>
</pre></div><p>Any inquisitive mind should be asking a very valid question by now.</p><p>In the non-interactive mode, we did not type any filter or provide any Maven coordinates for the archetype in the very first example. So, how does the plugin know about the archetype? When no archetype is specified, the plugin goes with the default one, which is <code class="literal">org.apache.maven.archetypes:maven-archetype-quickstart</code>.</p></div>
<div class="section" title="Archetype catalogues"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Archetype catalogues</h1></div></div></div><p>How does the <a id="id110" class="indexterm"/>plugin find all the archetypes available in the system? When you just <a id="id111" class="indexterm"/>type <code class="literal">mvn archetype:generate</code>, a list of archetypes is displayed by the plugin for the user selection. The complete list is around 1100, but only the first 10 are shown here:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>1: remote -&gt; br.com.ingenieux:elasticbeanstalk-service-webapp-archetype (A Maven Archetype Encompassing RestAssured, Jetty, Jackson, Guice and Jersey for Publishing JAX-RS-based Services on AWS' Elastic Beanstalk Service)</strong></span>
<span class="strong"><strong>2: remote -&gt; br.com.ingenieux:elasticbeanstalk-wrapper-webapp-archetype (A Maven Archetype Wrapping Existing war files on AWS' Elastic Beanstalk Service)</strong></span>
<span class="strong"><strong>3: remote -&gt; br.com.otavio.vraptor.archetypes:vraptor-archetype-blank (A simple project to start with VRaptor 4)</strong></span>
<span class="strong"><strong>4: remote -&gt; br.gov.frameworkdemoiselle.archetypes:demoiselle-html-rest (Archetype for web applications (HTML + REST) using Demoiselle Framework)</strong></span>
<span class="strong"><strong>5: remote -&gt; br.gov.frameworkdemoiselle.archetypes:demoiselle-jsf-jpa (Archetype for web applications (JSF + JPA) using Demoiselle Framework)</strong></span>
<span class="strong"><strong>6: remote -&gt; br.gov.frameworkdemoiselle.archetypes:demoiselle-minimal (Basic archetype for generic applications using Demoiselle Framework)</strong></span>
<span class="strong"><strong>7: remote -&gt; br.gov.frameworkdemoiselle.archetypes:demoiselle-vaadin-jpa (Archetype for Vaadin web applications)</strong></span>
<span class="strong"><strong>8: remote -&gt; ch.sbb.maven.archetypes:iib9-maven-projects (IBM Integration Bus 9 Maven Project Structure)</strong></span>
<span class="strong"><strong>9: remote -&gt; ch.sbb.maven.archetypes:wmb7-maven-projects (WebSphere Message Broker 7 Maven Project Structure)</strong></span>
<span class="strong"><strong>10: remote -&gt; co.ntier:spring-mvc-archetype (An extremely simple Spring MVC archetype, configured with NO XML.)</strong></span>
</pre></div><p>Going back to the original question, how does the plugin find these details about different archetypes?</p><p>The <code class="literal">archetype</code> <a id="id112" class="indexterm"/>plugin maintains the details about different archetypes in an internal catalogue, which comes with the plugin itself. The archetype catalogue is simply an <a id="id113" class="indexterm"/>XML file. The following shows the internal catalogue of the <code class="literal">archetype</code> plugin:</p><div class="informalexample"><pre class="programlisting">&lt;archetype-catalog&gt;

&lt;!-- Internal archetype catalog listing archetypes from the Apache Maven project. --&gt;

 &lt;archetypes&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-archetype&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample archetype.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-j2ee-simple&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;description&gt;An archetype which contains a simplifed sample J2EE application.&lt;/description&gt;
 &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.2&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven plugin.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-plugin-site&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven plugin site.This archetype can be layered upon an existing Maven plugin project.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-portlet&lt;/artifactId&gt;
    &lt;version&gt;1.0.1&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample JSR-268 Portlet.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-profiles&lt;/artifactId&gt;
    &lt;version&gt;1.0-alpha-4&lt;/version&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-quickstart&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven project.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-site&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven site which demonstrates some of the supported document types like APT, XDoc, and FML and demonstrates how to i18n your site. This archetype can be layered upon an existing Maven project.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-site-simple&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven site.&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    &lt;groupId&gt;org.apache.maven.archetypes&lt;/groupId&gt;
    &lt;artifactId&gt;maven-archetype-webapp&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;description&gt;An archetype which contains a sample Maven Webapp project.&lt;/description&gt;
  &lt;/archetype&gt;
 &lt;/archetypes&gt;
&lt;/archetype-catalog&gt;</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>In addition to the internal catalogue, you can also maintain a <code class="literal">local</code> archetype catalogue. This is <a id="id114" class="indexterm"/>available at <code class="literal">USER_HOME/.m2/archetype-catalog.xml</code>, and by default, it's an empty file.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note17"/>Note</h3><p>There is also a remote <a id="id115" class="indexterm"/>catalogue available at <a class="ulink" href="http://repo1.maven.org/maven2/archetype-catalog.xml">http://repo1.maven.org/maven2/archetype-catalog.xml</a>.</p></div></div><p>By default, the <code class="literal">archetype</code> <a id="id116" class="indexterm"/>plugin will load all the available archetypes from the <code class="literal">local</code> and <code class="literal">remote</code> catalogues. If we go back to the archetype list displayed by the plugin and type <code class="literal">mvn archetype:generate</code>, then by looking at each entry, we can determine whether a given archetype is loaded from the <code class="literal">internal</code>, <code class="literal">local</code>, or <code class="literal">remote</code> catalogue.</p><p>For example, the following archetype is loaded from the <code class="literal">remote</code> catalogue:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>1: remote -&gt; br.com.ingenieux:elasticbeanstalk-service-webapp-archetype (A Maven Archetype Encompassing RestAssured, Jetty, Jackson, Guice and Jersey for Publishing JAX-RS-based Services on AWS' Elastic Beanstalk Service)</strong></span>
</pre></div><p>If you want to force the <code class="literal">archetype</code> plugin to list all the archetypes from the internal catalogue only, then you need to use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -DarchetypeCatalog=internal</strong></span>
</pre></div><p>To list all the archetypes from the <code class="literal">local</code> catalogue only, you need to use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -DarchetypeCatalog=local</strong></span>
</pre></div><p>To list all the archetypes <a id="id117" class="indexterm"/>from the <code class="literal">internal</code>, <code class="literal">local</code>, and <code class="literal">remote</code> catalogues, you <a id="id118" class="indexterm"/>need to use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -DarchetypeCatalog=internal,local,remote</strong></span>
</pre></div><div class="section" title="Building an archetype catalogue"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec21"/>Building an archetype catalogue</h2></div></div></div><p>In addition to the <code class="literal">internal</code>, <code class="literal">local</code>, and <code class="literal">remote</code> catalogues, you can also build your own catalogue. Say <a id="id119" class="indexterm"/>you have developed your own set of Maven archetypes and need to build a catalogue out of them, which can be shared with others by publicly hosting it. Once you have built the archetypes, they will be available in your <code class="literal">local</code> Maven repository. The following command will crawl through the <code class="literal">local</code> Maven repository and build an archetype catalogue from all the archetypes available there. Here, we use the <code class="literal">crawl</code> goal of the <code class="literal">archetype</code> plugin:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:crawl -Dcatalog=my-catalog.xml</strong></span>
</pre></div></div><div class="section" title="Public archetype catalogues"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec22"/>Public archetype catalogues</h2></div></div></div><p>People who develop <a id="id120" class="indexterm"/>archetypes for their projects will list them in publicly hosted archetype catalogues. The following list shows some of the publicly available Maven archetype catalogues:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Fuse</strong></span>: The Fuse <a id="id121" class="indexterm"/>archetype <a id="id122" class="indexterm"/>catalogue can be found at <a class="ulink" href="http://repo.fusesource.com/nexus/content/groups/public/archetype-catalog.xml">http://repo.fusesource.com/nexus/content/groups/public/archetype-catalog.xml</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Java.net</strong></span>: The Java.net <a id="id123" class="indexterm"/>archetype <a id="id124" class="indexterm"/>catalogue can be found at <a class="ulink" href="https://java.net/projects/maven2-repository/sources/svn/content/trunk/repository/archetype-catalog.xml">https://java.net/projects/maven2-repository/sources/svn/content/trunk/repository/archetype-catalog.xml</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Cocoon</strong></span>: The Cocoon <a id="id125" class="indexterm"/>archetype <a id="id126" class="indexterm"/>catalogue can be found at <a class="ulink" href="http://cocoon.apache.org/archetype-catalog.xml">http://cocoon.apache.org/archetype-catalog.xml</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>MyFaces</strong></span>: The MyFaces archetype catalogue <a id="id127" class="indexterm"/>can <a id="id128" class="indexterm"/>be found at <a class="ulink" href="http://myfaces.apache.org/archetype-catalog.xml">http://myfaces.apache.org/archetype-catalog.xml</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Apache Synapse</strong></span>: The Apache Synapse <a id="id129" class="indexterm"/>archetype catalogue can be <a id="id130" class="indexterm"/>found at <a class="ulink" href="http://synapse.apache.org/archetype-catalog.xml">http://synapse.apache.org/archetype-catalog.xml</a></li></ul></div><p>Let's take Apache Synapse as an example. Synapse is an open source Apache project that builds an <span class="strong"><strong>enterprise </strong></span>
<a id="id131" class="indexterm"/>
<span class="strong"><strong>service bus</strong></span> (<span class="strong"><strong>ESB</strong></span>). The following command <a id="id132" class="indexterm"/>uses the Apache Synapse archetype to generate a Maven project:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate </strong></span>
<span class="strong"><strong>                   -DgroupId=com.packt.samples  </strong></span>
<span class="strong"><strong>                   -DartifactId=com.packt.samples.synapse   </strong></span>
<span class="strong"><strong>                   -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>                   -Dpackage=com.packt.samples.synapse.application </strong></span>
<span class="strong"><strong>                   -DarchetypeCatalog=http://synapse.apache.org  </strong></span>
<span class="strong"><strong>                   -DarchetypeGroupId=org.apache.synapse </strong></span>
<span class="strong"><strong>                   -DarchetypeArtifactId=synapse-package-archetype</strong></span>
<span class="strong"><strong>                   -DarchetypeVersion=2.0.0</strong></span>
<span class="strong"><strong>                   -DinteractiveMode=false</strong></span>
</pre></div><p>The previous command will produce the following directory structure. If you look at the <code class="literal">pom.xml</code> file, you will notice that it contains all the necessary instructions along with the required dependencies to build the Synapse project:</p><div class="informalexample"><pre class="programlisting">com.packt.samples.synapse 
                       |-pom.xml
                       |-src/main/assembly/bin.xml
                       |-conf/log4j.properties
                       |-repository/conf
                                      |-axis2.xml
                                      |-synapse.xml</pre></div><p>Let's have a look at the previous Maven command that we had used to build the project with the Synapse archetype. The most important argument is <code class="literal">archetypeCatalog</code>. The value of the <code class="literal">archetypeCatalog</code> argument can point directly to the <code class="literal">archetype-catalog.xml</code> file or to a directory that contains the <code class="literal">archetype-catalog.xml</code> file. The following configuration shows the <code class="literal">archetype-catalog.xml</code> file corresponding to the Synapse archetype. It only has a single archetype, but with two different versions:</p><div class="informalexample"><pre class="programlisting">&lt;archetype-catalog&gt;
 &lt;archetypes&gt;
  &lt;archetype&gt;
    <span class="strong"><strong>&lt;groupId&gt;org.apache.synapse&lt;/groupId&gt;</strong></span>
    <span class="strong"><strong>&lt;artifactId&gt;synapse-package-archetype&lt;/artifactId&gt;</strong></span>
    <span class="strong"><strong>&lt;version&gt;1.3&lt;/version&gt;</strong></span>
    &lt;repository&gt;http://repo1.maven.org/maven2&lt;/repository&gt;
    &lt;description&gt;Create a Synapse 1.3 custom package&lt;/description&gt;
  &lt;/archetype&gt;
  &lt;archetype&gt;
    <span class="strong"><strong>&lt;groupId&gt;org.apache.synapse&lt;/groupId&gt;</strong></span>
<span class="strong"><strong>    &lt;artifactId&gt;synapse-package-archetype&lt;/artifactId&gt;</strong></span>
    <span class="strong"><strong>&lt;version&gt;2.0.0&lt;/version&gt;</strong></span>
    &lt;repository&gt;
      http://people.apache.org/repo/m2-snapshot-repository
    &lt;/repository&gt;
    &lt;description&gt;Create a Synapse 2.0.0 custom package&lt;/description&gt;
  &lt;/archetype&gt;
 &lt;/archetypes&gt;
&lt;/archetype-catalog&gt;</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note18"/>Note</h3><p>The value of the <code class="literal">archetypeCatalog</code> parameter can be a comma-separated list, where each item points to an <code class="literal">archetype-catalog.xml</code> file or to a directory, which contains <code class="literal">archetype-catalog.xml</code>. The default values are <code class="literal">remote</code> and <code class="literal">local</code>, where the archetypes are loaded from the <code class="literal">local</code> repository and the <code class="literal">remote</code> repository. If you want to load an <code class="literal">archetype-catalog.xml</code> file from the local file system, then you need to prefix the absolute path to the file with <code class="literal">file://</code>. The value <code class="literal">local</code> is just a shortcut for <code class="literal">file://~/.m2/archetype-catalog.xml</code>.</p></div></div><p>In the previous <a id="id133" class="indexterm"/>Maven command, we used the <code class="literal">archetype</code> plugin in the non-interactive mode, so we had to be very specific with the archetype that we needed to generate the Maven project. This was done with the following three arguments. The value of these three arguments must match the corresponding elements defined in the associated <code class="literal">archetype-catalog.xml</code> file:</p><div class="informalexample"><pre class="programlisting">-DarchetypeGroupId=org.apache.synapse 
-DarchetypeArtifactId=synapse-package-archetype
-DarchetypeVersion=2.0.0</pre></div></div><div class="section" title="The anatomy of archetype – catalog.xml"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec23"/>The anatomy of archetype – catalog.xml</h2></div></div></div><p>We have already <a id="id134" class="indexterm"/>gone through a couple of sample <code class="literal">archetype-catalog.xml</code> files and their uses. The XML schema of the <code class="literal">archetype-catalog.xml</code> <a id="id135" class="indexterm"/>file is available at <a class="ulink" href="http://maven.apache.org/xsd/archetype-catalog-1.0.0.xsd">http://maven.apache.org/xsd/archetype-catalog-1.0.0.xsd</a>. The following shows an <code class="literal">archetype-catalog.xml</code> file skeleton with all the key elements:</p><div class="informalexample"><pre class="programlisting">&lt;archetype-catalog&gt;
  &lt;archetypes&gt;
    &lt;archetype&gt;
      &lt;groupId&gt;&lt;/groupId&gt;
      &lt;artifactId&gt;&lt;/artifactId&gt;
      &lt;version&gt;&lt;/version&gt;
      &lt;repository&gt;&lt;/repository&gt;
      &lt;description&gt;&lt;/description&gt;
    &lt;/archetype&gt;
    ...
  &lt;/archetypes&gt;
&lt;/archetype-catalog&gt;</pre></div><p>The <code class="literal">archetypes</code> parent element can hold one or more <code class="literal">archetype</code> child elements. Each <code class="literal">archetype</code> element should uniquely identify the Maven artifact corresponding to it. This is done by combining the <code class="literal">groupId</code>, <code class="literal">artifactId</code>, and <code class="literal">version</code> elements of the artifact. These three elements carry the exact same meaning that we discussed under Maven coordinates. The <a id="id136" class="indexterm"/>
<code class="literal">description</code> element can be used to describe the archetype. The value of the description element will appear against the archetype when it is listed by the <code class="literal">archetype</code> plugin. For example, the following output is generated according to the pattern—<code class="literal">groupId:artifactId (description)</code> from the <code class="literal">archetype-catalog.xml</code> file when you type <code class="literal">mvn archetype:generate</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Choose archetype:</strong></span>
<span class="strong"><strong>1: remote -&gt; org.apache.maven.archetypes:maven-archetype-quickstart (An archetype which contains a sample Maven project.)</strong></span>
</pre></div><p>Each <code class="literal">archetype</code> child element can carry a value for the <code class="literal">repository</code> element. This instructs the <code class="literal">archetype</code> plugin where to find the corresponding artifact. When no value is specified, the artifact is loaded from the repository, where the catalogue file comes from.</p></div></div>
<div class="section" title="The archetype plugin goals"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec27"/>The archetype plugin goals</h1></div></div></div><p>So far in this chapter, we <a id="id137" class="indexterm"/>have only discussed the <code class="literal">generate</code> and <code class="literal">crawl</code> goals of the <code class="literal">archetype</code> plugin. All the useful functionalities in the Maven build process are developed as plugins. A given Maven plugin can have multiple goals, where each goal carries out a very specific task. We will discuss plugins in detail in <a class="link" href="ch04.html" title="Chapter 4. Maven Plugins">Chapter 4</a>, <span class="emphasis"><em>Maven Plugins</em></span>.</p><p>The following goals are associated with the <code class="literal">archetype</code> plugin:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:generate</code>: The <code class="literal">generate</code> goal creates a Maven project corresponding to the selected archetype. This accepts the <code class="literal">archetypeGroupId</code>, <code class="literal">archetypeArtifactId</code>, <code class="literal">archetypeVersion</code>, <code class="literal">filter</code>, <code class="literal">interactiveMode</code>, <code class="literal">archetypeCatalog</code>, and <code class="literal">baseDir</code> arguments. We have already discussed almost all of these arguments in detail.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:update-local-catalog</code>: The <code class="literal">update-local-catalog</code> goal has to be executed against a Maven archetype project. This will update the <code class="literal">local</code> archetype catalog with the new archetype. The <code class="literal">local</code> archetype catalog is available at <code class="literal">~/.m2/archetype-catalog.xml</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:jar</code>: The <code class="literal">jar</code> goal has to be executed against a Maven archetype project, which will create a JAR file out of it. This accepts the <code class="literal">archetypeDirectory</code> argument, which contains the classes; it also accepts the <code class="literal">finalName</code> argument, the name of the JAR file to be generated, and the <code class="literal">outputDirectory</code> argument, which is the location where the final output is copied.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:crawl</code>: The <code class="literal">crawl</code> goal crawls through a local or a file system-based Maven <a id="id138" class="indexterm"/>repository (not remote or via HTTP) and creates an archetype catalogue file. This accepts <code class="literal">catalogFile</code> as an argument (which maps into the <code class="literal">catalog</code> system property), which is the name of the catalogue file to be created. By default, this crawls through the <code class="literal">local</code> Maven repository, and to override the location, we need to pass the corresponding repository URL with the <code class="literal">repository</code> argument.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:create-from-project</code>: The <code class="literal">create-from-project</code> goal creates an archetype project from an existing project. If you compare this with the <code class="literal">generate</code> goal, then <code class="literal">generate</code>, in fact, creates a new Maven project from scratch corresponding to the selected archetype, while <code class="literal">create-from-project</code> creates a Maven archetype project from an existing project. In other words, <code class="literal">create-from-project</code> generates a template out of an existing Maven project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:integration-test</code>: The <code class="literal">integration-test</code> goal will execute the integration tests associated with the Maven archetype project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">archetype:help</code>: The <code class="literal">help</code> goal will display the manual associated with the <code class="literal">archetype</code> plugin, listing out all the available goals. If you want to get a detailed description of all the goals, then use the <code class="literal">-Ddetail=true</code> parameter along with the command. It is also possible to get help for a given goal. For example, the <a id="id139" class="indexterm"/>following command will display the help associated with the <code class="literal">generate</code> goal:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:help -Ddetail=true -Dgoal=generate</strong></span>
</pre></div></li></ul></div></div>
<div class="section" title="Java EE web applications with the archetype plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec28"/>Java EE web applications with the archetype plugin</h1></div></div></div><p>If you want to <a id="id140" class="indexterm"/>start with a Java EE web <a id="id141" class="indexterm"/>application, you can simply use the <code class="literal">maven-archetype-webapp</code> archetype to generate the Maven project skeleton, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B </strong></span>
<span class="strong"><strong>                   -DgroupId=com.packt.samples  </strong></span>
<span class="strong"><strong>                   -DartifactId=my-webapp </strong></span>
<span class="strong"><strong>                   -Dpackage=com.packt.samples.webapp </strong></span>
<span class="strong"><strong>                   -Dversion=1.0.0  </strong></span>
<span class="strong"><strong>                   -DarchetypeGroupId=org.apache.maven.archetypes  </strong></span>
<span class="strong"><strong>                   -DarchetypeArtifactId=maven-archetype-webapp </strong></span>
<span class="strong"><strong>                   -DarchetypeVersion=1.0</strong></span>
</pre></div><p>The preceding command will produce the following directory structure. One issue here is that it does not have the <code class="literal">java</code> directory just after <code class="literal">src/main</code>. If you want to add any Java code, you need to make sure that you first create an <code class="literal">src/main/java</code> directory and create your Java package under it; otherwise, with the default configuration settings, Maven won't pick your classes for compilation. By default, Maven looks for the source code inside <code class="literal">src/main/java</code>:</p><div class="informalexample"><pre class="programlisting">my-webapp
     |-pom.xml
     |-src/main/webapp
                  |-index.jsp
                  |-WEB-INF/web.xml
     |- src/main/resources</pre></div><p>The <code class="literal">maven-archetype-webapp</code> archetype is not the only archetype to generate a Java EE project using the <code class="literal">archetype</code> plugin. Codehaus, a collaborative environment to build open source projects, also provides a few archetypes to generate web applications. The following example uses the <code class="literal">webapp-javaee6</code> archetype from Codehaus:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B  </strong></span>
<span class="strong"><strong>                  -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>                  -DartifactId=my-webapp </strong></span>
<span class="strong"><strong>                  -Dpackage=com.packt.samples.webapp </strong></span>
<span class="strong"><strong>                  -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>                  -DarchetypeGroupId=org.codehaus.mojo.archetypes  </strong></span>
<span class="strong"><strong>                  -DarchetypeArtifactId=webapp-javaee6  </strong></span>
<span class="strong"><strong>                  -DarchetypeVersion=1.3</strong></span>
</pre></div><p>The preceding command will produce the following directory structure. This overcomes one of the issues <a id="id142" class="indexterm"/>in the <code class="literal">maven-archetype-webapp</code> archetype, and creates the <code class="literal">src/main/java</code> and <code class="literal">src/test/java</code> directories. The only <a id="id143" class="indexterm"/>issue here is that it does not create the <code class="literal">src/main/webapp/WEB-INF</code> directory, which you will have to create manually:</p><div class="informalexample"><pre class="programlisting">my-webapp
     |-pom.xml
     |-src/main/webapp/index.jsp         
     |-src/main/java/com/packt/samples/webapp/
     |-src/test/java/com/packt/samples/webapp/</pre></div><div class="section" title="Deploying web applications to a remote Apache Tomcat server"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec24"/>Deploying web applications to a remote Apache Tomcat server</h2></div></div></div><p>Now, we <a id="id144" class="indexterm"/>have created a template web application either using the <code class="literal">maven-archetype-webapp</code> or <code class="literal">webapp-javaee6</code> archetype. Let's see how to deploy this web application into a remote Apache Tomcat application server from Maven itself. Most developers would love doing this rather than manual copying.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note19"/>Note</h3><p>This assumes you have already installed Apache Tomcat in your environment. If not, you can <a id="id145" class="indexterm"/>download Tomcat 7.x distribution from <a class="ulink" href="http://tomcat.apache.org/download-70.cgi">http://tomcat.apache.org/download-70.cgi</a> and set it up.</p></div></div><p>To deploy the web application, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">As we are going to deploy the web application to a remote Tomcat server, we need to have a valid user account that has the privilege to deploy a web application. Add the following entries to the <code class="literal">TOMCAT_HOME/conf/tomcat-users.xml</code> file under the <code class="literal">tomcat-users</code> root element. This will create a user with the name <code class="literal">admin</code> and the password <code class="literal">password</code>, and the <code class="literal">manager-gui</code> and <code class="literal">manager-script</code> roles:<div class="informalexample"><pre class="programlisting">&lt;role rolename="manager-gui"/&gt;
&lt;role rolename="manager-script"/&gt;
&lt;user username="admin" password="password" roles="manager-gui,manager-script" /&gt;</pre></div></li><li class="listitem">Now, we need to configure Maven to talk to the remote Tomcat server. Add the following configuration to <code class="literal">USER_HOME/.m2/settings.xml</code> under the <code class="literal">servers</code> element, shown as follows:<div class="informalexample"><pre class="programlisting">&lt;server&gt;
  &lt;id&gt;apache-tomcat&lt;/id&gt;
  &lt;username&gt;admin&lt;/username&gt;
  &lt;password&gt;password&lt;/password&gt;
&lt;/server&gt;</pre></div></li><li class="listitem">Go <a id="id146" class="indexterm"/>inside the root directory of the template web application that we generated before (<code class="literal">my-webapp</code>), and then add the <code class="literal">tomcat7-maven-plugin</code> to the <code class="literal">pom.xml</code> file available there. The complete <code class="literal">pom.xml</code> file will look like this:<div class="informalexample"><pre class="programlisting">&lt;project &gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.packt.samples&lt;/groupId&gt;
  &lt;artifactId&gt;my-webapp&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
  &lt;name&gt;my-webapp Maven Webapp&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;finalName&gt;my-webapp&lt;/finalName&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
         &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
         &lt;artifactId&gt;<span class="strong"><strong>tomcat7-maven-plugin</strong></span>&lt;/artifactId&gt;
         &lt;version&gt;2.2&lt;/version&gt;
         &lt;configuration&gt;
            &lt;url&gt;http://localhost:8080/manager/text&lt;/url&gt;
            &lt;server&gt;apache-tomcat&lt;/server&gt;
            &lt;path&gt;/my-webapp&lt;/path&gt;
         &lt;/configuration&gt;
      &lt;/plugin&gt;
   &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre></div></li><li class="listitem">Use the following Maven command to build and deploy the sample web application into the Tomcat server. Once it is deployed, you can access it via <code class="literal">http://localhost:8080/my-webapp/</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn clean install tomcat7:deploy</strong></span>
</pre></div></li><li class="listitem">To <a id="id147" class="indexterm"/>redeploy, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn clean install tomcat7:redeploy</strong></span>
</pre></div></li><li class="listitem">To undeploy, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn clean install tomcat7:undeploy</strong></span>
</pre></div></li></ol></div></div></div>
<div class="section" title="Android mobile applications with the archetype plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec29"/>Android mobile applications with the archetype plugin</h1></div></div></div><p>If you are an <a id="id148" class="indexterm"/>Android application <a id="id149" class="indexterm"/>developer who wants to start with a skeleton Android project, you can use the <code class="literal">android-quickstart</code> archetype developed by akquinet, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B </strong></span>
<span class="strong"><strong>                 -DarchetypeGroupId=de.akquinet.android.archetypes </strong></span>
<span class="strong"><strong>                 -DarchetypeArtifactId=android-quickstart  </strong></span>
<span class="strong"><strong>                 -DarchetypeVersion=1.0.4 </strong></span>
<span class="strong"><strong>                 -DgroupId=com.packt.samples  </strong></span>
<span class="strong"><strong>                 -DartifactId=my-android-app </strong></span>
<span class="strong"><strong>                 -Dversion=1.0.0</strong></span>
</pre></div><p>This command produces the following skeleton project:</p><div class="informalexample"><pre class="programlisting">my-android-app
      |-pom.xml
      |-AndroidManifest.xml
      |-android.properties
      |-src/main/java/com/packt/samples/HelloAndroidActivity.java
      |-res/drawable-hdpi/icon.png
      |-res/drawable-ldpi/icon.png
      |-res/drawable-mdpi/icon.png
      |-res/layout/main.xml
      |-res/values/strings.xml
      |-assets</pre></div><p>To build the Android skeleton project, run the following Maven command from the <code class="literal">my-android-app</code> directory:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn clean install -Dandroid.sdk.path=/path/to/android/sdk</strong></span>
</pre></div><p>The previous command looks straightforward, but is based on your Android SDK version; <a id="id150" class="indexterm"/>therefore, you might encounter <a id="id151" class="indexterm"/>certain issues. Some of the possible issues and solutions are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You will see the following error if you pass an invalid value to the <code class="literal">android.sdk.path</code> argument:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources (default-generate-sources) on project my-android-app: Execution default-generate-sources of goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources failed: Path "/Users/prabath/Downloads/adt-bundle-mac-x86_64-20140702/platforms" is not a directory.</strong></span>
</pre></div><p>The path will point to the Android <code class="literal">sdk</code> directory, and right under this, you will find the <code class="literal">platforms</code> directory. By setting <code class="literal">android.sdk.path</code> to the correct path, you can avoid this error.</p></li><li class="listitem" style="list-style-type: disc">By default, the <code class="literal">android-quickstart</code> archetype assumes the Android platform to be <code class="literal">7</code>. You will see the following error if the Android platform installed in your local machine is different from this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources (default-generate-sources) on project my-android-app: Execution default-generate-sources of goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources failed: Invalid SDK: Platform/API level 7 not available.</strong></span>
</pre></div><p>To fix this, open the <code class="literal">pom.xml</code> file and set the right platform version with <code class="literal">&lt;sdk&gt;&lt;platform&gt;20&lt;/platform&gt;&lt;/sdk&gt;</code>.</p></li><li class="listitem" style="list-style-type: disc">By default, the <code class="literal">android-quickstart</code> archetype assumes that the <code class="literal">aapt</code> tool is available under <code class="literal">sdk/platform-tools</code>. However, with the latest <code class="literal">sdks</code>, it's being <a id="id152" class="indexterm"/>moved to <code class="literal">sdk/build-tools/android-4.4W</code>; you will get the following error:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources (default-generate-sources) on project my-android-app: Execution default-generate-sources of goal com.jayway.maven.plugins.android.generation2:maven-android-plugin:2.8.3:generate-sources failed: Could not find tool 'aapt'.</strong></span>
</pre></div><p>To fix the <a id="id153" class="indexterm"/>error, you need to update the <code class="literal">maven-android-plugin</code> <code class="literal">version</code> and <code class="literal">artifactId</code>.</p><p>Open up the <code class="literal">pom.xml</code> file inside the <code class="literal">my-android-app</code> directory and find the following plugin configuration. Change <code class="literal">artifactId</code> to <code class="literal">android-maven-plugin</code> and version to <code class="literal">4.0.0-rc.1</code>, shown as follows:</p><div class="informalexample"><pre class="programlisting">  &lt;plugin&gt;
    &lt;groupId&gt;
           com.jayway.maven.plugins.android.generation2
    &lt;/groupId&gt;
    &lt;artifactId&gt;<span class="strong"><strong>android-maven-plugin</strong></span>&lt;/artifactId&gt;
    &lt;version&gt;<span class="strong"><strong>4.0.0-rc.1</strong></span>&lt;/version&gt;
    &lt;configuration&gt;&lt;/configuration&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;/plugin&gt;</pre></div></li></ul></div><p>Once the build is complete, <code class="literal">android-maven-plugin</code> will produce the <code class="literal">my-android-app-1.0.0.apk</code> and <code class="literal">my-android-app-1.0.0.jar</code> artifacts inside the <code class="literal">target</code> directory.</p><p>To deploy the <a id="id154" class="indexterm"/>skeleton Android application (apk) to the connected device, use the following Maven command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn android:deploy -Dandroid.sdk.path=/path/to/android/sdk</strong></span>
</pre></div></div>
<div class="section" title="EJB archives with the archetype plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec30"/>EJB archives with the archetype plugin</h1></div></div></div><p>Here, we <a id="id155" class="indexterm"/>will discuss how to create a Maven <span class="strong"><strong>Enterprise JavaBeans</strong></span> (<span class="strong"><strong>EJB</strong></span>) project using the <code class="literal">ejb-javaee6</code> archetype developed by Codehaus, which is a <a id="id156" class="indexterm"/>collaborative environment to build open source projects:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B  </strong></span>
<span class="strong"><strong>                  -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>                  -DartifactId=my-ejbapp </strong></span>
<span class="strong"><strong>                  -Dpackage=com.packt.samples.ejbapp </strong></span>
<span class="strong"><strong>                  -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>                  -DarchetypeGroupId=org.codehaus.mojo.archetypes  </strong></span>
<span class="strong"><strong>                  -DarchetypeArtifactId=ejb-javaee6  </strong></span>
<span class="strong"><strong>                  -DarchetypeVersion=1.5</strong></span>
</pre></div><p>The previous command produces the following skeleton project. You can create your EJB classes inside <code class="literal">src/main/java/com/packt/samples/ejbapp/</code>:</p><div class="informalexample"><pre class="programlisting">my-ejbapp
      |-pom.xml
      |-src/main/java/com/packt/samples/ejbapp/
      |-src/main/resources/META-INF/MANIFEST.MF</pre></div><p>If you look at the following <code class="literal">pom.xml</code> file inside <code class="literal">my-ejbapp</code> directory, you will notice that <code class="literal">maven-ejb-plugin</code> is used internally to produce the EJB artifact:</p><div class="informalexample"><pre class="programlisting">&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;<span class="strong"><strong>maven-ejb-plugin</strong></span>&lt;/artifactId&gt;
  &lt;version&gt;2.3&lt;/version&gt;
  &lt;configuration:
    &lt;ejbVersion&gt;3.1&lt;/ejbVersion&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre></div><p>Even though we have highlighted <code class="literal">ejb-javaee6</code>, it is not the best out there to generate a Maven EJB project. The template produced by the <code class="literal">ejb-javaee6</code> archetype is very basic. Oracle WebLogic has developed a better EJB archetype,—<code class="literal">basic-webapp-ejb</code>. The following example <a id="id157" class="indexterm"/>shows how to use the <code class="literal">basic-webapp-ejb</code> archetype:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B</strong></span>
<span class="strong"><strong>        -DarchetypeGroupId=com.oracle.weblogic.archetype</strong></span>
<span class="strong"><strong>        -DarchetypeArtifactId=basic-webapp-ejb</strong></span>
<span class="strong"><strong>        -DarchetypeVersion=12.1.3-0-0</strong></span>
<span class="strong"><strong>        -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>        -DartifactId=my-ejbapp </strong></span>
<span class="strong"><strong>        -Dpackage=com.packt.samples.ejbapp </strong></span>
<span class="strong"><strong>        -Dversion=1.0.0 </strong></span>
</pre></div><p>Prior to executing the previous command, there is more homework to be done. The <code class="literal">basic-webapp-ejb</code> archetype is not available in any public Maven repositories. First, you need to download the <a id="id158" class="indexterm"/>WebLogic distribution from <a class="ulink" href="http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/wls_12c_netbeans_install/wls_12c_netbeans_install.html">http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/wls_12c_netbeans_install/wls_12c_netbeans_install.html</a>, and then install it locally by performing the instructions given in the <code class="literal">README.txt</code> file. Once the installation is complete, the <code class="literal">basic-webapp-ejb</code> archetype and <code class="literal">weblogic-maven-plugin</code> can be installed into the <a id="id159" class="indexterm"/>local Maven repository, shown as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <code class="literal">wls12130/wlserver/server/lib</code> and execute the following command. This will build the plugin JAR file using the WebLogic JarBuilder tool:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ java -jar wljarbuilder.jar -profile weblogic-maven-plugin</strong></span>
</pre></div></li><li class="listitem">The previous command will create the <code class="literal">weblogic-maven-plugin.jar</code> file. Now, we need to extract it out to get the <code class="literal">pom.xml</code> file. From <code class="literal">wls12130/wlserver/server/lib</code>, execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ jar xvf weblogic-maven-plugin.jar</strong></span>
</pre></div></li><li class="listitem">Now, we need to copy the <code class="literal">pom.xml</code> file to <code class="literal">wls12130/wlserver/server/lib</code>. From <code class="literal">wls12130/wlserver/server/lib</code>, execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ cp META-INF/maven/com.oracle.weblogic/weblogic-maven-plugin/pom.xml .</strong></span>
</pre></div></li><li class="listitem">Now, we can install <code class="literal">weblogic-maven-plugin.jar</code> into the <code class="literal">local</code> Maven repository. From <code class="literal">wls12130/wlserver/server/lib</code>, execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn install:install-file -Dfile=weblogic-maven-plugin.jar -DpomFile=pom.xml</strong></span>
</pre></div></li><li class="listitem">In addition to the plugin, we also need to install the <code class="literal">basic-webapp-ejb</code> archetype. To do this, go to <code class="literal">wls12130/oracle_common/plugins/maven/com/oracle/maven/oracle-maven-sync/12.1.3</code> and execute the following two commands. Note that <code class="literal">oracle_common</code> is a hidden directory. If you are using a different version of WebLogic instead of 12.1.3, use the number associated with your version:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn install:install-file -DpomFile=oracle-maven-sync-12.1.3.pom -Dfile=oracle-maven-sync-12.1.3.jar</strong></span>
<span class="strong"><strong>$ mvn com.oracle.maven:oracle-maven-sync:push -Doracle-maven-sync.oracleHome=/Users/prabath/Downloads/wls12130  -Doracle-maven-sync.testingOnly=false</strong></span>
</pre></div></li></ol></div><p>Once you are done with these steps, you can execute the following command to generate the EJB template project using the WebLogic <code class="literal">basic-webapp-ejb</code> archetype. Make sure that you have the right version of <code class="literal">archetypeVersion</code>; this should match the archetype version that <a id="id160" class="indexterm"/>comes with your WebLogic distribution:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B</strong></span>
<span class="strong"><strong>        -DarchetypeGroupId=com.oracle.weblogic.archetype</strong></span>
<span class="strong"><strong>        -DarchetypeArtifactId=basic-webapp-ejb</strong></span>
<span class="strong"><strong>        -DarchetypeVersion=12.1.3-0-0</strong></span>
<span class="strong"><strong>        -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>        -DartifactId=my-ejbapp </strong></span>
<span class="strong"><strong>        -Dpackage=com.packt.samples.ejbapp </strong></span>
<span class="strong"><strong>        -Dversion=1.0.0 </strong></span>
</pre></div><p>This command <a id="id161" class="indexterm"/>produces the following skeleton project:</p><div class="informalexample"><pre class="programlisting">my-ejbapp
  |-pom.xml
  |-src/main/java/com/packt/samples/ejbapp                
                                |-entity/Account.java
                                |-service/AccountBean.java
                                |-service/AccountManager.java
                                |-service/AccountManagerImpl.java
                                |-interceptor/LogInterceptor.java
                                |-interceptor/OnDeposit.java
  |-src/main/resources/META-INF/persistence.xml
  |-src/main/scripts
  |-src/main/webapp/WEB-INF/web.xml
  |-src/main/webapp/WEB-INF/beans.xml
  |-src/main/webapp/css/bootstrap.css
  |-src/main/webapp/index.xhtml
  |-src/main/webapp/template.xhtml</pre></div><p>To package the EJB archive, execute the following command from the <code class="literal">my-ejbapp</code> directory. This will produce <code class="literal">basicWebappEjb.war</code> inside the <code class="literal">target</code> directory. Now, you can deploy this <a id="id162" class="indexterm"/>WAR file into your Java EE application server, which supports EJB:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn package</strong></span>
</pre></div></div>
<div class="section" title="JIRA plugins with the archetype plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec31"/>JIRA plugins with the archetype plugin</h1></div></div></div><p>JIRA is an <a id="id163" class="indexterm"/>issue-tracking system developed by Atlassian. It is quite <a id="id164" class="indexterm"/>popular among many open source projects. One of the extension points in JIRA is its plugins. Here, we will see how to generate a skeleton JIRA plugin using <code class="literal">jira-plugin-archetype</code> developed by Atlassian:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B</strong></span>
<span class="strong"><strong>         -DarchetypeGroupId=com.atlassian.maven.archetypes</strong></span>
<span class="strong"><strong>         -DarchetypeArtifactId=jira-plugin-archetype</strong></span>
<span class="strong"><strong>         -DarchetypeVersion=3.0.6</strong></span>
<span class="strong"><strong>         -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>         -DartifactId=my-jira-plugin </strong></span>
<span class="strong"><strong>         -Dpackage=com.packt.samples.jira </strong></span>
<span class="strong"><strong>         -Dversion=1.0.0 </strong></span>
<span class="strong"><strong>         -DarchetypeRepository=</strong></span>
<span class="strong"><strong>      http://repo.jfrog.org/artifactory/libs-releases/</strong></span>
</pre></div><p>This command will produce the following project template:</p><div class="informalexample"><pre class="programlisting">my-jira-plugin
         |-pom.xml
         |-README
         |-LICENSE
         |-src/main/java/com/packt/samples/jira/MyPlugin.java
         |-src/main/resources/atlassian-plugin.xml
         |- src/test/java/com/packt/samples/jira/MyPluginTest.java 
         |-src/test/java/it/MyPluginTest.java          
         |-src/test/resources/TEST_RESOURCES_README
         |-src/test/xml/TEST_XML_RESOURCES_README</pre></div></div>
<div class="section" title="Spring MVC applications with the archetype plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec32"/>Spring MVC applications with the archetype plugin</h1></div></div></div><p>Spring <span class="strong"><strong>model view controller</strong></span> (<span class="strong"><strong>MVC</strong></span>) is a web application framework developed under the Spring framework, which is an open source application framework and an inversion of the control container. Here, we will see how to generate a template Spring MVC application using the <code class="literal">spring-mvc-quickstart</code> archetype.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note20"/>Note</h3><p>To know more <a id="id165" class="indexterm"/>about the Spring MVC framework, refer to <a class="ulink" href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html">http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html</a>.</p></div></div><p>Currently, the <code class="literal">spring-mvc-quickstart</code> archetype is not available in any of the public Maven repositories, so <a id="id166" class="indexterm"/>we have to download it from GitHub and build from the source, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ git clone https://github.com/kolorobot/spring-mvc-quickstart-archetype.git</strong></span>
<span class="strong"><strong>$ cd spring-mvc-quickstart-archetype</strong></span>
<span class="strong"><strong>$ mvn clean install</strong></span>
</pre></div><p>Once the archetype is built from the source and is available in the <code class="literal">local</code> Maven repository, you can execute the following command to generate the template Spring MVC application:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn archetype:generate -B</strong></span>
<span class="strong"><strong>         -DarchetypeGroupId=com.github.spring-mvc-archetypes</strong></span>
<span class="strong"><strong>         -DarchetypeArtifactId=spring-mvc-quickstart</strong></span>
<span class="strong"><strong>         -DarchetypeVersion=1.0.0-SNAPSHOT</strong></span>
<span class="strong"><strong>         -DgroupId=com.packt.samples </strong></span>
<span class="strong"><strong>         -DartifactId=my-spring-app </strong></span>
<span class="strong"><strong>         -Dpackage=com.packt.samples.spring</strong></span>
<span class="strong"><strong>         -Dversion=1.0.0 </strong></span>
</pre></div><p>This will produce the following project template:</p><div class="informalexample"><pre class="programlisting">my-spring-app
         |-pom.xml
         |-src/main/java/com/packt/samples/spring/Application.java
         |-src/main/webapp/WEB-INF/views
         |-src/main/webapp/resources
         |-src/main/resources
         |-src/test/java/com/packt/samples/spring
         |-src/test/resources</pre></div><p>Let's see how to <a id="id167" class="indexterm"/>run the template Spring MVC application with the embedded Tomcat via Maven itself. Once the server is up, you can browse through the web application via <code class="literal">http://localhost:8080/my-spring-app</code>. The embedded Tomcat can be launched via the <code class="literal">run</code> goal of the <code class="literal">tomcat7</code> plugin, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mvn test tomcat7:run</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note21"/>Note</h3><p>More details about the <a id="id168" class="indexterm"/>
<code class="literal">tomcat7</code> plugin are available at <a class="ulink" href="http://tomcat.apache.org/maven-plugin-trunk/tomcat7-maven-plugin/">http://tomcat.apache.org/maven-plugin-trunk/tomcat7-maven-plugin/</a>.</p></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec33"/>Summary</h1></div></div></div><p>In this chapter, we focused on Maven archetypes. Maven archetypes provide a way of reducing repetitive work in building Maven projects. There are thousands of archetypes out there available publicly to assist you when building different types of projects. This chapter covered a commonly used set of archetypes.</p><p>In the next chapter, we will look into Maven plugins.</p></div></body></html>