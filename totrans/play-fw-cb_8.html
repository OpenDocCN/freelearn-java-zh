<html><head></head><body><h1 id="e-o2Wa">Chapter 8. Additional Play Information</h1>
<p id="e-wXdZ">In this chapter, we will cover the following recipes:</p>
<ul id="e-RXW7">
<li id="e-LCjp">Testing with Travis CI</li>
<li id="e-hZLc">Monitoring with New Relic</li>
<li id="e-z2v4">Integrating a Play application with AngularJS</li>
<li id="e-j5io">Integrating a Play application with Parse</li>
<li id="e-AfuR">Creating a Play development environment using Vagrant</li>
<li id="e-aDJ9">Coding Play 2 web apps with IntelliJ IDEA 14</li>
</ul>
<h1 id="e-RasB">Introduction</h1>
<p id="e-RapQ">In this chapter, we will explore additional recipes for Play that developers will find handy and useful in their toolbox. We will touch on automated testing and monitoring tools for Play 2.0 web applications that are essential auxiliary tools for the modern web application. We will also look at integrating an AngularJS frontend and integrating <a href="http://Parse.com">Parse.com</a>, a <strong>Backend-as-a-Service</strong> (<strong>BaaS</strong>), to manage our data in a Play web application.</p>
<p id="e-nmus">Finally, we will look into automating the creation of a Play development environment using the popular tool <strong>Vagrant</strong>, allowing developers to create shareable and more portable development environments.</p>

<h1 id="e-KeBJ">Testing with Travis CI</h1>
<p id="e-nuDo">For this recipe, we will explore how to use <strong>Travis CI</strong> to build and run automated tests for a Play 2.0 web app. We need to sign up for an account on Travis CI together with a Github account. We will also configure our Travis account in such a way that it is connected to a Github repository to conduct automatic tests on code commits.</p>
<h2 id="e-Sl1S">How to do it…</h2>
<p id="e-ccNI">For this recipe, you need to perform the following steps:</p>
<ol id="e-sseq">
<li id="e-Mkfe">Create a Github account at <a href="https://github.com/join">https://github.com/join</a>:<img data-width="800" data-height="727" src="W1jMSmgF.jpg"/>
</li>
<li id="e-Tvop">Create a new public Github repository called play2-travis at:<p id="e-IfOZ"><a href="https://github.com/new">https://github.com/new</a></p>
</li>
<li id="e-NcqB">On your development machine, create a new Play 2.0 web app using the <code>activator</code> template <code>play-slick-angular-test-example</code>:<pre id="e-r3X1">&lt;span class="strong"&gt;&lt;strong&gt;    activator new play2-travis play-slick-angular-test-example&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Xc2P">Edit <code>.travis.yml</code> to trigger our test script:<pre id="e-HyWe">&lt;span class="strong"&gt;&lt;strong&gt;    language: scala&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    scala:&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    - 2.11.2&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    script:&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    - sbt test&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-BWCP">Commit and push to the Github remote repository (please make special note of your Github username and specify it in the command below):<pre id="e-Sver">&lt;span class="strong"&gt;&lt;strong&gt;    git add --all &amp;amp;&amp;amp; git commit -am "Initial" &amp;amp;&amp;amp; git remote add origin https://github.com/&amp;lt;YOUR_GITHUB_USER&amp;gt;/play2-travis.git &amp;amp;&amp;amp; git push origin master&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Gaqj">Sign up for a Travis account by using your Github account at:<p id="e-o8fz"><a href="https://travis-ci.org">https://travis-ci.org</a></p>
</li>
<li id="e-KBmf">After Travis has synced your Github repositories, enable Travis builds for the play2-travis repository at <p id="e-wXey"><code>https://travis-ci.org/profile/&amp;lt;YOUR_GITHUB_USER&amp;gt;</code>:</p>
<img data-width="800" data-height="365" src="MFz8BeV6.jpg"/>
</li>
<li id="e-wegX">Next, modify <code>test/controllers/ReportSpec.scala</code> by adding a sample test failure:<pre id="e-wO6e">"testing a failure" in {
      true must equalTo(false)
    }</pre>
</li>
<li id="e-ocyV">Commit and push to trigger a Travis build with the expected test failure:<pre id="e-xOVu">&lt;span class="strong"&gt;&lt;strong&gt;    git commit -am "With expected test failure" &amp;amp;&amp;amp; git push origin master&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-CKgP">This should trigger our build in Travis after a few seconds. We expect our very first build to fail and should see a result similar to the following:<pre id="e-ON8O">&lt;span class="strong"&gt;&lt;strong&gt;    [info] x testing a failure&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [error]  the value is not equal to 'false' (ReportSpec.scala:58)&lt;/strong&gt;&lt;/span&gt;</pre>
<img data-width="800" data-height="514" src="BNTSYPGZ.jpg"/>
</li>
<li id="e-t5u3">Now, comment out the sample test failure in <code>test/controllers/ReportSpec.scala</code>:<pre id="e-XVVR">/*"testing a failure" in {
      true must equalTo(false)
    }*/</pre>
</li>
<li id="e-BxSA">Let's commit and push these latest changes, this time expecting our Travis build to pass:<pre id="e-tahb">&lt;span class="strong"&gt;&lt;strong&gt;    git commit -am "disabling failing test" &amp;amp;&amp;amp; git push origin master&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-mrmu">This commit should again trigger a build in Travis, and this time around, we should see all of the tests passing in our Travis dashboard.<img data-width="800" data-height="508" src="SOMLDy56.jpg"/>
</li>
</ol>
<h2 id="e-jM5q">How it works…</h2>
<p id="e-UHG4">In this recipe, we utilized Travis CI to build and execute tests in our linked Github repository. This setup enables us to establish a <strong>development-commit-test</strong> process. This setup requires user accounts for Travis CI and Github.</p>
<p id="e-xZng">Once we have identified a Github repository, we want to integrate with Travis. We need to update the Travis configuration (<code>.travis.yml</code>) in the project root, specifying a run script to execute our webapp tests:</p>
<pre id="e-Zfpg">&lt;span class="strong"&gt;&lt;strong&gt;    script:&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    - sbt test&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-nFC1">This is the command that Travis executes when running our tests. Travis will configure builds based on the settings in the <code>.travis.yml</code> configuration file (in our recipe, running the <code>sbt</code> task test) to execute our webapp tests. Build results are displayed on the repository dashboard in Travis:</p>
<img data-width="800" data-height="515" src="y58YdeMZ.jpg"/><p id="e-lZfv">Once we have our Github repository linked and enabled in Travis, we observe that a build is triggered after every code commit and pushed to the Github repository. This is a great development tool and process for developers to be made aware of any regression issues to recently checked-in code, with support for other build tooling such as artifact publishing and notifications.</p>

<h1 id="e-tg2q">Monitoring with New Relic</h1>
<p id="e-ki8D">For this recipe, we will deploy a Play 2.0 web app using Docker and Digital Ocean, and monitor the web app using <strong>New Relic</strong>. We will deploy the web app as a Docker container and detail out how to instrument the computer-database-scala sample web application using a New Relic JAR file integrated with our activator build script.</p>
<h2 id="e-jOGy">How to do it…</h2>
<p id="e-d5RI">For this recipe, you need to perform the following steps:</p>
<ol id="e-Ggkr">
<li id="e-eByT">First, sign up for a New Relic account at <a href="https://newrelic.com/signup">https://newrelic.com/signup</a>
</li>
<li id="e-zkKp">Create a new Java application in the New Relic dashboard:<img data-width="800" data-height="542" src="mkHMw6TA.jpg"/>
</li>
<li id="e-PpZl">During the creation of the Java application, please make note of your New Relic license key:<img data-width="800" data-height="649" src="uUKAhSoN.jpg"/>
</li>
<li id="e-kafB">Next, download the New Relic Java agent ZIP and make note of the download location. This ZIP file should contain the Java agent library, license key file, API documentation, and other useful New Relic resources.<img data-width="800" data-height="649" src="Eirt8Ocw.jpg"/>
</li>
<li id="e-CtJp">Unzip the Java agent ZIP file and make note of two important files that we will need, <code>newrelic.yml</code> and <code>newrelic.jar</code>:<pre id="e-OT8f">&lt;span class="strong"&gt;&lt;strong&gt;    $ ls ~/Downloads/newrelic/&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    CHANGELOG &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    extension-example.xml &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic-api-sources.jar &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic.yml&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    LICENSE &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    extension.xsd &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic-api.jar &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    nrcerts&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    README.txt &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic-api-javadoc.jar &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic.jar&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-ac0i">Edit the <code>newrelic.yml</code> file by adding a relevant name to the setting parameter <code>app_name</code>, For this recipe, we will name our <code>app_name</code>, <code>computer-database-scala</code>:<pre id="e-WYMk">&lt;span class="strong"&gt;&lt;strong&gt;    common: &amp;amp;default_settings&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      license_key: '111112222223333344444455555556666666'&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      agent_enabled: true&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      app_name: computer-database-scala&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      # ..&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-f5gf">Create a new Play web application using the <code>activator</code> template <code>computer-database-scala</code>, and change it into the project root directory:<pre id="e-URzj">&lt;span class="strong"&gt;&lt;strong&gt;    activator new play2-deploy-81 computer-database-scala&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    cd play2-deploy-81&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-ndE0">Create an <code>instrument</code> directory in the <code>conf</code> directory:<pre id="e-xNWT">&lt;span class="strong"&gt;&lt;strong&gt;    mkdir conf/instrument&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-IQaS">Copy our two New Relic config files to <code>conf/instrument</code>:<pre id="e-vwno">&lt;span class="strong"&gt;&lt;strong&gt;    cp ~/Downloads/newrelic/newrelic.yml conf/instrument&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    cp ~/Downloads/newrelic/newrelic.jar conf/instrument&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-PoIB">Edit <code>conf/application.conf</code> to enable automatic database evolution:<pre id="e-b1Sq">&lt;span class="strong"&gt;&lt;strong&gt;    applyEvolutions.default=true&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-DoEd">Add a newer version of the native Docker packager <code>sbt</code> plugin in <code>project/plugins.sbt</code>, which has additional native support for Docker:<pre id="e-vwlY">&lt;span class="strong"&gt;&lt;strong&gt;    addSbtPlugin("com.typesafe.sbt" % "sbt-native-packager" % "1.0.0-M3")&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-i1ze">Edit <code>build.sbt</code> to specify docker-specific settings for the web app:<pre id="e-tyMq">&lt;span class="strong"&gt;&lt;strong&gt;    $ vi build.sbt&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    import com.typesafe.sbt.SbtNativePackager._&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    name := """play2-deploy-81"""&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    version := "0.0.1-SNAPSHOT"&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    scalaVersion := "2.11.4"&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    dockerRepository := Some("ginduc")&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    dockerExposedPorts := Seq(9000)&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;     dockerEntrypoint := Seq("bin/play2-deploy-81", "-J-javaagent:conf/instrument/newrelic.jar")&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    libraryDependencies ++= Seq(&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      jdbc,&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      anorm,&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      "org.webjars" % "jquery" % "2.1.1",&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;      "org.webjars" % "bootstrap" % "3.3.1"&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    )&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    lazy val root = (project in file(".")).enablePlugins(PlayScala)&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-eTcm">Create the Docker image using <code>activator</code>:<pre id="e-FLYo">&lt;span class="strong"&gt;&lt;strong&gt;     activator clean docker:stage&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-wvXZ">Log in to Docker from your local development machine using your Docker Hub credentials:<pre id="e-jGL7">&lt;span class="strong"&gt;&lt;strong&gt;    $ docker login&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-MAI2">Build the image and upload to <a href="http://hub.docker.com">hub.docker.com</a> using <code>activator</code>:<pre id="e-NzEX">&lt;span class="strong"&gt;&lt;strong&gt;    activator docker:publish&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Mtae">Pull the <code>play2-deploy-81</code> Docker image from <a href="http://hub.docker.com">hub.docker.com</a> into the virtual machine we will be deploying the web application on:<pre id="e-bVt2">&lt;span class="strong"&gt;&lt;strong&gt;    docker pull &amp;lt;YOUR_DOCKERHUB_USERNAME&amp;gt;/play2-deploy-81:0.0.1-SNAPSHOT&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-omvd">Run the <code>play2-deploy-81</code> Docker container in the same remote virtual machine:<pre id="e-ncHS">&lt;span class="strong"&gt;&lt;strong&gt;    docker run -d -p 9000:9000 ginduc/play2-deploy-81:0.0.1-SNAPSHOT&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-aYqc">Using a web browser, you should now be able to access our just-deployed computer database web application:<img data-width="800" data-height="614" src="Y52a0H5f.jpg"/>
</li>
<li id="e-SggM">Now, log in to your New Relic account and navigate to your application's dashboard. You should be able to see some relevant application statistics in the form of charts and graphs:<img data-width="800" data-height="631" src="JD52glse.jpg"/>
</li>
</ol>
<h2 id="e-KTfr">How it works…</h2>
<p id="e-OF9i">In this recipe, we deployed a Play 2.0 web application in a remote <strong>virtual machine</strong> (<strong>vm</strong>). For the virtual machine, we used CoreOS version 607.0.0 as the base operating system, which should automatically install Docker:</p>
<pre id="e-SGvW">&lt;span class="strong"&gt;&lt;strong&gt;    $ docker -v&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Docker version 1.5.0, build a8a31ef-dirty&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-ZajO">Once the deployment VM was set up, we turned our attention to setting up our New Relic account. After creating the account, we downloaded the New Relic Java agent and made a special note of our account license key with New Relic. We will use both next, as we integrate the New Relic java agent with our Play web application:</p>
<pre id="e-UDsG">&lt;span class="strong"&gt;&lt;strong&gt;  $ unzip newrelic-java-3.15.0.zip&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  Archive:  newrelic-java-3.15.0.zip&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;     creating: newrelic/&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/newrelic.jar&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/LICENSE&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/README.txt&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/extension.xsd&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;   inflating: newrelic/nrcerts&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/extension-example.xml&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;   inflating: newrelic/CHANGELOG&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;   inflating: newrelic/newrelic.yml&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/newrelic-api.jar&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;   inflating: newrelic/newrelic-api-sources.jar&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    inflating: newrelic/newrelic-api-javadoc.jar&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-k2Hq">We used the activator template <code>computer-database-scala</code> for this recipe as our sample Play web application.</p>
<p id="e-jadP">Once we have our web project generated, we will place the two New Relic config files inside the <code>conf/instrument</code> directory in our project root:</p>
<pre id="e-Ck0p">&lt;span class="strong"&gt;&lt;strong&gt;    $ ls conf/instrument&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic.jar &lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    newrelic.yml&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-Anw7">To load the native Docker packager, we need to add the <code>sbt-native-packager</code> plugin to our build plugins file in <code>project/plugins.sbt</code>:</p>
<pre id="e-N6Iq">addSbtPlugin("com.typesafe.sbt" % "sbt-native-packager" % "1.0.0-M3")</pre>
<p id="e-PHS9">The last step is to configure our main build file <code>build.sbt</code>, to specify the docker-specific settings to create the image:</p>
<pre id="e-sIDa">maintainer := "ginduc &amp;lt;ginduc@dynamicobjx.com&amp;gt;"
     dockerRepository := Some("dynobjx")
     dockerExposedPorts := Seq(9000)
     dockerEntrypoint := Seq("bin/imapi", "-J-javaagent:conf/instrument/newrelic.jar")</pre>
<p id="e-OH8e">With the preceding settings, we specify the default repository in <a href="http://hub.docker.com">hub.docker.com</a> and the main port number we will be exposing our app in (in this recipe, port number 9000). The final setting is where we specify the <code>entrypoint</code> command. We had to modify it to pass in the necessary settings to specify the New Relic java agent:</p>
<pre id="e-YeI7">dockerEntrypoint := Seq("bin/imapi", "-J-javaagent:conf/instrument/newrelic.jar")</pre>
<p id="e-LxpM">The generated <code>Dockerfile</code> from the preceding settings should look like this:</p>
<pre id="e-ufnr">&lt;span class="strong"&gt;&lt;strong&gt;    $ cat target/docker/Dockerfile&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    FROM dockerfile/java:latest&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    MAINTAINER ginduc &amp;lt;ginduc@dynamicobjx.com&amp;gt;&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    EXPOSE 9000&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    ADD files /&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    WORKDIR /opt/docker&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    RUN ["chown", "-R", "daemon", "."]&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    USER daemon&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    ENTRYPOINT ["bin/imapi", "-J-javaagent:conf/instrument/newrelic.jar"]&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    CMD []&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-CQEs">We can verify that the New Relic java agent is loaded currently, by viewing the Docker logs as we run our Docker container:</p>
<pre id="e-WYSA">&lt;span class="strong"&gt;&lt;strong&gt;    $ docker logs     9790caf8046c7da1d561dcc6e221169d64fa125cdd0a689222fe31637c7bc234&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Mar 30, 2015 13:54:11 +0000 [1 1] com.newrelic INFO: New Relic Agent:      Loading configuration file "/opt/docker/conf/instrument/./newrelic.yml"&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Mar 30, 2015 13:54:11 +0000 [1 1] com.newrelic INFO: New Relic Agent: Writing to log file: /opt/docker/lib/logs/newrelic_agent.log&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Play server process ID is 1&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] play - database [default] connected at jdbc:h2:mem:play&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Application started (Prod)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Listening for HTTP on /0:0:0:0:0:0:0:0:9000&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-hjV1">Once we have installed and deployed the Docker container in our deployment VM, we can access the <code>computer-database-scala</code> web application using a web browser. We can then view all relevant instrumentation data points, such as JVM and database metrics, with charts and graphs, using the New Relic dashboard:</p>
<img data-width="800" data-height="630" src="jSVRWVg1.jpg"/><p id="e-phu5">Here, we can view how in-depth New Relic's application metrics are, with reporting views for the JVM, database connections, and so on:</p>
<img data-width="800" data-height="632" src="zdXzAn7U.jpg"/>
<h1 id="e-v140">Integrating a Play application with AngularJS</h1>
<p id="e-Q5iQ">For this recipe, we will integrate a Play web application with an AngularJS-based frontend. AngularJS is a popular JavaScript framework and provides developers with tools to build powerful interactive UIs with ease. Some familiarity with AngularJS is assumed for this recipe.</p>
<p id="e-kdhT">More information about AngularJS can be found here at <a href="https://angularjs.org/">https://angularjs.org/</a>.</p>
<p id="e-hAFI">In this recipe, we will also use WebJars, a Play-friendly dependency management repository, to manage our AngularJS libraries.</p>
<p id="e-oR3o">More information about WebJars can be found at <a href="http://www.webjars.org/">http://www.webjars.org/</a>.</p>
<p id="e-pG8r">We will also be using RequireJS, which is a JavaScript module script loader, to manage the AngularJS module and  <code>public/javascripts/main.js</code>, our main application JavaScript module. For more information about RequireJS, refer to their online documentation at <a href="http://requirejs.org/">http://requirejs.org/</a>.</p>
<h2 id="e-FDdZ">How to do it…</h2>
<p id="e-ajzA">For this recipe, you need to perform the following steps:</p>
<ol id="e-M3I5">
<li id="e-nuwo">Create a new Play 2 web application project by using the <code>activator</code> template <code>play-scala</code>:<pre id="e-pILb">&lt;span class="strong"&gt;&lt;strong&gt;    activator new play2-angular-83 play-scala &amp;amp;&amp;amp; cd play2-angular-83&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-MNHt">Edit the <code>build.sbt</code> build file to import RequireJS, AngularJS, and Bootstrap:<pre id="e-Ixei">libraryDependencies ++= Seq(
      "org.webjars" %% "webjars-play" % "2.3.0",
      "org.webjars" % "angularjs" % "1.3.4",
      "org.webjars" % "bootstrap" % "3.3.1" exclude("org.webjars", "jquery"),
      "org.webjars" % "requirejs" % "2.1.15" exclude("org.webjars", "jquery")
    )</pre>
</li>
<li id="e-Rv0o">Edit the contents of the default application controller file <code>app/controllers/Application.scala</code>, and replace the contents with the following snippet:<pre id="e-aOES">package controllers
     import play.api._
    import play.api.libs.json.Json
    import play.api.mvc._
     case class Product(sku: String, title: String)
     object Application extends Controller {
      implicit val productWrites = Json.writes[Product]
       def index = Action {
        Ok(views.html.index())
      }
       val products = Seq(
        Product("733733-421", "HP ProLiant DL360p Gen8"),
        Product("7147H2G", "IBM System x x3690 X5"),
        Product("R630-3552", "DELL PowerEdge R630"),
        Product("RX-2280I", "Supermicro RTG RX-2280I"),
        Product("MB449D/A", "Apple Xserve")
      )
       def listProducts = Action {
        Ok(Json.toJson(products))
      }
    }</pre>
</li>
<li id="e-IaEr">Edit the contents of the routes file <code>conf/routes</code>, and replace with the following snippet:<pre id="e-xeF6"># Routes
    GET     /                           controllers.Application.index
    GET     /assets/*file               controllers.Assets.versioned(path="/public", file: Asset)
    GET     /api/products               controllers.Application.listProducts
    GET     /webjars/*file              controllers.WebJarAssets.at(file)</pre>
</li>
<li id="e-DQ4m">Edit the contents of the default index template HTML file <code>app/views/index.scala.html</code> and replace with the following snippet:<pre id="e-pIRM">@main("Product Catalogue") {
      &amp;lt;nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"&amp;gt;
        &amp;lt;div class="container-fluid"&amp;gt;
          &amp;lt;div class="navbar-header"&amp;gt;
            &amp;lt;button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"&amp;gt;
                &amp;lt;span class="sr-only"&amp;gt;Toggle navigation&amp;lt;/span&amp;gt;
                &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;
                &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;
                &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;
            &amp;lt;/button&amp;gt;
            &amp;lt;a class="navbar-brand" href="#"&amp;gt;Product Catalogue&amp;lt;/a&amp;gt;
          &amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/nav&amp;gt;
       &amp;lt;div class="container-fluid"&amp;gt;
        &amp;lt;div class="row"&amp;gt;
          &amp;lt;ng-view /&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
    }</pre>
</li>
<li id="e-vYY8">Edit the contents of the default layout template file <code>app/views/main.scala.html</code> and replace with the following snippets:<pre id="e-n7sd">@(title: String)(content: Html)&amp;lt;!DOCTYPE html&amp;gt;
   &amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;meta charset="utf-8"&amp;gt;
    &amp;lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&amp;gt;
    &amp;lt;meta name="viewport" content="width=device-width, initial-scale=1"&amp;gt;
    &amp;lt;meta name="description" content=""&amp;gt;
    &amp;lt;meta name="author" content=""&amp;gt;
    &amp;lt;title&amp;gt;@title&amp;lt;/title&amp;gt;
    &amp;lt;link rel="shortcut icon" type="image/png" href='@routes.Assets.versioned("images/favicon.png")'&amp;gt;
    &amp;lt;link rel="stylesheet" media="screen" href='@routes.WebJarAssets.at(WebJarAssets.locate("css/bootstrap.min.css"))' /&amp;gt;
    &amp;lt;style&amp;gt;
        body {
            padding-top: 50px;
        }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    @content
    &amp;lt;script data-main='@routes.Assets.versioned("javascripts/main.js").url' src='@routes.WebJarAssets.at(WebJarAssets.locate("require.min.js")).url'&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;/body&amp;gt;
  &amp;lt;/html&amp;gt;</pre>
</li>
<li id="e-kv2E">Add the main JavaScript file for our web application in <code>public/javascripts/main.js</code> and add the following snippet:<pre id="e-pu4X">'use strict';
   requirejs.config({
    paths: {
      'angular': ['../lib/angularjs/angular'],
      'angular-route': ['../lib/angularjs/angular-route'],
      'angular-resource': ['../lib/angularjs/angular-resource.min']
    },
    shim: {
      'angular': {
        exports : 'angular'
      },
      'angular-route': {
        deps: ['angular'],
        exports : 'angular'
      },
      'angular-resource': {
        deps: ['angular'],
        exports : 'angular'
      }
    }
  });
   require([
    'angular',
    'angular-route',
    'angular-resource',
    './services',
    './controllers'
    ],
    function(angular) {
      angular.module('azApp', [
        'ngRoute',
        'ngResource',
        'azApp.services',
        'azApp.controllers'
      ])
       .config(['$routeProvider', '$locationProvider', '$httpProvider', function($routeProvider, $locationProvider, $httpProvider) {
        $routeProvider
          .when('/', {
            templateUrl: 'assets/javascripts/partials/products.html',
            controller: 'ProductsCtrl'
          })
      }]);
       angular.bootstrap(document, ['azApp']);
  });</pre>
</li>
<li id="e-q6Vw">Next, we add the Angular controller JavaScript file in <code>public/javascripts/controllers.js</code> with the following contents:<pre id="e-BbwM">'use strict';
   define(['angular'], function(angular) {
    angular.module('azApp.controllers', [])
       .controller('ProductsCtrl', ['$scope', 'Products', function ($scope, Products) {
        $scope.products = Products.list().query();
      }])
     ;
  });</pre>
</li>
<li id="e-xUMH">After adding the angular controllers file, we add the Angular factory JavaScript file in <code>public/javascript/services.js</code> with the following contents:<pre id="e-UH8o">'use strict';
   define(['angular'], function(angular) {
    angular.module('azApp.services', [])
      .factory('Products', ['$resource', '$http', function Contacts($resource, $http) {
          var endpointURI = '/api/products';
           return {
            list: function(options) {
                return $resource(endpointURI);
            }
          }
      }])
    ;
  });</pre>
</li>
<li id="e-sdLc">Finally, we add the products partial HTML file in <code>public/javascripts/partials/products.html</code> with the following contents:<pre id="e-AVrb">&amp;lt;div class="table-responsive"&amp;gt;
      &amp;lt;table class="table table-striped table-hover"&amp;gt;
        &amp;lt;thead&amp;gt;
          &amp;lt;th&amp;gt;Product Title&amp;lt;/th&amp;gt;
          &amp;lt;th&amp;gt;SKU&amp;lt;/th&amp;gt;
        &amp;lt;/thead&amp;gt;
      &amp;lt;tbody&amp;gt;
        &amp;lt;tr ng-repeat="p in products | orderBy:'title'"&amp;gt;
          &amp;lt;td ng-bind="p.title"&amp;gt;&amp;lt;/td&amp;gt;
          &amp;lt;td ng-bind="p.sku"&amp;gt;&amp;lt;/td&amp;gt;
        &amp;lt;/tr&amp;gt;
      &amp;lt;/tbody&amp;gt;
    &amp;lt;/table&amp;gt;
  &amp;lt;/div&amp;gt;</pre>
</li>
<li id="e-fP94">We can now execute the <code>activator</code> command <code>run</code> to start the Play 2 web application:<pre id="e-nkcJ">&lt;span class="strong"&gt;&lt;strong&gt;    $ activator "~run"&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Loading project definition&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Set current project to play2-angular-83&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    --- (Running the application, auto-reloading is enabled) ---&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Listening for HTTP on /0:0:0:0:0:0:0:0:9000&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    (Server started, use Ctrl+D to stop and go back to the console...)&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    [success] Compiled in 354ms&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-fiL7">Using <code>curl</code>, we can verify that our products API endpoint is working correctly:<pre id="e-fGNG">&lt;span class="strong"&gt;&lt;strong&gt;    $ curl http://localhost:9000/api/products&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [{"sku":"733733-421","title":"HP ProLiant DL360p Gen8"}, {"sku":"7147H2G","title":"IBM System x x3690 X5"},{"sku":"R630- 3552","title":"DELL PowerEdge R630"},{"sku":"RX-2280I","title":"Supermicro RTG  RX-2280I"},{"sku":"MB449D/A","title":"Apple Xserve"}]%&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-G0Zc">We can now access our Angular-driven products listing page with the Play 2 backed API endpoint by loading the URL <code>http://localhost:9000</code> in a web browser:<img data-width="800" data-height="282" src="rmqhYqAm.jpg"/>
</li>
</ol>
<h2 id="e-fwLf">How it works…</h2>
<p id="e-w70g">In this recipe, we created a Play 2 web application that used AngularJS and Bootstrap to display a listing of products. The list of products was served by a Play 2-based Rest API endpoint, which returns a set of products that contain a product title and SKU.</p>
<p id="e-Mcto">To wire up everything together, we had to modify a few configuration settings to the base play-scala <code>activator</code> template and add new JavaScript files that contained our main AngularJS script.</p>
<ol id="e-MU28">
<li id="e-WAmD">First, we had to declare that our web application required AngularJS, RequireJS, and Bootstrap by modifying our library dependencies in the <code>build.sbt</code> file:<pre id="e-WVFf">libraryDependencies ++= Seq(
      "org.webjars" %% "webjars-play" % "2.3.0",
      "org.webjars" % "angularjs" % "1.3.4",
      "org.webjars" % "bootstrap" % "3.3.1" exclude("org.webjars", "jquery"),
      "org.webjars" % "requirejs" % "2.1.15" exclude("org.webjars", "jquery")
    )</pre>
</li>
<li id="e-W3Nr">Next, we modified the application controller to add a product case class and the <code>listProducts</code> action, which will serve our products API endpoint:<pre id="e-Gjlb">case class Product(sku: String, title: String)
    
    def listProducts = Action {
      Ok(Json.toJson(products))
    }</pre>
</li>
<li id="e-HCCl">Next, we need to modify our <code>routes</code> file to declare new routes and reconfigure an existing route:<pre id="e-l37F">GET     /assets/*file               controllers.Assets.versioned(path="/public", file: Asset)
    GET     /api/products               controllers.Application.listProducts
    GET     /webjars/*file              controllers.WebJarAssets.at(file)</pre>
</li>
<li id="e-klCw">In the preceding snippet, we reconfigured the existing <code>/assets/*file</code> route by using the <code>versioned</code> action instead. We then added the products API endpoint route and the route entry for the WebJars assets.</li>
<li id="e-D2Z8">Next, we need to make modifications to the existing <code>app/views/index.scala.html</code> template to insert the Angular View tag to render partial HTMLs:<pre id="e-h2qd">@main("Product Catalogue") {
  
      &amp;lt;div class="container-fluid"&amp;gt;
        &amp;lt;div class="row"&amp;gt;
          &amp;lt;ng-view /&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
    }</pre>
</li>
<li id="e-yya6">The next step would be to modify the layouts template file <code>app/views/main.scala.html</code> to load our main JavaScript file and its dependencies:<pre id="e-wepP">@(title: String)(content: Html)&amp;lt;!DOCTYPE html&amp;gt;
   &amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;meta charset="utf-8"&amp;gt;
    &amp;lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&amp;gt;
    &amp;lt;meta name="viewport" content="width=device-width, initial-scale=1"&amp;gt;
    &amp;lt;meta name="description" content=""&amp;gt;
    &amp;lt;meta name="author" content=""&amp;gt;
    &amp;lt;title&amp;gt;@title&amp;lt;/title&amp;gt;
    &amp;lt;link rel="shortcut icon" type="image/png" href='@routes.Assets.versioned("images/favicon.png")'&amp;gt;
    &amp;lt;link rel="stylesheet" media="screen" href='@routes.WebJarAssets.at(WebJarAssets.locate("css/bootstrap.min.css"))' /&amp;gt;
    &amp;lt;style&amp;gt;
        body {
            padding-top: 50px;
        }
    &amp;lt;/style&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    @content
    &amp;lt;script data-main='@routes.Assets.versioned("javascripts/main.js").url' src='@routes.WebJarAssets.at(WebJarAssets.locate("require.min.js")).url'&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;/body&amp;gt;
  &amp;lt;/html&amp;gt;</pre>
</li>
<li id="e-LbJw">We then need to add our main JavaScript file in <code>public/javascripts/main.js</code> to configure our main Angular app:<pre id="e-k6iy">'use strict';
   requirejs.config({
    paths: {
      'angular': ['../lib/angularjs/angular'],
      'angular-route': ['../lib/angularjs/angular-route'],
      'angular-resource': ['../lib/angularjs/angular-resource.min']
    },
    shim: {
      'angular': {
        exports : 'angular'
      },
      'angular-route': {
        deps: ['angular'],
        exports : 'angular'
      },
      'angular-resource': {
        deps: ['angular'],
        exports : 'angular'
      }
    }
  });
   require([
    'angular',
    'angular-route',
    'angular-resource',
    './services',
    './controllers'
    ],
    function(angular) {
      angular.module('azApp', [
        'ngRoute',
        'ngResource',
        'azApp.services',
        'azApp.controllers'
      ])
       .config(['$routeProvider', '$locationProvider', '$httpProvider', function($routeProvider, $locationProvider, $httpProvider) {
        $routeProvider
          .when('/', {
            templateUrl: 'assets/javascripts/partials/products.html',
            controller: 'ProductsCtrl'
          })
      }]);
       angular.bootstrap(document, ['azApp']);
  });</pre>
</li>
<li id="e-PKpX">In the preceding snippet, we initialized Angular and two other Angular plugins, <code>angular-routes</code> and <code>angular-resources</code>, which will handle request routes and manage API calls respectively. We also loaded and initialized our Angular controllers and services script files:<pre id="e-paM6">require([
    'angular',
    'angular-route',
    'angular-resource',
    './services',
    './controllers'
    ])</pre>
</li>
<li id="e-UaRN">Lastly, we configured our Angular app routes using the <code>$routeProvider</code> directive. For this recipe, the base URL loads the products controller by default, using the template partial <code>public/javascripts/partials/products.html</code>:<pre id="e-o3D9">$routeProvider
    .when('/', {
      templateUrl: 'assets/javascripts/partials/products.html',
      controller: 'ProductsCtrl'
    })
  }])</pre>
</li>
</ol>
<p id="e-njV2">For this recipe, we were successfully able to integrate AngularJS with our Play 2 web application using the WebJars repository to manage all frontend libraries (for this recipe, Angular, RequireJS, and Bootstrap). We were able to access a products API endpoint and display its contents in an Angular template.</p>

<h1 id="e-iqmf">Integrating a Play application with Parse.com</h1>
<p id="e-ivi3">For this recipe, we will integrate a Play 2 Rest API with a BaaS such as <a href="http://Parse.com">Parse.com</a>'s Parse Core, which is a cloud service that allows developers to store data in the cloud. In this recipe, we want to be able to see how we can use Play to integrate other external web services into our web application. It should not be uncommon for modern web applications to have more than one data source. We will use a Parse Core application to mimic this. We will use the Play WS library to connect to the Parse API, particularly using HTTP headers to send application credentials and JSON data to the Parse API web service. We will also be able to use <a href="http://Parse.com">Parse.com</a>'s own core data browser to view the data we have stored in our Parse Core application.</p>
<p id="e-jvVn">For this recipe, we will need a <a href="http://Parse.com">Parse.com</a> account. You can sign up for one at <a href="https://parse.com/#signup">https://parse.com/#signup</a>.</p>
<h2 id="e-lCMo">How to do it…</h2>
<p id="e-D3Ye">For this recipe, you need to perform the following steps:</p>
<ol id="e-nYLX">
<li id="e-sViV">Sign in to your <a href="http://Parse.com">Parse.com</a> account and create a new Parse Core application:<img data-width="800" data-height="553" src="j2XLqIq7.jpg"/>
</li>
<li id="e-UUTI">Once a new Parse app has been created, navigate to the <strong>settings</strong> section to retrieve your <strong>application ID</strong> and <strong>Rest API key</strong>:<img data-width="800" data-height="545" src="dNeR7iVv.jpg"/>
</li>
<li id="e-VyjJ">Next, create a new Parse class (analogous to a database table) in the Parse Core section. For this recipe, we will store <strong>Item</strong> records:<img data-width="800" data-height="558" src="ptAW9lE1.jpg"/>
</li>
<li id="e-Rfpv">After creating the Parse class, add the necessary columns for our items. For this recipe, we will add the <strong>title</strong> and SKU columns:<img data-width="800" data-height="559" src="uMTZKg5W.jpg"/>
</li>
<li id="e-FFuY">Next, we will work on our Play 2 web application that will interface with Parse Core. Generate a new Play 2 web application based on the activator template <code>play-scala</code>:<pre id="e-vjaK">&lt;span class="strong"&gt;&lt;strong&gt;    activator new play2-parse-84 play-scala &amp;amp;&amp;amp; cd play2-parse-84&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Ncc5">Next, create a new plugin in <code>app/plugins/ParsePlugin.scala</code>, with the following content:<pre id="e-pqeq">package plugins
     import play.api.{Application, Plugin}
     class ParsePlugin(app: Application) extends Plugin {
      lazy val parseAPI: ParseAPI = {
        new ParseAPI(
          app.configuration.getString("parse.core.appId").get,
          app.configuration.getString("parse.core.restKey").get
        )
      }
       override def onStart() = {
        parseAPI
      }
    }</pre>
</li>
<li id="e-z1eL">Next, add the Parse Core keys, which we made note of in the previous step, in the <code>conf/application.conf file</code>. Make sure to replace the placeholders with your actual Parse app ID and Rest key:<pre id="e-aqpt">parse.core.appId=&amp;lt;YOUR_PARSE_APP_ID&amp;gt;
    parse.core.restKey=&amp;lt;YOUR_PARSE_REST_KEY&amp;gt;</pre>
</li>
<li id="e-XM38">Next, create our Parse helper class in <code>app/plugins/ParseAPI.scala</code>, with the following content:<pre id="e-d6Ms">package plugins
     import play.api.Play.current
    import play.api.libs.json.JsValue
    import play.api.libs.ws.WS
     class ParseAPI(appId: String, restKey: String) {
      private val PARSE_API_HEADER_APP_ID = "X-Parse-Application-Id"
      private val PARSE_API_HEADER_REST_API_KEY = "X-Parse-REST-API-Key"
      private val PARSE_API_URL = "https://api.parse.com"
      private val PARSE_API_URL_CLASSES = "/1/classes/"
      private val PARSE_API_HEADER_CONTENT_TYPE = "Content-Type"
      private val CONTENT_TYPE_JSON = "application/json; charset=utf-8"
       private val parseBaseUrl = "%s%s".format(PARSE_API_URL, PARSE_API_URL_CLASSES)
       def list(className: String) = parseWS(className).get()
       def create(className: String, json: JsValue) = {
        parseWS(className)
          .withHeaders(PARSE_API_HEADER_CONTENT_TYPE -&amp;gt; CONTENT_TYPE_JSON)
      .post(json)
      }
       private def parseWS(className: String) = WS.url("%s%s".format(parseBaseUrl, className))
        .withHeaders(PARSE_API_HEADER_APP_ID -&amp;gt; appId)
        .withHeaders(PARSE_API_HEADER_REST_API_KEY -&amp;gt; restKey)
    }</pre>
</li>
<li id="e-kEwn">Next, initialize the plugin on the app startup by creating the Play plugins configuration file in <code>conf/play.plugins</code> with the following content:<pre id="e-m7pf">799:plugins.ParsePlugin</pre>
</li>
<li id="e-varD">Finally, let's add our <code>Items</code> controller in the <code>app/controllers/Items.scala</code> file, with the following contents, which should add two action methods, <code>index()</code>, for returning items from Parse Core, and <code>create()</code>, which will persist items on Parse Core:<pre id="e-Sg4H">package controllers
     import play.api.Play
    import play.api.Play.current
    import play.api.libs.json.{JsError, Json, JsObject}
    import play.api.mvc.{BodyParsers, Action, Controller}
    import play.api.libs.concurrent.Execution.Implicits._
    import plugins.ParsePlugin
    import scala.collection.mutable.ListBuffer
    import scala.concurrent.Future
     case class Item(objectId: Option[String], title: String, sku: String)
     object Items extends Controller {
      private val parseAPI = Play.application.plugin[ParsePlugin].get.parseAPI
      implicit val itemWrites = Json.writes[Item]
      implicit val itemReads = Json.reads[Item]
       val `Items` = "Items"
       def index = Action.async { implicit request =&amp;gt;
        parseAPI.list(`Items`).map { res =&amp;gt;
          val list = ListBuffer[Item]()
          (res.json \ "results").as[List[JsObject]].map { itemJson =&amp;gt;
            list += itemJson.as[Item]
          }
          Ok(Json.toJson(list))
        }
      }
       def create = Action.async(BodyParsers.parse.json) { implicit request =&amp;gt;
        val post = request.body.validate[Item]
        post.fold(
          errors =&amp;gt; Future.successful {
            BadRequest(Json.obj("error" -&amp;gt; JsError.toFlatJson(errors)))
          },
          item =&amp;gt; {
            parseAPI.create(`Items`, Json.toJson(item)).map { res =&amp;gt;
              if (res.status == CREATED) {
                Created(Json.toJson(res.json))
              } else {
                BadGateway("Please try again later")
              }
            }
          }
        )
      }
    }</pre>
</li>
<li id="e-DIQ7">Add the necessary routes entry in the <code>conf/routes</code> file for our <code>Items</code> actions:<pre id="e-tQWA">GET     /api/items                  controllers.Items.index
    POST    /api/items                  controllers.Items.create</pre>
</li>
<li id="e-sUxI">To run our web application, we will use the activator command <code>run</code>, with the tilde character (~) to signify that we want Hot-Reloading enabled for this web application:<pre id="e-Fes9">&lt;span class="strong"&gt;&lt;strong&gt;    $ activator "~run"&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Loading project definition&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Set current project to play2-parse-84&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    --- (Running the application, auto-reloading is enabled) ---&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Listening for HTTP on /0:0:0:0:0:0:0:0:9000&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    (Server started, use Ctrl+D to stop and go back to the console...)&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    [success] Compiled in 400ms&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Application started (Dev)&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-FchO">Using <code>curl</code>, we can now insert new records into our Parse Core application:<pre id="e-qIPd">&lt;span class="strong"&gt;&lt;strong&gt;    $ curl -v -X POST http://localhost:9000/api/items --header "Content-type: application/json" -d '{"title":"Supermicro RTG RX-2280I", "sku":"RX-2280I"}'&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Hostname was NOT found in DNS cache&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    *   Trying ::1...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Connected to localhost (::1) port 9000 (#0)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; POST /api/items HTTP/1.1&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; User-Agent: curl/7.37.1&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Host: localhost:9000&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Accept: */*&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Content-type: application/json&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Content-Length: 53&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt;&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * upload completely sent off: 53 out of 53 bytes&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; HTTP/1.1 201 Created&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; Content-Type: application/json; charset=utf-8&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; Content-Length: 64&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt;&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Connection #0 to host localhost left intact&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    {"createdAt":"2015-04-08T06:13:52.103Z","objectId":"K7Q2JEXxmI"}%&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-xF4C">Now, we can also retrieve <code>items</code> stored on Parse Core by using <code>curl</code>:<pre id="e-ZdNw">&lt;span class="strong"&gt;&lt;strong&gt;    $ curl -v http://localhost:9000/api/items&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Hostname was NOT found in DNS cache&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    *   Trying ::1...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Connected to localhost (::1) port 9000 (#0)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; GET /api/items HTTP/1.1&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; User-Agent: curl/7.37.1&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Host: localhost:9000&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt; Accept: */*&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;gt;&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; HTTP/1.1 200 OK&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; Content-Type: application/json; charset=utf-8&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt; Content-Length: 231&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    &amp;lt;&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    * Connection #0 to host localhost left intact&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [{"objectId":"0aTdEVAwaF","title":"DELL PowerEdge R630","sku":"R630-3552"},    {"objectId":"T3TqVdi9a2","title":"HP ProLiant DL360p Gen8","sku":"733733-421"},    {"objectId":"K7Q2JEXxmI","title":"Supermicro RTG RX-2280I","sku":"RX-2280I"}]%&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
</ol>
<h2 id="e-ELWR">How it works…</h2>
<p id="e-wki4">In this recipe, we looked into a more practical example of integrating an external web service with a Play 2 web application using the Play WS library. The Play WS library saves developers from a lot of boilerplate code in setting up and connecting to a remote HTTP host, it also provides convenient methods to set up headers, request parameters, and so on.</p>
<p id="e-kaj8">Parse Core is a very popular and solid backend-as-a-service provider, which offers other developer services, such as mobile push notifications and mobile analytics, all of which are important additions to any developer toolchain.</p>
<p id="e-J9dR">Essential to this recipe is signing up for a <a href="http://Parse.com">Parse.com</a> account and creating a Parse Core application. Once we have that set up, we can proceed to creating a Play plugin, which will take care of the initialization and setting up of our connection to the Parse API:</p>
<pre id="e-T0iF">// app/plugins/ParsePlugin.scala
    class ParsePlugin(app: Application) extends Plugin {
      lazy val parseAPI: ParseAPI = {
        new ParseAPI(
          app.configuration.getString("parse.core.appId").get,
          app.configuration.getString("parse.core.restKey").get
        )
      }
       override def onStart() = {
        parseAPI
      }
    }
     // conf/application.conf
    parse.core.appId=&amp;lt;YOUR_PARSE_APP_ID&amp;gt;
    parse.core.restKey=&amp;lt;YOUR_PARSE_REST_KEY&amp;gt;</pre>
<p id="e-Ftbf">Next, we create our Parse Core delegate class <code>conf/plugins/ParseAPI.scala</code>, which will encapsulate all interfacing with the Parse API:</p>
<pre id="e-m7Ua">package plugins
     import play.api.Play.current
    import play.api.libs.json.JsValue
    import play.api.libs.ws.WS
     class ParseAPI(appId: String, restKey: String) {
      private val PARSE_API_HEADER_APP_ID = "X-Parse-Application-Id"
      private val PARSE_API_HEADER_REST_API_KEY = "X-Parse-REST-API-Key"
      private val PARSE_API_URL = "https://api.parse.com"
      private val PARSE_API_URL_CLASSES = "/1/classes/"
      private val PARSE_API_HEADER_CONTENT_TYPE = "Content-Type"
      private val CONTENT_TYPE_JSON = "application/json; charset=utf-8"
       private val parseBaseUrl = "%s%s".format(PARSE_API_URL, PARSE_API_URL_CLASSES)
       def list(className: String) = parseWS(className).get()
       def create(className: String, json: JsValue) = {
        parseWS(className)
          .withHeaders(PARSE_API_HEADER_CONTENT_TYPE -&amp;gt; CONTENT_TYPE_JSON)
      .post(json)
      }
       private def parseWS(className: String) = WS.url("%s%s".format(parseBaseUrl, className))
        .withHeaders(PARSE_API_HEADER_APP_ID -&amp;gt; appId)
        .withHeaders(PARSE_API_HEADER_REST_API_KEY -&amp;gt; restKey)
    }</pre>
<p id="e-OqB5">In the preceding class, we created two public methods that should have data retrieval and record creation. We include the required Parse API headers for authentication whenever we do a <code>GET</code> or <code>POST</code> request:</p>
<pre id="e-e0Yr">private def parseWS(className: String) = WS.url("%s%s".format(parseBaseUrl, className))
        .withHeaders(PARSE_API_HEADER_APP_ID -&amp;gt; appId)
        .withHeaders(PARSE_API_HEADER_REST_API_KEY -&amp;gt; restKey)</pre>
<p id="e-dAvA">For the <code>POST</code> request, we add the required additional header to set our content type to <code>application/json</code>:</p>
<pre id="e-VQ9F">def create(className: String, json: JsValue) = {
      parseWS(className)
        .withHeaders(PARSE_API_HEADER_CONTENT_TYPE -&amp;gt; CONTENT_TYPE_JSON)
        .post(json)
    }</pre>
<p id="e-pLeQ">Once the Parse plugin is all set up, we create the <code>Items</code> controller, which will receive the requests for items and item creation and will be responsible for the delegation of these requests to the Parse API helper:</p>
<pre id="e-eaFE">def index = Action.async { implicit request =&amp;gt;
      parseAPI.list(`Items`).map { res =&amp;gt;
        val list = ListBuffer[Item]()
        (res.json \ "results").as[List[JsObject]].map { itemJson =&amp;gt;
          list += itemJson.as[Item]
        }
        Ok(Json.toJson(list))
      }
    }
     def create = Action.async(BodyParsers.parse.json) { implicit request =&amp;gt;
      val post = request.body.validate[Item]
      post.fold(
        errors =&amp;gt; Future.successful {
          BadRequest(Json.obj("error" -&amp;gt; JsError.toFlatJson(errors)))
        },
        item =&amp;gt; {
          parseAPI.create(`Items`, Json.toJson(item)).map { res =&amp;gt;
            if (res.status == CREATED) {
              Created(Json.toJson(res.json))
            } else {
              BadGateway("Please try again later")
            }
          }
        }
      )
    }</pre>
<p id="e-suqc">Do not forget to add the subsequent routes in the <code>conf/routes</code> config file:</p>
<pre id="e-z4VG">GET     /api/items                  controllers.Items.index
    POST    /api/items                  controllers.Items.create</pre>
<p id="e-TnNn">We can use the Parse Core dashboard to view all data created via the Parse API:</p>
<img data-width="800" data-height="543" src="K0GHawAH.jpg"/><h2 id="e-bYpJ">There's more…</h2>
<p id="e-FQU9">For more information about Parse Core, please refer to their online documentation found at <a href="https://parse.com/docs">https://parse.com/docs</a>.</p>

<h1 id="e-KUb4">Creating a Play development environment using Vagrant</h1>
<p id="e-Y7fw">We will explore how to create a portable development environment for Play 2 development using <strong>Vagrant</strong>, a powerful addition to any developer's toolchain. Vagrant allows developers to automate the creation of a development environment, from installing the required development kits for <strong>Read-Eval-Print Loop</strong> (<strong>REPL</strong>) tools, to installing other services such as MySQL and Redis. This setup is useful for multimember development teams or developers who work off of multiple workstations, where a consistent, identical development environment is necessary and ideal.</p>
<p id="e-RInO">For this recipe, we will create our Vagrant instance from the ground up, installing the required libraries to run our sample Play web application, and running a MySQL service using Docker and the actual sample Play web application using the <code>activator</code> template <code>play-slick-angular-test-example</code>.</p>
<h2 id="e-AN7N">How to do it…</h2>
<p id="e-QRNm">For this recipe, you need to perform the following steps:</p>
<ol id="e-U8Qn">
<li id="e-BnEt">Install Vagrant by following the installation instructions at the following link:<p id="e-kt1u"><a href="https://docs.vagrantup.com/v2/installation/index.html">https://docs.vagrantup.com/v2/installation/index.html</a></p>
</li>
<li id="e-P5nk">You should now have a version of Vagrant installed locally:<pre id="e-xWVb">&lt;span class="strong"&gt;&lt;strong&gt;    $ vagrant -v&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Vagrant 1.6.3&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Bss7">Create a workspace directory and change into the newly created directory:<pre id="e-fvR0">&lt;span class="strong"&gt;&lt;strong&gt;    mkdir play2-vagrant-85 &amp;amp;&amp;amp; cd $_&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-MlA7">Create a <code>Vagrantfile</code> in the project root with the following content:<pre id="e-C2UF"># -*- mode: ruby -*-
    # vi: set ft=ruby :
     VAGRANTFILE_API_VERSION = "2"
     Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
      config.vm.box = "Centos-6.5"
      config.vm.box_url = "https://github.com/2creatives/vagrant-centos/releases/download/v6.5.1/centos65-x86_64-20131205.box"
      config.vm.hostname = "VG-play2"
       config.vm.provision :shell, :path =&amp;gt; "bootstrap.sh"
       config.vm.network "forwarded_port", guest: 9000, host: 9000
      config.vm.network "forwarded_port", guest: 3306, host: 3306
       config.vm.provider :virtualbox do |vb|
        vb.name = "VG-play2"
        vb.gui = false
        vb.customize ["modifyvm", :id, "--memory", "4096", "--cpus", "2", "--    ioapic", "on"]
      end
    end</pre>
</li>
<li id="e-H6Ru">Create a Bootstrap bash script file <code>bootstrap.sh</code>, with the following content:<pre id="e-jocP">#!/usr/bin/env bash
     set -x
     SCALA_VER=2.11.2
    ACTIVATOR_VER=1.3.2
    MYSQL_ROOT_PW="cookbook"
     if [ ! -e "/home/vagrant/.firstboot" ]; then
       # tools etc
      yum -y install yum-plugin-fastestmirror
      yum -y install git wget curl rpm-build
       # Pre-docker install: http://stackoverflow.com/a/27216873
      sudo yum-config-manager --enable public_ol6_latest
      sudo yum install -y device-mapper-event-libs
       # Docker
      yum -y install docker-io
      service docker start
      chkconfig docker on
      usermod -a -G docker vagrant
       # Install the JDK
      curl -LO 'http://download.oracle.com/otn-pub/java/jdk/7u51-b13/jdk-7u51-linux-x64.rpm' -H 'Cookie: oraclelicense=accept-securebackup-cookie'
      rpm -i jdk-7u51-linux-x64.rpm
      /usr/sbin/alternatives --install /usr/bin/java java /usr/java/default/bin/java 200000
      rm jdk-7u51-linux-x64.rpm
       # Install scala repl
      rpm -ivh http://scala-lang.org/files/archive/scala-$SCALA_VER.rpm
       # Install Activator
      cd /opt
      wget http://downloads.typesafe.com/typesafe-activator/$ACTIVATOR_VER/typesafe-activator-$ACTIVATOR_VER.zip
      unzip typesafe-activator-$ACTIVATOR_VER.zip
      chown -R vagrant:vagrant /opt/activator-$ACTIVATOR_VER
       # Set Path
      echo "export JAVA_HOME=/usr/java/default/" &amp;gt;&amp;gt; /home/vagrant/.bash_profile
      echo "export PATH=$PATH:$JAVA_HOME/bin:/home/vagrant/bin:/opt/activator-$ACTIVATOR_VER" &amp;gt;&amp;gt; /home/vagrant/.bash_profile
       touch /home/vagrant/.firstboot
    fi
     # Start MySQL
    docker run -e MYSQL_PASS=$MYSQL_ROOT_PW -i -d -p 3306:3306 --name mysqld -t tutum/mysql</pre>
</li>
<li id="e-XU6c">Create a git ignore file <code>.gitignore</code>, to exclude the Vagrant directory workspace from git:<pre id="e-Wwgh">&lt;span class="strong"&gt;&lt;strong&gt;    $ cat .gitignore&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    .vagrant&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-hgq4">Once Vagrant is installed and our <code>Vagrantfile</code> has been configured properly, we can initialize our Vagrant instance:<pre id="e-mgW0">&lt;span class="strong"&gt;&lt;strong&gt;    vagrant up&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-WgzI">We can log in to the Vagrant instance using the following command:<pre id="e-WYSY">&lt;span class="strong"&gt;&lt;strong&gt;    vagrant ssh&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-PKJD">Once logged in to the Vagrant instance, change into the Vagrant workspace directory with the following command:<pre id="e-NiCP">&lt;span class="strong"&gt;&lt;strong&gt;    cd /vagrant&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-o9kb">List the contents of the <code>/vagrant</code> directory to verify that you are in the correct directory:<pre id="e-o8OF">&lt;span class="strong"&gt;&lt;strong&gt;    $ ls -ltra&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    -rw-r--r--   1 vagrant vagrant    9 Mar 31 12:48 .gitignore&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    -rw-r--r--   1 vagrant vagrant  683 Mar 31 12:50 Vagrantfile&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    drwxr-xr-x   1 vagrant vagrant  102 Mar 31 12:57 .vagrant&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    -rwxr-xr-x   1 vagrant vagrant 1632 Apr  1 12:44 bootstrap.sh&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-YduX">For this recipe, we will use the <code>activator</code> template <code>play-slick-angular-test-example</code> and generate a new Play 2 project based on this:<pre id="e-YtL1">&lt;span class="strong"&gt;&lt;strong&gt;    $ activator new play-slick-angular-test-example play-slick-angular-test-example&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-AXYq">Edit the configuration file in <code>conf/application.conf</code> by modifying the following lines of code:<pre id="e-pdkZ">db.default.driver=com.mysql.jdbc.Driver
    db.default.url="jdbc:mysql://localhost/report?createDatabaseIfNotExist=true"
    db.default.user=admin
    db.default.password="cookbook"
     applyEvolutions.default=true</pre>
</li>
<li id="e-wEQN">Run the Play web application using <code>activator</code>:<pre id="e-GeiV">&lt;span class="strong"&gt;&lt;strong&gt;    $ activator run&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-A7bp">You should now be able to access the Play web application by using a web browser:<img data-width="800" data-height="373" src="aLB0M6Rs.jpg"/>
</li>
</ol>
<h2 id="e-P3P1">How it works…</h2>
<p id="e-Pk5t">In this recipe, we installed Vagrant, a popular developer tool that automates the initialization and setup of developer environments, as per the following steps:</p>
<ol id="e-xtR3">
<li id="e-BfBy">In the <code>Vagrantfile</code> config file, we declared that we will be using a Centos 6.5 Vagrant box as our base OS:<pre id="e-U7GD">config.vm.box_url = "https://github.com/2creatives/vagrant-centos/releases/download/v6.5.1/centos65-x86_64-20131205.box"</pre>
</li>
<li id="e-JiJf">We declared that we want our <code>bootstrap.sh</code> script file to be run during the Vagrant instance provisioning:<pre id="e-Rsvb">config.vm.provision :shell, :path =&amp;gt; "bootstrap.sh"</pre>
</li>
<li id="e-lGNv">Next, we declared which ports to forward from our vagrant instance to our host machine, port 9000 for Play and port 3306 for MySQL:<pre id="e-tGRg">config.vm.network "forwarded_port", guest: 9000, host: 9000
    config.vm.network "forwarded_port", guest: 3306, host: 3306</pre>
</li>
<li id="e-h0ez">Finally, we optionally configured our Vagrant instance to have a 4-GB RAM and utilize two CPUs:<pre id="e-VmKI">vb.customize ["modifyvm", :id, "--memory", "4096", "--cpus", "2", "--ioapic", "on"]</pre>
</li>
<li id="e-y9sY">We installed relevant tools for Play development, which we specified in the <code>bootstrap.sh</code> script file. We declared the version of Scala and Activator at the top of the <code>bootstrap.sh</code> file:<pre id="e-Qz6G">SCALA_VER=2.11.2
    ACTIVATOR_VER=1.3.2</pre>
</li>
<li id="e-WJ3A">We also declared the default MySQL password to use for our MySQL instance:<pre id="e-eaj6">MYSQL_ROOT_PW="cookbook"</pre>
</li>
<li id="e-etO7">Next, we installed the required and necessary CentOS packages:<pre id="e-lsCw">&lt;span class="strong"&gt;&lt;strong&gt;# tools etc&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  yum -y install yum-plugin-fastestmirror&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  yum -y install git wget curl rpm-build&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-gwQY">The next packages to install are Docker and its required libraries:<pre id="e-J5Kn">&lt;span class="strong"&gt;&lt;strong&gt;# Pre-docker install: http://stackoverflow.com/a/27216873&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  sudo yum-config-manager --enable public_ol6_latest&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  sudo yum install -y device-mapper-event-libs&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;  # Docker&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  yum -y install docker-io&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  service docker start&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  chkconfig docker on&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;  usermod -a -G docker vagrant&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-HslZ">Next, we installed the JDK, a Scala binary, and Activator:<pre id="e-ju9H">&lt;span class="strong"&gt;&lt;strong&gt;    # Install the JDK&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    curl -LO 'http://download.oracle.com/otn-pub/java/jdk/7u51-b13/jdk-7u51-linux-x64.rpm' -H 'Cookie: oraclelicense=accept-securebackup-cookie'&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    rpm -i jdk-7u51-linux-x64.rpm&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    /usr/sbin/alternatives --install /usr/bin/java java /usr/java/default/bin/java 200000&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    rm jdk-7u51-linux-x64.rpm&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    # Install scala repl&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    rpm -ivh http://scala-lang.org/files/archive/scala-$SCALA_VER.rpm&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    # Install Activator&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    cd /opt&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    wget http://downloads.typesafe.com/typesafe-activator/$ACTIVATOR_VER/typesafe-activator-$ACTIVATOR_VER.zip&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    unzip typesafe-activator-$ACTIVATOR_VER.zip&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    chown -R vagrant:vagrant /opt/activator-$ACTIVATOR_VER&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    # Set Path&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    echo "export JAVA_HOME=/usr/java/default/" &amp;gt;&amp;gt; /home/vagrant/.bash_profile&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    echo "export PATH=$PATH:$JAVA_HOME/bin:/home/vagrant/bin:/opt/activator-$ACTIVATOR_VER" &amp;gt;&amp;gt; /home/vagrant/.bash_profile&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-N0ZZ">Finally, we ran a MySQL Docker container on the instance start up:<pre id="e-KW8M">&lt;span class="strong"&gt;&lt;strong&gt;    # Start MySQL&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    docker run -e MYSQL_PASS=$MYSQL_ROOT_PW -i -d -p 3306:3306 --name mysqld -t tutum/mysql&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-RSHD">We run the Vagrant command <code>vagrant up</code>, to initialize the Vagrant instance from scratch. After a short while, our Play 2 development environment should be ready. Log in to the Vagrant instance using the command <code>vagrant ssh</code>. You should be able to verify whether all the required binaries have been installed:<pre id="e-kjqy">&lt;span class="strong"&gt;&lt;strong&gt;    [vagrant@VG-play2 ~]$ java -version&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    java version "1.7.0_51"&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Java(TM) SE Runtime Environment (build 1.7.0_51-b13)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Java HotSpot(TM) 64-Bit Server VM (build 24.51-b03, mixed mode)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [vagrant@VG-play2 ~]$ activator --version&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    sbt launcher version 0.13.8-M5&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [vagrant@VG-play2 ~]$ scala -version&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    Scala code runner version 2.11.2 -- Copyright 2002-2013, LAMP/EPFL&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [vagrant@VG-play2 ~]$ docker ps&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    CONTAINER ID        IMAGE                COMMAND             CREATED                STATUS              PORTS                    NAMES&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    08ecd4a3d98c        tutum/mysql:latest   "/run.sh"           21 minutes ago          Up 21 minutes       0.0.0.0:3306-&amp;gt;3306/tcp   mysqld&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-Yycy">Once the Vagrant instance is up and running, we can build and run a Play web application; in this recipe, the <code>play-slick-angular-test-example</code> activator template that we installed in the <code>/vagrant</code> directory:<pre id="e-TBcS">&lt;span class="strong"&gt;&lt;strong&gt;    cd /vagrant/play-slick-angular-test-example&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    activator run&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Loading project definition from /vagrant/play-slick-angular-test-example/project&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Set current project to PlaySlickAngularBootstrapH2TestsExample (in build file:/vagrant/play-slick-angular-test-example/)&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [success] Total time: 4 s, completed Apr 6, 2015 2:55:54 PM&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Updating {file:/vagrant/play-slick-angular-test-example/}root...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Resolving jline#jline;2.12 ...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Done updating.&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    --- (Running the application from SBT, auto-reloading is enabled) ---&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    [info] play - Listening for HTTP on /0:0:0:0:0:0:0:0:9000&lt;/strong&gt;&lt;/span&gt;
 &lt;span class="strong"&gt;&lt;strong&gt;    (Server started, use Ctrl+D to stop and go back to the console...)&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
</ol>
<h2 id="e-nhkF">There's more…</h2>
<p id="e-fhRm">Remember to pause your Vagrant instance whenever you want to shut down the instance for a while and return to it later:</p>
<pre id="e-vS6I">&lt;span class="strong"&gt;&lt;strong&gt;    vagrant halt&lt;/strong&gt;&lt;/span&gt;</pre>
<p id="e-a0qZ">This allows the Vagrant instance to retain its current state without having to reinitialize the Vagrant instance later. For more information about Vagrant, refer to the documentation at <a href="https://docs.vagrantup.com/v2/">https://docs.vagrantup.com/v2/</a>.</p>

<h1 id="e-Kqt7">Coding Play 2 web apps with IntelliJ IDEA 14</h1>
<p id="e-LVmA">For this recipe, we will explore how to use the popular IDE, IntelliJ IDEA 14 to code Play 2 web applications. We will be using the community edition:</p>
<h2 id="e-DhmE">How to do it…</h2>
<p id="e-ppdM">For this recipe, you need to perform the following steps:</p>
<ol id="e-syBf">
<li id="e-fihk">Download and install IntelliJ IDEA 14 from the Jetbrains website:<p id="e-W0Nd"><a href="https://www.jetbrains.com/idea/download/">https://www.jetbrains.com/idea/download/</a></p>
</li>
<li id="e-Asik">Navigate to the Play 2 web application with which you will want to use IDEA 14; in this recipe, <code>play2-parse-84</code>:<pre id="e-wTfK">&lt;span class="strong"&gt;&lt;strong&gt;    cd play2-parse-84&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-XiK2">Using <code>activator</code>, generate the base IDEA 14 project files:<pre id="e-Gwfc">&lt;span class="strong"&gt;&lt;strong&gt;    $ activator idea&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Creating IDEA module for project 'play2-parse-84' ...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Running compile:managedSources ...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Running test:managedSources ...&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Created /Users/cookbook/play2-parse-84/.idea/IdeaProject.iml&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Created /Users/cookbook/play2-parse-84/.idea&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Created /Users/cookbook/play2-parse-84.iml&lt;/strong&gt;&lt;/span&gt;
&lt;span class="strong"&gt;&lt;strong&gt;    [info] Created /Users/cookbook/play2-parse-84/.idea_modules/play2-parse-84- build.iml&lt;/strong&gt;&lt;/span&gt;</pre>
</li>
<li id="e-jhQR">Start IntelliJ IDEA 14 and click on <strong>Import Project</strong>:<img data-width="500" data-height="413" src="Me0lXmyK.jpg"/>
</li>
<li id="e-cPaN">Using IDEA 14, navigate to the project directory of the project you want to work on; in this recipe, <strong>play2-parse-84</strong>:<img data-width="600" data-height="563" src="Oskb2rVI.jpg"/>
</li>
<li id="e-lEnN">On the next screen, select <strong>SBT</strong> as the external model for the project:<img data-width="700" data-height="631" src="CNcotwH8.jpg"/>
</li>
<li id="e-nxp5">Next, select additional project settings, such as the installed JDK version to use:<img data-width="700" data-height="630" src="ptXtiYwi.jpg"/>
</li>
<li id="e-MEl7">After clicking on <strong>Finish</strong>, you should have your Play 2 web application loaded correctly on IntelliJ IDEA 14:<img data-width="800" data-height="757" src="RGPlTj7A.jpg"/>
</li>
</ol>
<h2 id="e-MHcV">How it works…</h2>
<p id="e-Q7Gf">In this recipe, we simply used Activator's built-in support for IntelliJ IDEA to generate our Play 2 web applications IDEA project files using the command <code>activator idea</code>. Once we generated the IDEA project files from our current code base, all we needed to do was import it into IntelliJ IDEA and follow the project settings screens. We should now be able to work on our Play 2 web applications using IntelliJ IDEA.</p>
</body></html>