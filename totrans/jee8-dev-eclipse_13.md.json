["```java\nCREATE\nVIEW `user_group_view` AS\n    SELECT\n        `user`.`user_name` AS `user_name`,\n        `groups`.`group_name` AS `group_name`,\n        `user`.`password` AS `password`\n    FROM\n        ((`user`\n        JOIN `groups`)\n        JOIN `user_group`)\n    WHERE\n        ((`user`.`id` = `user_group`.`user_id`)\n            AND (`groups`.`id` = `user_group`.`group_id`))\n```", "```java\n<security-constraint>\n    <display-name>Admin resources</display-name>\n    <web-resource-collection>\n        <web-resource-name>admins</web-resource-name>\n        <url-pattern>/admin/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n        <role-name>admin </role-name>\n    </auth-constraint>\n    <!--         \n    <user-data-constraint>\n        <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n    </user-data-constraint>\n    -->\n</security-constraint>\n<security-role>\n    <description>Admins</description>\n    <role-name>admin</role-name>\n</security-role>\n```", "```java\n<!DOCTYPE HTML>\n<html>\n<head>\n<title>Course Management Admin</title>\n</head>\n<body>\n       Welcome to Course Management Admin<br>\n</body>\n</html>\n```", "```java\n<security-constraint>\n    <display-name>Admin resources</display-name>\n    <web-resource-collection>\n        <web-resource-name>admins</web-resource-name>\n        <url-pattern>/admin/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n        <role-name>admin-role</role-name>\n    </auth-constraint>\n</security-constraint>\n<login-config>\n    <auth-method>BASIC</auth-method>\n    <realm-name>courseManagementJDBCRealm</realm-name>\n</login-config>\n```", "```java\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE glassfish-web-app PUBLIC \"-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN\" \"http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd\">\n<glassfish-web-app error-url=\"\">\n    <security-role-mapping>\n       <role-name>admin-role</role-name>\n       <group-name>admin</group-name>\n    </security-role-mapping>\n</glassfish-web-app>\n```", "```java\n<login-config>\n    <auth-method>FORM</auth-method>\n    <realm-name>courseManagementJDBCRealm</realm-name>\n    <form-login-config>\n        <form-login-page>/login.jsp</form-login-page>\n        <form-error-page>/login-error.jsp</form-error-page>\n    </form-login-config>\n</login-config>\n```", "```java\n<!DOCTYPE HTML>\n<html>\n<head>\n<title>Admin Login</title>\n</head>\n<body>\n    <form method=post action=\"j_security_check\">\n        <table>\n            <tr>\n                <td>User Name: </td>\n                <td><input type=\"text\" name=\"j_username\"></td>\n            </tr>\n            <tr>\n               <td>Password: </td>\n               <td><input type=\"password\" name=\"j_password\"></td>\n            </tr>\n            <tr>\n                <td colspan=\"2\"><input type=\"submit\" value=\"Login\"></td>\n            </tr>\n        </table>\n    </form>\n</body>\n</html>\n```", "```java\n<!DOCTYPE HTML>\n<html>\n<head>\n<title>Login Failed</title>\n</head>\n<body>\n       Invalid user name or password<br>\n       <a href=\"<%=request.getContextPath()%>/admin/admin.jsp\">Try Again</a>\n</body>\n</html>\n```", "```java\n<!DOCTYPE HTML>\n<html>\n<head>\n<title>Course Management Admin</title>\n</head>\n<body>\n       Welcome to Course Management Admin<br>\n       <a href=\"../logout.jsp\">Logout</a>\n</body>\n</html>\n```", "```java\n<%@ page session=\"true\"%>\nLogged out <%=request.getRemoteUser()%>\n<% session.invalidate(); %>\n```", "```java\n<security-constraint>\n    <display-name>Admin resources</display-name>\n    <web-resource-collection>\n        <web-resource-name>admins</web-resource-name>\n        <url-pattern>/admin/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n        <role-name>admin</role-name>\n    </auth-constraint>\n</security-constraint>\n<login-config>\n    <auth-method>FORM</auth-method>\n    <form-login-config>\n        <form-login-page>/login.jsp</form-login-page>\n        <form-error-page>/login-error.jsp</form-error-page>\n    </form-login-config>\n</login-config> \n```", "```java\n<Realm  className=\"org.apache.catalina.realm.JDBCRealm\"\n    driverName=\"com.mysql.jdbc.Driver\"\n    connectionURL=\"jdbc:mysql://localhost:3306/course_management\"\n    connectionName=\"<your-db-username>\"\n    connectionPassword=\"<your-db-password>\"\n    userTable=\"user_group_view\"\n    userNameCol=\"user_name\"\n    userCredCol=\"password\"\n    userRoleTable=\"user_group_view\"\n    roleNameCol=\"group_name\" />\n```", "```java\n  <login-config>\n    <auth-method>FORM</auth-method>\n    <form-login-config>\n      <form-login-page>/login.jsp</form-login-page>\n      <form-error-page>/login-error.jsp</form-error-page>\n    </form-login-config>\n  </login-config>\n```", "```java\npackage packt.book.jee.eclipse.ch4.servlet;\n// skipping imports to save space\n@WebServlet(\"/AdminServlet\")\n@ServletSecurity(@HttpConstraint(rolesAllowed = \"admin\"))\npublic class AdminServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n    public AdminServlet() {\n        super();\n    }\n\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException {\n        try {\n            request.authenticate(response);\n            response.getWriter()\n                    .append(\"Served at: \").append(request.getContextPath());\n        } finally {\n            response.getWriter().close();\n        }      \n     }\n\n    protected void doPost(HttpServletRequest request, \n        HttpServletResponse response) throws ServletException, IOException {\n        doGet(request, response);\n    }\n}\n```", "```java\n:<security-constraint>\n    <display-name>Admin resources</display-name>\n    <web-resource-collection>\n        <web-resource-name>admins</web-resource-name>\n            <url-pattern>/services/*</url-pattern>\n        </web-resource-collection>\n        <auth-constraint>\n            <role-name>admin</role-name>\n        </auth-constraint>\n </security-constraint>\n<login-config>\n    <auth-method>BASIC</auth-method>\n</login-config>   \n```", "```java\nString userName = \"user1\";\nString password = \"user1_pass\";\nString authString = userName + \":\" + password;\nString encodedAuthStr =  Base64.*getEncoder*().encodeToString(authString.getBytes());\n//Execute HTTP get method\nResponse response = webTarget.request(MediaType.*APPLICATION_JSON*).header(HttpHeaders.*AUTHORIZATION*, \"Basic \" + encodedAuthStr).get();\n```", "```java\n<dependency>\n    <groupId>commons-codec</groupId>\n    <artifactId>commons-codec</artifactId>\n    <version>1.11</version>\n</dependency>\n```", "```java\nencodedAuthStr =  new String(org.apache.commons.codec.binary.Base64.encodeBase64(authString.getBytes()));\n```", "```java\n  <dependency>\n   <groupId>javax</groupId>\n   <artifactId>javaee-api</artifactId>\n   <version>8.0</version>\n   <scope>provided</scope>\n  </dependency>\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\nimport javax.annotation.security.DeclareRoles;\nimport javax.enterprise.context.ApplicationScoped;\n@DeclareRoles({\"admin\", \"user\", \"manager\"})\n@ApplicationScoped\npublic class ApplicationConfig {}\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\n\n// skipped imports\n\n@BasicAuthenticationMechanismDefinition()\n@ServletSecurity(@HttpConstraint(rolesAllowed = {\"admin\", \"manager\"} ))\npublic class AdminServlet extends HttpServlet {\n\n private static final long serialVersionUID = 1L;\n\n @Inject\n private SecurityContext securityContext;\n\n public AdminServlet() {\n super();\n }\n\n protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n if (securityContext.isCallerInRole(\"manager\")) {\n request.getRequestDispatcher(\"/ManagementServlet\").forward(request, response);\n } else {\n response.getWriter().append(\"Welcome to Admin Page!\");\n }\n }\n\n protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n doGet(request, response);\n }\n}\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\n// skipped imports\n@BasicAuthenticationMechanismDefinition(realmName=\"basic\")\n@ServletSecurity(@HttpConstraint(rolesAllowed = {\"manager\"} ))\npublic class ManagementServlet extends HttpServlet {\n private static final long serialVersionUID = 1L;\n\n public ManagementServlet() {\n   super();\n }\n\n protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n response.getWriter().append(\"Welcome to Management Page!\");\n }\n\n protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n doGet(request, response);\n }\n}\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\n\n// skipped imports\n\n@ApplicationScoped\npublic class SimpleMapIdentityStore implements IdentityStore {\n class UserInfo {\n   String userName;\n   String password;\n   String role;\n\n   public UserInfo(String userName, String password, String role) {\n     this.userName = userName;\n     this.password = password;\n     this.role = role;\n   }\n }\n\n private HashMap<String, UserInfo> store = new HashMap<>();\n\n public SimpleMapIdentityStore() {\n   UserInfo user1 = new UserInfo(\"user1\", \"user1_pass\", \"admin\");\n   UserInfo user2 = new UserInfo(\"user2\", \"user2_pass\", \"user\");\n   UserInfo user3 = new UserInfo(\"user3\", \"user3_pass\", \"manager\");\n   store.put(user1.userName, user1);\n   store.put(user2.userName, user2);\n   store.put(user3.userName, user3);\n }\n\n public CredentialValidationResult validate(UsernamePasswordCredential usernamePasswordCredential) {\n   String userName = usernamePasswordCredential.getCaller();\n   String password = usernamePasswordCredential.getPasswordAsString(); \n\n   UserInfo userInfo = this.store.get(userName.toLowerCase());\n   if (userInfo == null || !userInfo.password.equals(password)) {\n     return INVALID_RESULT;\n   }\n\n   return new CredentialValidationResult(userInfo.userName, new HashSet<>(asList(userInfo.role)));\n } \n}\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\n\nimport javax.enterprise.context.ApplicationScoped;\nimport javax.security.enterprise.identitystore.DatabaseIdentityStoreDefinition;\nimport javax.security.enterprise.identitystore.PasswordHash;\n\n@DatabaseIdentityStoreDefinition (\n dataSourceLookup = \"jdbc/CourseManagement\",\n callerQuery = \"select password from user_group_view where user_name = ?\",\n groupsQuery = \"select group_name from user_group_view where user_name = ?\",\n hashAlgorithm = PasswordHash.class,\n priority = 10 \n)\n@ApplicationScoped\npublic class ApplicationConfig {\n}\n```", "```java\npackage packt.book.jee.eclipse.ch7.web.servlet;\n// ...\n@FormAuthenticationMechanismDefinition(\n loginToContinue = @LoginToContinue(\n loginPage = \"/loginServlet\",\n errorPage = \"/loginErrorServlet\"\n )\n)\n@DeclareRoles({\"admin\"})\n@ServletSecurity(@HttpConstraint(rolesAllowed = \"admin\"))\npublic class AdminServlet extends HttpServlet {\n ...\n}\n```"]