<html><head></head><body>
<div id="_idContainer016">
<h1 class="chapter-number" id="_idParaDest-81"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-82"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.2.1">API Specifications and Implementation</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In previous chapters, we learned about the design aspects of REST APIs and the Spring fundamentals required to develop RESTful web services. </span><span class="koboSpan" id="kobo.3.2">In this chapter, you’ll make use of these two areas to implement </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">REST APIs.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">We have chosen a design-first approach for implementation to make our development process understandable for non-technical stakeholders as well. </span><span class="koboSpan" id="kobo.5.2">To make this approach possible, we will make use </span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.6.1">of the </span><strong class="bold"><span class="koboSpan" id="kobo.7.1">OpenAPI Specification</span></strong><span class="koboSpan" id="kobo.8.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.9.1">OAS</span></strong><span class="koboSpan" id="kobo.10.1">) to, first, design an API and, later, implement it. </span><span class="koboSpan" id="kobo.10.2">We will also learn how to handle errors that occur while serving the request. </span><span class="koboSpan" id="kobo.10.3">In this chapter, we will use the example of designing and implementing an API of a sample </span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">e-commerce app.</span></span></p>
<p><span class="koboSpan" id="kobo.12.1">By the end of this chapter, you should be able to design the API specifications and make use of the OpenAPI codegen to generate the code for models and API Java interfaces. </span><span class="koboSpan" id="kobo.12.2">You will also know how to write the pseudo-Spring controllers to implement the API Java interfaces and Global Exception Handler for the </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">web service.</span></span></p>
<p><span class="koboSpan" id="kobo.14.1">We’ll cover the following topics as part of </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.16.1">Designing APIs </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">with OAS</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Understanding the basic structure </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">of OAS</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Converting OAS to </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">Spring code</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">Implementing the OAS </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">code interfaces</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">Adding a Global </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">Exception Handler</span></span></li>
<li><span class="koboSpan" id="kobo.26.1">Testing the implementation of </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">the controllers</span></span></li>
</ul>
<h1 id="_idParaDest-83"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.28.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.29.1">You need the following to execute the instructions in this and the </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">following chapters:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.31.1">Any Java IDE, such as NetBeans, IntelliJ, </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">or Eclipse</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.33.1">Java Development Kit</span></strong><span class="koboSpan" id="kobo.34.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.35.1">JDK</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">) 17</span></span></li>
<li><span class="koboSpan" id="kobo.37.1">An internet connection to download the dependencies </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">and Gradle</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.39.1">You can find the code files for this chapter on GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">at </span></span><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03"><span class="No-Break"><span class="koboSpan" id="kobo.41.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.42.1">.</span></span></p>
<h1 id="_idParaDest-84"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.43.1">Designing APIs with OAS</span></h1>
<p><span class="koboSpan" id="kobo.44.1">You can directly </span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.45.1">start coding the </span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.46.1">API; however, this approach leads to many issues, such as frequent modifications, difficulty in API management, and difficulty in reviews specifically led by non-technical </span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.47.1">domain teams. </span><span class="koboSpan" id="kobo.47.2">Therefore, you should use the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.48.1">design-first approach</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">The first question that comes to mind is, how can we design REST APIs? </span><span class="koboSpan" id="kobo.50.2">You learned in </span><a href="B19349_01.xhtml#_idTextAnchor014"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.51.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.52.1">, </span><em class="italic"><span class="koboSpan" id="kobo.53.1">RESTful Web Service Fundamentals</span></em><span class="koboSpan" id="kobo.54.1">, that there is no existing standard to govern REST API implementation. </span><span class="koboSpan" id="kobo.54.2">OAS was introduced to solve at least the aspects of the REST API’s</span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.55.1"> specification and description. </span><span class="koboSpan" id="kobo.55.2">It allows</span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.56.1"> you to write REST APIs in the </span><strong class="bold"><span class="koboSpan" id="kobo.57.1">YAML Ain’t Markup Language</span></strong><span class="koboSpan" id="kobo.58.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.59.1">YAML</span></strong><span class="koboSpan" id="kobo.60.1">) or </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">JavaScript Object Notation</span></strong><span class="koboSpan" id="kobo.62.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.63.1">JSON</span></strong><span class="koboSpan" id="kobo.64.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">markup languages.</span></span></p>
<p><span class="koboSpan" id="kobo.66.1">We’ll use version 3.0 of OAS (</span><a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md"><span class="koboSpan" id="kobo.67.1">https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md</span></a><span class="koboSpan" id="kobo.68.1">) to implement the e-commerce app REST API. </span><span class="koboSpan" id="kobo.68.2">We’ll use YAML (pronounced as </span><em class="italic"><span class="koboSpan" id="kobo.69.1">yamel</span></em><span class="koboSpan" id="kobo.70.1">, rhyming with </span><em class="italic"><span class="koboSpan" id="kobo.71.1">camel</span></em><span class="koboSpan" id="kobo.72.1">), which is cleaner and easier to read. </span><span class="koboSpan" id="kobo.72.2">YAML is also space-sensitive. </span><span class="koboSpan" id="kobo.72.3">It uses space for indentation; for example, it represents the </span><strong class="source-inline"><span class="koboSpan" id="kobo.73.1">key: value</span></strong><span class="koboSpan" id="kobo.74.1"> pair (pay attention to the space after the colon – </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">:</span></strong><span class="koboSpan" id="kobo.76.1">). </span><span class="koboSpan" id="kobo.76.2">You can read more about YAML </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">at </span></span><a href="https://yaml.org/spec/"><span class="No-Break"><span class="koboSpan" id="kobo.78.1">https://yaml.org/spec/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.79.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">OAS was earlier known as the </span><em class="italic"><span class="koboSpan" id="kobo.81.1">Swagger Specification</span></em><span class="koboSpan" id="kobo.82.1">. </span><span class="koboSpan" id="kobo.82.2">Today, OAS-supporting tools are still known</span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.83.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.84.1">Swagger tools</span></strong><span class="koboSpan" id="kobo.85.1">. </span><span class="koboSpan" id="kobo.85.2">Swagger tools are open source projects that help the overall development life cycle of REST APIs. </span><span class="koboSpan" id="kobo.85.3">We’ll make use of the following Swagger tools in </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">this chapter:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.87.1">Swagger Editor</span></strong><span class="koboSpan" id="kobo.88.1"> (</span><a href="https://editor.swagger.io/"><span class="koboSpan" id="kobo.89.1">https://editor.swagger.io/</span></a><span class="koboSpan" id="kobo.90.1">): This tool is used to design and describe the e-commerce </span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.91.1">app REST APIs. </span><span class="koboSpan" id="kobo.91.2">It allows you to write and preview, at the same time, your REST APIs’ design and description. </span><span class="koboSpan" id="kobo.91.3">Make sure that you use OAS 3.0. </span><span class="koboSpan" id="kobo.91.4">Its beta version is available </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">at </span></span><a href="https://editor-next.swagger.io/"><span class="No-Break"><span class="koboSpan" id="kobo.93.1">https://editor-next.swagger.io/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.94.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.95.1">Swagger Codegen</span></strong><span class="koboSpan" id="kobo.96.1"> (</span><a href="https://github.com/swagger-api/swagger-codegen"><span class="koboSpan" id="kobo.97.1">https://github.com/swagger-api/swagger-codegen</span></a><span class="koboSpan" id="kobo.98.1">): This tool is </span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.99.1">used to generate the Spring-based API models and Java interfaces. </span><span class="koboSpan" id="kobo.99.2">You’ll use the Gradle plugin (</span><a href="https://github.com/int128/gradle-swagger-generator-plugin"><span class="koboSpan" id="kobo.100.1">https://github.com/int128/gradle-swagger-generator-plugin</span></a><span class="koboSpan" id="kobo.101.1">) to generate code that works on top of Swagger Codegen. </span><span class="koboSpan" id="kobo.101.2">There is also an OpenAPI tool Gradle plugin – OpenAPI Generator (</span><a href="https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator-gradle-plugin"><span class="koboSpan" id="kobo.102.1">https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator-gradle-plugin</span></a><span class="koboSpan" id="kobo.103.1">). </span><span class="koboSpan" id="kobo.103.2">However, we’ll opt for the former one because of the open issues count, which is 3.2k (there are multiple for Java/Spring as well) at the time </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">of writing.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.105.1">Swagger UI</span></strong><span class="koboSpan" id="kobo.106.1"> (</span><a href="https://swagger.io/swagger-ui/"><span class="koboSpan" id="kobo.107.1">https://swagger.io/swagger-ui/</span></a><span class="koboSpan" id="kobo.108.1">): This tool is</span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.109.1"> used to generate the REST API </span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.110.1">documentation. </span><span class="koboSpan" id="kobo.110.2">The same Gradle plugin will be used to generate the </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">API documentation.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.112.1">Now that you </span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.113.1">have</span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.114.1"> some idea of how the design-first approach can be used to develop APIs using OAS supporting tools, let’s understand the basic structure </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">of OAS.</span></span></p>
<h1 id="_idParaDest-85"><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.116.1">Understanding the basic structure of OAS</span></h1>
<p><span class="koboSpan" id="kobo.117.1">The OpenAPI </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.118.1">definition structure can be divided into the following sections (all are keywords </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">and case-sensitive):</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.120.1">openapi (version)</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">info</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.122.1">externalDocs</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">servers</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">tags</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">paths</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">components</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.127.1">All the preceding terms are part of </span><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">root</span></strong><span class="koboSpan" id="kobo.129.1">. </span><span class="koboSpan" id="kobo.129.2">The first three sections (</span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">openapi</span></strong><span class="koboSpan" id="kobo.131.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.132.1">info</span></strong><span class="koboSpan" id="kobo.133.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">externalDocs</span></strong><span class="koboSpan" id="kobo.135.1">) are used to define the metadata of </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">the API.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">You can place an API’s definition either in a single file or divided into multiple files. </span><span class="koboSpan" id="kobo.137.2">OAS supports both. </span><span class="koboSpan" id="kobo.137.3">We’ll use a single file to define the sample </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">e-commerce API.</span></span></p>
<p><span class="koboSpan" id="kobo.139.1">Instead of discussing all the sections theoretically and then writing the e-commerce API definitions, we’ll </span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.140.1">do both together. </span><span class="koboSpan" id="kobo.140.2">First, we’ll cover each section definition of the e-commerce API, and then we’ll discuss why we have used it and what </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">it implies.</span></span></p>
<h2 id="_idParaDest-86"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.142.1">The metadata sections of OAS</span></h2>
<p><span class="koboSpan" id="kobo.143.1">Let’s have a look</span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.144.1"> at the metadata sections of the e-commerce </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">API definitions:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.146.1">openapi</span></strong><span class="koboSpan" id="kobo.147.1">: 3.0.3</span><strong class="bold"><span class="koboSpan" id="kobo.148.1">info</span></strong><span class="koboSpan" id="kobo.149.1">:
  </span><strong class="bold"><span class="koboSpan" id="kobo.150.1">title</span></strong><span class="koboSpan" id="kobo.151.1">: Sample Ecommerce App
  </span><strong class="bold"><span class="koboSpan" id="kobo.152.1">description</span></strong><span class="koboSpan" id="kobo.153.1">: &gt;
    'This is a ***sample ecommerce app API***.
</span><span class="koboSpan" id="kobo.153.2">     You can find
    out more about Swagger at [swagger.io]
      (http://swagger.io).
</span><span class="koboSpan" id="kobo.153.3">    Description supports markdown markup. </span><span class="koboSpan" id="kobo.153.4">For example,
      you can
    use the `inline code` using back ticks.'
</span><span class="koboSpan" id="kobo.153.5">  </span><strong class="bold"><span class="koboSpan" id="kobo.154.1">termsOfService</span></strong><span class="koboSpan" id="kobo.155.1">: https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-SpringBoot-3/blob/main/LICENSE
  </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">contact</span></strong><span class="koboSpan" id="kobo.157.1">:
    </span><strong class="bold"><span class="koboSpan" id="kobo.158.1">name</span></strong><span class="koboSpan" id="kobo.159.1">: Packt Support
    </span><strong class="bold"><span class="koboSpan" id="kobo.160.1">url</span></strong><span class="koboSpan" id="kobo.161.1">: https://www.packt.com
    </span><strong class="bold"><span class="koboSpan" id="kobo.162.1">email</span></strong><span class="koboSpan" id="kobo.163.1">: support@packtpub.com
  </span><strong class="bold"><span class="koboSpan" id="kobo.164.1">license</span></strong><span class="koboSpan" id="kobo.165.1">:
    </span><strong class="bold"><span class="koboSpan" id="kobo.166.1">name</span></strong><span class="koboSpan" id="kobo.167.1">: MIT
    </span><strong class="bold"><span class="koboSpan" id="kobo.168.1">url</span></strong><span class="koboSpan" id="kobo.169.1">: https://github.com/PacktPublishing/Modern-API-
         Development-with-Spring-6-and-Spring-Boot3/blob
         /main/LICENSE
  </span><strong class="bold"><span class="koboSpan" id="kobo.170.1">version</span></strong><span class="koboSpan" id="kobo.171.1">: 1.0.0
</span><strong class="bold"><span class="koboSpan" id="kobo.172.1">externalDocs</span></strong><span class="koboSpan" id="kobo.173.1">:
  </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">description</span></strong><span class="koboSpan" id="kobo.175.1">: Any document link you want to generate along
               with API.
</span><span class="koboSpan" id="kobo.175.2">  </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">url</span></strong><span class="koboSpan" id="kobo.177.1">: http://swagger.io</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.178.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a></p>
<p><span class="koboSpan" id="kobo.179.1">Now, let us</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.180.1"> discuss each code section </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">in detail:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">openapi</span></strong><span class="koboSpan" id="kobo.183.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">openapi</span></strong><span class="koboSpan" id="kobo.185.1"> section tells us which OAS is used to write the API’s definition. </span><span class="koboSpan" id="kobo.185.2">OpenAPI uses semantic </span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.186.1">versioning (</span><a href="https://semver.org/"><span class="koboSpan" id="kobo.187.1">https://semver.org/</span></a><span class="koboSpan" id="kobo.188.1">), which means the version will be in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">major:minor:patch</span></strong><span class="koboSpan" id="kobo.190.1"> form. </span><span class="koboSpan" id="kobo.190.2">If you look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">openapi</span></strong><span class="koboSpan" id="kobo.192.1"> metadata value, we use </span><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">3.0.3</span></strong><span class="koboSpan" id="kobo.194.1">. </span><span class="koboSpan" id="kobo.194.2">This reveals that we use major version </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">3</span></strong><span class="koboSpan" id="kobo.196.1"> with patch </span><strong class="source-inline"><span class="koboSpan" id="kobo.197.1">3</span></strong><span class="koboSpan" id="kobo.198.1"> (the minor version </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">0</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">).</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">info</span></strong><span class="koboSpan" id="kobo.203.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">info</span></strong><span class="koboSpan" id="kobo.205.1"> section contains the metadata about the API. </span><span class="koboSpan" id="kobo.205.2">This information is used to generate documentation and can be used by the client. </span><span class="koboSpan" id="kobo.205.3">It contains the following fields, out of which only </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">title</span></strong><span class="koboSpan" id="kobo.207.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">version</span></strong><span class="koboSpan" id="kobo.209.1"> are mandatory fields, with the others </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">being optional:</span></span><ul><li><strong class="source-inline"><span class="koboSpan" id="kobo.211.1">title</span></strong><span class="koboSpan" id="kobo.212.1">: The title of </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">the API.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">description</span></strong><span class="koboSpan" id="kobo.215.1">: This is used to describe the API details. </span><span class="koboSpan" id="kobo.215.2">As you can see, we can use Markdown (</span><a href="https://spec.commonmark.org/"><span class="koboSpan" id="kobo.216.1">https://spec.commonmark.org/</span></a><span class="koboSpan" id="kobo.217.1">) here. </span><span class="koboSpan" id="kobo.217.2">An </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">&gt;</span></strong><span class="koboSpan" id="kobo.219.1"> (angular bracket) symbol</span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.220.1"> is used to add </span><span class="No-Break"><span class="koboSpan" id="kobo.221.1">multi-line values.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">termsOfService</span></strong><span class="koboSpan" id="kobo.223.1">: This is a URL that links to the terms of services. </span><span class="koboSpan" id="kobo.223.2">Make sure that it follows the proper </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">URL format.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">contact</span></strong><span class="koboSpan" id="kobo.226.1">: This is the contact information of the API provider. </span><span class="koboSpan" id="kobo.226.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">email</span></strong><span class="koboSpan" id="kobo.228.1"> attribute should be the email address of the contact person/organization. </span><span class="koboSpan" id="kobo.228.2">Other attributes are </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">name</span></strong><span class="koboSpan" id="kobo.230.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">url</span></strong><span class="koboSpan" id="kobo.232.1">. </span><span class="koboSpan" id="kobo.232.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">name</span></strong><span class="koboSpan" id="kobo.234.1"> attribute represents the name of the contact person or organization. </span><span class="koboSpan" id="kobo.234.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">url</span></strong><span class="koboSpan" id="kobo.236.1"> attribute provides the link to the contact</span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.237.1"> page. </span><span class="koboSpan" id="kobo.237.2">This is an optional field, and all attributes are </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">also optional.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">license</span></strong><span class="koboSpan" id="kobo.240.1">: This is the license information. </span><span class="koboSpan" id="kobo.240.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">name</span></strong><span class="koboSpan" id="kobo.242.1"> attribute is a required field that represents the correct license name, such as MIT. </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">url</span></strong><span class="koboSpan" id="kobo.244.1"> is optional and provides a link to the </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">license document.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">version</span></strong><span class="koboSpan" id="kobo.247.1">: This exposes the API version in the </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">string format.</span></span></li></ul></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">externalDocs</span></strong><span class="koboSpan" id="kobo.250.1">: This is an optional field that points to extended documentation of the exposed API. </span><span class="koboSpan" id="kobo.250.2">It has two attributes – </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">description</span></strong><span class="koboSpan" id="kobo.252.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">url</span></strong><span class="koboSpan" id="kobo.254.1">. </span><span class="koboSpan" id="kobo.254.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">description</span></strong><span class="koboSpan" id="kobo.256.1"> attribute is an optional field that defines a summary of the external documentation. </span><span class="koboSpan" id="kobo.256.2">You can use the Markdown syntax for the description. </span><span class="koboSpan" id="kobo.256.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">url</span></strong><span class="koboSpan" id="kobo.258.1"> attribute is </span><em class="italic"><span class="koboSpan" id="kobo.259.1">mandatory</span></em><span class="koboSpan" id="kobo.260.1"> and links to </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">external documentation.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.262.1">Let’s continue building our API definition. </span><span class="koboSpan" id="kobo.262.2">We have completed the metadata section, so let’s discuss the servers and </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">tags sections.</span></span></p>
<h2 id="_idParaDest-87"><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.264.1">The servers and tags sections of OAS</span></h2>
<p><span class="koboSpan" id="kobo.265.1">After the metadata</span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.266.1"> section, we can now describe the </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">servers</span></strong><span class="koboSpan" id="kobo.268.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">tags</span></strong><span class="koboSpan" id="kobo.270.1"> sections. </span><span class="koboSpan" id="kobo.270.2">Let’s have a look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">following code:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.272.1">servers</span></strong><span class="koboSpan" id="kobo.273.1">:  - url: https://ecommerce.swagger.io/v2
</span><strong class="bold"><span class="koboSpan" id="kobo.274.1">tags</span></strong><span class="koboSpan" id="kobo.275.1">:
  - </span><strong class="bold"><span class="koboSpan" id="kobo.276.1">name</span></strong><span class="koboSpan" id="kobo.277.1">: cart
    </span><strong class="bold"><span class="koboSpan" id="kobo.278.1">description</span></strong><span class="koboSpan" id="kobo.279.1">: Everything about cart
    </span><strong class="bold"><span class="koboSpan" id="kobo.280.1">externalDocs</span></strong><span class="koboSpan" id="kobo.281.1">:
      description: Find out more (extra document link)
      url: http://swagger.io
  - name: order
    description: Operation about orders</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.282.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a></p>
<p><span class="koboSpan" id="kobo.283.1">Now, let us discuss each code section </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">in detail:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">servers</span></strong><span class="koboSpan" id="kobo.286.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">servers</span></strong><span class="koboSpan" id="kobo.288.1"> section is an optional section that contains a list of servers that host the API. </span><span class="koboSpan" id="kobo.288.2">If the hosted API document is interactive, then it can be used by Swagger UI to directly call the API and show the response. </span><span class="koboSpan" id="kobo.288.3">If it is not provided, then it points to the root (</span><strong class="source-inline"><span class="koboSpan" id="kobo.289.1">/</span></strong><span class="koboSpan" id="kobo.290.1">) of the hosted document server. </span><span class="koboSpan" id="kobo.290.2">Server URLs are shown using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">url</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.292.1"> attribute.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">tags</span></strong><span class="koboSpan" id="kobo.294.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">tags</span></strong><span class="koboSpan" id="kobo.296.1"> section, defined at the root level, contains the collection of tags and their metadata. </span><span class="koboSpan" id="kobo.296.2">Tags are used to group the operations performed on the resources. </span><span class="koboSpan" id="kobo.296.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.297.1">tags</span></strong><span class="koboSpan" id="kobo.298.1"> metadata contains </span><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">name</span></strong><span class="koboSpan" id="kobo.300.1">, which is a mandatory field, and two additional optional attributes: </span><strong class="source-inline"><span class="koboSpan" id="kobo.301.1">description</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.302.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">externalDocs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.305.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">name</span></strong><span class="koboSpan" id="kobo.307.1"> attribute contains the tag name. </span><span class="koboSpan" id="kobo.307.2">We have already discussed the description and </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">externalDocs</span></strong><span class="koboSpan" id="kobo.309.1"> fields in the previous section </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">on metadata.</span></span></p>
<p><span class="koboSpan" id="kobo.311.1">Let’s discuss the last two sections </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">of OAS.</span></span></p>
<h2 id="_idParaDest-88"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.313.1">The components section of OAS</span></h2>
<p><span class="koboSpan" id="kobo.314.1">If we were going </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.315.1">through the structure sequentially, we would have discussed </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">path</span></strong><span class="koboSpan" id="kobo.317.1"> first. </span><span class="koboSpan" id="kobo.317.2">However, conceptually, we want to write our models first before we use them in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">path</span></strong><span class="koboSpan" id="kobo.319.1"> section. </span><span class="koboSpan" id="kobo.319.2">Therefore, we’ll discuss the </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">components</span></strong><span class="koboSpan" id="kobo.321.1"> section first, which is used to define </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">the models.</span></span></p>
<p><span class="koboSpan" id="kobo.323.1">Here is a code snippet from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">components</span></strong><span class="koboSpan" id="kobo.325.1"> section of the sample </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">e-commerce app:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.327.1">components</span></strong><span class="koboSpan" id="kobo.328.1">:  </span><strong class="bold"><span class="koboSpan" id="kobo.329.1">schemas</span></strong><span class="koboSpan" id="kobo.330.1">:
    Cart:
      </span><strong class="bold"><span class="koboSpan" id="kobo.331.1">description</span></strong><span class="koboSpan" id="kobo.332.1">: Shopping Cart of the user
      </span><strong class="bold"><span class="koboSpan" id="kobo.333.1">type</span></strong><span class="koboSpan" id="kobo.334.1">: </span><strong class="bold"><span class="koboSpan" id="kobo.335.1">object</span></strong><span class="koboSpan" id="kobo.336.1">
      properties:
        customerId:
          description: Id of the customer who possesses
          the cart
          type: </span><strong class="bold"><span class="koboSpan" id="kobo.337.1">string</span></strong><span class="koboSpan" id="kobo.338.1">
        items:
          description: Collection of items in cart.
</span><span class="koboSpan" id="kobo.338.2">          type: </span><strong class="bold"><span class="koboSpan" id="kobo.339.1">array</span></strong><span class="koboSpan" id="kobo.340.1">
          </span><strong class="bold"><span class="koboSpan" id="kobo.341.1">items</span></strong><span class="koboSpan" id="kobo.342.1">:
            </span><strong class="bold"><span class="koboSpan" id="kobo.343.1">$ref</span></strong><span class="koboSpan" id="kobo.344.1">: '</span><strong class="bold"><span class="koboSpan" id="kobo.345.1">#/components/schemas/Item</span></strong><span class="koboSpan" id="kobo.346.1">'</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.347.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a></p>
<p><span class="koboSpan" id="kobo.348.1">If you are working with YAML for the first time, you may find it a bit uncomfortable. </span><span class="koboSpan" id="kobo.348.2">However, once you go through this section, you’ll feel more comfortable </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">with YAML.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">Here, we define a model called </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">Cart</span></strong><span class="koboSpan" id="kobo.352.1">. </span><span class="koboSpan" id="kobo.352.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.353.1">Cart</span></strong><span class="koboSpan" id="kobo.354.1"> model is of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.355.1">object</span></strong><span class="koboSpan" id="kobo.356.1"> type and contains two fields, namely </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">customerId</span></strong><span class="koboSpan" id="kobo.358.1"> (a string) and </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">items</span></strong><span class="koboSpan" id="kobo.360.1"> (</span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">an array).</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.362.1">The object data type</span></p>
<p class="callout"><span class="koboSpan" id="kobo.363.1">You can define any model or field as an object. </span><span class="koboSpan" id="kobo.363.2">Once you mark a type as </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">object</span></strong><span class="koboSpan" id="kobo.365.1">, the next attribute is </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">properties</span></strong><span class="koboSpan" id="kobo.367.1">, which consists of all the object’s fields. </span><span class="koboSpan" id="kobo.367.2">For example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">Cart</span></strong><span class="koboSpan" id="kobo.369.1"> model in the previous code will have the </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">following syntax:</span></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">type: object</span></strong></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">properties:</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">    &lt;</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">field name&gt;:</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">        type: &lt;</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">data type&gt;</span></strong></span></p>
<p><span class="koboSpan" id="kobo.377.1">OAS supports six </span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.378.1">basic data types, which are as follows (all are </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">in lowercase):</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">string</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">number</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">integer</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">boolean</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">object</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">array</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.386.1">Let’s discuss the </span><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">Cart</span></strong><span class="koboSpan" id="kobo.388.1"> model, in which we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">string</span></strong><span class="koboSpan" id="kobo.390.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">object</span></strong><span class="koboSpan" id="kobo.392.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">array</span></strong><span class="koboSpan" id="kobo.394.1"> data types. </span><span class="koboSpan" id="kobo.394.2">Other data types are </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">number</span></strong><span class="koboSpan" id="kobo.396.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">integer</span></strong><span class="koboSpan" id="kobo.398.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">boolean</span></strong><span class="koboSpan" id="kobo.400.1">. </span><span class="koboSpan" id="kobo.400.2">Now, you may be wondering how to define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">date</span></strong><span class="koboSpan" id="kobo.402.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">time</span></strong><span class="koboSpan" id="kobo.404.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">float</span></strong><span class="koboSpan" id="kobo.406.1"> types, and so on. </span><span class="koboSpan" id="kobo.406.2">You can do that with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">format</span></strong><span class="koboSpan" id="kobo.408.1"> attribute, which you can use along with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">object</span></strong><span class="koboSpan" id="kobo.410.1"> type. </span><span class="koboSpan" id="kobo.410.2">For example, take a look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.412.1">
orderDate:  type: string
  format: date-time</span></pre>
<p><span class="koboSpan" id="kobo.413.1">In the previous code, </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">orderDate</span></strong><span class="koboSpan" id="kobo.415.1"> is defined with </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">type string</span></strong><span class="koboSpan" id="kobo.417.1">, but </span><strong class="source-inline"><span class="koboSpan" id="kobo.418.1">format</span></strong><span class="koboSpan" id="kobo.419.1"> determines what string value it will contain. </span><span class="koboSpan" id="kobo.419.2">Since </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">format</span></strong><span class="koboSpan" id="kobo.421.1"> is marked with </span><strong class="source-inline"><span class="koboSpan" id="kobo.422.1">date-time</span></strong><span class="koboSpan" id="kobo.423.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">orderDate</span></strong><span class="koboSpan" id="kobo.425.1"> field will contain the date and time in the format defined in </span><em class="italic"><span class="koboSpan" id="kobo.426.1">RFC 3339</span></em><span class="koboSpan" id="kobo.427.1">, </span><em class="italic"><span class="koboSpan" id="kobo.428.1">section 5.6</span></em><span class="koboSpan" id="kobo.429.1"> (https://tools.ietf.org/html/rfc3339#section-5.6) – for </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">example, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.431.1">2020-10-22T19:31:58Z</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.433.1">There are some other common formats you can use along with types, </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">as follows:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">type: number</span></strong><span class="koboSpan" id="kobo.436.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.437.1">format: float</span></strong><span class="koboSpan" id="kobo.438.1">: This will contain the </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">floating-point number</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">type: number</span></strong><span class="koboSpan" id="kobo.441.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">format: double</span></strong><span class="koboSpan" id="kobo.443.1">: This will contain the floating-point number with </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">double precision</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">type: integer</span></strong><span class="koboSpan" id="kobo.446.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">format: int32</span></strong><span class="koboSpan" id="kobo.448.1">: This will contain the </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">int</span></strong><span class="koboSpan" id="kobo.450.1"> type (signed </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">32-bit</span></span><span class="No-Break"><a id="_idIndexMarker175"/></span><span class="No-Break"><span class="koboSpan" id="kobo.452.1"> integer)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">type: integer</span></strong><span class="koboSpan" id="kobo.454.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.455.1">format: int64</span></strong><span class="koboSpan" id="kobo.456.1">: This will contain the long type (signed </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">64-bit integer)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">type: string</span></strong><span class="koboSpan" id="kobo.459.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">format: date</span></strong><span class="koboSpan" id="kobo.461.1">: This will contain the date as per </span><em class="italic"><span class="koboSpan" id="kobo.462.1">RFC 3339</span></em><span class="koboSpan" id="kobo.463.1"> – for </span><span class="No-Break"><span class="koboSpan" id="kobo.464.1">example, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">2020-10-22</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">type: string</span></strong><span class="koboSpan" id="kobo.467.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.468.1">format: byte</span></strong><span class="koboSpan" id="kobo.469.1">: This will contain the </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">Base64-encoded values</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">type: string</span></strong><span class="koboSpan" id="kobo.472.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">format: binary</span></strong><span class="koboSpan" id="kobo.474.1">: This will contain the binary data (and can be used </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">for files)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.476.1">Our </span><strong class="source-inline"><span class="koboSpan" id="kobo.477.1">Cart</span></strong><span class="koboSpan" id="kobo.478.1"> model’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.479.1">items</span></strong><span class="koboSpan" id="kobo.480.1"> field is an array of the user-defined </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">Item</span></strong><span class="koboSpan" id="kobo.482.1"> type. </span><span class="koboSpan" id="kobo.482.2">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">Item</span></strong><span class="koboSpan" id="kobo.484.1"> is another model and referenced using </span><strong class="source-inline"><span class="koboSpan" id="kobo.485.1">$ref</span></strong><span class="koboSpan" id="kobo.486.1">. </span><span class="koboSpan" id="kobo.486.2">In fact, all user-defined types are referenced using </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">$ref</span></strong><span class="koboSpan" id="kobo.488.1">. </span><span class="koboSpan" id="kobo.488.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">Item</span></strong><span class="koboSpan" id="kobo.490.1"> model is also part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">components</span></strong><span class="koboSpan" id="kobo.492.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">schema</span></strong><span class="koboSpan" id="kobo.494.1"> section. </span><span class="koboSpan" id="kobo.494.2">Therefore, the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">$ref</span></strong><span class="koboSpan" id="kobo.496.1"> contains an anchor for user-defined types with </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">#/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">component/ schemas/{type}</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">$ref</span></strong><span class="koboSpan" id="kobo.501.1"> represents the reference object. </span><span class="koboSpan" id="kobo.501.2">It is based on the JSON reference (</span><a href="https://tools.ietf.org/html/draft-pbryan-zyp-json-ref-03"><span class="koboSpan" id="kobo.502.1">https://tools.ietf.org/html/draft-pbryan-zyp-json-ref-03</span></a><span class="koboSpan" id="kobo.503.1">) and follows the same semantics in YAML. </span><span class="koboSpan" id="kobo.503.2">It can refer to an object in the same document or external documents. </span><span class="koboSpan" id="kobo.503.3">Therefore, it is used when you have API definitions divided into multiple files. </span><span class="koboSpan" id="kobo.503.4">You have already seen one example of its usage in the previous code. </span><span class="koboSpan" id="kobo.503.5">Let’s see one </span><span class="No-Break"><span class="koboSpan" id="kobo.504.1">more example:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.505.1">
# Relative Schema Document$ref: Cart.yaml
# Relative Document with embedded Schema
$ref: definitions.yaml#/Cart</span></pre>
<p><span class="koboSpan" id="kobo.506.1">There is another caveat to the previous code. </span><span class="koboSpan" id="kobo.506.2">If you look closely, you will find two </span><em class="italic"><span class="koboSpan" id="kobo.507.1">items</span></em><span class="koboSpan" id="kobo.508.1"> – one is a property of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">Cart</span></strong><span class="koboSpan" id="kobo.510.1"> object type and another one is an attribute of the array type. </span><span class="koboSpan" id="kobo.510.2">The</span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.511.1"> former one is simple – a field of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">Cart</span></strong><span class="koboSpan" id="kobo.513.1"> object. </span><span class="koboSpan" id="kobo.513.2">However, the latter belongs to </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">array</span></strong><span class="koboSpan" id="kobo.515.1"> and is a part of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">array</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.517.1"> syntax.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.518.1">Array syntax</span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">type: array</span></strong></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">items:</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">    type: &lt;type </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">of object&gt;</span></strong></span></p>
<p class="callout"><span class="koboSpan" id="kobo.523.1">  i. </span><span class="koboSpan" id="kobo.523.2">You could have a nested array if you placed the type of object </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">array</span></strong></span></p>
<p class="callout"><span class="koboSpan" id="kobo.526.1">  ii. </span><span class="koboSpan" id="kobo.526.2">You can also refer to the user-defined type using </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">$ref</span></strong><span class="koboSpan" id="kobo.528.1">, as shown in </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">the code</span></span><span class="koboSpan" id="kobo.530.1">   (then, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">type</span></strong><span class="koboSpan" id="kobo.532.1"> attribute is not required </span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">for </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">items</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">)</span></span></p>
<p><span class="koboSpan" id="kobo.536.1">Let’s see what the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">Item</span></strong><span class="koboSpan" id="kobo.538.1"> model </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">looks like:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.540.1">Item</span></strong><span class="koboSpan" id="kobo.541.1">:  description: Items in shopping cart
  type: object
  properties:
    id:
      description: Item Identifier
      type: string
    quantity:
      description: The item quantity
      type: integer
      format: int32
    unitPrice:
      description: The item's price per unit
      type: number
      format: double</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.542.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a></p>
<p><span class="koboSpan" id="kobo.543.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">Item</span></strong><span class="koboSpan" id="kobo.545.1"> model is</span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.546.1"> also part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">components</span></strong><span class="koboSpan" id="kobo.548.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">schema</span></strong><span class="koboSpan" id="kobo.550.1"> section. </span><span class="koboSpan" id="kobo.550.2">We have defined several models used by the e-commerce app API. </span><span class="koboSpan" id="kobo.550.3">You can find them in the GitHub code </span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">at </span></span><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-and-Spring-Boot/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.552.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-and-Spring-Boot/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.553.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.554.1">Now, you have learned how you can define models under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">components</span></strong><span class="koboSpan" id="kobo.556.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.557.1">schema</span></strong><span class="koboSpan" id="kobo.558.1"> section. </span><span class="koboSpan" id="kobo.558.2">We’ll now discuss how to define an API’s endpoints in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.559.1">path</span></strong><span class="koboSpan" id="kobo.560.1"> section </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">of OAS.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.562.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.563.1">Like </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">schemas</span></strong><span class="koboSpan" id="kobo.565.1">, you can also define </span><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">requestBodies</span></strong><span class="koboSpan" id="kobo.567.1"> (the request payload) and </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">responses</span></strong><span class="koboSpan" id="kobo.569.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">components</span></strong><span class="koboSpan" id="kobo.571.1"> section. </span><span class="koboSpan" id="kobo.571.2">This is useful when you have common request bodies </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">and responses.</span></span></p>
<h2 id="_idParaDest-89"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.573.1">The path section of OAS</span></h2>
<p><span class="koboSpan" id="kobo.574.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">path</span></strong><span class="koboSpan" id="kobo.576.1"> section is the</span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.577.1"> last section of OAS (sequence-wise, it is second-to-last, but we already discussed </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">components</span></strong><span class="koboSpan" id="kobo.579.1"> in the previous subsection), where we define the endpoints. </span><span class="koboSpan" id="kobo.579.2">This is the place where we form the URI and attach the </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">HTTP methods.</span></span></p>
<p><span class="koboSpan" id="kobo.581.1">Let’s write the definition for </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">GET /api/v1/carts/{customerId}/items</span></strong><span class="koboSpan" id="kobo.583.1">. </span><span class="koboSpan" id="kobo.583.2">This API gets the items of the cart associated with a given </span><span class="No-Break"><span class="koboSpan" id="kobo.584.1">customer identifier:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.585.1">paths</span></strong><span class="koboSpan" id="kobo.586.1">:  </span><strong class="bold"><span class="koboSpan" id="kobo.587.1">/api/v1/carts/{customerId}</span></strong><span class="koboSpan" id="kobo.588.1">:
    </span><strong class="bold"><span class="koboSpan" id="kobo.589.1">get</span></strong><span class="koboSpan" id="kobo.590.1">:
      </span><strong class="bold"><span class="koboSpan" id="kobo.591.1">tags</span></strong><span class="koboSpan" id="kobo.592.1">:
        - cart
      </span><strong class="bold"><span class="koboSpan" id="kobo.593.1">summary</span></strong><span class="koboSpan" id="kobo.594.1">: Returns the shopping cart
      </span><strong class="bold"><span class="koboSpan" id="kobo.595.1">description</span></strong><span class="koboSpan" id="kobo.596.1">: Returns the shopping cart of
      given customer
      </span><strong class="bold"><span class="koboSpan" id="kobo.597.1">operationId</span></strong><span class="koboSpan" id="kobo.598.1">: getCartByCustomerId
      </span><strong class="bold"><span class="koboSpan" id="kobo.599.1">parameters</span></strong><span class="koboSpan" id="kobo.600.1">:
        - name: customerId
          in: path
          description: Customer Identifier
          required: true
          schema:
            type: string
      </span><strong class="bold"><span class="koboSpan" id="kobo.601.1">responses</span></strong><span class="koboSpan" id="kobo.602.1">:
        200:
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Cart'
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Cart'
        404:
          description: Given customer ID doesn't exist
          content: {}</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.603.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></span></a></p>
<p><span class="koboSpan" id="kobo.604.1">If you just go through the previous code, you can see what the endpoint is, what HTTP method and </span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.605.1">parameter this API uses, and most importantly, what response you can expect. </span><span class="koboSpan" id="kobo.605.2">Let’s discuss this in more detail. </span><span class="koboSpan" id="kobo.605.3">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.606.1">v1</span></strong><span class="koboSpan" id="kobo.607.1"> represents the version of the API. </span><span class="koboSpan" id="kobo.607.2">Each endpoint path (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">/api/v1/carts/{customerId}/items</span></strong><span class="koboSpan" id="kobo.609.1">) has an HTTP method (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">POST</span></strong><span class="koboSpan" id="kobo.611.1">) associated with it. </span><span class="koboSpan" id="kobo.611.2">The endpoint path always starts </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.615.1">Each method can then have seven fields – </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">tags</span></strong><span class="koboSpan" id="kobo.617.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.618.1">summary</span></strong><span class="koboSpan" id="kobo.619.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">description</span></strong><span class="koboSpan" id="kobo.621.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">operationId</span></strong><span class="koboSpan" id="kobo.623.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">parameters</span></strong><span class="koboSpan" id="kobo.625.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">responses</span></strong><span class="koboSpan" id="kobo.627.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.628.1">requestBody</span></strong><span class="koboSpan" id="kobo.629.1">. </span><span class="koboSpan" id="kobo.629.2">Let us learn about each </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">of them:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">tags</span></strong><span class="koboSpan" id="kobo.632.1">: Tags are used to group APIs, as shown in the following screenshot for APIs tagged with </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">cart</span></strong><span class="koboSpan" id="kobo.634.1">. </span><strong class="bold"><span class="koboSpan" id="kobo.635.1">Swagger Codegen</span></strong><span class="koboSpan" id="kobo.636.1"> makes use of tags to put an API’s method in the same class. </span><span class="koboSpan" id="kobo.636.2">For example, all the listed </span><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">cart</span></strong><span class="koboSpan" id="kobo.638.1"> endpoints in the following screenshot will be </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">CartsApi.java</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer014">
<span class="koboSpan" id="kobo.642.1"><img alt="Figure 3.1 – Cart APIs" src="image/Figure_03.1_B19349.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.643.1">Figure 3.1 – Cart APIs</span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">summary</span></strong><span class="koboSpan" id="kobo.645.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.646.1">description</span></strong><span class="koboSpan" id="kobo.647.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">summary</span></strong><span class="koboSpan" id="kobo.649.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">description</span></strong><span class="koboSpan" id="kobo.651.1"> sections are the same as we ones we discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.652.1">The metadata sections of OAS</span></em><span class="koboSpan" id="kobo.653.1"> section. </span><span class="koboSpan" id="kobo.653.2">They</span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.654.1"> contain the given API’s operation summary and detailed description, respectively. </span><span class="koboSpan" id="kobo.654.2">As usual, you can use Markdown in the description field, as it refers to the </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">same schema.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">operationId</span></strong><span class="koboSpan" id="kobo.657.1">: This represents the name of the operation. </span><span class="koboSpan" id="kobo.657.2">As you can see in the previous code, we have assigned the </span><strong class="source-inline"><span class="koboSpan" id="kobo.658.1">getCartByCustomerId</span></strong><span class="koboSpan" id="kobo.659.1"> value to it. </span><span class="koboSpan" id="kobo.659.2">This same operation name will be used by Swagger Codegen as a method name in the generated API </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">Java interface.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">Parameters</span></strong><span class="koboSpan" id="kobo.662.1">: If you look closely, you’ll find </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">-</span></strong><span class="koboSpan" id="kobo.664.1"> (a hyphen) in front of the name field. </span><span class="koboSpan" id="kobo.664.2">This is used to declare it as an array element. </span><span class="koboSpan" id="kobo.664.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">parameters</span></strong><span class="koboSpan" id="kobo.666.1"> field can contain multiple parameters – in fact, a combination of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.667.1">path</span></strong><span class="koboSpan" id="kobo.668.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">query</span></strong><span class="koboSpan" id="kobo.670.1"> parameters; therefore, it is declared as </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">an array.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.672.1">For </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">path</span></strong><span class="koboSpan" id="kobo.674.1"> parameters, you need to make sure that the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.675.1">name</span></strong><span class="koboSpan" id="kobo.676.1">, under </span><strong class="source-inline"><span class="koboSpan" id="kobo.677.1">parameters</span></strong><span class="koboSpan" id="kobo.678.1">, is the same as given in </span><strong class="source-inline"><span class="koboSpan" id="kobo.679.1">path</span></strong><span class="koboSpan" id="kobo.680.1"> inside </span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">curly braces.</span></span></p>
<p><span class="koboSpan" id="kobo.682.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.683.1">parameters</span></strong><span class="koboSpan" id="kobo.684.1"> field contains the API </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">query</span></strong><span class="koboSpan" id="kobo.686.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">path</span></strong><span class="koboSpan" id="kobo.688.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">header</span></strong><span class="koboSpan" id="kobo.690.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.691.1">cookie</span></strong><span class="koboSpan" id="kobo.692.1"> parameters. </span><span class="koboSpan" id="kobo.692.2">In the previous code, we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.693.1">path</span></strong><span class="koboSpan" id="kobo.694.1"> parameter (the value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.695.1">in</span></strong><span class="koboSpan" id="kobo.696.1"> field). </span><span class="koboSpan" id="kobo.696.2">You can change the value to </span><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">query</span></strong><span class="koboSpan" id="kobo.698.1"> if you want to declare it as a </span><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">query</span></strong><span class="koboSpan" id="kobo.700.1"> parameter and so on for other </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">parameter types.</span></span></p>
<p><span class="koboSpan" id="kobo.702.1">You can mark a field as required or optional using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.703.1">required</span></strong><span class="koboSpan" id="kobo.704.1"> field inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.705.1">parameters</span></strong><span class="koboSpan" id="kobo.706.1"> section, which is a </span><span class="No-Break"><span class="koboSpan" id="kobo.707.1">Boolean parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.708.1">Finally, you must declare the data type of the parameter, which is where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">schema</span></strong><span class="koboSpan" id="kobo.710.1"> field </span><span class="No-Break"><span class="koboSpan" id="kobo.711.1">is used.</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">responses</span></strong><span class="koboSpan" id="kobo.713.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.714.1">responses</span></strong><span class="koboSpan" id="kobo.715.1"> field is a required field for all API operations. </span><span class="koboSpan" id="kobo.715.2">This defines the type of responses that can be sent by the API operation when requested. </span><span class="koboSpan" id="kobo.715.3">It</span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.716.1"> contains HTTP status codes as the default field. </span><span class="koboSpan" id="kobo.716.2">The field must have at least one response, which can be a </span><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">default</span></strong><span class="koboSpan" id="kobo.718.1"> response or any successful HTTP status code, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">200</span></strong><span class="koboSpan" id="kobo.720.1">. </span><span class="koboSpan" id="kobo.720.2">As the name suggests, the default response will be used when no other response is defined or available in the </span><span class="No-Break"><span class="koboSpan" id="kobo.721.1">API operation.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.722.1">The response type (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.723.1">200</span></strong><span class="koboSpan" id="kobo.724.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.725.1">default</span></strong><span class="koboSpan" id="kobo.726.1">) field contains three types of fields – </span><strong class="source-inline"><span class="koboSpan" id="kobo.727.1">description</span></strong><span class="koboSpan" id="kobo.728.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.729.1">content</span></strong><span class="koboSpan" id="kobo.730.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">headers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.734.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.735.1">description</span></strong><span class="koboSpan" id="kobo.736.1"> field is used to describe </span><span class="No-Break"><span class="koboSpan" id="kobo.737.1">the response.</span></span></li>
<li><span class="koboSpan" id="kobo.738.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">headers</span></strong><span class="koboSpan" id="kobo.740.1"> field is used to define the header and its value. </span><span class="koboSpan" id="kobo.740.2">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.741.1">headers</span></strong><span class="koboSpan" id="kobo.742.1"> example is shown </span><span class="No-Break"><span class="koboSpan" id="kobo.743.1">as follows:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.744.1">
responses:  200:    description: operation successful      headers:        X-RateLimit-Limit:          schema:            type: integer</span></pre></li> <li><span class="koboSpan" id="kobo.745.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">content</span></strong><span class="koboSpan" id="kobo.747.1"> field, like we have in previous code, defines the type of content that denotes the different media types. </span><span class="koboSpan" id="kobo.747.2">We use </span><strong class="source-inline"><span class="koboSpan" id="kobo.748.1">application/json</span></strong><span class="koboSpan" id="kobo.749.1">. </span><span class="koboSpan" id="kobo.749.2">Similarly, you can define other media types, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">application/xml</span></strong><span class="koboSpan" id="kobo.751.1">. </span><span class="koboSpan" id="kobo.751.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.752.1">content</span></strong><span class="koboSpan" id="kobo.753.1"> type field contains the actual response object that can be defined using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.754.1">schema</span></strong><span class="koboSpan" id="kobo.755.1"> field, as we have defined an array of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">Item</span></strong><span class="koboSpan" id="kobo.757.1"> model </span><span class="No-Break"><span class="koboSpan" id="kobo.758.1">inside it.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.759.1">As mentioned earlier, you can create a reusable response under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">components</span></strong><span class="koboSpan" id="kobo.761.1"> section and directly use it </span><span class="No-Break"><span class="koboSpan" id="kobo.762.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.763.1">$ref</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.764.1">.</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.765.1">requestBody</span></strong><span class="koboSpan" id="kobo.766.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">requestBody</span></strong><span class="koboSpan" id="kobo.768.1"> field is used to define the request payload object. </span><span class="koboSpan" id="kobo.768.2">Like the </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">responses</span></strong><span class="koboSpan" id="kobo.770.1"> object, </span><strong class="source-inline"><span class="koboSpan" id="kobo.771.1">requestBody</span></strong><span class="koboSpan" id="kobo.772.1"> also contains the description and content fields. </span><span class="koboSpan" id="kobo.772.2">Content can be defined in a similar fashion to the way it is defined for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">responses</span></strong><span class="koboSpan" id="kobo.774.1"> object. </span><span class="koboSpan" id="kobo.774.2">You can refer to the previous code of </span><strong class="source-inline"><span class="koboSpan" id="kobo.775.1">POST /carts/{customerId}/items</span></strong><span class="koboSpan" id="kobo.776.1"> for an example. </span><span class="koboSpan" id="kobo.776.2">As a response, you can also create reusable request bodies under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">components</span></strong><span class="koboSpan" id="kobo.778.1"> section and directly use them </span><span class="No-Break"><span class="koboSpan" id="kobo.779.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.780.1">$ref</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.782.1">Now, you know</span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.783.1"> how to define the API specification using OAS. </span><span class="koboSpan" id="kobo.783.2">Great! </span><span class="koboSpan" id="kobo.783.3">Here, we just described part of a sample e-commerce app’s API. </span><span class="koboSpan" id="kobo.783.4">Similarly, you can describe other APIs. </span><span class="koboSpan" id="kobo.783.5">You can refer to </span><strong class="source-inline"><span class="koboSpan" id="kobo.784.1">openapi.yaml</span></strong><span class="koboSpan" id="kobo.785.1"> (</span><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="koboSpan" id="kobo.786.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/openapi.yaml</span></a><span class="koboSpan" id="kobo.787.1">) for the complete code of our e-commerce </span><span class="No-Break"><span class="koboSpan" id="kobo.788.1">API definitions.</span></span></p>
<p><span class="koboSpan" id="kobo.789.1">I suggest that you copy the code from </span><strong class="source-inline"><span class="koboSpan" id="kobo.790.1">openapi.yaml</span></strong><span class="koboSpan" id="kobo.791.1"> and paste it into the editor at </span><a href="https://editor.swagger.io"><span class="koboSpan" id="kobo.792.1">https://editor.swagger.io</span></a><span class="koboSpan" id="kobo.793.1"> to view the API in a nice user interface and play around with it. </span><span class="koboSpan" id="kobo.793.2">Make sure to convert the API to OpenAPI version 3 using the </span><strong class="bold"><span class="koboSpan" id="kobo.794.1">Edit</span></strong><span class="koboSpan" id="kobo.795.1"> menu if the default version is not set </span><span class="No-Break"><span class="koboSpan" id="kobo.796.1">to 3.0.</span></span></p>
<p><span class="koboSpan" id="kobo.797.1">We have finished designing our APIs, so now let’s generate code using </span><strong class="source-inline"><span class="koboSpan" id="kobo.798.1">openapi.yaml</span></strong><span class="koboSpan" id="kobo.799.1"> and enjoy the fruits of our </span><span class="No-Break"><span class="koboSpan" id="kobo.800.1">hard work.</span></span></p>
<h1 id="_idParaDest-90"><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.801.1">Converting OAS to Spring code</span></h1>
<p><span class="koboSpan" id="kobo.802.1">I am sure</span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.803.1"> you are as excited as I am </span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.804.1">to start implementing the API. </span><span class="koboSpan" id="kobo.804.2">So far, we have learned about the RESTful web service theory and concepts and Spring fundamentals, and also designed our first API specs for a sample </span><span class="No-Break"><span class="koboSpan" id="kobo.805.1">e-commerce application.</span></span></p>
<p><span class="koboSpan" id="kobo.806.1">For this section, you can either clone the Git repository (</span><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3"><span class="koboSpan" id="kobo.807.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3</span></a><span class="koboSpan" id="kobo.808.1">) or start to create a Spring project from scratch using </span><strong class="bold"><span class="koboSpan" id="kobo.809.1">Spring Initializr</span></strong><span class="koboSpan" id="kobo.810.1"> (</span><a href="https://start.spring.io/"><span class="koboSpan" id="kobo.811.1">https://start.spring.io/</span></a><span class="koboSpan" id="kobo.812.1">) with the </span><a id="_idIndexMarker185"/><span class="No-Break"><span class="koboSpan" id="kobo.813.1">following options:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.814.1">Project</span></strong><span class="koboSpan" id="kobo.815.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.816.1">Gradle - </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">Groovy</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.818.1">Language</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.819.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">Java</span></strong></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.821.1">Spring </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.822.1">Boot</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.823.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.824.1">3.0.8</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.825.1">Or use the 3.X.X available version. </span><span class="koboSpan" id="kobo.825.2">Replace the project metadata with your </span><span class="No-Break"><span class="koboSpan" id="kobo.826.1">preferred values</span></span></p>
<ul>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.827.1">Packaging</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.829.1">Jar</span></strong></span></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.830.1">Java</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.831.1">: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">17</span></strong></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.833.1">Dependencies</span></strong><span class="koboSpan" id="kobo.834.1">: </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.835.1">Spring Web</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.836.1">Once you open the project in your favorite IDE (IntelliJ, Eclipse, or NetBeans), you can add the following extra dependencies required for OpenAPI support under </span><strong class="source-inline"><span class="koboSpan" id="kobo.837.1">dependencies</span></strong><span class="koboSpan" id="kobo.838.1"> in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.839.1">build.gradle</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.840.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.841.1">
swaggerCodegen 'org.openapitools:openapi-generator-cli:6.2.1'compileOnly 'io.swagger:swagger-annotations:1.6.4'
compileOnly 'org.springframework.boot:spring-boot-starter-
             validation'
compileOnly 'org.openapitools:jackson-databind-nullable:0.2.3'
implementation 'com.fasterxml.jackson.dataformat:jackson-
                dataformat-xml'
implementation 'org.springframework.boot:spring-boot-starter-
                hateoas'
implementation 'io.springfox:springfox-oas:3.0.0'</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/build.gradle"><span class="No-Break"><span class="koboSpan" id="kobo.842.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/build.gradle</span></span></a></p>
<p><span class="koboSpan" id="kobo.843.1">As mentioned earlier, we will use the Swagger plugin for code generation from the API definitions we just wrote. </span><span class="koboSpan" id="kobo.843.2">Follow the next seven steps to generate </span><span class="No-Break"><span class="koboSpan" id="kobo.844.1">the code.</span></span></p>
<ol>
<li><strong class="bold"><span class="koboSpan" id="kobo.845.1">Adding the Gradle plugin</span></strong><span class="koboSpan" id="kobo.846.1">: To make use of the OpenAPI Generator CLI tool, you can add the</span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.847.1"> Swagger</span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.848.1"> Gradle plugin under </span><strong class="source-inline"><span class="koboSpan" id="kobo.849.1">plugins {}</span></strong><span class="koboSpan" id="kobo.850.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">build.gradle</span></strong><span class="koboSpan" id="kobo.852.1">, as </span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">shown here:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.854.1">
plugins {  …  …  id '</span><strong class="bold"><span class="koboSpan" id="kobo.855.1">org.hidetake.swagger.generator</span></strong><span class="koboSpan" id="kobo.856.1">' version '2.19.2'}</span></pre></li> <li><strong class="bold"><span class="koboSpan" id="kobo.857.1">Defining the OpenAPI config for code generation</span></strong><span class="koboSpan" id="kobo.858.1">: You need certain configurations, such as what model and API package names OpenAPI Generator’s CLI should use, or the library it should use to generate the REST interfaces or date/time-related objects. </span><span class="koboSpan" id="kobo.858.2">All these and other configurations can be defined in </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.859.1">config.json</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.860.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.861.1">/src/main/resources/api/config.json</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.862.1">):</span></span><pre class="source-code"><span class="koboSpan" id="kobo.863.1">
{  "</span><strong class="bold"><span class="koboSpan" id="kobo.864.1">library</span></strong><span class="koboSpan" id="kobo.865.1">": "</span><strong class="bold"><span class="koboSpan" id="kobo.866.1">spring-boot</span></strong><span class="koboSpan" id="kobo.867.1">",  "dateLibrary": "java8",  "hideGenerationTimestamp": true,  "modelPackage": "com.packt.modern.api.model",  "apiPackage": "com.packt.modern.api",  "invokerPackage": "com.packt.modern.api",  "serializableModel": true,  "useTags": true,  "useGzipFeature" : true,  "</span><strong class="bold"><span class="koboSpan" id="kobo.868.1">hateoas</span></strong><span class="koboSpan" id="kobo.869.1">": true,  "unhandledException": true,  "</span><strong class="bold"><span class="koboSpan" id="kobo.870.1">useSpringBoot3</span></strong><span class="koboSpan" id="kobo.871.1">": true,  "useSwaggerUI": true,   …   …  "</span><strong class="bold"><span class="koboSpan" id="kobo.872.1">importMappings</span></strong><span class="koboSpan" id="kobo.873.1">": {    "ResourceSupport":"org.springframework.hateoas.        RepresentationModel",    "Link": "org.springframework.hateoas.Link"  }}</span></pre></li> </ol>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/config.json"><span class="No-Break"><span class="koboSpan" id="kobo.874.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/resources/api/config.json</span></span></a></p>
<p><span class="koboSpan" id="kobo.875.1">This</span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.876.1"> configuration </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.877.1">sets </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">spring-boot</span></strong><span class="koboSpan" id="kobo.879.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.880.1">library</span></strong><span class="koboSpan" id="kobo.881.1"> – that is, Swagger Codegen will generate the classes aligned with Spring Boot. </span><span class="koboSpan" id="kobo.881.2">You can see that </span><strong class="source-inline"><span class="koboSpan" id="kobo.882.1">useSpringBoot3</span></strong><span class="koboSpan" id="kobo.883.1"> is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.884.1">true</span></strong><span class="koboSpan" id="kobo.885.1"> to make sure that generated classes are aligned with Spring </span><span class="No-Break"><span class="koboSpan" id="kobo.886.1">Boot 3.</span></span></p>
<p><span class="koboSpan" id="kobo.887.1">All other properties are self-explanatory except </span><strong class="source-inline"><span class="koboSpan" id="kobo.888.1">importMappings</span></strong><span class="koboSpan" id="kobo.889.1">. </span><span class="koboSpan" id="kobo.889.2">It contains the mapping of a type from a YAML file to Java or a type existing in the external library. </span><span class="koboSpan" id="kobo.889.3">Therefore, once code is generated for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.890.1">importMappings</span></strong><span class="koboSpan" id="kobo.891.1"> object, it uses the mapped class in the generated code. </span><span class="koboSpan" id="kobo.891.2">If we use </span><strong class="source-inline"><span class="koboSpan" id="kobo.892.1">Link</span></strong><span class="koboSpan" id="kobo.893.1"> in any of the models, then the generated models will use the mapped </span><strong class="source-inline"><span class="koboSpan" id="kobo.894.1">org.springframework.hateoas.Link</span></strong><span class="koboSpan" id="kobo.895.1"> class instead of the model defined in the </span><span class="No-Break"><span class="koboSpan" id="kobo.896.1">YAML file.</span></span></p>
<p><span class="koboSpan" id="kobo.897.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.898.1">hateoas</span></strong><span class="koboSpan" id="kobo.899.1"> configuration property allows us to use the Spring HATEOAS library and add </span><span class="No-Break"><span class="koboSpan" id="kobo.900.1">HATEOAS links.</span></span></p>
<p><span class="koboSpan" id="kobo.901.1">You can find more information about the configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.902.1">at </span></span><a href="https://github.com/swagger-api/swagger-codegen#customizing-the-generator"><span class="No-Break"><span class="koboSpan" id="kobo.903.1">https://github.com/swagger-api/swagger-codegen#customizing-the-generator</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.904.1">.</span></span></p>
<ol>
<li value="3"><strong class="bold"><span class="koboSpan" id="kobo.905.1">Defining the OpenAPI Generator ignore file</span></strong><span class="koboSpan" id="kobo.906.1">: You can also add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.907.1">.gitignore</span></strong><span class="koboSpan" id="kobo.908.1"> like file </span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.909.1"> to</span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.910.1"> ignore certain code you don’t want to generate. </span><span class="koboSpan" id="kobo.910.2">Add the following line of code to the file (</span><strong class="source-inline"><span class="koboSpan" id="kobo.911.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.912.1">src/main/resources/api/.openapi-generator-ignore</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.913.1">):</span></span><pre class="source-code"><span class="koboSpan" id="kobo.914.1">
**/*Controller.java</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.915.1">We don’t want to generate controllers. </span><span class="koboSpan" id="kobo.915.2">After the code’s addition, only API Java interfaces and models will be generated. </span><span class="koboSpan" id="kobo.915.3">We’ll add </span><span class="No-Break"><span class="koboSpan" id="kobo.916.1">controllers manually.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.917.1">Copy the OAS file from </span><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/blob/main/Chapter03/src/main/resources/api/openapi.yaml"><span class="koboSpan" id="kobo.918.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/blob/main/Chapter03/src/main/resources/api/openapi.yaml</span></a> <span class="No-Break"><span class="koboSpan" id="kobo.919.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.920.1">/src/main/resources/api</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.921.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.922.1">Defining a swaggerSources task in the Gradle build file</span></strong><span class="koboSpan" id="kobo.923.1">: Now, let’s add logic to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.924.1">swaggerSources</span></strong><span class="koboSpan" id="kobo.925.1"> task in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.926.1">build.gradle</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.927.1"> file:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.928.1">swaggerSources</span></strong><span class="koboSpan" id="kobo.929.1"> {  def typeMappings = 'URI=URI'  def importMappings = 'URI=java.net.URI'  </span><strong class="bold"><span class="koboSpan" id="kobo.930.1">eStore</span></strong><span class="koboSpan" id="kobo.931.1"> {    def apiYaml = "${rootDir}/src/main/resources/api/openapi.     </span><span class="koboSpan" id="kobo.931.2">yaml"    def configJson = "${rootDir}/src/main/resources/api/config.     </span><span class="koboSpan" id="kobo.931.3">json"    </span><strong class="bold"><span class="koboSpan" id="kobo.932.1">inputFile</span></strong><span class="koboSpan" id="kobo.933.1"> = file(apiYaml)    def ignoreFile = file("${rootDir}/src/main/resources/api/.openapi-generator-ignore")    </span><strong class="bold"><span class="koboSpan" id="kobo.934.1">code</span></strong><span class="koboSpan" id="kobo.935.1"> {      </span><strong class="bold"><span class="koboSpan" id="kobo.936.1">language</span></strong><span class="koboSpan" id="kobo.937.1"> = 'spring'      </span><strong class="bold"><span class="koboSpan" id="kobo.938.1">configFile</span></strong><span class="koboSpan" id="kobo.939.1"> = file(configJson)      </span><strong class="bold"><span class="koboSpan" id="kobo.940.1">rawOptions</span></strong><span class="koboSpan" id="kobo.941.1"> = ['--ignore-file-override',</span><strong class="bold"><span class="koboSpan" id="kobo.942.1">        </span></strong><span class="koboSpan" id="kobo.943.1">ignoreFile,                   '--type-mappings', typeMappings,                   '--import-mappings',                      importMappings]                   as List&lt;String&gt;      </span><strong class="bold"><span class="koboSpan" id="kobo.944.1">components</span></strong><span class="koboSpan" id="kobo.945.1"> = [models: true, apis: true,supportingFiles:        'ApiUtil.java']      dependsOn validation    }  }}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.946.1">Here, we</span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.947.1"> defined </span><strong class="source-inline"><span class="koboSpan" id="kobo.948.1">eStore</span></strong><span class="koboSpan" id="kobo.949.1"> (the</span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.950.1"> user-defined name), which contains </span><strong class="source-inline"><span class="koboSpan" id="kobo.951.1">inputFile</span></strong><span class="koboSpan" id="kobo.952.1">, pointing to the location of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.953.1">openapi.yaml</span></strong><span class="koboSpan" id="kobo.954.1"> file. </span><span class="koboSpan" id="kobo.954.2">After defining the input, the generator needs to produce the output, which is configured </span><span class="No-Break"><span class="koboSpan" id="kobo.955.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.956.1">code</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.957.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.958.1">For the </span><strong class="source-inline"><span class="koboSpan" id="kobo.959.1">code</span></strong><span class="koboSpan" id="kobo.960.1"> block, </span><strong class="source-inline"><span class="koboSpan" id="kobo.961.1">language</span></strong><span class="koboSpan" id="kobo.962.1"> is set to Spring (it supports various languages); </span><strong class="source-inline"><span class="koboSpan" id="kobo.963.1">configFile</span></strong><span class="koboSpan" id="kobo.964.1"> points to </span><strong class="source-inline"><span class="koboSpan" id="kobo.965.1">config.json</span></strong><span class="koboSpan" id="kobo.966.1">; </span><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">rawOptions</span></strong><span class="koboSpan" id="kobo.968.1"> contains an </span><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">ignore</span></strong><span class="koboSpan" id="kobo.970.1"> file, type mapping, and import mappings; and </span><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">components</span></strong><span class="koboSpan" id="kobo.972.1"> contains the file flags you want to generate – models and API Java interfaces. </span><span class="koboSpan" id="kobo.972.2">Except for </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">language</span></strong><span class="koboSpan" id="kobo.974.1">, all our other configuration properties are optional in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">code</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.976.1"> block.</span></span></p>
<p><span class="koboSpan" id="kobo.977.1">We only want to generate models and APIs. </span><span class="koboSpan" id="kobo.977.2">You can generate other files too, such as clients or test files. </span><strong class="source-inline"><span class="koboSpan" id="kobo.978.1">ApiUtil.java</span></strong><span class="koboSpan" id="kobo.979.1"> is required in the generated API Java interface otherwise, it will give a compilation error during build time. </span><span class="koboSpan" id="kobo.979.2">Therefore, it is added </span><span class="No-Break"><span class="koboSpan" id="kobo.980.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.981.1">components</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.982.1">.</span></span></p>
<ol>
<li value="6"><strong class="bold"><span class="koboSpan" id="kobo.983.1">Adding swaggerSources to the compileJava task dependency</span></strong><span class="koboSpan" id="kobo.984.1">: Now we need to add </span><strong class="source-inline"><span class="koboSpan" id="kobo.985.1">swaggerSources</span></strong><span class="koboSpan" id="kobo.986.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.987.1">compileJava</span></strong><span class="koboSpan" id="kobo.988.1"> task as a </span><span class="No-Break"><span class="koboSpan" id="kobo.989.1">dependent task.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.990.1">This task</span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.991.1"> points </span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.992.1">to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.993.1">code</span></strong><span class="koboSpan" id="kobo.994.1"> block defined </span><span class="No-Break"><span class="koboSpan" id="kobo.995.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.996.1">eStore</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.997.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.998.1">
compileJava.dependsOn </span><strong class="bold"><span class="koboSpan" id="kobo.999.1">swaggerSources.eStore.code</span></strong></pre> <p><span class="koboSpan" id="kobo.1000.1">Also, you need to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1001.1">generateSwaggerCode</span></strong><span class="koboSpan" id="kobo.1002.1"> task as a dependency to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1003.1">processResources</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1004.1"> task:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1005.1">
processResources {  dependsOn(</span><strong class="source-inline"><span class="koboSpan" id="kobo.1006.1">generateSwaggerCode</span></strong><span class="koboSpan" id="kobo.1007.1">)
}</span></pre>
<p><span class="koboSpan" id="kobo.1008.1">You may get a warning in prior to Gradle 8 versions if you don’t define this dependency, and but it will still work. </span><span class="koboSpan" id="kobo.1008.2">However, this code block is required for the Gradle </span><span class="No-Break"><span class="koboSpan" id="kobo.1009.1">8 version.</span></span></p>
<ol>
<li value="7"><strong class="bold"><span class="koboSpan" id="kobo.1010.1">Adding the generated source code to Gradle sourceSets</span></strong><span class="koboSpan" id="kobo.1011.1">: We also need to add the generated source code and resources to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1012.1">sourceSets</span></strong><span class="koboSpan" id="kobo.1013.1">. </span><span class="koboSpan" id="kobo.1013.2">This makes the generated source code and resources available for development </span><span class="No-Break"><span class="koboSpan" id="kobo.1014.1">and build:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1015.1">
sourceSets.main.java.srcDir "${swaggerSources.eStore.code.outputDir}/src/main/java"sourceSets.main.resources.srcDir "${swaggerSources.eStore.code  .outputDir}/src/main/resources"</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1016.1">The source code will be generated in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1017.1">/build</span></strong><span class="koboSpan" id="kobo.1018.1"> directory of the project, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1019.1">Chapter03\build\swagger-code-eStore</span></strong><span class="koboSpan" id="kobo.1020.1">. </span><span class="koboSpan" id="kobo.1020.2">This will append the generated source code and resources to </span><span class="No-Break"><span class="koboSpan" id="kobo.1021.1">Gradle </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">sourceSets</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.1024.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.1025.1">You have generated the API Java interfaces and models using the Swagger Codegen utility. </span><span class="koboSpan" id="kobo.1025.2">Therefore, when you load the project for the first time in your IDE, you may get errors if you don’t run your build because IDE won’t find the generated Java files (models and API Java interfaces). </span><span class="koboSpan" id="kobo.1025.3">You can run the build’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.1026.1">gradlew clean build</span></strong><span class="koboSpan" id="kobo.1027.1"> command to generate </span><span class="No-Break"><span class="koboSpan" id="kobo.1028.1">these files.</span></span></p>
<ol>
<li value="8"><strong class="bold"><span class="koboSpan" id="kobo.1029.1">Building the project to generate, compile, and build the code</span></strong><span class="koboSpan" id="kobo.1030.1">: The last step is to </span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.1031.1">execute</span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.1032.1"> the build. </span><span class="koboSpan" id="kobo.1032.2">Make sure you have an executable Java code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1033.1">build</span></strong><span class="koboSpan" id="kobo.1034.1"> path. </span><span class="koboSpan" id="kobo.1034.2">The Java version should match the version defined in the property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1035.1">build.gradle</span></strong><span class="koboSpan" id="kobo.1036.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1037.1">sourceCompatibility = '17'</span></strong><span class="koboSpan" id="kobo.1038.1">) or in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1039.1">IDE settings:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1040.1">$ gradlew clean build</span></strong></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1041.1">Once the build is executed successfully, you can find the generated code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1042.1">build</span></strong><span class="koboSpan" id="kobo.1043.1"> directory, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer015">
<span class="koboSpan" id="kobo.1045.1"><img alt="Figure 3.2 ﻿– The OpenAPI-generated code" src="image/Figure_03.2_B19349.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1046.1">Figure 3.2 – The OpenAPI-generated code</span></p>
<p><span class="koboSpan" id="kobo.1047.1">And that’s it. </span><span class="koboSpan" id="kobo.1047.2">Once you follow all the aforementioned steps, you can successfully generate the API </span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.1048.1">models </span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.1049.1">and API Java interfaces code. </span><span class="koboSpan" id="kobo.1049.2">In the next section, you’ll implement the API Java interfaces generated by </span><span class="No-Break"><span class="koboSpan" id="kobo.1050.1">OpenAPI Codegen.</span></span></p>
<h1 id="_idParaDest-91"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.1051.1">Implementing the OAS code interfaces</span></h1>
<p><span class="koboSpan" id="kobo.1052.1">So far, we have</span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.1053.1"> generated code that consists of e-commerce app models and API Java interfaces. </span><span class="koboSpan" id="kobo.1053.2">These generated interfaces contain all the annotations as per the YAML description provided by us. </span><span class="koboSpan" id="kobo.1053.3">For example, in </span><strong class="source-inline"><span class="koboSpan" id="kobo.1054.1">CartApi.java</span></strong><span class="koboSpan" id="kobo.1055.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1056.1">@RequestMapping</span></strong><span class="koboSpan" id="kobo.1057.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1058.1">@PathVariable</span></strong><span class="koboSpan" id="kobo.1059.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1060.1">@RequestBody</span></strong><span class="koboSpan" id="kobo.1061.1"> contain the endpoint path (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1062.1">/api/v1/carts/{customerId}/items</span></strong><span class="koboSpan" id="kobo.1063.1">), the value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1064.1">path</span></strong><span class="koboSpan" id="kobo.1065.1"> variable (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1066.1">{customerId}</span></strong><span class="koboSpan" id="kobo.1067.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.1068.1">path</span></strong><span class="koboSpan" id="kobo.1069.1">), and the request payload (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1070.1">Item</span></strong><span class="koboSpan" id="kobo.1071.1">), respectively. </span><span class="koboSpan" id="kobo.1071.2">Similarly, generated models contain all the mapping required to support the JSON and XML </span><span class="No-Break"><span class="koboSpan" id="kobo.1072.1">content types.</span></span></p>
<p><span class="koboSpan" id="kobo.1073.1">Swagger Codegen writes the Spring code for us. </span><span class="koboSpan" id="kobo.1073.2">We just need to implement the interface and write the business logic inside it. </span><span class="koboSpan" id="kobo.1073.3">Swagger Codegen generates the API Java interfaces for each of the provided tags. </span><span class="koboSpan" id="kobo.1073.4">For example, it generates the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1074.1">CartApi</span></strong><span class="koboSpan" id="kobo.1075.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1076.1">PaymentAPI</span></strong><span class="koboSpan" id="kobo.1077.1"> Java interfaces for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1078.1">cart</span></strong><span class="koboSpan" id="kobo.1079.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1080.1">payment</span></strong><span class="koboSpan" id="kobo.1081.1"> tags, respectively. </span><span class="koboSpan" id="kobo.1081.2">All the paths are clubbed together into a single Java interface based on the given tag. </span><span class="koboSpan" id="kobo.1081.3">For example, all the APIs with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1082.1">cart</span></strong><span class="koboSpan" id="kobo.1083.1"> tag will be clubbed together into a single Java </span><span class="No-Break"><span class="koboSpan" id="kobo.1084.1">interface, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1085.1">CartApi.java</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1086.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1087.1">Now, we just need to create</span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.1088.1"> a class for each of the interfaces and implement it. </span><span class="koboSpan" id="kobo.1088.2">We’ll create </span><strong class="source-inline"><span class="koboSpan" id="kobo.1089.1">CartController.java</span></strong><span class="koboSpan" id="kobo.1090.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1091.1">com.packt.modern.api.controllers</span></strong><span class="koboSpan" id="kobo.1092.1"> package and </span><span class="No-Break"><span class="koboSpan" id="kobo.1093.1">implement </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1094.1">CartApi</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1095.1">:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1096.1">@RestController</span></strong><span class="koboSpan" id="kobo.1097.1">public class </span><strong class="bold"><span class="koboSpan" id="kobo.1098.1">CartsController</span></strong><span class="koboSpan" id="kobo.1099.1"> implements </span><strong class="bold"><span class="koboSpan" id="kobo.1100.1">CartApi</span></strong><span class="koboSpan" id="kobo.1101.1"> {
  private static final Logger log = LoggerFactory.getLogger(CartsController.class);
  @Override
  public ResponseEntity&lt;List&lt;Item&gt;&gt; addCartItemsBy
    CustomerId(String customerId, @Valid Item item) {
    log.info("Request for customer ID: {}\nItem: {}",customerId, item);
    return ok(Collections.EMPTY_LIST);
  }
  @Override
  public ResponseEntity&lt;List&lt;Cart&gt;&gt; getCartByCustomerId(String customerId) {
    throw new RuntimeException("Manual Exception thrown");
  }
  // Other method implementations (omitted)
}</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/controllers/CartsController.java"><span class="No-Break"><span class="koboSpan" id="kobo.1102.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/controllers/CartsController.java</span></span></a></p>
<p><span class="koboSpan" id="kobo.1103.1">Here, we just implemented the two methods for demonstration purposes. </span><span class="koboSpan" id="kobo.1103.2">We’ll implement the actual business logic in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1104.1">next chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.1105.1">To add an item (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1106.1">POST /api/v1/carts/{customerId}/items</span></strong><span class="koboSpan" id="kobo.1107.1">) request, we just log the incoming request payload and customer ID inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1108.1">addCartItemsByCustomerId</span></strong><span class="koboSpan" id="kobo.1109.1"> method. </span><span class="koboSpan" id="kobo.1109.2">Another method, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1110.1">getCartByCustomerId</span></strong><span class="koboSpan" id="kobo.1111.1">, simply throws an exception. </span><span class="koboSpan" id="kobo.1111.2">This will allow us to demonstrate the</span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.1112.1"> Global Exception Handler in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1113.1">next section.</span></span></p>
<h1 id="_idParaDest-92"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.1114.1">Adding a Global Exception Handler</span></h1>
<p><span class="koboSpan" id="kobo.1115.1">We have multiple</span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.1116.1"> controllers that consist of multiple methods. </span><span class="koboSpan" id="kobo.1116.2">Each method may have checked exceptions or throw runtime exceptions. </span><span class="koboSpan" id="kobo.1116.3">We should have a centralized place to handle all these errors for better maintainability and modularity and </span><span class="No-Break"><span class="koboSpan" id="kobo.1117.1">clean code.</span></span></p>
<p><span class="koboSpan" id="kobo.1118.1">Spring provides an AOP feature for this. </span><span class="koboSpan" id="kobo.1118.2">We just need to write a single class annotated with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1119.1">@ControllerAdvice</span></strong><span class="koboSpan" id="kobo.1120.1">. </span><span class="koboSpan" id="kobo.1120.2">Then, we just need to add </span><strong class="source-inline"><span class="koboSpan" id="kobo.1121.1">@ExceptionHandler</span></strong><span class="koboSpan" id="kobo.1122.1"> for each type of exception. </span><span class="koboSpan" id="kobo.1122.2">This exception handler method will generate user-friendly error messages with other </span><span class="No-Break"><span class="koboSpan" id="kobo.1123.1">related information.</span></span></p>
<p><span class="koboSpan" id="kobo.1124.1">You can make use of the Project Lombok library if approved by your organization for third-party library usage. </span><span class="koboSpan" id="kobo.1124.2">This will remove the verbosity of the code for getters, setters, constructors, and </span><span class="No-Break"><span class="koboSpan" id="kobo.1125.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.1126.1">Let’s first write the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1127.1">Error</span></strong><span class="koboSpan" id="kobo.1128.1"> class in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1129.1">exceptions</span></strong><span class="koboSpan" id="kobo.1130.1"> package that contains all the </span><span class="No-Break"><span class="koboSpan" id="kobo.1131.1">error information:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1132.1">
public class </span><strong class="bold"><span class="koboSpan" id="kobo.1133.1">Error</span></strong><span class="koboSpan" id="kobo.1134.1"> {  private static final long serialVersionUID = 1L;
  private String errorCode;
  private String message;
  private Integer status;
  private String url = "Not available";
  private String reqMethod = "Not available";
  // getters and setters (omitted)
}</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/Error.java"><span class="No-Break"><span class="koboSpan" id="kobo.1135.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/Error.java</span></span></a></p>
<p><span class="koboSpan" id="kobo.1136.1">Here, we use the </span><span class="No-Break"><span class="koboSpan" id="kobo.1137.1">following properties:</span></span></p>
<ul>
<li> <strong class="source-inline"><span class="koboSpan" id="kobo.1138.1">errorCode</span></strong><span class="koboSpan" id="kobo.1139.1">: Application error code, which is different from HTTP </span><span class="No-Break"><span class="koboSpan" id="kobo.1140.1">error code</span></span></li>
<li> <strong class="source-inline"><span class="koboSpan" id="kobo.1141.1">message</span></strong><span class="koboSpan" id="kobo.1142.1">: A short, human-readable summary of </span><span class="No-Break"><span class="koboSpan" id="kobo.1143.1">the problem</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1144.1">status</span></strong><span class="koboSpan" id="kobo.1145.1">: An HTTP status code for this occurrence of the problem, set by the </span><span class="No-Break"><span class="koboSpan" id="kobo.1146.1">origin server</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1147.1">url</span></strong><span class="koboSpan" id="kobo.1148.1">: A URL of the request that produced </span><span class="No-Break"><span class="koboSpan" id="kobo.1149.1">the error</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1150.1">reqMethod</span></strong><span class="koboSpan" id="kobo.1151.1">: A method of the request that produced </span><span class="No-Break"><span class="koboSpan" id="kobo.1152.1">the error</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1153.1">You can add other</span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.1154.1"> fields here if required. </span><span class="koboSpan" id="kobo.1154.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1155.1">exceptions</span></strong><span class="koboSpan" id="kobo.1156.1"> package will contain all the code for user-defined exceptions and global </span><span class="No-Break"><span class="koboSpan" id="kobo.1157.1">exception handling.</span></span></p>
<p><span class="koboSpan" id="kobo.1158.1">After that, we’ll write an </span><strong class="source-inline"><span class="koboSpan" id="kobo.1159.1">enum</span></strong><span class="koboSpan" id="kobo.1160.1"> called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1161.1">ErrorCode</span></strong><span class="koboSpan" id="kobo.1162.1"> that will contain all the exception keys, including user-defined errors and their respective </span><span class="No-Break"><span class="koboSpan" id="kobo.1163.1">error codes:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1164.1">
public enum </span><strong class="bold"><span class="koboSpan" id="kobo.1165.1">ErrorCode</span></strong><span class="koboSpan" id="kobo.1166.1"> {  </span><strong class="bold"><span class="koboSpan" id="kobo.1167.1">GENERIC_ERROR</span></strong><span class="koboSpan" id="kobo.1168.1">("PACKT-0001", "The system is unable to
        complete the request. </span><span class="koboSpan" id="kobo.1168.2">Contact system support."),
  </span><strong class="bold"><span class="koboSpan" id="kobo.1169.1">HTTP_MEDIATYPE_NOT_SUPPORTED</span></strong><span class="koboSpan" id="kobo.1170.1">("PACKT-0002", "Requested
        media type is not supported. </span><span class="koboSpan" id="kobo.1170.2">Please use
        application/json or application/xml as 'Content-
        Type' header value"),
  </span><strong class="bold"><span class="koboSpan" id="kobo.1171.1">HTTP_MESSAGE_NOT_WRITABLE</span></strong><span class="koboSpan" id="kobo.1172.1">("PACKT-0003", "Missing 'Accept'
        header. </span><span class="koboSpan" id="kobo.1172.2">Please add 'Accept' header."),
  </span><strong class="bold"><span class="koboSpan" id="kobo.1173.1">HTTP_MEDIA_TYPE_NOT_ACCEPTABLE</span></strong><span class="koboSpan" id="kobo.1174.1">("PACKT-0004", "Requested
        'Accept' header value is not supported. </span><span class="koboSpan" id="kobo.1174.2">Please use
         application/json or application/xml as 'Accept'
         value"),
  </span><strong class="bold"><span class="koboSpan" id="kobo.1175.1">JSON_PARSE_ERROR</span></strong><span class="koboSpan" id="kobo.1176.1">("PACKT-0005", "Make sure request payload
        should be a valid JSON object."),
  </span><strong class="bold"><span class="koboSpan" id="kobo.1177.1">HTTP_MESSAGE_NOT_READABLE</span></strong><span class="koboSpan" id="kobo.1178.1">("PACKT-0006", "Make sure
        request payload should be a valid JSON or XML
        object according to 'Content-Type'.");
  private String errCode;
  private String errMsgKey;
  ErrorCode(final String errCode, final String errMsgKey) {
    this.errCode = errCode;
    this.errMsgKey = errMsgKey;
  }
  public String getErrCode() {  return errCode;  }
  public String getErrMsgKey() {  return errMsgKey;  }
}</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/ErrorCode.java"><span class="No-Break"><span class="koboSpan" id="kobo.1179.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/ErrorCode.java</span></span></a></p>
<p><span class="koboSpan" id="kobo.1180.1">Here, we just added a few error code enums with their code and messages. </span><span class="koboSpan" id="kobo.1180.2">We also just added actual error messages instead of message keys. </span><span class="koboSpan" id="kobo.1180.3">You can add message keys and add the resource file to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1181.1">src/main/resources</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1182.1">for internationalization.</span></span></p>
<p><span class="koboSpan" id="kobo.1183.1">Next, you’ll add </span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.1184.1">a utility to create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.1185.1">Error</span></strong><span class="koboSpan" id="kobo.1186.1"> object, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1187.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1188.1">
public class </span><strong class="bold"><span class="koboSpan" id="kobo.1189.1">ErrorUtils</span></strong><span class="koboSpan" id="kobo.1190.1"> {  private ErrorUtils() {}
  public static Error </span><strong class="bold"><span class="koboSpan" id="kobo.1191.1">createError</span></strong><span class="koboSpan" id="kobo.1192.1">(final String errMsgKey,
      final String errorCode, final Integer httpStatusCode) {
    Error error = new Error();
    error.setMessage(errMsgKey);
    error.setErrorCode(errorCode);
    error.setStatus(httpStatusCode);
    return error;
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.1193.1">Finally, we’ll create a class to implement the Global Exception Handler, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1194.1">shown here:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1195.1">@ControllerAdvice</span></strong><span class="koboSpan" id="kobo.1196.1">public class </span><strong class="bold"><span class="koboSpan" id="kobo.1197.1">RestApiErrorHandler</span></strong><span class="koboSpan" id="kobo.1198.1"> {
  private final MessageSource messageSource;
  @Autowired
  public RestApiErrorHandler(MessageSource messageSource) {
    this.messageSource = messageSource;
  }
  </span><strong class="bold"><span class="koboSpan" id="kobo.1199.1">@ExceptionHandler(Exception.class)</span></strong><span class="koboSpan" id="kobo.1200.1">
  public ResponseEntity&lt;Error&gt; handleException(HttpServletRequest request, Exception ex,Locale locale) {
    Error error = ErrorUtils
        .createError(ErrorCode.GENERIC_ERROR.getErrMsgKey(),  ErrorCode.GENERIC_ERROR.getErrCode(),  HttpStatus.INTERNAL_SERVER_ERROR.value())     .setUrl(request.getRequestURL().toString())  .setReqMethod(request.getMethod());
    return new ResponseEntity&lt;&gt;(error, HttpStatus.INTERNAL_SERVER_ERROR);
  }
  </span><strong class="bold"><span class="koboSpan" id="kobo.1201.1">@ExceptionHandler(HttpMediaTypeNotSupportedException.class)</span></strong><span class="koboSpan" id="kobo.1202.1">
  public ResponseEntity&lt;Error&gt;
       handleHttpMediaTypeNotSupportedException(
        HttpServletRequest request,
        HttpMediaTypeNotSupportedException ex, Locale locale){
    Error error = ErrorUtils
        .createError(ErrorCode.HTTP_MEDIATYPE_NOT_SUPPORTED
          .getErrMsgKey(),
        ErrorCode.HTTP_MEDIATYPE_NOT_SUPPORTED.getErrCode(),
        HttpStatus.UNSUPPORTED_MEDIA_TYPE.value())
          .setUrl(request.getRequestURL().toString())
          .setReqMethod(request.getMethod());
    return new ResponseEntity&lt;&gt;(
          error, HttpStatus.INTERNAL_SERVER_ERROR);
  }
  // removed code for brevity
}</span></pre>
<p><a href="https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/RestApiErrorHandler.java"><span class="No-Break"><span class="koboSpan" id="kobo.1203.1">https://github.com/PacktPublishing/Modern-API-Development-with-Spring-6-and-Spring-Boot-3/tree/main/Chapter03/src/main/java/com/packt/modern/api/exceptions/RestApiErrorHandler.java</span></span></a></p>
<p><span class="koboSpan" id="kobo.1204.1">As you can see, we marked the class with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1205.1">@ControllerAdvice</span></strong><span class="koboSpan" id="kobo.1206.1">, which enables this class to trace all the request and response processing by the REST controllers and allows us to handle exceptions </span><span class="No-Break"><span class="koboSpan" id="kobo.1207.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1208.1">@ExceptionHandler</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1209.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1210.1">In the previous code, we handle two exceptions – a generic internal server error exception and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1211.1">HttpMediaTypeNotSupportException</span></strong><span class="koboSpan" id="kobo.1212.1">. </span><span class="koboSpan" id="kobo.1212.2">The handling method just populates the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1213.1">Error</span></strong><span class="koboSpan" id="kobo.1214.1"> object using </span><strong class="source-inline"><span class="koboSpan" id="kobo.1215.1">ErrorCode</span></strong><span class="koboSpan" id="kobo.1216.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1217.1">HttpServletRequest</span></strong><span class="koboSpan" id="kobo.1218.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1219.1">HttpStatus</span></strong><span class="koboSpan" id="kobo.1220.1">. </span><span class="koboSpan" id="kobo.1220.2">Finally, it returns the error wrapped inside </span><strong class="source-inline"><span class="koboSpan" id="kobo.1221.1">ResponseEntity</span></strong><span class="koboSpan" id="kobo.1222.1"> with the appropriate </span><span class="No-Break"><span class="koboSpan" id="kobo.1223.1">HTTP status.</span></span></p>
<p><span class="koboSpan" id="kobo.1224.1">In this code, you can add user-defined exceptions too. </span><span class="koboSpan" id="kobo.1224.2">You can also make use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1225.1">Locale</span></strong><span class="koboSpan" id="kobo.1226.1"> instance (a method parameter) and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1227.1">messageSource</span></strong><span class="koboSpan" id="kobo.1228.1"> class member to support </span><span class="No-Break"><span class="koboSpan" id="kobo.1229.1">internationalized messages.</span></span></p>
<p><span class="koboSpan" id="kobo.1230.1">Now that we have </span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.1231.1">designed the API and generated the code and implementation, let’s now test the implementation in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1232.1">following subsection.</span></span></p>
<h1 id="_idParaDest-93"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.1233.1">Testing the implementation of the API</span></h1>
<p><span class="koboSpan" id="kobo.1234.1">Once the code is</span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.1235.1"> ready to run, you can compile and build the artifact using the following command from the root folder of </span><span class="No-Break"><span class="koboSpan" id="kobo.1236.1">the project:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1237.1">
$ ./gradlew clean build</span></pre> <p><span class="koboSpan" id="kobo.1238.1">The previous command removes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1239.1">build</span></strong><span class="koboSpan" id="kobo.1240.1"> folder and generates the artifact (the compiled classes and JAR). </span><span class="koboSpan" id="kobo.1240.2">After the successful build, you can run the application using the </span><span class="No-Break"><span class="koboSpan" id="kobo.1241.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1242.1">
$ java -jar build/libs/Chapter03-0.0.1-SNAPSHOT.jar</span></pre> <p><span class="koboSpan" id="kobo.1243.1">Now, we can perform tests using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1244.1">curl</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1245.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1246.1">
$ curl --request GET 'http://localhost:8080/api/v1/carts/1' --header 'Accept: application/xml'</span></pre> <p><span class="koboSpan" id="kobo.1247.1">This command calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1248.1">GET</span></strong><span class="koboSpan" id="kobo.1249.1"> request for </span><strong class="source-inline"><span class="koboSpan" id="kobo.1250.1">/carts</span></strong><span class="koboSpan" id="kobo.1251.1"> with ID </span><strong class="source-inline"><span class="koboSpan" id="kobo.1252.1">1</span></strong><span class="koboSpan" id="kobo.1253.1">. </span><span class="koboSpan" id="kobo.1253.2">Here, we demand the XML response using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1254.1">Accept</span></strong><span class="koboSpan" id="kobo.1255.1"> header, and we get the </span><span class="No-Break"><span class="koboSpan" id="kobo.1256.1">following response:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1257.1">
&lt;Error&gt;  &lt;</span><strong class="bold"><span class="koboSpan" id="kobo.1258.1">errorCode</span></strong><span class="koboSpan" id="kobo.1259.1">&gt;PACKT-0001&lt;/errorCode&gt;
  &lt;</span><strong class="bold"><span class="koboSpan" id="kobo.1260.1">message</span></strong><span class="koboSpan" id="kobo.1261.1">&gt;The system is unable to complete the request.
</span><span class="koboSpan" id="kobo.1261.2">           Contact system support.&lt;/message&gt;
  &lt;</span><strong class="bold"><span class="koboSpan" id="kobo.1262.1">status</span></strong><span class="koboSpan" id="kobo.1263.1">&gt;500&lt;/status&gt;
  &lt;</span><strong class="bold"><span class="koboSpan" id="kobo.1264.1">url</span></strong><span class="koboSpan" id="kobo.1265.1">&gt;http://localhost:8080/api/v1/carts/1&lt;/url&gt;
  &lt;</span><strong class="bold"><span class="koboSpan" id="kobo.1266.1">reqMethod</span></strong><span class="koboSpan" id="kobo.1267.1">&gt;GET&lt;/reqMethod&gt;
&lt;/Error&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1268.1">If you change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1269.1">Accept</span></strong><span class="koboSpan" id="kobo.1270.1"> header</span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.1271.1"> from </span><strong class="source-inline"><span class="koboSpan" id="kobo.1272.1">application/xml</span></strong><span class="koboSpan" id="kobo.1273.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1274.1">application/json</span></strong><span class="koboSpan" id="kobo.1275.1">, you will get the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1276.1">JSON response:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1277.1">
$ curl --request GET 'http://localhost:8080/api/v1/carts/1' --header 'Accept: application/json'{
  "errorCode":"PACKT-0001",
  "message":"The system is unable to complete the request.
</span><span class="koboSpan" id="kobo.1277.2">            Contact system support.",
  "status":500,
  "url":"http://localhost:8080/api/v1/carts/1",
  "reqMethod":"GET"
}</span></pre>
<p><span class="koboSpan" id="kobo.1278.1">Similarly, we can also call the API to add an item to the cart, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1279.1">shown here:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1280.1">
$ curl --request POST 'http://localhost:8080/api/v1/carts/1/items' \ --header 'Content-Type: application/json' \
 --header 'Accept: application/json' \
 --data-raw '{
 "id": "1",
 "quantity": 1,
 "unitPrice": 2.5
 }'
[]</span></pre>
<p><span class="koboSpan" id="kobo.1281.1">Here, we get </span><strong class="source-inline"><span class="koboSpan" id="kobo.1282.1">[]</span></strong><span class="koboSpan" id="kobo.1283.1"> (an empty array) as a response because, in the implementation, we just return the empty collection. </span><span class="koboSpan" id="kobo.1283.2">You need to provide the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1284.1">Content-Type</span></strong><span class="koboSpan" id="kobo.1285.1"> header in this request because we send the payload (item object) along with the request. </span><span class="koboSpan" id="kobo.1285.2">You can change </span><strong class="source-inline"><span class="koboSpan" id="kobo.1286.1">Content-Type</span></strong><span class="koboSpan" id="kobo.1287.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1288.1">application/xml</span></strong><span class="koboSpan" id="kobo.1289.1"> if the payload is written in XML. </span><span class="koboSpan" id="kobo.1289.2">If the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1290.1">Accept</span></strong><span class="koboSpan" id="kobo.1291.1"> header value is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1292.1">application/xml</span></strong><span class="koboSpan" id="kobo.1293.1">, it will return the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1294.1">&lt;List/&gt;</span></strong><span class="koboSpan" id="kobo.1295.1"> value. </span><span class="koboSpan" id="kobo.1295.2">You can remove/change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1296.1">Content-Type</span></strong><span class="koboSpan" id="kobo.1297.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1298.1">Accept</span></strong><span class="koboSpan" id="kobo.1299.1"> headers or use the malformed </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.1300.1">JSON or XML to test the other </span><span class="No-Break"><span class="koboSpan" id="kobo.1301.1">error response.</span></span></p>
<p><span class="koboSpan" id="kobo.1302.1">This way, we can generate the API description using OpenAPI and then use the generated models and API Java interfaces to implement </span><span class="No-Break"><span class="koboSpan" id="kobo.1303.1">the APIs.</span></span></p>
<h1 id="_idParaDest-94"><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.1304.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1305.1">In this chapter, we opted for the design-first approach to writing RESTful web services. </span><span class="koboSpan" id="kobo.1305.2">You learned how to write an API description using OAS and how to generate models and API Java interfaces using the Swagger Codegen tool (using the Gradle plugin). </span><span class="koboSpan" id="kobo.1305.3">We also implemented a Global Exception Handler to centralize the handling of all the exceptions. </span><span class="koboSpan" id="kobo.1305.4">Once you have the API Java interfaces, you can write their implementations for business logic. </span><span class="koboSpan" id="kobo.1305.5">Now, you know how to use OAS and Swagger Codegen to write RESTful APIs. </span><span class="koboSpan" id="kobo.1305.6">You also now know how to handle </span><span class="No-Break"><span class="koboSpan" id="kobo.1306.1">exceptions globally.</span></span></p>
<p><span class="koboSpan" id="kobo.1307.1">In the next chapter, we’ll implement fully fledged API Java interfaces with business logic with </span><span class="No-Break"><span class="koboSpan" id="kobo.1308.1">database persistence.</span></span></p>
<h1 id="_idParaDest-95"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.1309.1">Questions</span></h1>
<ol>
<li><span class="koboSpan" id="kobo.1310.1">What is OpenAPI and how does </span><span class="No-Break"><span class="koboSpan" id="kobo.1311.1">it help?</span></span></li>
<li><span class="koboSpan" id="kobo.1312.1">How can you define a nested array in a model in a YAML </span><span class="No-Break"><span class="koboSpan" id="kobo.1313.1">OAS-based file?</span></span></li>
<li><span class="koboSpan" id="kobo.1314.1">What annotations do we need to implement a Global </span><span class="No-Break"><span class="koboSpan" id="kobo.1315.1">Exception Handler?</span></span></li>
<li><span class="koboSpan" id="kobo.1316.1">How can you use models or classes written in Java code in your </span><span class="No-Break"><span class="koboSpan" id="kobo.1317.1">OpenAPI description?</span></span></li>
<li><span class="koboSpan" id="kobo.1318.1">Why do we only generate models and API Java interfaces using </span><span class="No-Break"><span class="koboSpan" id="kobo.1319.1">Swagger Codegen?</span></span></li>
</ol>
<h1 id="_idParaDest-96"><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.1320.1">Answers</span></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.1321.1">OAS was introduced to solve at least a few aspects of a REST API’s specification and description. </span><span class="koboSpan" id="kobo.1321.2">It allows you to write REST APIs in the YAML or JSON markup languages, which allows you to interact with all stakeholders, including those who are non-technical, for review and discussion in the development phase. </span><span class="koboSpan" id="kobo.1321.3">It also allows you to generate documentation, models, interfaces, clients, and servers in </span><span class="No-Break"><span class="koboSpan" id="kobo.1322.1">different languages.</span></span></li>
<li><span class="koboSpan" id="kobo.1323.1">The array is defined using the </span><span class="No-Break"><span class="koboSpan" id="kobo.1324.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1325.1">
type: arrayitems:  type: array  items:    type: string</span></pre></li> <li><span class="koboSpan" id="kobo.1326.1">You need a class annotation, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1327.1">@ControllerAdvice</span></strong><span class="koboSpan" id="kobo.1328.1">, and a method annotation, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1329.1">@ExceptionHandler</span></strong><span class="koboSpan" id="kobo.1330.1">, to implement the Global </span><span class="No-Break"><span class="koboSpan" id="kobo.1331.1">Exception Handler.</span></span></li>
<li><span class="koboSpan" id="kobo.1332.1">You can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1333.1">--type-mappings</span></strong><span class="koboSpan" id="kobo.1334.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1335.1">--import-mappings</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.1336.1">rawOptions</span></strong><span class="koboSpan" id="kobo.1337.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1338.1">swaggerSources</span></strong><span class="koboSpan" id="kobo.1339.1"> task of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1340.1">build.gradle</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1341.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1342.1">We only generate the models and API Java interfaces using Swagger Codegen because this allows the complete implementation of controllers by </span><span class="No-Break"><span class="koboSpan" id="kobo.1343.1">developers only.</span></span></li>
</ol>
<h1 id="_idParaDest-97"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.1344.1">Further reading</span></h1>
<ul>
<li><span class="koboSpan" id="kobo.1345.1">OAS </span><span class="No-Break"><span class="koboSpan" id="kobo.1346.1">3.0: </span></span><a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.3.md"><span class="No-Break"><span class="koboSpan" id="kobo.1347.1">https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.3.md</span></span></a></li>
<li><span class="koboSpan" id="kobo.1348.1">The Gradle plugin for OpenAPI </span><span class="No-Break"><span class="koboSpan" id="kobo.1349.1">Codegen: </span></span><a href="https://github.com/int128/gradle-swagger-generator-plugin"><span class="No-Break"><span class="koboSpan" id="kobo.1350.1">https://github.com/int128/gradle-swagger-generator-plugin</span></span></a></li>
<li><span class="koboSpan" id="kobo.1351.1">OAS Code Generator configuration options for </span><span class="No-Break"><span class="koboSpan" id="kobo.1352.1">Spring: </span></span><a href="https://openapi-generator.tech/docs/generators/spring/"><span class="No-Break"><span class="koboSpan" id="kobo.1353.1">https://openapi-generator.tech/docs/generators/spring/</span></span></a></li>
<li><span class="koboSpan" id="kobo.1354.1">YAML </span><span class="No-Break"><span class="koboSpan" id="kobo.1355.1">specifications: </span></span><a href="https://yaml.org/spec/"><span class="No-Break"><span class="koboSpan" id="kobo.1356.1">https://yaml.org/spec/</span></span></a></li>
<li><span class="koboSpan" id="kobo.1357.1">Semantic </span><span class="No-Break"><span class="koboSpan" id="kobo.1358.1">versioning: </span></span><a href="https://semver.org/"><span class="No-Break"><span class="koboSpan" id="kobo.1359.1">https://semver.org/</span></span></a></li>
</ul>
</div>
</body></html>