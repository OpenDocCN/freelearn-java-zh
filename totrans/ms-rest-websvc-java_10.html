<html><head></head><body>
  <div id="_idContainer071">
   <h1 class="chapterNumber">
    <a id="_idTextAnchor223">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     8
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-210">
    <a id="_idTextAnchor224">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Testing Strategies for Robust APIs
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.3.1">
     While researching and drafting this chapter, we had a completely different vision in mind.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     The original plan was to write a traditional piece on testing APIs, a structured, methodical exploration of established practices.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     The focus was going to be on the tools and techniques that have been
    </span>
    <a id="_idIndexMarker594">
    </a>
    <span class="koboSpan" id="kobo.4.1">
     staples of
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.5.1">
      API testing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     for years, such as Postman, Bruno, and various mocking frameworks.
    </span>
    <span class="koboSpan" id="kobo.6.2">
     These tools have been essential in helping engineers ensure API reliability and are still widely used, particularly in projects with legacy systems.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.7.1">
     However, the more we thought about the topic, it became clear that the landscape of software testing has
    </span>
    <a id="_idIndexMarker595">
    </a>
    <span class="koboSpan" id="kobo.8.1">
     undergone a significant shift.
    </span>
    <span class="koboSpan" id="kobo.8.2">
     The rise of
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.9.1">
      generative AI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.10.1">
     and
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.11.1">
      large language models
     </span>
    </strong>
    <span class="koboSpan" id="kobo.12.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.13.1">
      LLMs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.14.1">
     )—such as ChatGPT, Gemini, and similar tools—has fundamentally
    </span>
    <a id="_idIndexMarker596">
    </a>
    <span class="koboSpan" id="kobo.15.1">
     transformed how we approach software development, including testing.
    </span>
    <span class="koboSpan" id="kobo.15.2">
     What was once a slow and often repetitive process has now evolved into a dynamic, AI-enhanced workflow.
    </span>
    <span class="koboSpan" id="kobo.15.3">
     Generative AI doesn’t just make writing tests faster; it makes the entire process more engaging, efficient, and effective.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.16.1">
     This transformation isn’t just about convenience.
    </span>
    <span class="koboSpan" id="kobo.16.2">
     The integration of generative AI into API testing has far-reaching benefits for everyone involved in the software development lifecycle.
    </span>
    <span class="koboSpan" id="kobo.16.3">
     Engineers can now focus on higher-level problem solving rather than being bogged down by tedious test creation.
    </span>
    <span class="koboSpan" id="kobo.16.4">
     Product managers and owners gain greater confidence in the quality of their APIs, knowing that testing has become more thorough and adaptive.
    </span>
    <span class="koboSpan" id="kobo.16.5">
     The results are more meaningful, ensuring that APIs meet real-world needs while maintaining the highest quality standards.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.17.1">
     This chapter, therefore, is not the one originally set out to be written.
    </span>
    <span class="koboSpan" id="kobo.17.2">
     We have shifted focus entirely to reflect this new reality.
    </span>
    <span class="koboSpan" id="kobo.17.3">
     Here, we’ll explore how generative AI can revolutionize the way we write tests for APIs, providing insights and techniques to help you leverage this game-changing technology.
    </span>
    <span class="koboSpan" id="kobo.17.4">
     By embracing these advancements, we can create better APIs, foster collaboration, and deliver software that exceeds expectations.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.18.1">
     In this chapter, we’re going to cover the following topics:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.19.1">
      Types of tests
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.20.1">
      Test format and tooling
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.21.1">
      Prompt engineering for testing
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.22.1">
      Preparing a development environment
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.23.1">
      Running and evolving the code
     </span>
    </li>
   </ul>
   <h1 class="heading-1" id="_idParaDest-211">
    <a id="_idTextAnchor225">
    </a>
    <span class="koboSpan" id="kobo.24.1">
     Technical requirements
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.25.1">
     One of the advantages of focusing on these new ideas for integration and regression tests is in tools and installations.
    </span>
    <span class="koboSpan" id="kobo.25.2">
     If you can run a JavaJUnit test on your local machine, you already have everything needed to run a test.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.26.1">
     We will also utilize Docker to deploy our applications and dependencies locally.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.27.1">
     You will also need access to an LLM.
    </span>
    <span class="koboSpan" id="kobo.27.2">
     Any of the freely available LLMs should work well (ChatGPT, Gemini, Claude, …).
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-212">
    <a id="_idTextAnchor226">
    </a>
    <span class="koboSpan" id="kobo.28.1">
     Types of tests
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.29.1">
     With a few
    </span>
    <a id="_idIndexMarker597">
    </a>
    <span class="koboSpan" id="kobo.30.1">
     minutes of online search, one can identify 19 different types of tests commonly referenced in the industry, and I’m sure there are a few more:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.31.1">
       Functional testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.32.1">
      : Validates
     </span>
     <a id="_idIndexMarker598">
     </a>
     <span class="koboSpan" id="kobo.33.1">
      that the API functions
     </span>
     <a id="_idIndexMarker599">
     </a>
     <span class="koboSpan" id="kobo.34.1">
      as expected by checking its behavior against specified requirements
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.35.1">
       Integration testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.36.1">
      : Ensures
     </span>
     <a id="_idIndexMarker600">
     </a>
     <span class="koboSpan" id="kobo.37.1">
      the API interacts
     </span>
     <a id="_idIndexMarker601">
     </a>
     <span class="koboSpan" id="kobo.38.1">
      correctly with other software components, systems, or APIs
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.39.1">
       Unit testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.40.1">
      : Tests
     </span>
     <a id="_idIndexMarker602">
     </a>
     <span class="koboSpan" id="kobo.41.1">
      individual
     </span>
     <a id="_idIndexMarker603">
     </a>
     <span class="koboSpan" id="kobo.42.1">
      units or components of the API in isolation
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.43.1">
       Performance testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.44.1">
      : Evaluates
     </span>
     <a id="_idIndexMarker604">
     </a>
     <span class="koboSpan" id="kobo.45.1">
      the API’s responsiveness, scalability, and
     </span>
     <a id="_idIndexMarker605">
     </a>
     <span class="koboSpan" id="kobo.46.1">
      stability under different conditions
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.47.1">
       Load testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.48.1">
      : Checks
     </span>
     <a id="_idIndexMarker606">
     </a>
     <span class="koboSpan" id="kobo.49.1">
      how the
     </span>
     <a id="_idIndexMarker607">
     </a>
     <span class="koboSpan" id="kobo.50.1">
      API handles expected user traffic
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.51.1">
       Stress testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.52.1">
      : Pushes
     </span>
     <a id="_idIndexMarker608">
     </a>
     <span class="koboSpan" id="kobo.53.1">
      the API
     </span>
     <a id="_idIndexMarker609">
     </a>
     <span class="koboSpan" id="kobo.54.1">
      beyond its limits to find breaking points
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.55.1">
       Spike testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.56.1">
      : Assesses
     </span>
     <a id="_idIndexMarker610">
     </a>
     <span class="koboSpan" id="kobo.57.1">
      the API’s reaction to sudden
     </span>
     <a id="_idIndexMarker611">
     </a>
     <span class="koboSpan" id="kobo.58.1">
      traffic spikes
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.59.1">
       Soak testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.60.1">
      : Monitors
     </span>
     <a id="_idIndexMarker612">
     </a>
     <span class="koboSpan" id="kobo.61.1">
      the API’s performance over an extended
     </span>
     <a id="_idIndexMarker613">
     </a>
     <span class="koboSpan" id="kobo.62.1">
      period under sustained load
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.63.1">
       Security testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.64.1">
      : Ensures
     </span>
     <a id="_idIndexMarker614">
     </a>
     <span class="koboSpan" id="kobo.65.1">
      the API is secure from vulnerabilities
     </span>
     <a id="_idIndexMarker615">
     </a>
     <span class="koboSpan" id="kobo.66.1">
      and unauthorized access
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.67.1">
       Validation testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.68.1">
      : Verifies
     </span>
     <a id="_idIndexMarker616">
     </a>
     <span class="koboSpan" id="kobo.69.1">
      the API meets the expected
     </span>
     <a id="_idIndexMarker617">
     </a>
     <span class="koboSpan" id="kobo.70.1">
      system and business requirements as a whole
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.71.1">
       Usability testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.72.1">
      : Ensures
     </span>
     <a id="_idIndexMarker618">
     </a>
     <span class="koboSpan" id="kobo.73.1">
      the API is easy to understand
     </span>
     <a id="_idIndexMarker619">
     </a>
     <span class="koboSpan" id="kobo.74.1">
      and use by developers
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.75.1">
       Regression testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.76.1">
      : Ensures
     </span>
     <a id="_idIndexMarker620">
     </a>
     <span class="koboSpan" id="kobo.77.1">
      new changes or updates to
     </span>
     <a id="_idIndexMarker621">
     </a>
     <span class="koboSpan" id="kobo.78.1">
      the API do not break existing functionality
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.79.1">
       Compliance testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.80.1">
      : Verifies
     </span>
     <a id="_idIndexMarker622">
     </a>
     <span class="koboSpan" id="kobo.81.1">
      the API meets specific
     </span>
     <a id="_idIndexMarker623">
     </a>
     <span class="koboSpan" id="kobo.82.1">
      legal, regulatory, or industry standards
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.83.1">
       Exploratory testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.84.1">
      : Performs
     </span>
     <a id="_idIndexMarker624">
     </a>
     <span class="koboSpan" id="kobo.85.1">
      unscripted interactions
     </span>
     <a id="_idIndexMarker625">
     </a>
     <span class="koboSpan" id="kobo.86.1">
      with the API to uncover unexpected issues
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.87.1">
       Interoperability testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.88.1">
      : Verifies
     </span>
     <a id="_idIndexMarker626">
     </a>
     <span class="koboSpan" id="kobo.89.1">
      the API works correctly
     </span>
     <a id="_idIndexMarker627">
     </a>
     <span class="koboSpan" id="kobo.90.1">
      with different platforms, languages, and environments
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.91.1">
       Fuzz testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.92.1">
      : Identifies
     </span>
     <a id="_idIndexMarker628">
     </a>
     <span class="koboSpan" id="kobo.93.1">
      vulnerabilities by sending random, malformed, or
     </span>
     <a id="_idIndexMarker629">
     </a>
     <span class="koboSpan" id="kobo.94.1">
      unexpected data to the API
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.95.1">
       End-to-end testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.96.1">
      : Validates
     </span>
     <a id="_idIndexMarker630">
     </a>
     <span class="koboSpan" id="kobo.97.1">
      entire workflows
     </span>
     <a id="_idIndexMarker631">
     </a>
     <span class="koboSpan" id="kobo.98.1">
      or user scenarios involving the API
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.99.1">
       Data testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.100.1">
      : Ensures
     </span>
     <a id="_idIndexMarker632">
     </a>
     <span class="koboSpan" id="kobo.101.1">
      the integrity and correctness of the data
     </span>
     <a id="_idIndexMarker633">
     </a>
     <span class="koboSpan" id="kobo.102.1">
      processed or stored by the API
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.103.1">
       Mock and sandbox testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.104.1">
      : Tests
     </span>
     <a id="_idIndexMarker634">
     </a>
     <span class="koboSpan" id="kobo.105.1">
      API functionality in
     </span>
     <a id="_idIndexMarker635">
     </a>
     <span class="koboSpan" id="kobo.106.1">
      isolation or
     </span>
     <a id="_idIndexMarker636">
     </a>
     <span class="koboSpan" id="kobo.107.1">
      simulates environments
     </span>
     <a id="_idIndexMarker637">
     </a>
     <span class="koboSpan" id="kobo.108.1">
      without impacting live systems
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.109.1">
     Clearly, a comprehensive
    </span>
    <a id="_idIndexMarker638">
    </a>
    <span class="koboSpan" id="kobo.110.1">
     discussion on all these types of testing would require an entire book or more.
    </span>
    <span class="koboSpan" id="kobo.110.2">
     Therefore, in this chapter, we will focus on a few specific types of testing: functional, regression, and validation tests.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.111.1">
     Why these specific types of tests?
    </span>
    <span class="koboSpan" id="kobo.111.2">
     Well, as stated earlier, the main goal is to help software engineers create better APIs.
    </span>
    <span class="koboSpan" id="kobo.111.3">
     Among the various types of tests, functional, regression, and validation provide the most value in achieving this goal.
    </span>
    <span class="koboSpan" id="kobo.111.4">
     Their primary benefit is the confidence they instill when making changes.
    </span>
    <span class="koboSpan" id="kobo.111.5">
     One of the biggest challenges software engineers face is the unpredictable consequences of modifying code.
    </span>
    <span class="koboSpan" id="kobo.111.6">
     Changes needed to address one problem might inadvertently break something else.
    </span>
    <span class="koboSpan" id="kobo.111.7">
     This problem is both common and paralyzing.
    </span>
    <span class="koboSpan" id="kobo.111.8">
     How can we ensure that our changes won’t disrupt existing functionality?
    </span>
    <span class="koboSpan" id="kobo.111.9">
     By prioritizing functional and regression testing, we can tackle this concern head-on, ensuring the API continues to meet its requirements while safeguarding against unintended consequences
    </span>
    <a id="_idIndexMarker639">
    </a>
    <span class="koboSpan" id="kobo.112.1">
     introduced by new changes.
    </span>
    <span class="koboSpan" id="kobo.112.2">
     This is the essence of the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.113.1">
      test-driven development
     </span>
    </strong>
    <span class="koboSpan" id="kobo.114.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.115.1">
      TDD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.116.1">
     ) methodology that started in the early 2000s.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.117.1">
     However, creating and maintaining comprehensive test sets is a resource-intensive process, both in terms of time and cost.
    </span>
    <span class="koboSpan" id="kobo.117.2">
     Writing effective tests requires a deep understanding of the system, careful planning, and meticulous implementation.
    </span>
    <span class="koboSpan" id="kobo.117.3">
     Once written, these tests must be regularly updated
    </span>
    <a id="_idIndexMarker640">
    </a>
    <span class="koboSpan" id="kobo.118.1">
     and adapted to reflect changes in the system, which adds to the ongoing maintenance effort.
    </span>
    <span class="koboSpan" id="kobo.118.2">
     This level of investment can be difficult for organizations to justify, especially in fast-paced environments where tight deadlines and budget constraints are common.
    </span>
    <span class="koboSpan" id="kobo.118.3">
     As a result, many projects have historically deprioritized testing, often preventing development teams from dedicating the time and resources needed to build robust test suites.
    </span>
    <span class="koboSpan" id="kobo.118.4">
     This short-sighted approach may save effort in the short term but often leads to higher costs later when defects surface, affecting system reliability and customer satisfaction.
    </span>
    <span class="koboSpan" id="kobo.118.5">
     Also, let’s be honest—writing tests can be boring, and it’s a sentiment shared by many in the industry.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.119.1">
     Then, in November of 2022, the introduction of generative AI completely transformed the creation of software tests.
    </span>
    <span class="koboSpan" id="kobo.119.2">
     Generative AI has become an incredible asset in writing tests.
    </span>
    <span class="koboSpan" id="kobo.119.3">
     While there’s an ongoing debate about its impact on developing actual business logic—a discussion for another time—for testing purposes, it’s a phenomenal tool.
    </span>
    <span class="koboSpan" id="kobo.119.4">
     We will leverage generative AI extensively to write our tests and assist in their development.
    </span>
    <span class="koboSpan" id="kobo.119.5">
     This innovation not only enhances the value of functional and regression testing for software engineers but also makes these tests much easier and cheaper to write.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-213">
    <a id="_idTextAnchor227">
    </a>
    <span class="koboSpan" id="kobo.120.1">
     Test format and tooling
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.121.1">
     When it comes to testing APIs, we have access to a variety of tools and formats, each serving different needs
    </span>
    <a id="_idIndexMarker641">
    </a>
    <span class="koboSpan" id="kobo.122.1">
     and levels of expertise.
    </span>
    <span class="koboSpan" id="kobo.122.2">
     Tools such as Postman and Bruno provide user-friendly
    </span>
    <a id="_idIndexMarker642">
    </a>
    <span class="koboSpan" id="kobo.123.1">
     interfaces for building, managing, and running API tests.
    </span>
    <span class="koboSpan" id="kobo.123.2">
     These tools are especially useful for quick exploratory testing or for creating manual test workflows.
    </span>
    <span class="koboSpan" id="kobo.123.3">
     They excel in environments where visual representation and non-technical collaboration are essential.
    </span>
    <span class="koboSpan" id="kobo.123.4">
     However, when we shift our focus to automated, scalable, and pipeline-ready testing, tools such as JUnit, which are integrated directly into the development ecosystem, offer significant advantages.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.124.1">
     Tools such as Postman
    </span>
    <a id="_idIndexMarker643">
    </a>
    <span class="koboSpan" id="kobo.125.1">
     allow users to design API tests with minimal coding, making them accessible to a broader audience.
    </span>
    <span class="koboSpan" id="kobo.125.2">
     These tools often include features such as sharing test collections, generating test documentation, and providing real-time visual results.
    </span>
    <span class="koboSpan" id="kobo.125.3">
     Despite these strengths, they fall short when integrated into sophisticated CI/CD pipelines.
    </span>
    <span class="koboSpan" id="kobo.125.4">
     Exporting and running tests
    </span>
    <a id="_idIndexMarker644">
    </a>
    <span class="koboSpan" id="kobo.126.1">
     from Postman or Bruno often require additional tooling or manual steps, and they lack the seamless compatibility with source control systems such as Git that code-based
    </span>
    <a id="_idIndexMarker645">
    </a>
    <span class="koboSpan" id="kobo.127.1">
     testing frameworks offer.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.128.1">
     In contrast, JUnit, a widely
    </span>
    <a id="_idIndexMarker646">
    </a>
    <span class="koboSpan" id="kobo.129.1">
     used testing framework for Java, provides a code-first approach to testing APIs.
    </span>
    <span class="koboSpan" id="kobo.129.2">
     By writing API tests directly in Java using JUnit, developers can ensure their
    </span>
    <a id="_idIndexMarker647">
    </a>
    <span class="koboSpan" id="kobo.130.1">
     tests are treated as part of the source code.
    </span>
    <span class="koboSpan" id="kobo.130.2">
     This approach brings several advantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.131.1">
       Integration into deployment pipelines
      </span>
     </strong>
     <span class="koboSpan" id="kobo.132.1">
      : JUnit tests are inherently compatible with CI/CD tools such as Jenkins, GitHub Actions, and GitLab CI.
     </span>
     <span class="koboSpan" id="kobo.132.2">
      This allows API tests to run automatically during builds or deployments, ensuring that no changes go live without thorough testing.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.133.1">
       Leverage of source code infrastructure
      </span>
     </strong>
     <span class="koboSpan" id="kobo.134.1">
      : Because JUnit tests are written in pure code, they benefit from the same tools and workflows used for the application code itself—version control, peer reviews, static analysis, and more.
     </span>
     <span class="koboSpan" id="kobo.134.2">
      This consistency reduces complexity and ensures tests are always in sync with the application.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.135.1">
       Scalability and maintainability
      </span>
     </strong>
     <span class="koboSpan" id="kobo.136.1">
      : Code-based tests are easier to maintain as they evolve alongside the application.
     </span>
     <span class="koboSpan" id="kobo.136.2">
      Refactoring tools, IDE features, and linters help developers quickly adapt tests when APIs change, minimizing the risk of outdated or broken tests.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.137.1">
       Reusability and customization
      </span>
     </strong>
     <span class="koboSpan" id="kobo.138.1">
      : JUnit enables developers to write reusable test helpers and utilities, providing greater flexibility for complex testing scenarios.
     </span>
     <span class="koboSpan" id="kobo.138.2">
      It also supports advanced features such as parameterized tests, mock environments, and dependency injections.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.139.1">
     Additionally, JUnit’s ability to directly call real APIs—whether deployed locally or in a test environment—ensures that tests mimic real-world usage.
    </span>
    <span class="koboSpan" id="kobo.139.2">
     This helps catch issues such as incorrect request formatting, unexpected responses, or performance bottlenecks, which can be missed in abstracted environments such as Postman or Bruno.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.140.1">
     While Postman and Bruno are excellent for quick, one-off testing or for collaborating with non-developers, JUnit (and similar code-first tools) is the superior option for teams aiming to achieve robust, automated, and pipeline-integrated testing.
    </span>
    <span class="koboSpan" id="kobo.140.2">
     By treating API tests as first-class citizens within the code base, developers can maximize efficiency, scalability, and confidence in their APIs.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.141.1">
     Leveraging the strengths of automated testing is essential, yet AI is beginning to redefine testing entirely and a new approach to testing has appeared.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.142.1">
     The evolution of
    </span>
    <a id="_idIndexMarker648">
    </a>
    <span class="koboSpan" id="kobo.143.1">
     software development practices has always revolved around improving efficiency, quality, and collaboration.
    </span>
    <span class="koboSpan" id="kobo.143.2">
     One such recent advancement is the integration of
    </span>
    <a id="_idIndexMarker649">
    </a>
    <span class="koboSpan" id="kobo.144.1">
     generative AI into Agile software development, particularly within the SCRUM framework (see
    </span>
    <a href="https://www.scrum.org/resources/what-scrum-module">
     <span class="url">
      <span class="koboSpan" id="kobo.145.1">
       https://www.scrum.org/resources/what-scrum-module
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.146.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.146.2">
     Some teams are already experimenting with a new practice where prompts for AI-driven testing become an integral part of the development process, transforming how teams define, implement, and validate new features.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.147.1">
     In this updated workflow, the Technical Lead, in collaboration with the Product Owner, plays a pivotal role in shaping the development and testing lifecycle.
    </span>
    <span class="koboSpan" id="kobo.147.2">
     When a new story is defined, a feature or enhancement to an API is introduced, and the Technical Lead crafts detailed prompts designed for generative AI tools.
    </span>
    <span class="koboSpan" id="kobo.147.3">
     These prompts serve as the blueprint for testing the story’s acceptance criteria.
    </span>
    <span class="koboSpan" id="kobo.147.4">
     By leveraging the domain expertise of both the Technical Lead and the Product Owner, the prompts encapsulate not only the technical requirements but also the business context and expected outcomes of the feature.
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.148.1">
     <img alt="Figure 8.1 – Incorporating AI-driven prompts into Agile SCRUM workflows" src="../Images/B21843_08_1.jpg"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.149.1">
     Figure 8.1 – Incorporating AI-driven prompts into Agile SCRUM workflows
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.150.1">
     For example, if a new API endpoint is being added to return a customer’s transaction history, the prompt might specify the exact input parameters, the expected structure of the JSON response, and edge cases to test, such as handling invalid input or empty datasets.
    </span>
    <span class="koboSpan" id="kobo.150.2">
     These prompts are more than just instructions—they’re a shared artifact that bridges technical and business perspectives, ensuring alignment and clarity.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.151.1">
     This integration
    </span>
    <a id="_idIndexMarker650">
    </a>
    <span class="koboSpan" id="kobo.152.1">
     of generative AI into Agile workflows offers several significant advantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.153.1">
       Consistency
      </span>
     </strong>
     <span class="koboSpan" id="kobo.154.1">
      : Standardized prompts ensure a consistent approach to testing across stories, reducing variability and improving reliability
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.155.1">
       Efficiency
      </span>
     </strong>
     <span class="koboSpan" id="kobo.156.1">
      : By automating the generation of test cases, developers can focus on coding the feature itself, reducing repetitive tasks and freeing up time for innovation
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.157.1">
       Collaboration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.158.1">
      : The joint creation of prompts by Technical Leads and Product Owners fosters better communication and alignment between technical and business teams
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.159.1">
       Quality assurance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.160.1">
      : Prompts encourage the team to think critically about edge cases, error handling, and expected outcomes from the start, reducing bugs and rework down the line
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-214">
    <a id="_idTextAnchor228">
    </a>
    <span class="koboSpan" id="kobo.161.1">
     Storing prompts in the code base
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.162.1">
     To solidify the importance of these prompts, they are stored in the project’s Git repository alongside the
    </span>
    <a id="_idIndexMarker651">
    </a>
    <span class="koboSpan" id="kobo.163.1">
     source code.
    </span>
    <span class="koboSpan" id="kobo.163.2">
     This integration elevates
    </span>
    <a id="_idIndexMarker652">
    </a>
    <span class="koboSpan" id="kobo.164.1">
     prompts to a first-class citizen within the development lifecycle, treating them with the same rigor as the code itself.
    </span>
    <span class="koboSpan" id="kobo.164.2">
     Storing prompts in Git provides
    </span>
    <a id="_idIndexMarker653">
    </a>
    <span class="koboSpan" id="kobo.165.1">
     several key benefits:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.166.1">
       Version control
      </span>
     </strong>
     <span class="koboSpan" id="kobo.167.1">
      : Prompts evolve as features mature or requirements change.
     </span>
     <span class="koboSpan" id="kobo.167.2">
      Storing them in Git ensures a complete history of modifications, enabling teams to trace changes over time.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.168.1">
       Collaboration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.169.1">
      : Developers can review and refine prompts during code reviews, ensuring their accuracy and relevance before implementation begins.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.170.1">
       Traceability
      </span>
     </strong>
     <span class="koboSpan" id="kobo.171.1">
      : Linking prompts to specific stories, commits, and branches creates a transparent and auditable process that ties testing directly to development efforts.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.172.1">
       Reusability
      </span>
     </strong>
     <span class="koboSpan" id="kobo.173.1">
      : Over time, prompts for similar features or scenarios can be repurposed, reducing redundancy and accelerating future development cycles.
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-215">
    <a id="_idTextAnchor229">
    </a>
    <span class="koboSpan" id="kobo.174.1">
     AI-generated code as acceptance criteria
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.175.1">
     Once the prompts are finalized and stored, they become an integral part of the story’s acceptance criteria.
    </span>
    <span class="koboSpan" id="kobo.175.2">
     The assigned software engineer uses the prompt to generate test cases or other
    </span>
    <a id="_idIndexMarker654">
    </a>
    <span class="koboSpan" id="kobo.176.1">
     relevant code through generative AI tools.
    </span>
    <span class="koboSpan" id="kobo.176.2">
     This generated code
    </span>
    <a id="_idIndexMarker655">
    </a>
    <span class="koboSpan" id="kobo.177.1">
     acts as a baseline for validating the new feature.
    </span>
    <span class="koboSpan" id="kobo.177.2">
     The key requirement is that the generated code must pass successfully—be
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.178.1">
      green
     </span>
    </em>
    <span class="koboSpan" id="kobo.179.1">
     —before the story is marked as complete.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.180.1">
     This approach introduces a new layer of rigor to the definition of
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.181.1">
      done
     </span>
    </em>
    <span class="koboSpan" id="kobo.182.1">
     in SCRUM.
    </span>
    <span class="koboSpan" id="kobo.182.2">
     It ensures that testing is not an afterthought but a parallel process that evolves alongside the feature’s development.
    </span>
    <span class="koboSpan" id="kobo.182.3">
     Additionally, by automating large portions of the testing process through AI, teams can deliver high-quality software faster, with fewer manual testing bottlenecks.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.183.1">
     Integrating AI-driven testing into Agile practices demands more than tools—it requires a cultural shift.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-216">
    <a id="_idTextAnchor230">
    </a>
    <span class="koboSpan" id="kobo.184.1">
     Adopting a new Agile mindset
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.185.1">
     This practice represents a shift in mindset for Agile teams.
    </span>
    <span class="koboSpan" id="kobo.185.2">
     The act of defining prompts moves testing considerations
    </span>
    <a id="_idIndexMarker656">
    </a>
    <span class="koboSpan" id="kobo.186.1">
     to earlier in the development process, aligning with
    </span>
    <a id="_idIndexMarker657">
    </a>
    <span class="koboSpan" id="kobo.187.1">
     the principles of TDD.
    </span>
    <span class="koboSpan" id="kobo.187.2">
     It emphasizes the importance of testing not just as a verification step but as a collaborative, iterative process that enhances the overall quality of the software.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.188.1">
     By embedding AI-driven testing prompts into the Agile workflow, teams not only embrace the power of generative AI but also elevate their development practices to a new level of precision and efficiency.
    </span>
    <span class="koboSpan" id="kobo.188.2">
     This approach aligns perfectly with the goals of Agile: to deliver value faster, adapt to change effectively, and maintain a high standard of quality throughout the development lifecycle.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-217">
    <a id="_idTextAnchor231">
    </a>
    <span class="koboSpan" id="kobo.189.1">
     The structure of an API test environment
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.190.1">
     The goal
    </span>
    <a id="_idIndexMarker658">
    </a>
    <span class="koboSpan" id="kobo.191.1">
     of an API testing environment is to replicate all
    </span>
    <a id="_idIndexMarker659">
    </a>
    <span class="koboSpan" id="kobo.192.1">
     critical components of your application locally, facilitating comprehensive and realistic tests of your code.
    </span>
    <span class="koboSpan" id="kobo.192.2">
     The following figure illustrates a typical setup for such an environment, emphasizing a self-contained system suitable for development and testing purposes.
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.193.1">
     <img alt="Figure 8.2 – Typical structure of a local API testing environment using Docker and cloud networks" src="../Images/B21843_08_2.jpg"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.194.1">
     Figure 8.2 – Typical structure of a local API testing environment using Docker and cloud networks
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.195.1">
     In this diagram,
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.196.1">
      API App
     </span>
    </strong>
    <span class="koboSpan" id="kobo.197.1">
     represents the primary application whose APIs you are testing.
    </span>
    <span class="koboSpan" id="kobo.197.2">
     This app connects directly to essential backend components such as databases, caching services, or messaging queues, all deployed within a containerized (Docker) or cloud-based, non-production
    </span>
    <a id="_idIndexMarker660">
    </a>
    <span class="koboSpan" id="kobo.198.1">
     network environment.
    </span>
    <span class="koboSpan" id="kobo.198.2">
     The
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.199.1">
      API Tests
     </span>
    </strong>
    <span class="koboSpan" id="kobo.200.1">
     component directly
    </span>
    <a id="_idIndexMarker661">
    </a>
    <span class="koboSpan" id="kobo.201.1">
     interacts with
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.202.1">
      API App
     </span>
    </strong>
    <span class="koboSpan" id="kobo.203.1">
     , simulating real-world scenarios and ensuring thorough coverage and validation of API functionality.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.204.1">
     The term “local” here is flexible: it can refer to an individual software engineer’s machine, typically using Docker containers, or any non-production cloud-based environment provisioned for development purposes.
    </span>
    <span class="koboSpan" id="kobo.204.2">
     Ensuring every team member has access to such standardized, isolated environments is crucial, allowing consistent and repeatable tests across different workstations and reducing variability in test outcomes.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.205.1">
     There is an upfront effort involved in creating this local or development environment.
    </span>
    <span class="koboSpan" id="kobo.205.2">
     However, making this investment early in the development lifecycle significantly enhances efficiency, reducing the risk of integration issues and accelerating overall development.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-218">
    <a id="_idTextAnchor232">
    </a>
    <span class="koboSpan" id="kobo.206.1">
     “Prompting” the LLMs
    </span>
   </h1>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.207.1">
      Prompt engineering
     </span>
    </strong>
    <span class="koboSpan" id="kobo.208.1">
     is the practice of designing and refining prompts given to generative AI models to
    </span>
    <a id="_idIndexMarker662">
    </a>
    <span class="koboSpan" id="kobo.209.1">
     produce precise, accurate, and relevant outputs.
    </span>
    <span class="koboSpan" id="kobo.209.2">
     It involves careful phrasing and iterative tuning to achieve desired responses efficiently.
    </span>
    <span class="koboSpan" id="kobo.209.3">
     And now let’s look at some mechanisms needed to create effective prompts for test generation.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.210.1">
     As was said before, the use of generative AI for software testing is a perfect application of this technology.
    </span>
    <span class="koboSpan" id="kobo.210.2">
     Specifically, tests are generally less sensitive in terms of intellectual property and ownership concerns.
    </span>
    <span class="koboSpan" id="kobo.210.3">
     Tests are primarily tools for validation, ensuring that your main code behaves as expected.
    </span>
    <span class="koboSpan" id="kobo.210.4">
     Since the focus of tests is on functionality, edge cases, and coverage, generative AI can quickly generate a wide variety of test cases, saving developers time and effort.
    </span>
    <span class="koboSpan" id="kobo.210.5">
     Moreover, tests are often repetitive and detail-oriented—tasks that AI excels at.
    </span>
    <span class="koboSpan" id="kobo.210.6">
     The use of generative AI here can allow developers to focus on more creative or complex aspects of their work, while the AI takes care of the grunt work.
    </span>
    <span class="koboSpan" id="kobo.210.7">
     This means better productivity, faster iteration, and higher test coverage with minimal manual effort.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.211.1">
     In contrast, when it comes to using generative AI to write the main production code, the situation becomes a little more complex.
    </span>
    <span class="koboSpan" id="kobo.211.2">
     A major concern is ownership of the generated code.
    </span>
    <span class="koboSpan" id="kobo.211.3">
     Depending on the terms of the AI service, the code you use might still be partially owned or influenced by the AI provider.
    </span>
    <span class="koboSpan" id="kobo.211.4">
     This can create legal or compliance issues, especially in industries where intellectual property is a critical asset.
    </span>
    <span class="koboSpan" id="kobo.211.5">
     Additionally, there’s the concern that your code—or patterns from it—could be used to train future AI models.
    </span>
    <span class="koboSpan" id="kobo.211.6">
     This could inadvertently expose proprietary algorithms, business logic, or sensitive methodologies to external entities.
    </span>
    <span class="koboSpan" id="kobo.211.7">
     While this may not be a major issue for tests (which are often more generic and less confidential), it can be a significant risk for production code, where the intellectual property and security of the organization are at stake.
    </span>
    <span class="koboSpan" id="kobo.211.8">
     At the time of writing, there are several legal decisions establishing that AI-generated content cannot be copyrighted
    </span>
    <span class="Footnote-reference">
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.212.1">
      [3][4]
     </span>
    </em>
    <span class="koboSpan" id="kobo.213.1">
     .
    </span>
    <span class="koboSpan" id="kobo.213.2">
     Now, we will create the actual prompts for our test.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-219">
    <a id="_idTextAnchor233">
    </a>
    <span class="koboSpan" id="kobo.214.1">
     Testing the Products API
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.215.1">
     The Products API
    </span>
    <a id="_idIndexMarker663">
    </a>
    <span class="koboSpan" id="kobo.216.1">
     that we have been using in this book
    </span>
    <a id="_idIndexMarker664">
    </a>
    <span class="koboSpan" id="kobo.217.1">
     is a very good use case for this new testing strategy.
    </span>
    <span class="koboSpan" id="kobo.217.2">
     Let’s look at a test-generating prompt for that API.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.218.1">
     Let’s start by creating a test to validate the creation of new products with the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.219.1">
      PUT
     </span>
    </code>
    <span class="koboSpan" id="kobo.220.1">
     method:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.221.1">Assuming the role of a Senior Software Engineer in charge of implementing a set of APIs to support the Products resource
Generate a JUnit 5 test case for the "Create or Update Product" API endpoint in a Spring Boot application.
</span><span class="koboSpan" id="kobo.221.2">The endpoint uses the HTTP PUT method at the path /api/products/{productId}, where {productId} is a path variable validated with the format AA99999.
</span><span class="koboSpan" id="kobo.221.3">The request body is a ProductInput object, and the response is a ProductOutput object.
</span><span class="koboSpan" id="kobo.221.4">The test should cover two scenarios:
1 - Creating a New Product: When a new productId is provided, the API should create a new product and return HTTP status 201 Created. </span><span class="koboSpan" id="kobo.221.5">Verify that the response body contains the expected ProductOutput.
</span><span class="koboSpan" id="kobo.221.6">2 - Updating an Existing Product: When an existing productId is provided, the API should update the product and return HTTP status 200 OK. </span><span class="koboSpan" id="kobo.221.7">Verify that the response body contains the updated ProductOutput.
</span><span class="koboSpan" id="kobo.221.8">Assume a running instance of this API running on http:8080
Include at least assertions for:
- HTTP status codes (201 Created and 200 OK)
- Response headers (if applicable)
- Response body content
- Validation that the productId follows the format AA99999
Structure the test methods clearly, using descriptive names for each scenario.
</span><span class="koboSpan" id="kobo.221.9">Product is defined by the following classes - assume the expected Get and Set methods are present.
</span><span class="koboSpan" id="kobo.221.10">public </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.222.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.223.1">Product</span></span><span class="koboSpan" id="kobo.224.1"> {
  private </span><span class="hljs-title"><span class="koboSpan" id="kobo.225.1">String</span></span><span class="koboSpan" id="kobo.226.1"> name;
  private </span><span class="hljs-title"><span class="koboSpan" id="kobo.227.1">String</span></span><span class="koboSpan" id="kobo.228.1"> sku;
  private </span><span class="hljs-title"><span class="koboSpan" id="kobo.229.1">String</span></span><span class="koboSpan" id="kobo.230.1"> description;
  private </span><span class="hljs-title"><span class="koboSpan" id="kobo.231.1">BigDecimal</span></span><span class="koboSpan" id="kobo.232.1"> price;
  public </span><span class="hljs-title"><span class="koboSpan" id="kobo.233.1">Product</span></span><span class="koboSpan" id="kobo.234.1">() {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.235.1">super</span></span><span class="koboSpan" id="kobo.236.1">();
  }
  public </span><span class="hljs-title"><span class="koboSpan" id="kobo.237.1">Product</span></span><span class="koboSpan" id="kobo.238.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.239.1">String</span></span><span class="koboSpan" id="kobo.240.1"> name, </span><span class="hljs-title"><span class="koboSpan" id="kobo.241.1">String</span></span><span class="koboSpan" id="kobo.242.1"> sku, </span><span class="hljs-title"><span class="koboSpan" id="kobo.243.1">String</span></span><span class="koboSpan" id="kobo.244.1"> description,
                 </span><span class="hljs-title"><span class="koboSpan" id="kobo.245.1">BigDecimal</span></span><span class="koboSpan" id="kobo.246.1"> price) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.247.1">this</span></span><span class="koboSpan" id="kobo.248.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.249.1">name</span></span><span class="koboSpan" id="kobo.250.1"> = name;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.251.1">this</span></span><span class="koboSpan" id="kobo.252.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.253.1">sku</span></span><span class="koboSpan" id="kobo.254.1"> = sku;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.255.1">this</span></span><span class="koboSpan" id="kobo.256.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.257.1">description</span></span><span class="koboSpan" id="kobo.258.1"> = description;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.259.1">this</span></span><span class="koboSpan" id="kobo.260.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.261.1">price</span></span><span class="koboSpan" id="kobo.262.1"> = price;
  }
}
public record </span><span class="hljs-title"><span class="koboSpan" id="kobo.263.1">ProductDescriptionInput</span></span><span class="koboSpan" id="kobo.264.1">(@</span><span class="hljs-title"><span class="koboSpan" id="kobo.265.1">NotBlank</span></span><span class="koboSpan" id="kobo.266.1">
                                      @</span><span class="hljs-title"><span class="koboSpan" id="kobo.267.1">Size</span></span><span class="koboSpan" id="kobo.268.1">(min = </span><span class="hljs-number"><span class="koboSpan" id="kobo.269.1">10</span></span><span class="koboSpan" id="kobo.270.1">, max = </span><span class="hljs-number"><span class="koboSpan" id="kobo.271.1">255</span></span><span class="koboSpan" id="kobo.272.1">)
                                      </span><span class="hljs-title"><span class="koboSpan" id="kobo.273.1">String</span></span><span class="koboSpan" id="kobo.274.1"> description) {
}
public record </span><span class="hljs-title"><span class="koboSpan" id="kobo.275.1">ProductInput</span></span><span class="koboSpan" id="kobo.276.1">(
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.277.1">NotBlank</span></span><span class="koboSpan" id="kobo.278.1">
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.279.1">Size</span></span><span class="koboSpan" id="kobo.280.1">(min = </span><span class="hljs-number"><span class="koboSpan" id="kobo.281.1">3</span></span><span class="koboSpan" id="kobo.282.1">, max = </span><span class="hljs-number"><span class="koboSpan" id="kobo.283.1">255</span></span><span class="koboSpan" id="kobo.284.1">)
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.285.1">JsonProperty</span></span><span class="koboSpan" id="kobo.286.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.287.1">"name"</span></span><span class="koboSpan" id="kobo.288.1">)
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.289.1">String</span></span><span class="koboSpan" id="kobo.290.1"> name,
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.291.1">NotBlank</span></span><span class="koboSpan" id="kobo.292.1">
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.293.1">Size</span></span><span class="koboSpan" id="kobo.294.1">(min = </span><span class="hljs-number"><span class="koboSpan" id="kobo.295.1">10</span></span><span class="koboSpan" id="kobo.296.1">, max = </span><span class="hljs-number"><span class="koboSpan" id="kobo.297.1">255</span></span><span class="koboSpan" id="kobo.298.1">)
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.299.1">JsonProperty</span></span><span class="koboSpan" id="kobo.300.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.301.1">"description"</span></span><span class="koboSpan" id="kobo.302.1">)
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.303.1">String</span></span><span class="koboSpan" id="kobo.304.1"> description,
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.305.1">NotNull</span></span><span class="koboSpan" id="kobo.306.1">
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.307.1">Positive</span></span><span class="koboSpan" id="kobo.308.1">
        @</span><span class="hljs-title"><span class="koboSpan" id="kobo.309.1">JsonProperty</span></span><span class="koboSpan" id="kobo.310.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.311.1">"price"</span></span><span class="koboSpan" id="kobo.312.1">)
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.313.1">BigDecimal</span></span><span class="koboSpan" id="kobo.314.1"> price) {
    public </span><span class="hljs-title"><span class="koboSpan" id="kobo.315.1">Product</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.316.1">toProduct</span></span><span class="koboSpan" id="kobo.317.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.318.1">String</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.319.1"> productId</span></span><span class="koboSpan" id="kobo.320.1">) {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.321.1">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.322.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.323.1">Product</span></span><span class="koboSpan" id="kobo.324.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.325.1">name</span></span><span class="koboSpan" id="kobo.326.1">(),
                productId,
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.327.1">description</span></span><span class="koboSpan" id="kobo.328.1">(),
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.329.1">price</span></span><span class="koboSpan" id="kobo.330.1">());
    }
}
public record </span><span class="hljs-title"><span class="koboSpan" id="kobo.331.1">ProductOutput</span></span><span class="koboSpan" id="kobo.332.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.333.1">String</span></span><span class="koboSpan" id="kobo.334.1"> name, </span><span class="hljs-title"><span class="koboSpan" id="kobo.335.1">String</span></span><span class="koboSpan" id="kobo.336.1"> sku, </span><span class="hljs-title"><span class="koboSpan" id="kobo.337.1">String</span></span><span class="koboSpan" id="kobo.338.1"> description, 
                            </span><span class="hljs-title"><span class="koboSpan" id="kobo.339.1">BigDecimal</span></span><span class="koboSpan" id="kobo.340.1"> price) {
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.341.1">
     Let’s look
    </span>
    <a id="_idIndexMarker665">
    </a>
    <span class="koboSpan" id="kobo.342.1">
     at each part of this prompt in more detail:
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.343.1">
     First, we define
    </span>
    <a id="_idIndexMarker666">
    </a>
    <span class="koboSpan" id="kobo.344.1">
     the LLM perspective.
    </span>
    <span class="koboSpan" id="kobo.344.2">
     This is relevant to establish the role the LLM should play, and it does influence the answers.
    </span>
    <span class="koboSpan" id="kobo.344.3">
     Sometimes it is clear in the resulting code when you tell the LLM to act as a senior or junior professional:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.345.1">"Assuming the role of a Senior Software Engineer in charge of implementing a set of APIs to support the Products resource"
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.346.1">
     Then, give a clear request:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.347.1">"Generate a JUnit 5 test case for the "Create or Update Product" API endpoint in a Spring Boot application."
</span><span class="koboSpan" id="kobo.347.2">"The test should cover two scenarios:… "
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.348.1">
     The LLM’s output is heavily influenced by what you want as a result.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.349.1">
     Next, explain the API behavior as clearly as possible.
    </span>
    <span class="koboSpan" id="kobo.349.2">
     This is important because if the underlying behavior is not clear then the LLM will try to fill in the blanks, sometimes with invalid assumptions.
    </span>
    <span class="koboSpan" id="kobo.349.3">
     The more details you add, the better the test cases created:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.350.1">"The endpoint uses the HTTP PUT method at the path /api/products/{productId}, …."
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.351.1">
     Part of these
    </span>
    <a id="_idIndexMarker667">
    </a>
    <span class="koboSpan" id="kobo.352.1">
     details is the code that defines the data
    </span>
    <a id="_idIndexMarker668">
    </a>
    <span class="koboSpan" id="kobo.353.1">
     being tested.
    </span>
    <span class="koboSpan" id="kobo.353.2">
     Either present the data structures used or the expected HTTP responses, but some form of unambiguous definition must be present.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.354.1">
     Finally, add any specific assertions we want the test to validate:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.355.1">"Include at least assertions for:
- HTTP status codes (201 Created and 200 OK)
- Response headers (if applicable) …"
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.356.1">
     The result of this prompt is the following code and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.357.1">
      pom.xml
     </span>
    </code>
    <span class="koboSpan" id="kobo.358.1">
     dependency elements:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.359.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.360.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.361.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.362.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.363.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.364.1">&gt;</span></span><span class="koboSpan" id="kobo.365.1">org.springframework.boot</span><span class="hljs-tag"><span class="koboSpan" id="kobo.366.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.367.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.368.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.369.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.370.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.371.1">&gt;</span></span><span class="koboSpan" id="kobo.372.1">spring-boot-starter-test</span><span class="hljs-tag"><span class="koboSpan" id="kobo.373.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.374.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.375.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.376.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.377.1">scope</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.378.1">&gt;</span></span><span class="koboSpan" id="kobo.379.1">test</span><span class="hljs-tag"><span class="koboSpan" id="kobo.380.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.381.1">scope</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.382.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.383.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.384.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.385.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.386.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.387.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.388.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.389.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.390.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.391.1">&gt;</span></span><span class="koboSpan" id="kobo.392.1">io.projectreactor</span><span class="hljs-tag"><span class="koboSpan" id="kobo.393.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.394.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.395.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.396.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.397.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.398.1">&gt;</span></span><span class="koboSpan" id="kobo.399.1">reactor-test</span><span class="hljs-tag"><span class="koboSpan" id="kobo.400.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.401.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.402.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.403.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.404.1">scope</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.405.1">&gt;</span></span><span class="koboSpan" id="kobo.406.1">test</span><span class="hljs-tag"><span class="koboSpan" id="kobo.407.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.408.1">scope</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.409.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.410.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.411.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.412.1">&gt;</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.413.1">import</span></span><span class="koboSpan" id="kobo.414.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.415.1">junit</span></span><span class="koboSpan" id="kobo.416.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.417.1">jupiter</span></span><span class="koboSpan" id="kobo.418.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.419.1">api</span></span><span class="koboSpan" id="kobo.420.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.421.1">Test</span></span><span class="koboSpan" id="kobo.422.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.423.1">import</span></span><span class="koboSpan" id="kobo.424.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.425.1">springframework</span></span><span class="koboSpan" id="kobo.426.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.427.1">beans</span></span><span class="koboSpan" id="kobo.428.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.429.1">factory</span></span><span class="koboSpan" id="kobo.430.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.431.1">annotation</span></span><span class="koboSpan" id="kobo.432.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.433.1">Autowired</span></span><span class="koboSpan" id="kobo.434.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.435.1">import</span></span><span class="koboSpan" id="kobo.436.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.437.1">springframework</span></span><span class="koboSpan" id="kobo.438.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.439.1">boot</span></span><span class="koboSpan" id="kobo.440.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.441.1">test</span></span><span class="koboSpan" id="kobo.442.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.443.1">context</span></span><span class="koboSpan" id="kobo.444.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.445.1">SpringBootTest</span></span><span class="koboSpan" id="kobo.446.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.447.1">import</span></span><span class="koboSpan" id="kobo.448.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.449.1">springframework</span></span><span class="koboSpan" id="kobo.450.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.451.1">http</span></span><span class="koboSpan" id="kobo.452.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.453.1">HttpStatus</span></span><span class="koboSpan" id="kobo.454.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.455.1">import</span></span><span class="koboSpan" id="kobo.456.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.457.1">springframework</span></span><span class="koboSpan" id="kobo.458.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.459.1">test</span></span><span class="koboSpan" id="kobo.460.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.461.1">web</span></span><span class="koboSpan" id="kobo.462.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.463.1">reactive</span></span><span class="koboSpan" id="kobo.464.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.465.1">server</span></span><span class="koboSpan" id="kobo.466.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.467.1">WebTestClient</span></span><span class="koboSpan" id="kobo.468.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.469.1">import</span></span><span class="koboSpan" id="kobo.470.1"> java.</span><span class="hljs-property"><span class="koboSpan" id="kobo.471.1">math</span></span><span class="koboSpan" id="kobo.472.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.473.1">BigDecimal</span></span><span class="koboSpan" id="kobo.474.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.475.1">SpringBootTest</span></span><span class="koboSpan" id="kobo.476.1">(webEnvironment = </span><span class="hljs-title"><span class="koboSpan" id="kobo.477.1">SpringBootTest</span></span><span class="koboSpan" id="kobo.478.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.479.1">WebEnvironment</span></span><span class="koboSpan" id="kobo.480.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.481.1">RANDOM_PORT</span></span><span class="koboSpan" id="kobo.482.1">)
public </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.483.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.484.1">ProductsApiControllerTest</span></span><span class="koboSpan" id="kobo.485.1"> {
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.486.1">Autowired</span></span><span class="koboSpan" id="kobo.487.1">
    private </span><span class="hljs-title"><span class="koboSpan" id="kobo.488.1">WebTestClient</span></span><span class="koboSpan" id="kobo.489.1"> webTestClient;
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.490.1">Test</span></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.491.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.492.1">shouldCreateNewProduct_whenValidInputProvided</span></span><span class="koboSpan" id="kobo.493.1">() {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.494.1">// Arrange</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.495.1">String</span></span><span class="koboSpan" id="kobo.496.1"> productId = </span><span class="hljs-string"><span class="koboSpan" id="kobo.497.1">"AA12345"</span></span><span class="koboSpan" id="kobo.498.1">;
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.499.1">ProductInput</span></span><span class="koboSpan" id="kobo.500.1"> productInput = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.501.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.502.1">ProductInput</span></span><span class="koboSpan" id="kobo.503.1">(
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.504.1">"Test Product"</span></span><span class="koboSpan" id="kobo.505.1">,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.506.1">"A detailed description for the product"</span></span><span class="koboSpan" id="kobo.507.1">,
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.508.1">BigDecimal</span></span><span class="koboSpan" id="kobo.509.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.510.1">valueOf</span></span><span class="koboSpan" id="kobo.511.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.512.1">99.99</span></span><span class="koboSpan" id="kobo.513.1">)
        );
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.514.1">// Act &amp; Assert</span></span><span class="koboSpan" id="kobo.515.1">
        webTestClient.</span><span class="hljs-title"><span class="koboSpan" id="kobo.516.1">put</span></span><span class="koboSpan" id="kobo.517.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.518.1">uri</span></span><span class="koboSpan" id="kobo.519.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.520.1">"/api/products/{productId}"</span></span><span class="koboSpan" id="kobo.521.1">, productId)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.522.1">bodyValue</span></span><span class="koboSpan" id="kobo.523.1">(productInput)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.524.1">exchange</span></span><span class="koboSpan" id="kobo.525.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.526.1">expectStatus</span></span><span class="koboSpan" id="kobo.527.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.528.1">isCreated</span></span><span class="koboSpan" id="kobo.529.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.530.1">expectHeader</span></span><span class="koboSpan" id="kobo.531.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.532.1">exists</span></span><span class="koboSpan" id="kobo.533.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.534.1">"Location"</span></span><span class="koboSpan" id="kobo.535.1">) </span><span class="hljs-comment"><span class="koboSpan" id="kobo.536.1">// Optional: Check if Location header exists</span></span><span class="koboSpan" id="kobo.537.1">
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.538.1">expectBody</span></span><span class="koboSpan" id="kobo.539.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.540.1">ProductOutput</span></span><span class="koboSpan" id="kobo.541.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.542.1">class</span></span><span class="koboSpan" id="kobo.543.1">)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.544.1">value</span></span><span class="koboSpan" id="kobo.545.1">(response -&gt; {
                    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.546.1">// Assert response body content</span></span><span class="koboSpan" id="kobo.547.1">
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.548.1">name</span></span><span class="koboSpan" id="kobo.549.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.550.1">equals</span></span><span class="koboSpan" id="kobo.551.1">(productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.552.1">name</span></span><span class="koboSpan" id="kobo.553.1">());
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.554.1">sku</span></span><span class="koboSpan" id="kobo.555.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.556.1">equals</span></span><span class="koboSpan" id="kobo.557.1">(productId);
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.558.1">description</span></span><span class="koboSpan" id="kobo.559.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.560.1">equals</span></span><span class="koboSpan" id="kobo.561.1">(
                      productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.562.1">description</span></span><span class="koboSpan" id="kobo.563.1">());
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.564.1">price</span></span><span class="koboSpan" id="kobo.565.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.566.1">compareTo</span></span><span class="koboSpan" id="kobo.567.1">(
                      productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.568.1">price</span></span><span class="koboSpan" id="kobo.569.1">()) == </span><span class="hljs-number"><span class="koboSpan" id="kobo.570.1">0</span></span><span class="koboSpan" id="kobo.571.1">;
                });
    }
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.572.1">Test</span></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.573.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.574.1">shouldUpdateExistingProduct_whenValidInputProvided</span></span><span class="koboSpan" id="kobo.575.1">() {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.576.1">// Arrange</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.577.1">String</span></span><span class="koboSpan" id="kobo.578.1"> productId = </span><span class="hljs-string"><span class="koboSpan" id="kobo.579.1">"AA67890"</span></span><span class="koboSpan" id="kobo.580.1">; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.581.1">// Assume this product already exists in the system</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.582.1">ProductInput</span></span><span class="koboSpan" id="kobo.583.1"> productInput = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.584.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.585.1">ProductInput</span></span><span class="koboSpan" id="kobo.586.1">(
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.587.1">"Updated Product"</span></span><span class="koboSpan" id="kobo.588.1">,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.589.1">"An updated description for the product"</span></span><span class="koboSpan" id="kobo.590.1">,
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.591.1">BigDecimal</span></span><span class="koboSpan" id="kobo.592.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.593.1">valueOf</span></span><span class="koboSpan" id="kobo.594.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.595.1">149.99</span></span><span class="koboSpan" id="kobo.596.1">)
        );
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.597.1">// Act &amp; Assert</span></span><span class="koboSpan" id="kobo.598.1">
        webTestClient.</span><span class="hljs-title"><span class="koboSpan" id="kobo.599.1">put</span></span><span class="koboSpan" id="kobo.600.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.601.1">uri</span></span><span class="koboSpan" id="kobo.602.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.603.1">"/api/products/{productId}"</span></span><span class="koboSpan" id="kobo.604.1">, productId)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.605.1">bodyValue</span></span><span class="koboSpan" id="kobo.606.1">(productInput)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.607.1">exchange</span></span><span class="koboSpan" id="kobo.608.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.609.1">expectStatus</span></span><span class="koboSpan" id="kobo.610.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.611.1">isOk</span></span><span class="koboSpan" id="kobo.612.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.613.1">expectBody</span></span><span class="koboSpan" id="kobo.614.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.615.1">ProductOutput</span></span><span class="koboSpan" id="kobo.616.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.617.1">class</span></span><span class="koboSpan" id="kobo.618.1">)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.619.1">value</span></span><span class="koboSpan" id="kobo.620.1">(response -&gt; {
                    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.621.1">// Assert response body content</span></span><span class="koboSpan" id="kobo.622.1">
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.623.1">name</span></span><span class="koboSpan" id="kobo.624.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.625.1">equals</span></span><span class="koboSpan" id="kobo.626.1">(productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.627.1">name</span></span><span class="koboSpan" id="kobo.628.1">());
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.629.1">sku</span></span><span class="koboSpan" id="kobo.630.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.631.1">equals</span></span><span class="koboSpan" id="kobo.632.1">(productId);
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.633.1">description</span></span><span class="koboSpan" id="kobo.634.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.635.1">equals</span></span><span class="koboSpan" id="kobo.636.1">(
                      productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.637.1">description</span></span><span class="koboSpan" id="kobo.638.1">());
                    assert response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.639.1">price</span></span><span class="koboSpan" id="kobo.640.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.641.1">compareTo</span></span><span class="koboSpan" id="kobo.642.1">(
                      productInput.</span><span class="hljs-title"><span class="koboSpan" id="kobo.643.1">price</span></span><span class="koboSpan" id="kobo.644.1">()) == </span><span class="hljs-number"><span class="koboSpan" id="kobo.645.1">0</span></span><span class="koboSpan" id="kobo.646.1">;
                });
    }
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.647.1">Test</span></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.648.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.649.1">shouldRejectInvalidProductIdFormat</span></span><span class="koboSpan" id="kobo.650.1">() {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.651.1">// Arrange</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.652.1">String</span></span><span class="koboSpan" id="kobo.653.1"> invalidProductId = </span><span class="hljs-string"><span class="koboSpan" id="kobo.654.1">"INVALID123"</span></span><span class="koboSpan" id="kobo.655.1">;
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.656.1">ProductInput</span></span><span class="koboSpan" id="kobo.657.1"> productInput = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.658.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.659.1">ProductInput</span></span><span class="koboSpan" id="kobo.660.1">(
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.661.1">"Invalid Product"</span></span><span class="koboSpan" id="kobo.662.1">,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.663.1">"An invalid description"</span></span><span class="koboSpan" id="kobo.664.1">,
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.665.1">BigDecimal</span></span><span class="koboSpan" id="kobo.666.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.667.1">valueOf</span></span><span class="koboSpan" id="kobo.668.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.669.1">49.99</span></span><span class="koboSpan" id="kobo.670.1">)
        );
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.671.1">// Act &amp; Assert</span></span><span class="koboSpan" id="kobo.672.1">
        webTestClient.</span><span class="hljs-title"><span class="koboSpan" id="kobo.673.1">put</span></span><span class="koboSpan" id="kobo.674.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.675.1">uri</span></span><span class="koboSpan" id="kobo.676.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.677.1">"/api/products/{productId}"</span></span><span class="koboSpan" id="kobo.678.1">, invalidProductId)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.679.1">bodyValue</span></span><span class="koboSpan" id="kobo.680.1">(productInput)
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.681.1">exchange</span></span><span class="koboSpan" id="kobo.682.1">()
                .</span><span class="hljs-title"><span class="koboSpan" id="kobo.683.1">expectStatus</span></span><span class="koboSpan" id="kobo.684.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.685.1">isBadRequest</span></span><span class="koboSpan" id="kobo.686.1">(); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.687.1">// Assuming the API enforces validation on productId</span></span><span class="koboSpan" id="kobo.688.1">
    }
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.689.1">
     This code is
    </span>
    <a id="_idIndexMarker669">
    </a>
    <span class="koboSpan" id="kobo.690.1">
     not in itself complex or hard to write, but it is
    </span>
    <a id="_idIndexMarker670">
    </a>
    <span class="koboSpan" id="kobo.691.1">
     time-consuming, and most software engineers don’t particularly enjoy writing it.
    </span>
    <span class="koboSpan" id="kobo.691.2">
     Also, using an LLM to create the tests adds a lot of flexibility to the process.
    </span>
    <span class="koboSpan" id="kobo.691.3">
     For example, if you want this test to be created in a different language—for example, in Go—we only need to change the expected results to have a new version.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.692.1">"Generate a Go test case for the "Create or Update Product" API endpoint in a Spring Boot application."
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.693.1">
     Go ahead and
    </span>
    <a id="_idIndexMarker671">
    </a>
    <span class="koboSpan" id="kobo.694.1">
     play around with the code generation options.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.695.1">
     In some projects, there is even
    </span>
    <a id="_idIndexMarker672">
    </a>
    <span class="koboSpan" id="kobo.696.1">
     the requirement that automated tests be written in a different language than the original code.
    </span>
    <span class="koboSpan" id="kobo.696.2">
     There may not be a real technical reason for such a requirement, as an HTTP client is exactly like another, but it offers some extra psychological comfort to non-technical people in the project to have this extra layer of separation.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-220">
    <a id="_idTextAnchor234">
    </a>
    <span class="koboSpan" id="kobo.697.1">
     A more complex API to test
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.698.1">
     In the previous exercise, we looked at testing an API in which we had complete access to the source code, and we
    </span>
    <a id="_idIndexMarker673">
    </a>
    <span class="koboSpan" id="kobo.699.1">
     were developing that API from scratch.
    </span>
    <span class="koboSpan" id="kobo.699.2">
     Also, the example API was intentionally simple.
    </span>
    <span class="koboSpan" id="kobo.699.3">
     But, there is another common situation
    </span>
    <a id="_idIndexMarker674">
    </a>
    <span class="koboSpan" id="kobo.700.1">
     that many software engineers face: An API that is already in production, with not many automated tests available, that is more complex and returns sophisticated responses.
    </span>
    <span class="koboSpan" id="kobo.700.2">
     Let’s look at one such scenario.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.701.1">
     For this section, we are going to use the HAPI FHIR APIs and write some tests for them.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.702.1">
     HAPI FHIR is a complete Java implementation of the HL7 FHIR standard for healthcare interoperability.
    </span>
    <span class="koboSpan" id="kobo.702.2">
     We chose this example because the API is complex, there is a public test implementation available, and it is used extensively in the healthcare market.
    </span>
    <span class="koboSpan" id="kobo.702.3">
     This implementation is used by many organizations worldwide, including large hospital complexes, healthcare organizations, and governmental health agencies.
    </span>
    <span class="koboSpan" id="kobo.702.4">
     But what is interesting to us from a testing perspective is how complex these APIs are.
    </span>
    <span class="koboSpan" id="kobo.702.5">
     It is not uncommon to receive a few thousand lines of JSON in the response to a search, which allows us to create more nuanced prompts and corresponding tests.
    </span>
   </p>
   <div class="note">
    <div>
     <span class="koboSpan" id="kobo.703.1">
      <img alt="img" src="../Images/Information_Box_Icon.png"/>
     </span>
    </div>
    <p class="normal">
     <span class="koboSpan" id="kobo.704.1">
      To know more about HAPI FHIR and HL7 FHIR, please refer to the following links:
     </span>
    </p>
    <p class="normal">
     <a href="https://hapifhir.io/">
      <span class="url">
       <span class="koboSpan" id="kobo.705.1">
        https://hapifhir.io/
       </span>
      </span>
     </a>
    </p>
    <p class="normal">
     <a href="https://hl7.org/fhir/">
      <span class="url">
       <span class="koboSpan" id="kobo.706.1">
        https://hl7.org/fhir/
       </span>
      </span>
     </a>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.707.1">
     Because healthcare requirements are usually unique to each organization and dependent on many local regulations, there is a high level of customization required for any HAPI FHIR implementation.
    </span>
    <span class="koboSpan" id="kobo.707.2">
     It is not uncommon to find several thousand lines of custom code in a specific implementation.
    </span>
    <span class="koboSpan" id="kobo.707.3">
     A strong set of tests is crucial when customizing such a complex API.
    </span>
    <span class="koboSpan" id="kobo.707.4">
     You don’t want to break any of the HAPI FHIR contracts.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.708.1">
     Also, one great
    </span>
    <a id="_idIndexMarker675">
    </a>
    <span class="koboSpan" id="kobo.709.1">
     advantage of HAPI FHIR as a test example for us is the availability of a public test server:
    </span>
    <a href="https://hapi.fhir.org/baseR4">
     <span class="url">
      <span class="koboSpan" id="kobo.710.1">
       https://hapi.fhir.org/baseR4
      </span>
     </span>
    </a>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.711.1">
     Having prior knowledge of the HAPI FHIR APIs is not necessary to follow this section.
    </span>
    <span class="koboSpan" id="kobo.711.2">
     We are interested only in looking at the API’s behavior and preparing tests to validate that such behavior does
    </span>
    <a id="_idIndexMarker676">
    </a>
    <span class="koboSpan" id="kobo.712.1">
     not change.
    </span>
    <span class="koboSpan" id="kobo.712.2">
     Here are a couple of HAPI FHIR concepts we will use:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.713.1">
       PATIENT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.714.1">
      : HAPI FHIR is a healthcare system; therefore, PATIENT is a first-class element in it.
     </span>
     <span class="koboSpan" id="kobo.714.2">
      We will write some tests to validate that searching for a patient returns the elements we want.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.715.1">
       RESOURCE TYPE – BUNDLE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.716.1">
      : In HAPI FHIR, all results of a search are bundles.
     </span>
     <span class="koboSpan" id="kobo.716.2">
      This is just the name used to define a set of data, but we will validate this behavior as part of our tests.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.717.1">
     With that in mind, let’s assume you are a software engineer in the HAPI FHIR support team in a large hospital, and you just received the task of customizing the HAPI FHIR API to add a new element to a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.718.1">
      Patient
     </span>
    </code>
    <span class="koboSpan" id="kobo.719.1">
     record.
    </span>
    <span class="koboSpan" id="kobo.719.2">
     This new element is used only in this hospital’s system.
    </span>
    <span class="koboSpan" id="kobo.719.3">
     Assume that there are
    </span>
    <a id="_idIndexMarker677">
    </a>
    <span class="koboSpan" id="kobo.720.1">
     no test cases for the Patient API.
    </span>
    <span class="koboSpan" id="kobo.720.2">
     What can you do?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.721.1">
     Well, you could start by looking at the source code and try to find all the relevant classes and all, but this is a time-consuming task and will delay the generation of the tests.
    </span>
    <span class="koboSpan" id="kobo.721.2">
     Maybe a more pragmatic approach is needed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.722.1">
     So, start by looking at the API responses and prepare tests so your changes will not break the current contract.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.723.1">
     Here is a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.724.1">
      GET
     </span>
    </code>
    <span class="koboSpan" id="kobo.725.1">
     request that returns all the patients in the system, one at a time.
    </span>
    <span class="koboSpan" id="kobo.725.2">
     All the data is synthetic and not related to any real individual:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.726.1">https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.727.1">
     Let’s examine in detail the response we received (you will not get the same data when running this example, but the format and structure will be the same):
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.728.1">{  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.729.1">"resourceType":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.730.1">"Bundle"</span></span><span class="koboSpan" id="kobo.731.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.732.1">"id":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.733.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.734.1">241fc9a1-3d08-4c1c-95a9-6ac315d178a8"</span></span><span class="koboSpan" id="kobo.735.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.736.1">"meta":</span></span><span class="koboSpan" id="kobo.737.1"> {
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.738.1">"lastUpdated":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.739.1">"2024-11-18T13:05:22.536+00:00"</span></span><span class="koboSpan" id="kobo.740.1">
  },
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.741.1">"type":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.742.1">"searchset"</span></span><span class="koboSpan" id="kobo.743.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.744.1">"link":</span></span><span class="koboSpan" id="kobo.745.1"> [
    {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.746.1">"relation":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.747.1">"self"</span></span><span class="koboSpan" id="kobo.748.1">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.749.1">"url":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.750.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.751.1">https://hapi.fhir.org/baseR4/Patient?_count=1&amp;_format=json"</span></span><span class="koboSpan" id="kobo.752.1">
    },
    {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.753.1">"relation":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.754.1">"next"</span></span><span class="koboSpan" id="kobo.755.1">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.756.1">"url":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.757.1">"https://hapi.fhir.org/baseR4?_getpages=241fc9a1-3d08-4c1c-95a9-6ac315d178a8&amp;_getpagesoffset=1&amp;_count=1&amp;_format=json&amp;_pretty=true&amp;_bundletype=searchset"</span></span><span class="koboSpan" id="kobo.758.1">
    }
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.759.1">"entry":</span></span><span class="koboSpan" id="kobo.760.1"> [
    {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.761.1">"fullUrl":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.762.1">"https://hapi.fhir.org/baseR4/Patient/596484"</span></span><span class="koboSpan" id="kobo.763.1">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.764.1">"resource":</span></span><span class="koboSpan" id="kobo.765.1"> {
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.766.1">"resourceType":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.767.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.768.1">Patient"</span></span><span class="koboSpan" id="kobo.769.1">,
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.770.1">"id":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.771.1">"596484"</span></span><span class="koboSpan" id="kobo.772.1">,
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.773.1">"meta":</span></span><span class="koboSpan" id="kobo.774.1"> {
          </span><span class="hljs-attr"><span class="koboSpan" id="kobo.775.1">"versionId":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.776.1">"1"</span></span><span class="koboSpan" id="kobo.777.1">,
          </span><span class="hljs-attr"><span class="koboSpan" id="kobo.778.1">"lastUpdated":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.779.1">"2020-02-01T17:42:02.000+00:00"</span></span><span class="koboSpan" id="kobo.780.1">,
          </span><span class="hljs-attr"><span class="koboSpan" id="kobo.781.1">"source":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.782.1">"#McyYCIRVGrcmfKSf"</span></span><span class="koboSpan" id="kobo.783.1">
        },
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.784.1">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.785.1">text":</span></span><span class="koboSpan" id="kobo.786.1"> {
          </span><span class="hljs-attr"><span class="koboSpan" id="kobo.787.1">"status":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.788.1">"generated"</span></span><span class="koboSpan" id="kobo.789.1">,
          </span><span class="hljs-attr"><span class="koboSpan" id="kobo.790.1">"div":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.791.1">"&lt;div xmlns…div&gt;"</span></span><span class="koboSpan" id="kobo.792.1">
        },
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.793.1">"name":</span></span><span class="koboSpan" id="kobo.794.1"> [
          {
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.795.1">"family":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.796.1">"DelGrosso"</span></span><span class="koboSpan" id="kobo.797.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.798.1">"given":</span></span><span class="koboSpan" id="kobo.799.1"> [
              </span><span class="hljs-string"><span class="koboSpan" id="kobo.800.1">"Joe"</span></span><span class="koboSpan" id="kobo.801.1">
            ]
          }
        ],
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.802.1">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.803.1">telecom":</span></span><span class="koboSpan" id="kobo.804.1"> [
          {
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.805.1">"system":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.806.1">"phone"</span></span><span class="koboSpan" id="kobo.807.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.808.1">"value":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.809.1">"1(555)123-4567"</span></span><span class="koboSpan" id="kobo.810.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.811.1">"use":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.812.1">"home"</span></span><span class="koboSpan" id="kobo.813.1">
          }
        ],
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.814.1">"gender":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.815.1">"male"</span></span><span class="koboSpan" id="kobo.816.1">,
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.817.1">"birthDate":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.818.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.819.1">1985-09-11"</span></span><span class="koboSpan" id="kobo.820.1">,
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.821.1">"address":</span></span><span class="koboSpan" id="kobo.822.1"> [
          {
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.823.1">"use":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.824.1">"home"</span></span><span class="koboSpan" id="kobo.825.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.826.1">"line":</span></span><span class="koboSpan" id="kobo.827.1"> [
              </span><span class="hljs-string"><span class="koboSpan" id="kobo.828.1">"155 Quick Rd"</span></span><span class="koboSpan" id="kobo.829.1">
            ],
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.830.1">"city":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.831.1">"Fun City"</span></span><span class="koboSpan" id="kobo.832.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.833.1">"state":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.834.1">"NY"</span></span><span class="koboSpan" id="kobo.835.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.836.1">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.837.1">postalCode":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.838.1">"10101"</span></span><span class="koboSpan" id="kobo.839.1">,
            </span><span class="hljs-attr"><span class="koboSpan" id="kobo.840.1">"country":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.841.1">"US"</span></span><span class="koboSpan" id="kobo.842.1">
          }
        ]
      },
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.843.1">"search":</span></span><span class="koboSpan" id="kobo.844.1"> {
        </span><span class="hljs-attr"><span class="koboSpan" id="kobo.845.1">"mode":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.846.1">"match"</span></span><span class="koboSpan" id="kobo.847.1">
      }
    }
  ]
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.848.1">
     This result is already 70+ lines long and is a good start for our API analysis and to design our tests.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.849.1">
     Let’s look
    </span>
    <a id="_idIndexMarker678">
    </a>
    <span class="koboSpan" id="kobo.850.1">
     at the results.
    </span>
    <span class="koboSpan" id="kobo.850.2">
     We can see that the result of a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.851.1">
      GET
     </span>
    </code>
    <span class="koboSpan" id="kobo.852.1">
     function has a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.853.1">
      resourceType
     </span>
    </code>
    <span class="koboSpan" id="kobo.854.1">
     , which in this case is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.855.1">
      Bundle
     </span>
    </code>
    <span class="koboSpan" id="kobo.856.1">
     .
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.857.1">
      Type
     </span>
    </code>
    <span class="koboSpan" id="kobo.858.1">
     is a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.859.1">
      searchset
     </span>
    </code>
    <span class="koboSpan" id="kobo.860.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.861.1">
     There is an array of links (“link”) and an array of entries (“entry”) with the actual patient’s data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.862.1">
     Good, this is a start.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-221">
    <a id="_idTextAnchor235">
    </a>
    <span class="koboSpan" id="kobo.863.1">
     Preparing your test prompt
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.864.1">
     Remember that your goal is to make changes to the code, without breaking the current state, so start by
    </span>
    <a id="_idIndexMarker679">
    </a>
    <span class="koboSpan" id="kobo.865.1">
     defining clearly what you want to validate with your test—for example, “Test that all
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.866.1">
      GET
     </span>
    </code>
    <span class="koboSpan" id="kobo.867.1">
     searches will return a valid pagination JSON.”
    </span>
    <span class="koboSpan" id="kobo.867.2">
     Now, let’s write a prompt to generate our first test.
    </span>
    <span class="koboSpan" id="kobo.867.3">
     The results are from ChatGPT 4:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.868.1">Assuming the role of a Senior Software Engineer working on a HAPI FHIR customization project.
</span><span class="koboSpan" id="kobo.868.2">Prepare a test case that will make a call to the following URL: https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1
Make sure to validate that the response is in a JSON format and contains:
- a single 'resourceType' of 'Bundle'
- a single 'type' of 'searchset'
- a single 'id' in the format of an UUID
Use JAVA Junit 5
Here is a sample result set. </span><span class="koboSpan" id="kobo.868.3">The actual values of each element will vary from each call.
</span><span class="koboSpan" id="kobo.868.4">{
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.869.1">"resourceType":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.870.1">"Bundle"</span></span><span class="koboSpan" id="kobo.871.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.872.1">"id":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.873.1">"241fc9a1-3d08-4c1c-95a9-6ac315d178a8"</span></span><span class="koboSpan" id="kobo.874.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.875.1">"meta":</span></span><span class="koboSpan" id="kobo.876.1"> {
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.877.1">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.878.1">lastUpdated":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.879.1">"2024-11-18T13:05:22.536+00:00"</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.880.1">….</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.881.1">
     Paste the
    </span>
    <a id="_idIndexMarker680">
    </a>
    <span class="koboSpan" id="kobo.882.1">
     whole JSON sample with the prompt.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.883.1">
     The results are the following tests and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.884.1">
      pom.xml
     </span>
    </code>
    <span class="koboSpan" id="kobo.885.1">
     changes:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.886.1">import</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.887.1">static</span></span><span class="koboSpan" id="kobo.888.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.889.1">junit</span></span><span class="koboSpan" id="kobo.890.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.891.1">jupiter</span></span><span class="koboSpan" id="kobo.892.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.893.1">api</span></span><span class="koboSpan" id="kobo.894.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.895.1">Assertions</span></span><span class="koboSpan" id="kobo.896.1">.*;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.897.1">import</span></span><span class="koboSpan" id="kobo.898.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.899.1">junit</span></span><span class="koboSpan" id="kobo.900.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.901.1">jupiter</span></span><span class="koboSpan" id="kobo.902.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.903.1">api</span></span><span class="koboSpan" id="kobo.904.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.905.1">Test</span></span><span class="koboSpan" id="kobo.906.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.907.1">import</span></span><span class="koboSpan" id="kobo.908.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.909.1">springframework</span></span><span class="koboSpan" id="kobo.910.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.911.1">http</span></span><span class="koboSpan" id="kobo.912.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.913.1">ResponseEntity</span></span><span class="koboSpan" id="kobo.914.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.915.1">import</span></span><span class="koboSpan" id="kobo.916.1"> org.</span><span class="hljs-property"><span class="koboSpan" id="kobo.917.1">springframework</span></span><span class="koboSpan" id="kobo.918.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.919.1">web</span></span><span class="koboSpan" id="kobo.920.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.921.1">client</span></span><span class="koboSpan" id="kobo.922.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.923.1">RestTemplate</span></span><span class="koboSpan" id="kobo.924.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.925.1">import</span></span><span class="koboSpan" id="kobo.926.1"> com.</span><span class="hljs-property"><span class="koboSpan" id="kobo.927.1">fasterxml</span></span><span class="koboSpan" id="kobo.928.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.929.1">jackson</span></span><span class="koboSpan" id="kobo.930.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.931.1">databind</span></span><span class="koboSpan" id="kobo.932.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.933.1">JsonNode</span></span><span class="koboSpan" id="kobo.934.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.935.1">import</span></span><span class="koboSpan" id="kobo.936.1"> com.</span><span class="hljs-property"><span class="koboSpan" id="kobo.937.1">fasterxml</span></span><span class="koboSpan" id="kobo.938.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.939.1">jackson</span></span><span class="koboSpan" id="kobo.940.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.941.1">databind</span></span><span class="koboSpan" id="kobo.942.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.943.1">ObjectMapper</span></span><span class="koboSpan" id="kobo.944.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.945.1">import</span></span><span class="koboSpan" id="kobo.946.1"> java.</span><span class="hljs-property"><span class="koboSpan" id="kobo.947.1">util</span></span><span class="koboSpan" id="kobo.948.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.949.1">UUID</span></span><span class="koboSpan" id="kobo.950.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.951.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.952.1">HapiFhirTest</span></span><span class="koboSpan" id="kobo.953.1"> {
    private </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.954.1">static</span></span><span class="koboSpan" id="kobo.955.1"> final </span><span class="hljs-title"><span class="koboSpan" id="kobo.956.1">String</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.957.1">HAPI_FHIR_URL</span></span><span class="koboSpan" id="kobo.958.1"> =
      </span><span class="hljs-string"><span class="koboSpan" id="kobo.959.1">"https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1"</span></span><span class="koboSpan" id="kobo.960.1">;
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.961.1">Test</span></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.962.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.963.1">testHapiFhirResponse</span></span><span class="koboSpan" id="kobo.964.1">() {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.965.1">// Set up RestTemplate for HTTP call</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.966.1">RestTemplate</span></span><span class="koboSpan" id="kobo.967.1"> restTemplate = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.968.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.969.1">RestTemplate</span></span><span class="koboSpan" id="kobo.970.1">();
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.971.1">// Make the HTTP GET call</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.972.1">ResponseEntity</span></span><span class="koboSpan" id="kobo.973.1">&lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.974.1">String</span></span><span class="koboSpan" id="kobo.975.1">&gt; response = restTemplate.</span><span class="hljs-title"><span class="koboSpan" id="kobo.976.1">getForEntity</span></span><span class="koboSpan" id="kobo.977.1">(
</span><span class="hljs-title">          </span><span class="hljs-variable"><span class="koboSpan" id="kobo.978.1">HAPI_FHIR_URL</span></span><span class="koboSpan" id="kobo.979.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.980.1">String</span></span><span class="koboSpan" id="kobo.981.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.982.1">class</span></span><span class="koboSpan" id="kobo.983.1">);
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.984.1">// Assert the response is not null and has a 200 status code</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.985.1">assertNotNull</span></span><span class="koboSpan" id="kobo.986.1">(response);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.987.1">assertEquals</span></span><span class="koboSpan" id="kobo.988.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.989.1">200</span></span><span class="koboSpan" id="kobo.990.1">, response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.991.1">getStatusCodeValue</span></span><span class="koboSpan" id="kobo.992.1">());
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.993.1">// Assert the response body is not null</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.994.1">String</span></span><span class="koboSpan" id="kobo.995.1"> responseBody = response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.996.1">getBody</span></span><span class="koboSpan" id="kobo.997.1">();
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.998.1">assertNotNull</span></span><span class="koboSpan" id="kobo.999.1">(responseBody);
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1000.1">try</span></span><span class="koboSpan" id="kobo.1001.1"> {
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1002.1">// Parse the response body as JSON</span></span>
            <span class="hljs-title"><span class="koboSpan" id="kobo.1003.1">ObjectMapper</span></span><span class="koboSpan" id="kobo.1004.1"> objectMapper = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1005.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1006.1">ObjectMapper</span></span><span class="koboSpan" id="kobo.1007.1">();
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1008.1">JsonNode</span></span><span class="koboSpan" id="kobo.1009.1"> jsonNode = objectMapper.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1010.1">readTree</span></span><span class="koboSpan" id="kobo.1011.1">(responseBody);
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1012.1">// Assert 'resourceType' is present and equals 'Bundle'</span></span>
            <span class="hljs-title"><span class="koboSpan" id="kobo.1013.1">assertTrue</span></span><span class="koboSpan" id="kobo.1014.1">(jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1015.1">has</span></span><span class="koboSpan" id="kobo.1016.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1017.1">"resourceType"</span></span><span class="koboSpan" id="kobo.1018.1">));
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1019.1">assertEquals</span></span><span class="koboSpan" id="kobo.1020.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1021.1">"Bundle"</span></span><span class="koboSpan" id="kobo.1022.1">, jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1023.1">get</span></span><span class="koboSpan" id="kobo.1024.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1025.1">"resourceType"</span></span><span class="koboSpan" id="kobo.1026.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1027.1">asText</span></span><span class="koboSpan" id="kobo.1028.1">());
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1029.1">// Assert 'type' is present and equals 'searchset'</span></span>
            <span class="hljs-title"><span class="koboSpan" id="kobo.1030.1">assertTrue</span></span><span class="koboSpan" id="kobo.1031.1">(jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1032.1">has</span></span><span class="koboSpan" id="kobo.1033.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1034.1">"type"</span></span><span class="koboSpan" id="kobo.1035.1">));
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1036.1">assertEquals</span></span><span class="koboSpan" id="kobo.1037.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1038.1">"searchset"</span></span><span class="koboSpan" id="kobo.1039.1">, jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1040.1">get</span></span><span class="koboSpan" id="kobo.1041.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1042.1">"type"</span></span><span class="koboSpan" id="kobo.1043.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1044.1">asText</span></span><span class="koboSpan" id="kobo.1045.1">());
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1046.1">// Assert 'id' is present and is a valid UUID</span></span>
            <span class="hljs-title"><span class="koboSpan" id="kobo.1047.1">assertTrue</span></span><span class="koboSpan" id="kobo.1048.1">(jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1049.1">has</span></span><span class="koboSpan" id="kobo.1050.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1051.1">"id"</span></span><span class="koboSpan" id="kobo.1052.1">));
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1053.1">String</span></span><span class="koboSpan" id="kobo.1054.1"> id = jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1055.1">get</span></span><span class="koboSpan" id="kobo.1056.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1057.1">"id"</span></span><span class="koboSpan" id="kobo.1058.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1059.1">asText</span></span><span class="koboSpan" id="kobo.1060.1">();
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1061.1">assertTrue</span></span><span class="koboSpan" id="kobo.1062.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.1063.1">isValidUUID</span></span><span class="koboSpan" id="kobo.1064.1">(id));
        } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1065.1">catch</span></span><span class="koboSpan" id="kobo.1066.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1067.1">Exception</span></span><span class="koboSpan" id="kobo.1068.1"> e) {
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1069.1">fail</span></span><span class="koboSpan" id="kobo.1070.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1071.1">"Exception occurred while processing the response: "</span></span><span class="koboSpan" id="kobo.1072.1"> +
</span><span class="hljs-title">                  </span><span class="koboSpan" id="kobo.1073.1">e.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1074.1">getMessage</span></span><span class="koboSpan" id="kobo.1075.1">());
        }
    }
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1076.1">/**</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1077.1">     * Utility method to validate if a string is a valid UUID.</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1078.1">     *</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1079.1">     * </span></span><span class="hljs-doctag"><span class="koboSpan" id="kobo.1080.1">@param</span></span><span class="hljs-comment"><span class="koboSpan" id="kobo.1081.1"> uuid the string to validate</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1082.1">     * </span></span><span class="hljs-doctag"><span class="koboSpan" id="kobo.1083.1">@return</span></span><span class="hljs-comment"><span class="koboSpan" id="kobo.1084.1"> true if valid UUID, false otherwise</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1085.1">     */</span></span><span class="koboSpan" id="kobo.1086.1">
    private boolean </span><span class="hljs-title"><span class="koboSpan" id="kobo.1087.1">isValidUUID</span></span><span class="koboSpan" id="kobo.1088.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1089.1">String</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1090.1"> uuid</span></span><span class="koboSpan" id="kobo.1091.1">) {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1092.1">try</span></span><span class="koboSpan" id="kobo.1093.1"> {
            </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1094.1">UUID</span></span><span class="koboSpan" id="kobo.1095.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1096.1">fromString</span></span><span class="koboSpan" id="kobo.1097.1">(uuid);
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1098.1">return</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.1099.1">true</span></span><span class="koboSpan" id="kobo.1100.1">;
        } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1101.1">catch</span></span><span class="koboSpan" id="kobo.1102.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1103.1">IllegalArgumentException</span></span><span class="koboSpan" id="kobo.1104.1"> e) {
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1105.1">return</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.1106.1">false</span></span><span class="koboSpan" id="kobo.1107.1">;
        }
    }
}
With the accompanying dependencies in pom.xml
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1108.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1109.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1110.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1111.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1112.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1113.1">&gt;</span></span><span class="koboSpan" id="kobo.1114.1">org.springframework</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1115.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1116.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1117.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1118.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1119.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1120.1">&gt;</span></span><span class="koboSpan" id="kobo.1121.1">spring-web</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1122.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1123.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1124.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1125.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1126.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1127.1">&gt;</span></span><span class="koboSpan" id="kobo.1128.1">5.3.30</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1129.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1130.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1131.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1132.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1133.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1134.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1135.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1136.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1137.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1138.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1139.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1140.1">&gt;</span></span><span class="koboSpan" id="kobo.1141.1">com.fasterxml.jackson.core</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1142.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1143.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1144.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1145.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1146.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1147.1">&gt;</span></span><span class="koboSpan" id="kobo.1148.1">jackson-databind</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1149.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1150.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1151.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1152.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1153.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1154.1">&gt;</span></span><span class="koboSpan" id="kobo.1155.1">2.15.2</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1156.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1157.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1158.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1159.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1160.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1161.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1162.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1163.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1164.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1165.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1166.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1167.1">&gt;</span></span><span class="koboSpan" id="kobo.1168.1">org.junit.jupiter</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1169.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1170.1">groupId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1171.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1172.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1173.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1174.1">&gt;</span></span><span class="koboSpan" id="kobo.1175.1">junit-jupiter</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1176.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1177.1">artifactId</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1178.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.1179.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1180.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1181.1">&gt;</span></span><span class="koboSpan" id="kobo.1182.1">5.10.0</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1183.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1184.1">version</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1185.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1186.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1187.1">dependency</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1188.1">&gt;</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1189.1">
     This code runs immediately without any modifications.
    </span>
    <span class="koboSpan" id="kobo.1189.2">
     This was not the case with the previous generation of LLMs.
    </span>
    <span class="koboSpan" id="kobo.1189.3">
     If you are using an older model, such as ChatGPT 3.5 for example, you may have to manually adjust the code.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1190.1">
     This whole
    </span>
    <a id="_idIndexMarker681">
    </a>
    <span class="koboSpan" id="kobo.1191.1">
     test was completed in less than a minute by the LLM and it is actually fun to write and see the results so quickly—a very different experience from having to manually write tests by hand.
    </span>
    <span class="koboSpan" id="kobo.1191.2">
     The test can be improved, of course.
    </span>
    <span class="koboSpan" id="kobo.1191.3">
     For example, it could be changed to get the URL to be tested from a list or even a property file for added flexibility, but the core of the code is there and ready to be used.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1192.1">
     Now, let’s move on to a more complex type of test and see how far we can go with our validations.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-222">
    <a id="_idTextAnchor236">
    </a>
    <span class="koboSpan" id="kobo.1193.1">
     Validating more complex behavior
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1194.1">
     Looking at
    </span>
    <a id="_idIndexMarker682">
    </a>
    <span class="koboSpan" id="kobo.1195.1">
     the API’s response, we can see that the “link” array has two entries on this first page: “
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1196.1">
      self"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1197.1">
     and “
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1198.1">
      next"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1199.1">
     .
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code">  <span class="hljs-attr"><span class="koboSpan" id="kobo.1200.1">"link":</span></span><span class="koboSpan" id="kobo.1201.1"> [
    {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1202.1">"relation":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1203.1">"self"</span></span><span class="koboSpan" id="kobo.1204.1">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1205.1">"url":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1206.1">"https://hapi.fhir.org/baseR4/Patient?_count=1&amp;_format=json"</span></span><span class="koboSpan" id="kobo.1207.1">
    },
    {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1208.1">"relation":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1209.1">"next"</span></span><span class="koboSpan" id="kobo.1210.1">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1211.1">"url":</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1212.1">"https://hapi.fhir.org/..."</span></span><span class="koboSpan" id="kobo.1213.1">
    }
  ]</span><span class="hljs-string"><span class="koboSpan" id="kobo.1214.1">,</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1215.1">
     A good test would be to validate that a response always has the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1216.1">
      self
     </span>
    </code>
    <span class="koboSpan" id="kobo.1217.1">
     link.
    </span>
    <span class="koboSpan" id="kobo.1217.2">
     Let’s expand the prompt to include this.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1218.1">
     Here’s the new prompt:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1219.1">Assuming the role of a Senior Software Engineer working on a HAPI FHIR customization project.
</span><span class="koboSpan" id="kobo.1219.2">Prepare a test case that will make a call to the following URL: https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1
Make sure to validate that the response is in a JSON format and contains:
- a single 'resourceType' of 'Bundle'
- a single 'type' of 'searchset'
- a single 'id' in the format of an UUID
Validate that array "link" is present and that there is one element with "relation = self"
Use JAVA Junit 5
…
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1220.1">
     This will
    </span>
    <a id="_idIndexMarker683">
    </a>
    <span class="koboSpan" id="kobo.1221.1">
     add the following code to our test:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1222.1">// Validate link array</span></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1223.1">assertTrue</span></span><span class="koboSpan" id="kobo.1224.1">(jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1225.1">has</span></span><span class="koboSpan" id="kobo.1226.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1227.1">"link"</span></span><span class="koboSpan" id="kobo.1228.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.1229.1">"Response does not contain 'link'"</span></span><span class="koboSpan" id="kobo.1230.1">);
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1231.1">JsonNode</span></span><span class="koboSpan" id="kobo.1232.1"> links = jsonNode.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1233.1">get</span></span><span class="koboSpan" id="kobo.1234.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1235.1">"link"</span></span><span class="koboSpan" id="kobo.1236.1">);
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1237.1">assertTrue</span></span><span class="koboSpan" id="kobo.1238.1">(links.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1239.1">isArray</span></span><span class="koboSpan" id="kobo.1240.1">(), </span><span class="hljs-string"><span class="koboSpan" id="kobo.1241.1">"link is not an array"</span></span><span class="koboSpan" id="kobo.1242.1">);
boolean hasSelfLink = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1243.1">false</span></span><span class="koboSpan" id="kobo.1244.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1245.1">for</span></span><span class="koboSpan" id="kobo.1246.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1247.1">JsonNode</span></span><span class="koboSpan" id="kobo.1248.1"> link : links) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1249.1">if</span></span><span class="koboSpan" id="kobo.1250.1"> (link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1251.1">has</span></span><span class="koboSpan" id="kobo.1252.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1253.1">"relation"</span></span><span class="koboSpan" id="kobo.1254.1">) &amp;&amp; </span><span class="hljs-string"><span class="koboSpan" id="kobo.1255.1">"self"</span></span><span class="koboSpan" id="kobo.1256.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1257.1">equals</span></span><span class="koboSpan" id="kobo.1258.1">(
</span><span class="hljs-keyword">        </span><span class="koboSpan" id="kobo.1259.1">link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1260.1">get</span></span><span class="koboSpan" id="kobo.1261.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1262.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1263.1">relation"</span></span><span class="koboSpan" id="kobo.1264.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1265.1">asText</span></span><span class="koboSpan" id="kobo.1266.1">())) {
        hasSelfLink = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1267.1">true</span></span><span class="koboSpan" id="kobo.1268.1">;
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1269.1">break</span></span><span class="koboSpan" id="kobo.1270.1">;
    }
}
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1271.1">assertTrue</span></span><span class="koboSpan" id="kobo.1272.1">(hasSelfLink, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1273.1">"No link with 'relation' = 'self'"</span></span><span class="koboSpan" id="kobo.1274.1">);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1275.1">
     Again, the code is not very complex, but it is already showing signs of increasing difficulty.
    </span>
    <span class="koboSpan" id="kobo.1275.2">
     Writing this by hand would not be hard, but would take some time and attention.
    </span>
    <span class="koboSpan" id="kobo.1275.3">
     LLMs can create it in 30 seconds or less.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1276.1">
     Now, let’s add even more complexity.
    </span>
    <span class="koboSpan" id="kobo.1276.2">
     This is a pagination exercise, so let’s ask the code to follow the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1277.1">
      next
     </span>
    </code>
    <span class="koboSpan" id="kobo.1278.1">
     link for a few pages and validate that page.
    </span>
    <span class="koboSpan" id="kobo.1278.2">
     Then, validate if every entry in the result is unique, using
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1279.1">
      fullUrl
     </span>
    </code>
    <span class="koboSpan" id="kobo.1280.1">
     inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1281.1">
      entry
     </span>
    </code>
    <span class="koboSpan" id="kobo.1282.1">
     array as a candidate key.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1283.1">Assuming the role of a Senior Software Engineer working on a HAPI FHIR customization project.
</span><span class="koboSpan" id="kobo.1283.2">Prepare a test case that will make a call to the following URL: https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1
Make sure to validate that the response is in a JSON format and contains:
- a single 'resourceType' of 'Bundle'
- a single 'type' of 'searchset'
- an single 'id' in the format of an UUID
Validate that array "link" is present and that there is one element with "relation = self"
Now, follow the "next" link for at most 5 pages or until the last page. </span><span class="koboSpan" id="kobo.1283.3">Validate each page.
</span><span class="koboSpan" id="kobo.1283.4">In each "entry" there is a "fullUrl" attribute. </span><span class="koboSpan" id="kobo.1283.5">Threat it as a key and validate that it is present in every "entry".
</span><span class="koboSpan" id="kobo.1283.6">Also, make sure that the entries are unique and there is no repetition.
</span><span class="koboSpan" id="kobo.1283.7">Use JAVA Junit 5
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1284.1">
     The result
    </span>
    <a id="_idIndexMarker684">
    </a>
    <span class="koboSpan" id="kobo.1285.1">
     is starting to look more sophisticated and interesting.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1286.1">public </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1287.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1288.1">HapiFhirPaginationTest</span></span><span class="koboSpan" id="kobo.1289.1"> {
    @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1290.1">Test</span></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.1291.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1292.1">testHapiFhirPatientPagination</span></span><span class="koboSpan" id="kobo.1293.1">() throws </span><span class="hljs-title"><span class="koboSpan" id="kobo.1294.1">Exception</span></span><span class="koboSpan" id="kobo.1295.1"> {
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1296.1">String</span></span><span class="koboSpan" id="kobo.1297.1"> baseUrl =
</span><span class="hljs-title">          </span><span class="hljs-string"><span class="koboSpan" id="kobo.1298.1">"https://hapi.fhir.org/baseR4/Patient?_format=json&amp;_count=1"</span></span><span class="koboSpan" id="kobo.1299.1">;
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1300.1">ObjectMapper</span></span><span class="koboSpan" id="kobo.1301.1"> mapper = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1302.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1303.1">ObjectMapper</span></span><span class="koboSpan" id="kobo.1304.1">();
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1305.1">String</span></span><span class="koboSpan" id="kobo.1306.1"> nextUrl = baseUrl;
        int pageCount = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1307.1">0</span></span><span class="koboSpan" id="kobo.1308.1">;
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1309.1">Set</span></span><span class="koboSpan" id="kobo.1310.1">&lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.1311.1">String</span></span><span class="koboSpan" id="kobo.1312.1">&gt; uniqueFullUrls = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1313.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1314.1">HashSet</span></span><span class="koboSpan" id="kobo.1315.1">&lt;&gt;();
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1316.1">while</span></span><span class="koboSpan" id="kobo.1317.1"> (nextUrl != </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1318.1">null</span></span><span class="koboSpan" id="kobo.1319.1"> &amp;&amp; pageCount &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.1320.1">5</span></span><span class="koboSpan" id="kobo.1321.1">) {
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1322.1">HttpURLConnection</span></span><span class="koboSpan" id="kobo.1323.1"> connection = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1324.1">createConnection</span></span><span class="koboSpan" id="kobo.1325.1">(nextUrl);
            int responseCode = connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1326.1">getResponseCode</span></span><span class="koboSpan" id="kobo.1327.1">();
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1328.1">assertEquals</span></span><span class="koboSpan" id="kobo.1329.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1330.1">200</span></span><span class="koboSpan" id="kobo.1331.1">, responseCode,
</span><span class="hljs-title">                         </span><span class="hljs-string"><span class="koboSpan" id="kobo.1332.1">"Expected HTTP status code 200"</span></span><span class="koboSpan" id="kobo.1333.1">);
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1334.1">InputStream</span></span><span class="koboSpan" id="kobo.1335.1"> responseStream = connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1336.1">getInputStream</span></span><span class="koboSpan" id="kobo.1337.1">();
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1338.1">JsonNode</span></span><span class="koboSpan" id="kobo.1339.1"> response = mapper.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1340.1">readTree</span></span><span class="koboSpan" id="kobo.1341.1">(responseStream);
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1342.1">validatePage</span></span><span class="koboSpan" id="kobo.1343.1">(response, uniqueFullUrls);
            nextUrl = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1344.1">getNextLink</span></span><span class="koboSpan" id="kobo.1345.1">(response);
            pageCount++;
            connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1346.1">disconnect</span></span><span class="koboSpan" id="kobo.1347.1">();
        }
    }
    private </span><span class="hljs-title"><span class="koboSpan" id="kobo.1348.1">HttpURLConnection</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1349.1">createConnection</span></span><span class="koboSpan" id="kobo.1350.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.1351.1">String</span></span><span class="koboSpan" id="kobo.1352.1"> urlString) throws </span><span class="hljs-title"><span class="koboSpan" id="kobo.1353.1">Exception</span></span><span class="koboSpan" id="kobo.1354.1"> {
        </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1355.1">URL</span></span><span class="koboSpan" id="kobo.1356.1"> url = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1357.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1358.1">URL</span></span><span class="koboSpan" id="kobo.1359.1">(urlString);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1360.1">HttpURLConnection</span></span><span class="koboSpan" id="kobo.1361.1"> connection = (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1362.1">HttpURLConnection</span></span><span class="koboSpan" id="kobo.1363.1">)
</span><span class="hljs-title">                                         </span><span class="koboSpan" id="kobo.1364.1">url.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1365.1">openConnection</span></span><span class="koboSpan" id="kobo.1366.1">();
        connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1367.1">setRequestMethod</span></span><span class="koboSpan" id="kobo.1368.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1369.1">"GET"</span></span><span class="koboSpan" id="kobo.1370.1">);
        connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1371.1">setRequestProperty</span></span><span class="koboSpan" id="kobo.1372.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1373.1">"Accept"</span></span><span class="koboSpan" id="kobo.1374.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1375.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1376.1">application/json"</span></span><span class="koboSpan" id="kobo.1377.1">);
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1378.1">return</span></span><span class="koboSpan" id="kobo.1379.1"> connection;
    }
    private </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1380.1">void</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1381.1">validatePage</span></span><span class="koboSpan" id="kobo.1382.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1383.1">JsonNode response,</span></span>
<span class="hljs-params">                              </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1384.1">Set</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1385.1">&lt;</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1386.1">String</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1387.1">&gt; uniqueFullUrls</span></span><span class="koboSpan" id="kobo.1388.1">) {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1389.1">// Validate resourceType</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.1390.1">assertTrue</span></span><span class="koboSpan" id="kobo.1391.1">(response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1392.1">has</span></span><span class="koboSpan" id="kobo.1393.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1394.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1395.1">resourceType"</span></span><span class="koboSpan" id="kobo.1396.1">),
</span><span class="hljs-title">                   </span><span class="hljs-string"><span class="koboSpan" id="kobo.1397.1">"Response does not contain 'resourceType'"</span></span><span class="koboSpan" id="kobo.1398.1">);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1399.1">assertEquals</span></span><span class="koboSpan" id="kobo.1400.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1401.1">"Bundle"</span></span><span class="koboSpan" id="kobo.1402.1">, response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1403.1">get</span></span><span class="koboSpan" id="kobo.1404.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1405.1">"resourceType"</span></span><span class="koboSpan" id="kobo.1406.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1407.1">asText</span></span><span class="koboSpan" id="kobo.1408.1">(), 
</span><span class="hljs-title">                     </span><span class="hljs-string"><span class="koboSpan" id="kobo.1409.1">"resourceType is not 'Bundle'"</span></span><span class="koboSpan" id="kobo.1410.1">);
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1411.1">// Validate id is in UUID format</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.1412.1">assertTrue</span></span><span class="koboSpan" id="kobo.1413.1">(response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1414.1">has</span></span><span class="koboSpan" id="kobo.1415.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1416.1">"id"</span></span><span class="koboSpan" id="kobo.1417.1">), </span><span class="hljs-string"><span class="koboSpan" id="kobo.1418.1">"Response does not contain 'id'"</span></span><span class="koboSpan" id="kobo.1419.1">);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1420.1">String</span></span><span class="koboSpan" id="kobo.1421.1"> id = response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1422.1">get</span></span><span class="koboSpan" id="kobo.1423.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1424.1">"id"</span></span><span class="koboSpan" id="kobo.1425.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1426.1">asText</span></span><span class="koboSpan" id="kobo.1427.1">();
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1428.1">assertTrue</span></span><span class="koboSpan" id="kobo.1429.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.1430.1">isValidUUID</span></span><span class="koboSpan" id="kobo.1431.1">(id), </span><span class="hljs-string"><span class="koboSpan" id="kobo.1432.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1433.1">id is not a valid UUID"</span></span><span class="koboSpan" id="kobo.1434.1">);
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1435.1">// Validate type</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.1436.1">assertTrue</span></span><span class="koboSpan" id="kobo.1437.1">(response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1438.1">has</span></span><span class="koboSpan" id="kobo.1439.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1440.1">"type"</span></span><span class="koboSpan" id="kobo.1441.1">),
</span><span class="hljs-title">                   </span><span class="hljs-string"><span class="koboSpan" id="kobo.1442.1">"Response does not contain 'type'"</span></span><span class="koboSpan" id="kobo.1443.1">);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1444.1">assertEquals</span></span><span class="koboSpan" id="kobo.1445.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1446.1">"searchset"</span></span><span class="koboSpan" id="kobo.1447.1">, response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1448.1">get</span></span><span class="koboSpan" id="kobo.1449.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1450.1">"type"</span></span><span class="koboSpan" id="kobo.1451.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1452.1">asText</span></span><span class="koboSpan" id="kobo.1453.1">(),
</span><span class="hljs-title">                     </span><span class="hljs-string"><span class="koboSpan" id="kobo.1454.1">"type is not 'searchset'"</span></span><span class="koboSpan" id="kobo.1455.1">);
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1456.1">// Validate link array</span></span>
        <span class="hljs-title"><span class="koboSpan" id="kobo.1457.1">assertTrue</span></span><span class="koboSpan" id="kobo.1458.1">(response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1459.1">has</span></span><span class="koboSpan" id="kobo.1460.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1461.1">"link"</span></span><span class="koboSpan" id="kobo.1462.1">),
</span><span class="hljs-title">                   </span><span class="hljs-string"><span class="koboSpan" id="kobo.1463.1">"Response does not contain 'link'"</span></span><span class="koboSpan" id="kobo.1464.1">);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1465.1">JsonNode</span></span><span class="koboSpan" id="kobo.1466.1"> links = response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1467.1">get</span></span><span class="koboSpan" id="kobo.1468.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1469.1">"link"</span></span><span class="koboSpan" id="kobo.1470.1">);
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1471.1">assertTrue</span></span><span class="koboSpan" id="kobo.1472.1">(links.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1473.1">isArray</span></span><span class="koboSpan" id="kobo.1474.1">(), </span><span class="hljs-string"><span class="koboSpan" id="kobo.1475.1">"link is not an array"</span></span><span class="koboSpan" id="kobo.1476.1">);
        boolean hasSelfLink = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1477.1">false</span></span><span class="koboSpan" id="kobo.1478.1">;
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1479.1">for</span></span><span class="koboSpan" id="kobo.1480.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1481.1">JsonNode</span></span><span class="koboSpan" id="kobo.1482.1"> link : links) {
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1483.1">if</span></span><span class="koboSpan" id="kobo.1484.1"> (link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1485.1">has</span></span><span class="koboSpan" id="kobo.1486.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1487.1">"relation"</span></span><span class="koboSpan" id="kobo.1488.1">) &amp;&amp; </span><span class="hljs-string"><span class="koboSpan" id="kobo.1489.1">"self"</span></span><span class="koboSpan" id="kobo.1490.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1491.1">equals</span></span><span class="koboSpan" id="kobo.1492.1">(link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1493.1">get</span></span><span class="koboSpan" id="kobo.1494.1">(
</span><span class="hljs-keyword">                                        </span><span class="hljs-string"><span class="koboSpan" id="kobo.1495.1">"relation"</span></span><span class="koboSpan" id="kobo.1496.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1497.1">asText</span></span><span class="koboSpan" id="kobo.1498.1">())) {
                hasSelfLink = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1499.1">true</span></span><span class="koboSpan" id="kobo.1500.1">;
                </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1501.1">break</span></span><span class="koboSpan" id="kobo.1502.1">;
            }
        }
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1503.1">assertTrue</span></span><span class="koboSpan" id="kobo.1504.1">(hasSelfLink, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1505.1">"No link with 'relation' = 'self'"</span></span><span class="koboSpan" id="kobo.1506.1">);
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1507.1">// Validate entries</span></span>
        <span class="hljs-keyword"><span class="koboSpan" id="kobo.1508.1">if</span></span><span class="koboSpan" id="kobo.1509.1"> (response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1510.1">has</span></span><span class="koboSpan" id="kobo.1511.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1512.1">"entry"</span></span><span class="koboSpan" id="kobo.1513.1">)) {
            </span><span class="hljs-title"><span class="koboSpan" id="kobo.1514.1">JsonNode</span></span><span class="koboSpan" id="kobo.1515.1"> entries = response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1516.1">get</span></span><span class="koboSpan" id="kobo.1517.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1518.1">"entry"</span></span><span class="koboSpan" id="kobo.1519.1">);
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1520.1">for</span></span><span class="koboSpan" id="kobo.1521.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1522.1">JsonNode</span></span><span class="koboSpan" id="kobo.1523.1"> entry : entries) {
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.1524.1">assertTrue</span></span><span class="koboSpan" id="kobo.1525.1">(entry.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1526.1">has</span></span><span class="koboSpan" id="kobo.1527.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1528.1">"fullUrl"</span></span><span class="koboSpan" id="kobo.1529.1">),
</span><span class="hljs-title">                           </span><span class="hljs-string"><span class="koboSpan" id="kobo.1530.1">"Entry does not contain 'fullUrl'"</span></span><span class="koboSpan" id="kobo.1531.1">);
                </span><span class="hljs-title"><span class="koboSpan" id="kobo.1532.1">String</span></span><span class="koboSpan" id="kobo.1533.1"> fullUrl = entry.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1534.1">get</span></span><span class="koboSpan" id="kobo.1535.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1536.1">"fullUrl"</span></span><span class="koboSpan" id="kobo.1537.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1538.1">asText</span></span><span class="koboSpan" id="kobo.1539.1">();
                </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1540.1">// Ensure fullUrl is unique</span></span>
                <span class="hljs-title"><span class="koboSpan" id="kobo.1541.1">assertTrue</span></span><span class="koboSpan" id="kobo.1542.1">(uniqueFullUrls.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1543.1">add</span></span><span class="koboSpan" id="kobo.1544.1">(fullUrl),
</span><span class="hljs-title">                           </span><span class="hljs-string"><span class="koboSpan" id="kobo.1545.1">"Duplicate fullUrl detected: "</span></span><span class="koboSpan" id="kobo.1546.1"> + fullUrl);
            }
        }
    }
    private </span><span class="hljs-title"><span class="koboSpan" id="kobo.1547.1">String</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1548.1">getNextLink</span></span><span class="koboSpan" id="kobo.1549.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1550.1">JsonNode response</span></span><span class="koboSpan" id="kobo.1551.1">) {
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1552.1">JsonNode</span></span><span class="koboSpan" id="kobo.1553.1"> links = response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1554.1">get</span></span><span class="koboSpan" id="kobo.1555.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1556.1">"link"</span></span><span class="koboSpan" id="kobo.1557.1">);
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1558.1">for</span></span><span class="koboSpan" id="kobo.1559.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1560.1">JsonNode</span></span><span class="koboSpan" id="kobo.1561.1"> link : links) {
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1562.1">if</span></span><span class="koboSpan" id="kobo.1563.1"> (link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1564.1">has</span></span><span class="koboSpan" id="kobo.1565.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1566.1">"relation"</span></span><span class="koboSpan" id="kobo.1567.1">) &amp;&amp; </span><span class="hljs-string"><span class="koboSpan" id="kobo.1568.1">"next"</span></span><span class="koboSpan" id="kobo.1569.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1570.1">equals</span></span><span class="koboSpan" id="kobo.1571.1">(link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1572.1">get</span></span><span class="koboSpan" id="kobo.1573.1">(
</span><span class="hljs-keyword">                                        </span><span class="hljs-string"><span class="koboSpan" id="kobo.1574.1">"relation"</span></span><span class="koboSpan" id="kobo.1575.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1576.1">asText</span></span><span class="koboSpan" id="kobo.1577.1">())) {
                </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1578.1">return</span></span><span class="koboSpan" id="kobo.1579.1"> link.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1580.1">get</span></span><span class="koboSpan" id="kobo.1581.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1582.1">"url"</span></span><span class="koboSpan" id="kobo.1583.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1584.1">asText</span></span><span class="koboSpan" id="kobo.1585.1">();
            }
        }
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1586.1">return</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.1587.1">null</span></span><span class="koboSpan" id="kobo.1588.1">;
    }
    private boolean </span><span class="hljs-title"><span class="koboSpan" id="kobo.1589.1">isValidUUID</span></span><span class="koboSpan" id="kobo.1590.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1591.1">String</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1592.1"> id</span></span><span class="koboSpan" id="kobo.1593.1">) {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1594.1">try</span></span><span class="koboSpan" id="kobo.1595.1"> {
            </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1596.1">UUID</span></span><span class="koboSpan" id="kobo.1597.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1598.1">fromString</span></span><span class="koboSpan" id="kobo.1599.1">(id);
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1600.1">return</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.1601.1">true</span></span><span class="koboSpan" id="kobo.1602.1">;
        } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1603.1">catch</span></span><span class="koboSpan" id="kobo.1604.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.1605.1">IllegalArgumentException</span></span><span class="koboSpan" id="kobo.1606.1"> e) {
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1607.1">return</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.1608.1">false</span></span><span class="koboSpan" id="kobo.1609.1">;
        }
    }
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1610.1">
     The test is now a lot more complex.
    </span>
    <span class="koboSpan" id="kobo.1610.2">
     Look at how some helping functions are created (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1611.1">
      isValidUUID()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1612.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1613.1">
      createConnection()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1614.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.1614.2">
     This test would take longer to write and be costlier to maintain.
    </span>
    <span class="koboSpan" id="kobo.1614.3">
     But with the use of LLMs, the whole test is ready to run in just a few minutes.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1615.1">
     I hope you
    </span>
    <a id="_idIndexMarker685">
    </a>
    <span class="koboSpan" id="kobo.1616.1">
     are seeing the pattern at this point.
    </span>
    <span class="koboSpan" id="kobo.1616.2">
     As the API gets more complex, the tests also evolve.
    </span>
    <span class="koboSpan" id="kobo.1616.3">
     The LLM prompt itself is now stored in the Git repository and is an integral part of the code base, to the point that it can be seen as part of the software documentation.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-223">
    <a id="_idTextAnchor237">
    </a>
    <span class="koboSpan" id="kobo.1617.1">
     Summary
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1618.1">
     The introduction of generative AI holds immense potential to reshape the landscape of software development, especially in the realm of testing.
    </span>
    <span class="koboSpan" id="kobo.1618.2">
     By automating test creation, streamlining complex processes, and enhancing adaptability, generative AI offers the promise of transforming testing into a more efficient, accessible, and cost-effective part of the development lifecycle.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1619.1">
     Through the strategies and examples discussed in this chapter, we hope you have acquired the skills and inspiration to explore and extend the testing of your APIs.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1620.1">
     Testing is a tool for validating behavior during the development and maintenance of our APIs, but for a truly robust service, we need to monitor these behaviors in production.
    </span>
    <span class="koboSpan" id="kobo.1620.2">
     That is what we will be looking at in the next chapter.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-224">
    <a id="_idTextAnchor238">
    </a>
    <span class="koboSpan" id="kobo.1621.1">
     Further reading
    </span>
   </h1>
   <ul>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1622.1">
       Test driven development
      </span>
     </em>
     <span class="koboSpan" id="kobo.1623.1">
      :
     </span>
     <a href="https://en.wikipedia.org/wiki/Test-driven_development ">
      <span class="url">
       <span class="koboSpan" id="kobo.1624.1">
        https://en.wikipedia.org/wiki/Test-driven_development
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1625.1">
       Prompt Engineering
      </span>
     </em>
     <span class="koboSpan" id="kobo.1626.1">
      :
     </span>
     <a href="https://en.wikipedia.org/wiki/Prompt_engineering ">
      <span class="url">
       <span class="koboSpan" id="kobo.1627.1">
        https://en.wikipedia.org/wiki/Prompt_engineering
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1628.1">
       Legal Ruling: AI-Generated Art and Copyright
      </span>
     </em>
     <span class="koboSpan" id="kobo.1629.1">
      :
     </span>
     <a href="https://www.reuters.com/legal/ai-generated-art-cannot-receive-copyrights-us-court-says-2023-08-21/ ">
      <span class="url">
       <span class="koboSpan" id="kobo.1630.1">
        https://www.reuters.com/legal/ai-generated-art-cannot-receive-copyrights-us-court-says-2023-08-21/
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1631.1">
       U.S.
      </span>
      <span class="koboSpan" id="kobo.1631.2">
       Copyright Office’s View on AI Prompts
      </span>
     </em>
     <span class="koboSpan" id="kobo.1632.1">
      :
     </span>
     <a href="https://www.theverge.com/news/602096/copyright-office-says-ai-prompting-doesnt-deserve-copyright-protection ">
      <span class="url">
       <span class="koboSpan" id="kobo.1633.1">
        https://www.theverge.com/news/602096/copyright-office-says-ai-prompting-doesnt-deserve-copyright-protection
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1634.1">
       HAPI FHIR: Open-Source Implementation of HL7 FHIR
      </span>
     </em>
     <span class="koboSpan" id="kobo.1635.1">
      :
     </span>
     <em class="italic">
     </em>
     <a href="https://hapifhir.io/ ">
      <span class="url">
       <span class="koboSpan" id="kobo.1636.1">
        https://hapifhir.io/
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1637.1">
       HL7 FHIR Official Specification
      </span>
     </em>
     <a href="https://hl7.org/fhir/">
      <span class="url">
       <span class="koboSpan" id="kobo.1638.1">
        https://hl7.org/fhir/
       </span>
      </span>
     </a>
    </li>
   </ul>
  </div>
 </body></html>