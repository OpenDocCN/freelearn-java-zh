<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Data-Driven Testing with TestNG</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will see how to create data-driven tests using TestNG and Selenium WebDriver. We will look at the following topics:</p>
<ul>
<li>What is data-driven testing?</li>
<li>Using TestNG suite parameters to parameterize tests.</li>
<li>Using TestNG data providers for data-driven testing.</li>
<li>Using the CSV and Excel file formats for storing and reading test data.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overview of data-driven testing</h1>
                </header>
            
            <article>
                
<p>By employing the data-driven testing approach, we can use a single test to verify different sets of test cases or test data by driving the test with input and expected values from an external data source instead of using the hardcoded values every time a test is run. This becomes useful when we have similar tests that consist of the same steps but differ in the input data and expected value or the application state. Here is an example of a set of login test cases with different combinations:</p>
<table style="border-collapse: collapse;width: 100%;border-color: #000000" border="1">
<tbody>
<tr>
<td style="width: 24%" class="CDPAlignCenter CDPAlign"><strong>Description</strong></td>
<td style="width: 28.7548%" class="CDPAlignCenter CDPAlign"><strong>Test data</strong></td>
<td style="width: 41.2452%" class="CDPAlignCenter CDPAlign"><strong>Expected output</strong></td>
</tr>
<tr>
<td style="width: 24%">Test valid username and password</td>
<td style="width: 28.7548%">A pair of valid usernames and passwords</td>
<td style="width: 41.2452%">The user should log into the application with a success message</td>
</tr>
<tr>
<td style="width: 24%">Test invalid username and password</td>
<td style="width: 28.7548%">An invalid username and password</td>
<td style="width: 41.2452%">The user should be displayed the login error</td>
</tr>
<tr>
<td style="width: 24%">Valid username and invalid password</td>
<td style="width: 28.7548%">A valid username and an invalid password</td>
<td style="width: 41.2452%">The user should be displayed the login error</td>
</tr>
</tbody>
</table>
<p class="mce-root"/>
<p>We can create a single script that can handle the test data and the conditions from the preceding table. By using the data-driven testing approach, we separate the test data from the test logic by replacing the hardcoded test data with variables using the data from external sources, such as CSV or a spreadsheet file. This also helps to create reusable tests that can run with different sets of data, which can be kept outside of the test. Data-driven testing also helps in increasing the test coverage, as we can handle multiple test conditions while minimizing the amount of test code we need to write and maintain.</p>
<p>The benefits of data-driven testing are as follows:</p>
<ul>
<li>We can get greater test coverage while minimizing the amount of test code we need to write and maintain</li>
<li>It makes creating and running a lot of test conditions very easy</li>
<li>Test data can be designed and created before the application is ready for testing</li>
<li>Data tables can also be used in manual testing</li>
</ul>
<p>Selenium WebDriver, being a pure browser-automation API, does not provide built-in features to support data-driven testing. However, we can add support for data-driven testing using testing frameworks such as JUnit or TestNG. In this book, we are using TestNG as our testing framework and we will use parameterization features of TestNG to create data-driven tests in the following sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Parameterizing Tests using suite parameters</h1>
                </header>
            
            <article>
                
<p>In <em><a href="9f647c33-1720-4d7b-973b-7d2ef9dad924.xhtml">Chapter 1</a>, Introducing WebDriver and WebElements</em>, we created a search test that performs a simple search on the application under test. This test searches for a given product and validates the title. We used a hardcoded value, <kbd>phones</kbd>, for the search, as shown in the following code snippet:</p>
<pre> @Test
 public void searchProduct() {

        // find search box and enter search string
        WebElement searchBox = driver.findElement(By.name("q"));

       <strong> searchBox.sendKeys("Phones");</strong>

        WebElement searchButton =
                driver.findElement(By.className("search-button"));

        searchButton.click();

        <strong>assertThat(driver.getTitle())
                .isEqualTo("Search results for: 'Phones'");</strong>
    }</pre>
<p>Instead of using hardcoded values, we can parameterize these values and provide them to the test method using the suite-parameter feature of TestNG. This will help to remove using hardcoded values in the test method and move them into TestNG suite files. The parameterized values can be used in multiple tests. When we need to change these values, we don't have to go to each test and make a change,the  instead we can simply change these in suite file.</p>
<p>Now, let's look at steps for using the TestNG Parameters from the suite file. In <em><a href="9f647c33-1720-4d7b-973b-7d2ef9dad924.xhtml">Chapter 1</a>,</em> we created a <kbd>testng.xml</kbd> file, which is located in the <kbd>src/test/resources/suites</kbd> folder. Let's modify the file and add the parameter declaration, as highlighted in the following code snippet: </p>
<pre><span>&lt;!DOCTYPE </span><span>suite </span><span>SYSTEM </span><span>"http://testng.org/testng-1.0.dtd" </span><span>&gt;<br/></span><span><br/></span><span>&lt;suite </span><span>name</span><span>="Chapter 1" </span><span>verbose</span><span>="1"</span><span>&gt;<br/></span><span>    &lt;listeners&gt;<br/></span><span>        &lt;listener </span><span>class-name</span><span>="com.vimalselvam.testng.listener.ExtentTestNgFormatter"</span><span>/&gt;<br/></span><span>    &lt;/listeners&gt;<br/></span><span>    &lt;test </span><span>name</span><span>="Search Test"</span><span>&gt;<br/></span><strong><span>        &lt;parameter </span><span>name</span><span>="searchWord" </span><span>value</span><span>="phones"</span></strong><span><strong>/&gt;</strong><br/></span><strong><span>        &lt;parameter </span><span>name</span><span>="items" </span><span>value</span><span>="3"</span></strong><span><strong>/&gt;</strong><br/></span><span>        &lt;classes&gt;<br/></span><span>            &lt;class </span><span>name</span><span>="com.example.SearchTest"</span><span>/&gt;<br/></span><span>        &lt;/classes&gt;<br/></span><span>    &lt;/test&gt;<br/></span><span>&lt;/suite&gt;</span></pre>
<p>We can add parameters in the TestNG suite file using the <kbd>&lt;parameter&gt;</kbd> tag. We have to provide the <kbd>name</kbd> and  <kbd>value</kbd> attributes for the parameter. In this example, we create two parameters: <kbd>searchWord</kbd> and <kbd>items</kbd>. These parameters store the search word and expected count of items returned by the application for that search word. </p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Now, let's modify the test to use parameters instead of hardcoded values. First, we need to use the <kbd>@Parameters</kbd> annotation before the <kbd>@Test</kbd> annotation for the test method. In the <kbd>@Parameters</kbd> annotation, we need to supply the exact names and order of the parameters declared in the suite file. In this case, we will supply <kbd>searchWord</kbd> and <kbd>items</kbd>. We also need to add arguments to the test method along with the required data type to map the XML parameters. In this case, the <kbd>String searchWord</kbd> and <kbd>int Items</kbd> arguments are added to the <kbd>searchProduct()</kbd> test method. Finally, we need to replace the hardcoded values with the arguments in the test method, as shown in the following code snippet:</p>
<pre><strong><span>@Parameters</span>({<span>"searchWord"</span><span>, </span><span>"items"</span>})</strong><br/><span>@Test<br/></span><span>public void </span><span>searchProduct</span>(<strong>String searchWord<span>, int </span>items</strong>) {<br/><br/>    <span>// find search box and enter search string<br/></span><span>    </span>WebElement searchBox = <span>driver</span>.findElement(By.<span>name</span>(<span>"q"</span>))<span>;<br/></span><span><br/></span><span>    // use searchWord parameter value from XML suite file<br/></span><strong>    searchBox.sendKeys(searchWord)</strong><span><strong>;</strong><br/></span><span><br/></span><span>    </span>WebElement searchButton =<br/>            <span>driver</span>.findElement(By.<span>className</span>(<span>"search-button"</span>))<span>;<br/></span><span><br/></span><span>    </span>searchButton.click()<span>;<br/></span><span><br/></span><span>    </span><span>assertThat</span>(<span>driver</span>.getTitle())<br/>            .isEqualTo(<span>"Search results for: '" </span>+ searchWord  + <span>"'"</span>)<span>;<br/></span><span><br/></span><span>    </span>List&lt;WebElement&gt; searchItems = <span>driver<br/></span><span>            </span>.findElements(By.<span>xpath</span>(<span>"//h2[@class='product-name']/a"</span>))<span>;<br/></span><span><br/></span><span>    </span><strong><span>assertThat</span>(searchItems.size())</strong><br/><strong>            .isEqualTo(items)</strong><span><strong>;</strong><br/></span>}</pre>
<p>We have to run the parameterized tests via the testng.xml file for TestNG to read the parameters defined in the suite file and pass the values to the test method. </p>
<p>During execution, TestNG will use the parameters defined in the XML suite file and map these in the same order to the Java parameters in test methods using the <kbd>@Parameters</kbd> annotation. It will pass the parameter values from the suite file using the arguments added in the test method. TestNG will throw an exception if the number of parameters between XML and the <kbd><span>@Parameters</span></kbd> annotation does not match.</p>
<p class="mce-root"/>
<p>In the next section, we will see a programmatic parameterization, which offers us the ability to run tests with multiple rows of test data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Parameterizing Tests with a Data Provider</h1>
                </header>
            
            <article>
                
<p>While suite parameters are useful for simple parameterization, they are not sufficient for creating data-driven tests with multiple test data values and reading data from external files, such as property files, CSV, Excel, or databases. <span>In this case, we can use a <kbd>Data Provider</kbd> to supply the values need to test. A <kbd>Data Provider</kbd> is a method defined in the test class that returns an array of array of objects.  This method is annotated with the </span><kbd>@DataProvider</kbd> annotation. </p>
<p>Let's modify the preceding test to use the <kbd>Data Provider</kbd>. Instead of using a single searchWord, we will now use three combinations of <kbd>searchWords</kbd> and expected <kbd>items</kbd> counts returned by the search. We will add a new method, named provider(), in the SearchTest class, as shown in following code, before the <kbd>@BeforeMethod</kbd> annotation:</p>
<pre><span>public class </span>SearchTest {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><strong><span>    </span><span>@DataProvider</span>(<span>name </span>= <span>"searchWords"</span>)</strong><br/><strong>    <span>public </span>Object[][] <span>provider</span>() {</strong><br/><strong>        <span>return new </span>Object[][]{</strong><br/><strong>                {<span>"phones"</span><span>, </span><span>3</span>}<span>,<br/></span><span>                </span>{<span>"music"</span><span>, </span><span>5</span>}<span>,<br/></span><span>                </span>{<span>"iphone 5s"</span><span>, </span><span>0</span>}</strong><br/><strong>        }<span>;<br/></span><span>    </span>}</strong><br/><br/>    <span>@BeforeMethod<br/></span><span>    </span><span>public void </span><span>setup</span>() {<br/>        ...<br/><span>    </span>}<br/>    ...<br/>}</pre>
<p>When a method is annotated with<span> </span><kbd>@DataProvider</kbd>, it becomes a data-feeder method by passing the test data to the test case. In addition to the<span> </span><kbd>@DataProvider</kbd><span> </span>annotation, we also need to provide a name for the <kbd>data provider</kbd>. In this example, we have given the name as<span> </span><kbd>searchWords</kbd>.</p>
<p><span>Next, we need to update the <kbd>searchTest()</kbd> test method to link to the <kbd>data provider</kbd>. This is done with the following steps:</span></p>
<ol>
<li><span>Provide the name of the <kbd>data provider</kbd> in the <kbd>@Test</kbd> annotation</span></li>
<li>Add two arguments <kbd>String searchWord</kbd> and <kbd>int items</kbd> to the <kbd>searchProduct</kbd> method</li>
<li>Use method parameters to substitute hardcoded values:</li>
</ol>
<pre><span>public class </span>SearchTest {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@DataProvider</span>(<span>name </span>= <span>"searchWords"</span>)<br/>    <span>public </span>Object[][] <span>provider</span>() {<br/>      ...<span><br/></span><span>    </span>}<br/><br/>    <span>@BeforeMethod<br/></span><span>    </span><span>public void </span><span>setup</span>() {<br/><br/>        System.<span>setProperty</span>(<span>"webdriver.chrome.driver"</span><span>,<br/></span><span>                </span><span>"./src/test/resources/drivers/chromedriver"</span>)<span>;<br/></span><span>        </span><span>driver </span>= <span>new </span>ChromeDriver()<span>;<br/></span><span>        </span><span>driver</span>.get(<span>"http://demo-store.seleniumacademy.com/"</span>)<span>;<br/></span><span><br/></span><span>    </span>}<br/><br/>    <strong><span>@Test</span>(<span>dataProvider </span>= <span>"searchWords"</span>)</strong><br/>    <span>public void </span><span>searchProduct</span>(<strong>String searchWord<span>, int </span>items</strong>) {<br/><br/>        <span>// find search box and enter search string<br/></span><span>        </span>WebElement searchBox = <span>driver</span>.findElement(By.<span>name</span>(<span>"q"</span>))<span>;<br/></span><span><br/></span><span>        </span><strong>searchBox.sendKeys(searchWord)</strong><span><strong>;</strong><br/></span><span><br/></span><span>        </span>WebElement searchButton =<br/>                <span>driver</span>.findElement(By.<span>className</span>(<span>"search-button"</span>))<span>;<br/></span><span><br/></span><span>        </span>searchButton.click()<span>;<br/></span><span><br/></span><span>        </span><span>assertThat</span>(<span>driver</span>.getTitle())<br/>                .isEqualTo(<span>"Search results for: '" </span>+ searchWord + <span>"'"</span>)<span>;<br/></span><span><br/></span><strong><span>        </span>List&lt;WebElement&gt; searchItems = <span>driver<br/></span><span>                </span>.findElements(By.<span>xpath</span>(<span>"//h2[@class='product-name']/a"</span>))<span>;<br/></span><span><br/></span><span>        </span><span>assertThat</span>(searchItems.size())</strong><br/><strong>                .isEqualTo(items)</strong><span><strong>;</strong><br/></span><span>    </span>}<br/><br/>    <span>@AfterMethod<br/></span><span>    </span><span>public void </span><span>tearDown</span>() {<br/>        <span>driver</span>.quit()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p><span>The</span><span> </span><kbd>provider()</kbd><span> </span><span>method will become the data-feeder method, which returns</span><span> an</span><span> array of objects that are combinations of <kbd>searchWords</kbd> and expected <kbd>items</kbd> counts</span><span>, and TestNG will pass the array of data rows to the test method.</span></p>
<p>TestNG will execute the test four times with different test combinations. TestNG also generates a well-formatted report at the end of the test execution. Here is an example of the test results with TestNG using the defined values. The <kbd>searchProduct</kbd> test is executed three times, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d5d4e50e-b3fa-41d7-8dfc-58f99bc684a7.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reading data from a CSV file</h1>
                </header>
            
            <article>
                
<p>We saw a simple data-driven test TestNG. The test data was hardcoded in the test-script code. This could become difficult to maintain. It is recommended that we store the test data separately from the test scripts. Often, we use data from the production environment for testing. This data can be exported in the CSV format. We can read these CSV files in data-provider methods and pass the data to the test instead of hardcoded object arrays. </p>
<p class="mce-root"/>
<p>In this example, we will use the OpenCSV library to read a CSV file. OpenCSV is a simple Java library for reading CSV files in Java. You can find more details on OpenCSV at <a href="http://opencsv.sourceforge.net/">http://opencsv.sourceforge.net/</a>. </p>
<p>Let's first create a CSV file, named <kbd>data.csv</kbd>, in the <kbd>src/test/resources/data</kbd> folder and copy the following combinations of <kbd>searchWords</kbd> and <kbd>items</kbd>:</p>
<pre><span>searchWord</span><span>,</span><span>items<br/></span><span>phones</span><span>,</span><span>3<br/></span><span>music</span><span>,</span><span>5<br/></span><span>iphone 5s</span><span>,</span><span>0</span></pre>
<p><span>Next, we need to add the OpenCSV dependency to the Maven pom.xml file. For this example, we will use the latest version, 3.4, as shown in the following code snippet:</span></p>
<pre><span>&lt;dependency&gt;<br/></span><span>    &lt;groupId&gt;</span>com.opencsv<span>&lt;/groupId&gt;<br/></span><span>    &lt;artifactId&gt;</span>opencsv<span>&lt;/artifactId&gt;<br/></span><span>    &lt;version&gt;</span>3.4<span>&lt;/version&gt;<br/></span><span>&lt;/dependency&gt;</span></pre>
<p>Finally, we need to modify the <kbd>provider()</kbd> method in the test class to read the contents of the CSV file and return them as an<span> array of objects, as shown in the following code:</span></p>
<pre><span>public class </span>SearchTest {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><strong><span>@DataProvider</span>(<span>name </span>= <span>"searchWords"</span>)</strong><br/><strong>    <span>public </span>Iterator&lt;Object[]&gt; <span>provider</span>() <span>throws </span>Exception {</strong><br/>        <br/><strong>        CSVReader reader = <span>new </span>CSVReader(</strong><br/><strong>                <span>new </span>FileReader(<span>"./src/test/resources/data/data.csv"</span>)</strong><br/><strong>                <span>, </span><span>','</span><span>, </span><span>'</span><span>\'</span><span>'</span><span>, </span><span>1</span>)<span>;<br/></span><span>        <br/></span><span>        </span>List&lt;Object[]&gt; myEntries = <span>new </span>ArrayList&lt;Object[]&gt;()<span>;<br/></span><span>        </span>String[] nextLine<span>;<br/></span><span>        while </span>((nextLine = reader.readNext()) != <span>null</span>) {</strong><br/><strong>            myEntries.add(nextLine)<span>;<br/></span><span>        </span>}</strong><br/><strong>        reader.close()<span>;<br/></span><span>        return </span>myEntries.iterator()<span>;<br/></span><span>    </span>}</strong><br/><br/>    <span>@BeforeMethod<br/></span><span>    </span><span>public void </span><span>setup</span>() {<br/><br/>        System.<span>setProperty</span>(<span>"webdriver.chrome.driver"</span><span>,<br/></span><span>                </span><span>"./src/test/resources/drivers/chromedriver"</span>)<span>;<br/></span><span>        </span><span>driver </span>= <span>new </span>ChromeDriver()<span>;<br/></span><span>        </span><span>driver</span>.get(<span>"http://demo-store.seleniumacademy.com/"</span>)<span>;<br/></span><span><br/></span><span>    </span>}<br/><br/>    <span>@Test</span>(<span>dataProvider </span>= <span>"searchWords"</span>)<br/>    <span>public void </span><span>searchProduct</span>(String searchWord<span>, </span>String items) {<br/><br/>        <span>// find search box and enter search string<br/></span><span>        </span>WebElement searchBox = <span>driver</span>.findElement(By.<span>name</span>(<span>"q"</span>))<span>;<br/></span><span><br/></span><span>        </span>searchBox.sendKeys(searchWord)<span>;<br/></span><span><br/></span><span>        </span>WebElement searchButton =<br/>                <span>driver</span>.findElement(By.<span>className</span>(<span>"search-button"</span>))<span>;<br/></span><span><br/></span><span>        </span>searchButton.click()<span>;<br/></span><span><br/></span><span>        </span><span>assertThat</span>(<span>driver</span>.getTitle())<br/>                .isEqualTo(<span>"Search results for: '" </span>+ searchWord + <span>"'"</span>)<span>;<br/></span><span><br/></span><span>        </span>List&lt;WebElement&gt; searchItems = <span>driver<br/></span><span>                </span>.findElements(By.<span>xpath</span>(<span>"//h2[@class='product-name']/a"</span>))<span>;<br/></span><span><br/></span><span>        </span><span>assertThat</span>(searchItems.size())<br/>                .isEqualTo(Integer.<span>parseInt</span>(items))<span>;<br/></span><span>    </span>}<br/><br/>    <span>@AfterMethod<br/></span><span>    </span><span>public void </span><span>tearDown</span>() {<br/>        <span>driver</span>.quit()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>In the provide method, the CSV file will be parsed using the CSVReader class of the OpenCSV library. We need to provide the path of the CSV file, the delimiter character, and the header row number (this will skip while fetching the data), as shown in the following code snippet:</p>
<pre><span>@DataProvider</span>(<span>name </span>= <span>"searchWords"</span>)<br/><span>public </span>Iterator&lt;Object[]&gt; <span>provider</span>() <span>throws </span>Exception {<br/><br/>    CSVReader reader = <span>new </span>CSVReader(<br/>            <span>new </span>FileReader(<span>"./src/test/resources/data/data.csv"</span>)<br/>            <span>, </span><span>','</span><span>, </span><span>'</span><span>\'</span><span>'</span><span>, </span><span>1</span>)<span>;<br/></span><span><br/></span><span>    </span>List&lt;Object[]&gt; myEntries = <span>new </span>ArrayList&lt;Object[]&gt;()<span>;<br/></span><span>    </span>String[] nextLine<span>;<br/></span><span>    while </span>((nextLine = reader.readNext()) != <span>null</span>) {<br/>        myEntries.add(nextLine)<span>;<br/></span><span>    </span>}<br/>    reader.close()<span>;<br/></span><span>    return </span>myEntries.iterator()<span>;<br/></span>}</pre>
<p>In the preceding code, we will read each line of the CSV file ,copy it to an array of the object, and return it to the test method. The test method will be executed for each row in the CSV file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reading data from an Excel file</h1>
                </header>
            
            <article>
                
<p>To maintain test cases and test data, Microsoft Excel is a favourite tool for testers. Compared to the CSV file format, Excel offers numerous features and a structured way to store data. A tester can create and maintain tables of test data in an Excel spreadsheet easily. </p>
<p>Let's create an Excel spreadsheet, named <kbd>data.xlsx</kbd>, in the <kbd>src/test/resources/data</kbd> folder with the following contents:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/af37aa88-2891-4ba1-9fd8-452979afabbb.png"/></div>
<p>In this section, we will use an Excel spreadsheet as your data source. We will use the Apache POI API, developed by the Apache Foundation, to manipulate the Excel spreadsheet. </p>
<p class="mce-root"/>
<p>Let's modify the <kbd>provider()</kbd> method to use a helper class, called <kbd>SpreadsheetData</kbd>, to read the Excel file's contents:</p>
<pre><span>@DataProvider</span>(<span>name </span>= <span>"searchWords"</span>)<br/><span>public </span>Object[][] <span>provider</span>() <span>throws </span>Exception {<br/>    SpreadsheetData spreadsheetData = <span>new </span>SpreadsheetData()<span>;<br/></span><span>    return </span>spreadsheetData.getCellData(<span>"./src/test/resources/data/data.xlsx"</span>)<span>;<br/></span>}</pre>
<p>The <kbd>SpreadsheetData</kbd> class This is available in the source code bundle for this book. This class supports both the old .xls and newer .xlsx formats:</p>
<pre><span>public class </span>SpreadsheetData {<br/>    <span>public </span>String[][] <span>getCellData</span>(String path) <span>throws </span>InvalidFormatException<span>, </span>IOException {<br/> <span>       </span>FileInputStream stream = <span>new </span>FileInputStream(path)<span>;<br/></span><span>        </span>Workbook workbook = WorkbookFactory.<span>create</span>(stream)<span>;<br/></span><span> </span><span>       </span>Sheet s = workbook.getSheetAt(<span>0</span>)<span>;<br/></span><span> </span><span>       int </span>rowcount = s.getLastRowNum()<span>;<br/></span><span>        int </span>cellcount = s.getRow(<span>0</span>).getLastCellNum()<span>;<br/></span><span> </span><span>       </span>String data[][] = <span>new </span>String[rowcount][cellcount]<span>;<br/></span><span>        for </span>(<span>int </span>rowCnt = <span>1</span><span>; </span>rowCnt &lt;= rowcount<span>; </span>rowCnt++) {<br/>            Row row = s.getRow(rowCnt)<span>;<br/></span><span>            for </span>(<span>int </span>colCnt = <span>0</span><span>; </span>colCnt &lt; cellcount<span>; </span>colCnt++) {<br/>                Cell cell = row.getCell(colCnt)<span>;<br/></span><span>                try </span>{<br/>                    <span>if </span>(cell.getCellType() == cell.<span>CELL_TYPE_STRING</span>) {<br/>                        data[rowCnt - <span>1</span>][colCnt] = cell.getStringCellValue()<span>;<br/></span><span>                    </span>} <span>else </span>{<br/>                        data[rowCnt - <span>1</span>][colCnt] = String.<span>valueOf</span>(cell.getNumericCellValue())<span>;<br/></span><span>                    </span>}<br/>                } <span>catch </span>(Exception e) {<br/>                    e.printStackTrace()<span>;<br/></span><span>                </span>}<br/>            }<br/>        }<br/>        <span>return </span>data<span>;<br/></span><span>    </span>}<br/>}</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p>When the test is executed, the <kbd>provider()</kbd> method will create an instance of the <kbd>SpreadsheetData</kbd> class. The <kbd>SpreadsheetData</kbd> class reads the contents of the Excel spreadsheet row by row in a collection and returns this collection back to the <kbd>provider()</kbd> method:</p>
<pre>InputStream spreadsheet = new FileInputStream("./src/test/resources/data/data.xlsx"); <br/>return new SpreadsheetData(spreadsheet).getData(); </pre>
<p>For each row in the test data collection returned by the <kbd>provider()</kbd> method, the test runner will instantiate the test case class, passing the test data as parameters to the test-class constructor, and then execute all the tests in the test class.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we learned about an important technique to create parameterized and data-driven tests using TestNG features. This will help you to create highly-maintainable and robust tests with minimum coding effort and increased test coverage. We also looked at ways to read data from the CSV and Excel formats.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>Explain what Data-driven Testing is.</li>
<li>Selenium supports data-driven testing— True or False?</li>
<li>What are two methods in TestNG to create data-driven tests?</li>
<li>Explain the <kbd>DataProvider</kbd> method in TestNG.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further information</h1>
                </header>
            
            <article>
                
<p><span>You can check out the following links for more information about the topics covered in this chapter:</span></p>
<ul>
<li>Read more about TestNG data-driven features at <a href="https://testng.org/doc/documentation-main.html#parameters">https://testng.org/doc/documentation-main.html#parameters</a></li>
<li>Read more about the Apache POI library at <a href="https://poi.apache.org/">https://poi.apache.org/</a></li>
</ul>


            </article>

            
        </section>
    </body></html>