<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Experimenting with the Java Shell</h1>
                </header>
            
            <article>
                
<p class="mce-root">In the previous chapter, we explored how to migrate pre-Java 9 applications to the new Java platform. We examined several issues that might cause your current applications to have problems running on Java 9. We started with a review of Project Jigsaw and then looked at how modules fit into the new Java platform. We provided you with insights and processes to get your Java 8 code working with Java 9. Specifically, we <span>provided tips for</span> migration <span>planning, shared advice from</span> Oracle <span>regarding migration, and shared tools that you can use to help you as you get started with Java 9.</span></p>
<p>In this chapter, we will take our first look at the new command line, <strong>read-eval-print loop</strong> (also referred to as <strong>REPL</strong>) tool in Java 9, the <strong>Java Shell</strong> (<strong>JShell</strong>). We will start with introductory information regarding the tool, the read-eval-print loop concept, and move into the commands and command-line options for use with JShell. We will take a practitioner's approach to our review of the Java Shell and include examples you can try on your own.</p>
<p>The following topics are covered in this chapter:</p>
<ul>
<li>What is JShell?</li>
<li>Getting started with JShell</li>
<li>Practical uses of JShell</li>
<li>Working with scripts</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">What is JShell?</h1>
                </header>
            
            <article>
                
<p>JShell is a new tool introduced with Java 9. It is an interactive read-eval-print loop tool that is used to evaluate the following Java programming language components--declarations, statements, and expressions. It has its own API so that it can be used by external applications.</p>
<div class="packt_infobox">Read-Eval-Print Loop is often referred to as REPL, taking the first letter from each word in the phrase. It is also knows language shell or interactive top-level.</div>
<p>The introduction of JShell was a result of <strong>Java Enhancement Program</strong> (<strong>JEP</strong>) 222. Here are the stated goals of this JEP in regards to the Java Shell command-line tool:</p>
<ul>
<li>Facilitate rapid investigation</li>
<li>Facilitate rapid coding</li>
<li>Provide an edit history</li>
</ul>
<p>The rapid investigation and coding listed previously includes statements and expressions. Impressively, these statements and expressions do not need to be part of a method. Furthermore, variables and methods are not required to be part of a class, making this tool especially dynamic.</p>
<p>In addition, the following listed features were included to make JShell much easier to use and to make your time using JShell as time-efficient as possible:</p>
<ul>
<li>Tab-completion</li>
<li>Auto-completion for end-of-statement semicolons</li>
<li>Auto-completion for imports</li>
<li>Auto-completion for definitions</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting Started with JShell</h1>
                </header>
            
            <article>
                
<p>JShell is a command-line tool that is located in the <kbd>/bin</kbd> folder. The syntax for this tool is <kbd>jshell &lt;options&gt; &lt;load files&gt;</kbd>. As you can see here, there are several options that can be used with this tool:</p>
<div class="CDPAlignCenter CDPAlign"><img height="415" width="558" src="assets/79170c70-1fa1-4f3b-a6c0-61566af67576.png"/></div>
<p>You have already seen the <kbd>-h</kbd> option, that we executed with <kbd>jshell -h</kbd>. This provided the listing of JShell options.</p>
<p>To log into your JShell, you simply use the <kbd>jshell</kbd> command. You will see that the prompt in the command window changes accordingly:</p>
<div class="CDPAlignCenter CDPAlign"><img height="116" width="365" src="assets/6a06a27e-8f36-4fcd-8fde-1573ac2a19e7.png"/></div>
<p>Exiting the shell is as easy as entering <kbd>/exit</kbd>. Once inside the JShell, you can enter any of the following commands:</p>
<table>
<tbody>
<tr>
<td><strong>Command</strong></td>
<td><strong>Functionality</strong></td>
</tr>
<tr>
<td><kbd>/drop</kbd></td>
<td>
<p class="mce-root">Use this command to delete a source entry that is referenced by <kbd>name</kbd> or <kbd>id</kbd>. Here is the syntax:</p>
<pre class="mce-root">    /drop &lt;name or id&gt;</pre></td>
</tr>
<tr>
<td><kbd>/edit</kbd></td>
<td>
<p class="mce-root">With this command, you can edit a source entry using a <kbd>name</kbd> or <kbd><span>id</span></kbd> reference. Here is the syntax:</p>
<pre class="mce-root">    /edit &lt;name or id&gt;</pre></td>
</tr>
<tr>
<td><kbd>/env</kbd></td>
<td>
<p class="mce-root">This powerful command allows you to view or change the evaluation context. Here is the syntax:</p>
<pre class="mce-root">    /env [-class-path &lt;path&gt;] [-module-path &lt;path&gt;]<br/>     [-add-modules &lt;modules]</pre></td>
</tr>
<tr>
<td><kbd>/exit</kbd></td>
<td>
<p>This command is used to exit the JShell. The syntax is simply <kbd>/exit</kbd> without any options or parameters available.</p>
</td>
</tr>
<tr>
<td><kbd>/history</kbd></td>
<td>
<p>The history command provides a history of what you have typed. The syntax is simply <kbd>/history</kbd> without any options or parameters available.</p>
</td>
</tr>
<tr>
<td><kbd>/&lt;id&gt;</kbd></td>
<td>
<p class="mce-root">This command is used to rerun a previous snippet by referencing the <kbd>id</kbd>. Here is the syntax: <kbd>/&lt;id&gt;</kbd></p>
<div class="packt_tip">You can also run a specific snippet by referencing the <em>n</em><sup>th</sup> previous snippet with <kbd>/-&lt;n&gt;</kbd>.</div>
</td>
</tr>
<tr>
<td><kbd>/imports</kbd></td>
<td>
<p>You can use this command to list the imported items. The syntax is <kbd>/imports</kbd> and it does not accept any options or parameters.</p>
</td>
</tr>
<tr>
<td><kbd>/list</kbd></td>
<td>
<p class="mce-root">This command will list the source you typed. Here is the syntax:</p>
<pre class="mce-root">    /list [&lt;name or id&gt; | -all | -start]</pre></td>
</tr>
<tr>
<td><kbd>/methods</kbd></td>
<td>
<p class="mce-root">This command lists all declared methods as well as their signatures. Here is the syntax:</p>
<pre class="mce-root">    /methods [&lt;name or id&gt; | -all | -start]</pre></td>
</tr>
<tr>
<td><kbd>/open</kbd></td>
<td>
<p class="mce-root">Using this command, you can open a file as source input. Here is the syntax:</p>
<pre class="mce-root">    /open &lt;file&gt;</pre></td>
</tr>
<tr>
<td><kbd>/reload</kbd></td>
<td>
<p class="mce-root">The reload command gives you the ability to reset and replay relevant history. Here is the syntax:</p>
<pre>    /reload [-restore] [-quiet]  [-class-path <br/>     &lt;path&gt;] [-module-path &lt;path&gt;]</pre></td>
</tr>
<tr>
<td><kbd>/reset</kbd></td>
<td>
<p class="mce-root">This command resets the JShell. Here is the syntax:</p>
<pre>    /reset [-class-path &lt;path&gt;] [-module-path <br/>     &lt;path&gt;] [-add-modules &lt;modules]</pre></td>
</tr>
<tr>
<td><kbd>/save</kbd></td>
<td>
<p class="mce-root">This command saves the snippet source to a file specified by you. Here is the syntax:</p>
<pre class="mce-root">    /save [-all | -history | -start] &lt;file&gt;</pre></td>
</tr>
<tr>
<td><kbd>/set</kbd></td>
<td>
<p class="mce-root">This command is used to set the JShell configuration information. Here is the syntax:</p>
<pre>    /set editor | start | feedback | mode | prompt | <br/>     truncation | format</pre></td>
</tr>
<tr>
<td><kbd>/types</kbd></td>
<td>
<p class="mce-root">This command simply lists declared types. Here is the syntax:</p>
<pre class="mce-root">    /types [&lt;name or id&gt; | -all | -start]</pre></td>
</tr>
<tr>
<td><kbd>/vars</kbd></td>
<td>
<p class="mce-root">This command lists all declared variables as well as their values. Here is the syntax:</p>
<pre class="mce-root">    /vars [&lt;name or id&gt; | -all | -start]</pre></td>
</tr>
<tr>
<td><kbd>/!</kbd></td>
<td>
<p>This command will rerun the last snippet. The syntax is simply <kbd>/!</kbd></p>
</td>
</tr>
</tbody>
</table>
<div class="packt_infobox">Several of the previously listed commands use the term <strong>snippet</strong>. In the context of Java 9 and JShell, a snippet is one of the following:<br/>
- ClassDeclaration<br/>
- Expression<br/>
- FieldDeclaration<br/>
- ImportDeclaration<br/>
- InterfaceDeclaration<br/>
- MethodDeclaration</div>
<p>Entering the <kbd>/help</kbd> or <kbd>/?</kbd> command in the JShell provides a complete list of commands and syntax that can be used in the shell. That list is provided as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img height="614" width="514" src="assets/74b0198b-5ff2-4ce2-8614-755ededffdcd.png"/></div>
<p>The <kbd>/help</kbd> command can be especially helpful if you are still new to JShell. As you can see in the following screenshot, we can obtain an introduction to JShell by simply entering the <kbd>/help intro</kbd> command:</p>
<div class="CDPAlignCenter CDPAlign"><img height="250" width="668" src="assets/74ab00b5-f43f-41f9-a5b4-7572ea599217.png"/></div>
<p>If you find yourself using JShell often you might benefit from one or more of the following listed shortcuts. These can be listed at any time from within JShell by using the <kbd>/help shortcuts</kbd> command:</p>
<div class="CDPAlignCenter CDPAlign"><img height="319" width="607" src="assets/ef5d4a71-3e70-409b-b616-c12b64b82889.png"/></div>
<p>Additional help can be obtained from within the JShell by using the <kbd>/help</kbd> command followed by the command you want additional help on. For example, entering <kbd>/help reload</kbd> provides detailed information regarding the <kbd>/reload</kbd> command. That information is provided as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img height="407" width="597" src="assets/d3911d74-214e-4f95-91c8-6bce2c1e4dc7.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical uses of JShell</h1>
                </header>
            
            <article>
                
<p>Whether you are a new or seasoned developer or just new to Java, you are bound to find the JShell very useful. In this section, we will look at some practical uses of JShell. Specifically, we will cover:</p>
<ul>
<li>Feedback modes</li>
<li>Listing your assets</li>
<li>Editing in the JShell</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Feedback modes</h1>
                </header>
            
            <article>
                
<p>Command-line tools usually provide relatively sparse feedback in an effort to not overcrowd the screen or otherwise become a nuisance to developers. JShell has several feedback modes in addition to giving developers the ability to create their own custom modes.</p>
<p>As you can see from the following screenshot, there are four feedback modes--<kbd>concise</kbd>, <kbd>normal</kbd>, <kbd>silent</kbd>, and <kbd>verbose</kbd>. Here, we entered the <kbd>/set feedback</kbd> command without any parameters to list the feedback modes as well as to identify what the current feedback mode is. The first line of output displays the command-line command and argument set that would be used to set the mode to the currently set mode. So, in the following screenshot, the current feedback mode is set to <kbd>verbose</kbd> and the other three modes are listed:</p>
<div class="CDPAlignCenter CDPAlign"><img height="165" width="395" src="assets/dddc60ca-7c07-4686-9145-f8c900e3de1d.png"/></div>
<p>We can dictate which mode we want to enter when we first enter JShell by including an option when we launch JShell. Here are the command-line options:</p>
<table>
<tbody>
<tr>
<td><strong>Command-line command and option</strong></td>
<td><strong>Feedback mode</strong></td>
</tr>
<tr>
<td><kbd>jshell -q</kbd></td>
<td><kbd>concise</kbd></td>
</tr>
<tr>
<td><kbd>jshell -n</kbd></td>
<td><kbd>normal</kbd></td>
</tr>
<tr>
<td><kbd>jshell -s</kbd></td>
<td><kbd>silent</kbd></td>
</tr>
<tr>
<td><kbd>jshell -v</kbd></td>
<td><kbd>verbose</kbd></td>
</tr>
</tbody>
</table>
<p> </p>
<p>You will notice that we use <kbd>-q</kbd> for <kbd>concise</kbd> mode instead of <kbd>-c</kbd>. The <kbd>-c</kbd> option has the <kbd>-c&lt;flag&gt;</kbd> syntax and is used to pass <kbd>&lt;flag&gt;</kbd> to the compiler.</p>
<p>The best way to review the differences between the feedback modes is to use examples. Starting with the <kbd>normal</kbd> mode, we will execute command-line commands to accomplish the following ordered feedback demonstration:</p>
<ol>
<li>Create a variable.</li>
<li>Update the variable's value.</li>
<li>Create a method.</li>
<li>Update the method.</li>
<li>Run the method.</li>
</ol>
<p>To start our first test, we will execute the <kbd>/set feedback normal</kbd> command at the <kbd>jshell&gt;</kbd> prompt, which sets the JShell feedback mode to <kbd>normal</kbd>. After entering the <kbd>normal</kbd> feedback mode, we will enter the necessary commands to run our demonstration:</p>
<div class="CDPAlignCenter CDPAlign"><img height="361" width="650" src="assets/da31124e-cf8d-42f5-86c7-34320be3a32f.png"/></div>
<p>After entering <kbd>normal</kbd> feedback mode, we entered <kbd>int myVar = 3</kbd> to and received <kbd>myVar ==&gt; 3</kbd> as feedback. In our next command, we changed the value of the same variable and received the same output with the new value. Our next statement, <kbd>void quickMath() {System.out.println("Your result is " + (x*30 + 19));}</kbd>, used a variable that was not declared and you see the resulting two-part feedback--one part indicating that the method was created and the other to inform that the method cannot be invoked until the undeclared variable is declared. Next, we changed our method to include the <kbd>myVar</kbd> variable and the feedback reported that the method was modified. Our last step was to run the method using <kbd>quickMath();</kbd> and the results are as we expected.</p>
<p>Let's try this same feedback demonstration in <kbd>concise</kbd> mode:</p>
<div class="CDPAlignCenter CDPAlign"><img height="259" width="700" src="assets/607d40d3-e5c6-42c5-9c77-db99bcf36dc6.png"/></div>
<p>As you can see from the preceding screenshot, the <kbd>concise</kbd> feedback mode provides us with much less feedback. We created and modified the variables and received no feedback. When we created the method with an undeclared variable, we received the same feedback that we did in <kbd>normal</kbd> mode. We updated the method without confirmation or other feedback.</p>
<p>Our next use of the feedback demonstration will be in <kbd>silent</kbd> mode:</p>
<div class="CDPAlignCenter CDPAlign"><img height="238" width="706" src="assets/a36a879b-5760-41b5-baf6-59f858aa81cd.png"/></div>
<p>When we entered <kbd>silent</kbd> feedback mode, as you can see in the preceding screenshot, the JShell prompt changed from <kbd>jshell&gt;</kbd> to <kbd>-&gt;</kbd>. There was no feedback provided when we created the <kbd>myVar</kbd> variable, modified the <kbd>myVar</kbd> variable, or created the <kbd>quickMath()</kbd> method. We intentionally created the <kbd>quickMath()</kbd> method to use an undeclared variable. Because we were in <kbd>silent</kbd> feedback mode, we were not informed that the method had an undeclared variable. Based on this lack of feedback, we ran the method and were not provided any output or feedback. Next, we updated the method to include the <kbd>myVar</kbd> declared variable and then ran the method.</p>
<div class="packt_infobox">The <kbd>silent</kbd> feedback mode might seem pointless as no feedback is provided, but there is a great utility with this mode. Using the <kbd>silent</kbd> mode might be appropriate for pipelining or simply when you want to minimize the amount of terminal output. You can include specific, conditional, outputs with implicit <kbd>System.out.println</kbd> commands, as an example.</div>
<p>Our last use of the feedback demonstration is in <kbd>verbose</kbd> feedback mode. This feedback mode, as you would assume from its name, provides the most amount of feedback. Here are our test results:</p>
<div class="CDPAlignCenter CDPAlign"><img height="433" width="685" src="assets/2247bbaf-0d96-46df-bf51-ca9af8e428ed.png"/></div>
<p>In our feedback demonstration, using <kbd>verbose</kbd> feedback mode, we receive a bit more feedback as well as a nicer format for the feedback.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a custom feedback mode</h1>
                </header>
            
            <article>
                
<p>While the internal feedback modes (<kbd>normal</kbd>, <kbd>concise</kbd>, <kbd>silent</kbd>, and <kbd>verbose</kbd>) cannot be modified, you can create your own custom feedback mode. The first step in this process is to copy an existing mode. The following example demonstrates how to copy the <kbd>verbose</kbd> mode to a <kbd>myCustom</kbd> mode with the <kbd>/set mode myCustom verbose -command</kbd> command string:</p>
<div class="CDPAlignCenter CDPAlign"><img height="82" width="348" src="assets/bda794ab-e212-4f42-809e-aca69f132974.png"/></div>
<p>We used the <kbd>-command</kbd> option to ensure we would receive the command feedback. You can make various changes to your feedback mode using the <kbd>/set</kbd> command along with one of the options listed in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img height="349" width="509" src="assets/a8d25f6c-3c92-4e9c-9bf5-2ed9e704d056.png"/></div>
<p>As an example, let's walk through the truncation setting that mandates how many characters are displayed on each output line. Using the <kbd>/set truncation</kbd> command, as illustrated in the following screenshot, shows the current truncation settings:</p>
<div class="CDPAlignCenter CDPAlign"><img height="227" width="711" src="assets/15b9336e-af3a-4bc5-888b-044067fc108d.png"/></div>
<p>As you can see, our <kbd>myCustom</kbd> feedback mode has a truncation of <kbd>80</kbd>. We will change that to <kbd>60</kbd> with the <kbd>/set truncation myCustom 60</kbd> command and then use the <kbd>/set truncation</kbd> command for verification:</p>
<div class="CDPAlignCenter CDPAlign"><img height="234" width="689" src="assets/b50e340c-6e9a-4a4d-a410-c95a394eb919.png"/></div>
<p>As you can see in the previous screenshot, the truncation for our <kbd>myCustom</kbd> feedback mode was successfully changed from the <kbd>80</kbd> inherited from the <kbd>verbose</kbd> mode to <kbd>60</kbd>, based on our use of the <kbd>/set truncation myCustom 60</kbd> JShell command.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Listing your assets</h1>
                </header>
            
            <article>
                
<p>There are a few JShell commands that are convenient for listing assets that you have created. Using the feedback demonstration from the previous section, we executed the <kbd>/vars,</kbd> <kbd>/methods</kbd>, and <kbd>/list</kbd> commands to provide a list of variables, methods, and all sources respectively:</p>
<div class="CDPAlignCenter CDPAlign"><img height="177" width="517" src="assets/1153ebd7-03ec-4b23-b70c-08296217bf83.png"/></div>
<p>We can also use the <kbd>/list -all</kbd> command and option combination to see what packages the JShell imported. As you can see in the following screenshot, JShell imported several packages that make our work within the shell more convenient, saving us time from having to import these standard packages in our methods:</p>
<div class="CDPAlignCenter CDPAlign"><img height="318" width="688" src="assets/af691bad-e276-4b12-9f96-5d6bcae6c00c.png"/></div>
<p>If you just want to list the startup imports, you can use the <kbd>/list -start</kbd> command and option combination. As you can see in the following screenshot, each start up import has an "<kbd>s</kbd>" prefix and is numerically ordered:</p>
<div class="CDPAlignCenter CDPAlign"><img height="244" width="682" src="assets/10654dec-f7f3-4329-83ef-62abc5eb3550.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Editing in the JShell</h1>
                </header>
            
            <article>
                
<p>JShell is not a full-featured text editor, but there are several things you can do within the shell. This section provides you with the editing techniques grouped into modifying text, basic navigation, historical navigation, and advanced editing commands.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Modifying text</h1>
                </header>
            
            <article>
                
<p>The default text edit/entry mode is that the text you type will appear at the current cursor position. You have several options available to you when you want to delete text. Here is a complete list:</p>
<table>
<tbody>
<tr>
<td><strong>Delete action</strong></td>
<td><strong>PC keyboard combination</strong></td>
<td><strong>Mac keyboard combination</strong></td>
</tr>
<tr>
<td>Delete the character at the current cursor location</td>
<td><em>Delete</em></td>
<td><em>Delete</em></td>
</tr>
<tr>
<td>Delete the character to the left of the cursor</td>
<td><em>Backspace</em></td>
<td><em>Backspace</em></td>
</tr>
<tr>
<td>Delete the text from the cursor location to the end of the line</td>
<td><em>Ctrl</em> + <em>K</em></td>
<td><em>Cmd</em> + <em>K</em></td>
</tr>
<tr>
<td>Delete the text from the cursor location to the end of the current word</td>
<td><em>Alt</em> + <em>D</em></td>
<td><em>Alt</em>/<em>Opt</em> + <em>D</em></td>
</tr>
<tr>
<td>Delete from the cursor location to the previous white space</td>
<td><em>Ctrl</em> + <em>W</em></td>
<td><em>Cmd</em> + <em>W</em></td>
</tr>
<tr>
<td>Paste the most recently deleted text at the cursor location</td>
<td><em>Ctrl</em> + <em>Y</em></td>
<td><em>Cmd</em> + <em>Y</em></td>
</tr>
<tr>
<td>When the <em>Ctrl</em> + <em>Y</em> (or <em>Cmd</em> + <em>Y</em> on Mac) is used, you will be able to use the <em>Alt</em> + <em>Y</em> keyboard combination to cycle through previously deleted text</td>
<td><em>Alt</em> + <em>Y</em></td>
<td><em>Alt</em>/<em>Opt</em> + <em>Y</em></td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Basic navigation</h1>
                </header>
            
            <article>
                
<p>While navigational control inside the JShell is similar to most command-line editors, it is helpful to have a list of basic navigational controls:</p>
<table>
<tbody>
<tr>
<td><strong>Key/Key combination</strong></td>
<td><strong>Navigation action</strong></td>
</tr>
<tr>
<td><em>Left arrow</em></td>
<td>Move backward one character</td>
</tr>
<tr>
<td><em>Right arrow</em></td>
<td>Move forward one character</td>
</tr>
<tr>
<td><em>Up arrow</em></td>
<td>Move up one line through history</td>
</tr>
<tr>
<td><em>Down arrow</em></td>
<td>Move down one line forward through history</td>
</tr>
<tr>
<td><em>Return</em></td>
<td>Enter (submit) the current line</td>
</tr>
<tr>
<td><em>Ctrl</em> + <em>A</em> (c<em>md</em> - <em>A</em> on Mac)</td>
<td>Jump to the beginning of the current line</td>
</tr>
<tr>
<td><em>Ctrl</em> + <em>E</em> (c<em>md</em> - <em>E</em> on Mac)</td>
<td>Jump to the end of the current line</td>
</tr>
<tr>
<td><em>Alt</em> + <em>B</em></td>
<td>Jump back one word</td>
</tr>
<tr>
<td><em>Alt</em> + <em>F</em></td>
<td>Jump forward one word</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Historical navigation</h1>
                </header>
            
            <article>
                
<p>JShell remembers the snippets and commands that you enter. It maintains this history so that you can reuse snippets and commands you already entered. To cycle through snippets and commands, you can hold down the <em>Ctrl</em> key (c<em>md</em> on Mac) and then use the up and down arrow keys until you see the snippet or command you want.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced editing commands</h1>
                </header>
            
            <article>
                
<p>There are several more editing options to include search functionality, macros creation and use, and more. JShell's editor is based on JLine2, a Java library for parsing console input and editing. You can learn more about JLine2 at this URL: <a href="https://github.com/jline/jline2/wiki/JLine-2.x-Wiki">https://github.com/jline/jline2/wiki/JLine-2.x-Wiki</a>.<a href="https://github.com/jline/jline2/wiki/JLine-2.x-Wiki"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with scripts</h1>
                </header>
            
            <article>
                
<p>Up to this point, you have entered data directly into JShell from the keyboard. You also have the ability to work with JShell scripts which are a sequence of JShell commands and snippets. The format is the same as other scripting formats with one command per line.</p>
<p>In this section, we will look at start up scripts, examine how to load scripts, how to save scripts, and then end with a look at advanced scripting with JShell.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Start up scripts</h1>
                </header>
            
            <article>
                
<p>Each time the JShell is launched, the start up scripts are loaded. This also occurs each time the <kbd>/reset</kbd>, <kbd>/reload</kbd>, and <kbd>/env</kbd> commands are used.</p>
<p>By default, the DEFAULT start up script is used by JShell. If you want to use a different start up script, you merely need to use the <kbd>/set start &lt;script&gt;</kbd> command. Here is an example--<kbd>/set start MyStartupScript.jsh</kbd>. Alternatively, you can use the <kbd>jshell --start MyStartupScript.jsh</kbd> command at the Command Prompt to launch JShell and load the <kbd>MyStartupScript.jsh</kbd> JShell start up script.</p>
<p>When you use the <kbd>/set start &lt;script&gt;</kbd> command with the <kbd>-retain</kbd> option, you are telling JShell to use the new start up script the next time you launch JShell.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Loading scripts</h1>
                </header>
            
            <article>
                
<p>Loading scripts in the JShell can be accomplished with one of the following methods:</p>
<ul>
<li>You can use the <kbd>/open</kbd> command along with the name of the script as a parameter. For example, if our script name is <kbd>MyScript</kbd>, we would use <kbd>/open MyScript</kbd>.</li>
<li>A second option for loading scripts is to use the <kbd>jshell MyScript.jsh</kbd> at the Command Prompt. This will launch JShell and load the <kbd>MyScript.jsh</kbd> JShell script.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving scripts</h1>
                </header>
            
            <article>
                
<p>In addition to creating JShell scripts in external editors, we can create them within the JShell environment as well. When taking this approach, you will need to use the <kbd>/save</kbd> command to save your scripts. As you can see in the following screenshot, the <kbd>/save</kbd> command requires, at a minimum, a file name argument:</p>
<div class="CDPAlignCenter CDPAlign"><img height="225" width="519" src="assets/def4106e-dc00-4d62-9dea-cb861036220a.png"/></div>
<p>There are three options available to you with the <kbd>/save</kbd> command:</p>
<ul>
<li>The <kbd>-all</kbd> option can be used to save the source of all snippets to the specified file.</li>
<li>The <kbd>-history</kbd> option saves a sequential history of all commands and snippets you entered since JShell was launched. JShell's ability to perform this operation informs you that it maintains a history of everything you enter.</li>
<li>The <kbd>-start</kbd> option saves the current start up definitions to the specified file.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced scripting with JShell</h1>
                </header>
            
            <article>
                
<p>What are the limits of JShell? There is so much you can do with this tool, and you are virtually only limited by your imagination and programming abilities.</p>
<p>Let's look at an advanced code base that can be used to compile and run Java programs from a JShell script:</p>
<pre class="mce-root">    import java.util.concurrent.*<br/>    import java.util.concurrent.*<br/>    import java.util.stream.*<br/>    import java.util.*<br/><br/>    void print2Console(String thetext) <br/>    { <br/>      System.out.println(thetext); <br/>      System.out.println("");<br/>    }<br/><br/>    void runSomeProcess(String... args) throws Exception <br/>    { <br/>      String theProcess = <br/>        Arrays.asList(args).stream().collect(<br/>         Collectors.joining(" ")); <br/>        print2Console("You asked me to run: '"+theProcess+"'"); <br/>        print2Console(""); <br/>        ProcessBuilder compileBuilder = new <br/>          ProcessBuilder(args).inheritIO(); <br/>        Process compileProc = compileBuilder.start(); <br/>        CompletableFuture&lt;Process&gt; compileTask =<br/>         compileProc.onExit(); <br/>        compileTask.get();<br/>    }<br/><br/>    print2Console("JShell session launched.")<br/>    print2Console("Preparing to compile Sample.java. . . ")<br/><br/>    // run the Java Compiler to complete Sample.java<br/>    runSomeProcess("javac", "Sample.java")<br/>    print2Console("Compilation complete.")<br/>    print2Console("Preparing to run Sample.class...")<br/><br/>    // run the Sample.class file<br/>    runSomeProcess("java", "Sample")<br/>    print2Console("Run Cycle compete.")<br/><br/>    // exit JShell<br/>    print2Console("JShell Termination in progress...)<br/>    print2Console("Session ended.")<br/><br/>    /exit</pre>
<p>As you can see with this script, we created a <kbd>runSomeProcess()</kbd> method and can use it to explicitly compile and run external Java files.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we examined JShell, Java 9's new read-eval-print loop command-line tool. We started with introductory information regarding the tool and looked closely at the read-eval-print loop concept. We spent considerable time reviewing JShell commands and command-line options. Our coverage included practical guides to feedback modes, asset listing, and editing in the shell. We also gained experience working with scripts.</p>
<p>In the next chapter, we will look at Java 9's new default garbage collector. Specifically, we will look at the default garbage collection, depreciated garbage collection combinations, and examine garbage collection logging.</p>


            </article>

            
        </section>
    </body></html>