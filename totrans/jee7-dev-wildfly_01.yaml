- en: Chapter 1. Getting Started with WildFly
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章. 开始使用WildFly
- en: Java Enterprise Edition provides a standard to develop enterprise software,
    but allows the developers to choose its specific implementation. For every technology
    that is included in the Java EE (Enterprise Edition) specification, there is a
    reference implementation; an open source library or component that fulfills all
    of the requirements. Companies and organizations can create their own versions
    of the components, which means that there is no central Java EE platform that
    everybody uses. In place of that, we get multiple approaches on the implemented
    specification, with improvements and optimizations for specific cases. At the
    time of writing this, there are about 20 certified (full) implementations of Java
    EE 6 and three implementations of Java EE 7.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Java企业版提供了一种开发企业软件的标准，但允许开发者选择其特定的实现。对于Java EE（企业版）规范中包含的每一项技术，都有一个参考实现；一个满足所有要求的开源库或组件。公司和组织可以创建自己版本的组件，这意味着没有所有人都使用的中央Java
    EE平台。取而代之的是，我们得到了多种实现规范的方法，针对特定情况进行了改进和优化。在撰写本文时，大约有20个Java EE 6的认证（完整）实现和三个Java
    EE 7的实现。
- en: An application server is a runtime environment that provides applications with
    all the Java EE components. Glassfish is the reference implementation sponsored
    by Oracle, but beginning from Version 4 (created for Java EE 7), there is no longer
    commercial support for it. In this book, you will learn how to develop applications
    on the WildFly Application Server, previously known as the JBoss Application Server.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 应用服务器是一个提供所有Java EE组件的运行时环境。Glassfish是由Oracle赞助的参考实现，但从版本4（为Java EE 7创建）开始，它不再提供商业支持。在这本书中，你将学习如何在WildFly应用服务器上开发应用程序，之前被称为JBoss应用服务器。
- en: JBoss is a division of Red Hat, which seeks to provide a developer-friendly
    open source ecosystem for enterprise development. Currently, the company supports
    multiple projects (around 100), and some of them are implementations of Java EE
    specifications. The enterprise elements are combined in JBoss's own application
    server, WildFly.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: JBoss是红帽公司的一个部门，旨在为企业管理开发提供开发者友好的开源生态系统。目前，该公司支持多个项目（大约100个），其中一些是Java EE规范的实现。企业元素被整合到JBoss自己的应用服务器WildFly中。
- en: It is worth noting that the name change from JBoss AS to WildFly was made to
    separate the application server from the company and other subprojects. The name
    was chosen in a public vote (more information on this is available at [http://jbossas.jboss.org/rename/vote](http://jbossas.jboss.org/rename/vote)).
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，从JBoss AS更名为WildFly是为了将应用服务器与公司和其他子项目区分开来。这个名字是通过公开投票选出的（更多信息可在[http://jbossas.jboss.org/rename/vote](http://jbossas.jboss.org/rename/vote)找到）。
- en: The new release features a scalable and high performing web server called Undertow,
    which supports the HTTP upgrade mechanism and WebSocket protocol. What's more,
    the new version of the container is even faster than JBoss Application Server
    7, and offers a unified configuration mechanism. However, the main essence of
    the latest release is the Java EE 7 compliance, which allows developers to use
    technologies from the newest version of the Java EE specification.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 新版本推出了一个可扩展且性能高的Web服务器Undertow，它支持HTTP升级机制和WebSocket协议。更重要的是，新版本的容器甚至比JBoss应用服务器7更快，并提供了一个统一的配置机制。然而，最新版本的核心是Java
    EE 7兼容性，这允许开发者使用Java EE规范最新版本的技术。
- en: 'The focus of this book is on application development; therefore, we will first
    need to gather all resources required to deliver our applications. In this chapter,
    we will cover the following topics in detail:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书的重点是应用开发；因此，我们首先需要收集所有交付应用程序所需的资源。在本章中，我们将详细介绍以下主题：
- en: An overview of Java EE and WildFly
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Java EE和WildFly概述
- en: Preparing your environment for the installation of software
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备您的环境以安装软件
- en: Downloading and installing WildFly
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下载和安装WildFly
- en: Verifying the WildFly installation
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证WildFly的安装
- en: Installing other resources needed for development
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装开发所需的其他资源
- en: An overview of Java EE and WildFly
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Java EE和WildFly概述
- en: Java EE (formerly called J2EE) is an umbrella specification embracing a standard
    set of technologies for server-side Java development. Java EE technologies include
    Java Servlet, **JavaServer** **Pages** (**JSPs**), **JavaServer** **Faces** (**JSFs**),
    **Enterprise** **JavaBeans** (**EJB**), **Contexts and** **Dependency Injection**
    (**CDI**), **Java Messaging** **Service** (**JMS**), **Java** **Persistence API**
    (**JPA**), **Java API for XML** **Web Services** (**JAX-WS**), and **Java API**
    **for RESTful Web Services** (**JAX-RS**), among others. The newest version of
    Java EE extends the range of available technologies even further by providing
    support for Batch Applications, Concurrency Utilities, **JSON Processing** (**JSON-P**)
    and WebSocket. Several commercial and open source application servers exist, which
    allow developers to run applications compliant with Java EE; WildFly (formerly
    known as JBoss AS) is the leading open source solution adopted by developers and,
    although this is difficult to measure in exact terms, it is likely to be the most
    widely used application server in the market.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: As with all application servers compliant with Java EE, WildFly ships with all
    the required libraries to allow us to develop and deploy Java applications that
    are built on the Java EE platform.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: WildFly and Enterprise Application Platform
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: WildFly and previous JBoss Application Servers were freely available for the
    community in the form of downloadable binary packages (for major releases) or
    buildable source code (for bug fixing releases). These versions are called community
    releases and are free to use for development and production.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: 'JBoss also releases more stable and hardened versions of software of the community
    builds, which are called **Enterprise Application Platform** (**EAP**), a commercial
    product with support service from Red Hat. Red Hat calls this kind of relationship
    between projects as upstream/downstream. The community builds are the source of
    changes and innovations for the downstream, the code is downstream. The commercial
    version numeration differed from the community line, but it was an extended variant
    of the community releases (for example, EAP 6.1.0 was built on JBoss 7.2.0, which
    was available only on GitHub in the form of buildable source code; the same goes
    for EAP 6.2.0 and JBoss 7.3.0). EAP builds have a more complex licensing system;
    the usage terms depend on the maturity of the build and are as follows:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: '**EAP Alpha** is free for the developers and production use, as they are an
    equivalent of the standard community version with optional fixes included. The
    corresponding community binaries may not be available for download, as they would
    be similar to the EAP Alpha version.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**EAP Beta** is available to developers for free (after registration to a subscription
    program), but cannot be used in production.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**EAP Final** is also available to developers for free, but additionally, new
    security patches are available only in the paid subscription.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The distribution model proposed by JBoss allows the developers to work for
    free on the same version as the one used in production. This is a huge benefit,
    especially since the competitive solution from Oracle (Glassfish: the reference
    implementation of a Java EE compliant server) no longer has a version with commercial
    support.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: Welcome to Java EE 7
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Java EE 7 includes several improvements and additions to the existing version.
    The new version is focused on three themes: developer productivity, HTML5, and
    providing new features required by enterprise applications. The following sections
    list the major improvements to the specifications that are of interest to enterprise
    application developers.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: If you are starting your adventure with Java EE, feel free to skip this section.
    The technologies described in the following sections will be covered in future
    chapters in more detail.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: JavaServer Faces 2.2 – JSR 344
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Java EE 7 includes a new version of the JSF specification, which is not so
    revolutionary as 2.0, but still provides some appealing additions for developers.
    The key features delivered by JSF 2.2 are as follows:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: The HTML5 markup is now supported by the usage of pass-through elements and
    attributes. Earlier, custom attributes would have to be supported by an extended
    renderer for every component. The new constructs allow the developer to pass additional
    HTML attributes to the markup generated by JSF components.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The flow scope has been introduced with `@FlowScoped`, which makes the creation
    of wizards (dialogs with multiple steps) easier.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Ajax-based file upload is now supported out of the box.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Also, stateless views have been presented as a way to improve performance.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enterprise JavaBeans 3.2 – JSR 345
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Compared to EJB 3.1, the Version 3.2 is a minor update of the existing version.
    It concentrates mainly on marking some older features as obsolete (they are now
    optional, which means that not every Java EE 7-compliant application server will
    support them). The optional features are connected with persistence to web services
    based on EJB 2.1 and JAX-RPC. The main enhancements provided by the new specification
    are as follows:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: Life cycle methods for stateful session beans can now be transactional.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Timer Service API, now allows you to access all active timers in the current
    EJB module.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A new container provided role (`**`) has been introduced. It can be used to
    indicate any authenticated user (without taking his or her actual roles into account).
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Passivation of stateful session beans can now be disabled.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Transactional parts of the EJB specification have been extracted and reused
    in other parts of the Java EE platform (the transaction support has been placed
    in the JTA 1.2 specification). For instance, the transactional behavior can now
    be used in CDI beans, thanks to the introduction of the `@Transactional` annotation.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: Java Persistence API 2.1 – JSR 338
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: JPA was introduced as a standard part of Java EE in Version 5 of the specification.
    JPA was intended to replace entity beans as the default object-relational mapping
    framework for Java EE. JPA adopted ideas from third-party object-relational frameworks,
    such as Hibernate and JDO, and made them a part of the standard version.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: 'JPA 2.1 is an improvement over JPA 2.0 as it provides several facilities for
    developers, which are as follows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: It provides a standardized schema generation mechanism, thanks to an extended
    set of annotations and `persistence.xml` properties
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It adds support for type conversion, by the introduction of the `@Converter`
    annotation
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Stored procedures are now supported by the Entity Manager API, so that the use
    of the SQL query mechanism for them is no longer required
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Criteria API has been extended by bulk updates and deletes
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Injection is possible into entity listener classes along with the usage of life
    cycle callback methods
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Named queries can now be created during runtime
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **JPA Query Language** (**JPQL**) has been extended with new database functions
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Additionally, Java EE 7-compliant containers must now support preconfigured
    data sources (along with other resources), which can be instantly used by JPA
    entities.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: WildFly uses Hibernate as its JPA provider and is shipped with a ready-to-use
    H2 in-memory database. The default data source points to the H2 instance hosted
    inside of the application server.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: Contexts and Dependency Injection for Java EE 1.1 – JSR 346
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Version 1.1 of **Contexts and Dependency Injection** (**CDI**) provides improvements
    for the issues identified in CDI after its introduction in Java EE 6\. The process
    of simplifying the programming model started in Version 1.0 and is now being continued.
    The areas covered by the update are as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: CDI is now enabled by default (without the need to add the `bean.xml` file to
    the deployment), with the possibility to specify the desired component scanning
    mode.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More fine-grained control over the bean discovery mechanism is now available
    for the developer, thanks to the use of the `@Vetoed` annotation and class or
    packages filters in `beans.xml`. Interceptors, decorators, and alternatives can
    now be globally enabled for the whole application using the `@Priority` annotation,
    instead of enabling every module.
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Event metadata can now be examined when a CDI event is handled.
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interceptors have been enhanced with the possibility to be executed around constructor
    invocation.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, the new version contains a significant number of enhancements for the
    development of portable extensions.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Weld is the CDI implementation internally used in WildFly.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: Java Servlet API 3.1 – JSR 340
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The new version of the Java Servlet API has a clear focus on new features.
    The most important of them is the HTTP upgrade mechanism, which allows the client
    and server to start a conversation in HTTP 1.1, and negotiate another protocol
    for subsequent requests. This feature was used to implement the WebSockets mechanism
    in Java EE 7\. Other features of the new version of specification are as follows:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: Non-blocking I/O API for Servlets has been provided to improve scalability of
    web applications
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Multiple security improvements have been introduced; the most notable of them
    is the possibility to set the default security semantics for all HTTP methods
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: JAX-RS, the Java API for RESTful Web Services 2.0 – JSR 339
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In Java EE 7, the JAX-RS specification has been enriched with some long-awaited
    features. The version has changed from 1.1 to 2.0 because of the major impact
    of the improvements that came with the new specification. The most important features
    are listed as follows:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: The client API is now part of the specification, so the usage of third-party
    libraries is no longer needed. The implementation of the specification is required
    to provide a REST client that conforms to the common API.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asynchronous requests are now supported so that the client does not have to
    passively wait for the completion of the task.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Filters and handlers have been introduced as a common mechanism to provide extension
    points for the developer. They can be used for cross-cutting concerns, such as
    auditing and security.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bean Validation has been integrated into JAX-RS, making constraint annotations
    usable for request parameters.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: WildFly comes bundled with RESTEasy, an implementation of JAX-RS 2.0.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: Java Message Service 2.0 – JSR 343
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The JSR 343 is the first update for the JMS specification in over a decade.
    Once more, the main theme of the update is the simplification of the API. The
    new API dramatically decreases the amount of boilerplate code that has to be written
    by the programmer while still maintaining backwards compatibility. Other new features
    are listed as follows:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: Asynchronous message sending is now supported, so the application does not have
    to be blocked until an acknowledgment from the server is received
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Messages can now be sent with a scheduled delay for the delivery
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: HornetQ is the JMS provider used and developed by JBoss. It is possible to use
    it outside of WildFly as a standalone message broker.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: Bean Validation 1.1 – JSR 349
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The process of updating the Bean Validation in Java EE 7 concentrates on two
    main features:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: Methods validation, which allows the developer to validate parameters and return
    values
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tighter CDI integration, which changes the life cycle of the elements of the
    validation framework, allowing the developer to use dependency injection in his
    or her own `ConstraintValidator` implementations
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Concurrency utilities for Java EE 1.0 – JSR 236
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Concurrency utilities is a new feature pack to use multithreading in Java EE
    application components. The new specification provides `ManagedExecutorService`
    (a container-aware version of `ExecutorService` known from Java SE), which can
    be used to delegate the execution of tasks to a separate thread. These managed
    tasks could use most of the features that are available for application components
    (such as EJBs or Servlets). It is also possible to schedule cyclic or delayed
    tasks using new `ManagedScheduledExecutorService`. These new additions to the
    platform are filling a functional gap for Java EE, which was very hard to overcome
    within its architecture earlier on.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 并发实用工具是一个新的功能包，用于在Java EE应用组件中使用多线程。新的规范提供了`ManagedExecutorService`（Java SE中已知的`ExecutorService`的容器感知版本），可以用来将任务的执行委托给一个单独的线程。这些管理任务可以使用大多数适用于应用组件的功能（例如EJB或Servlet）。还可以使用新的`ManagedScheduledExecutorService`来安排周期性或延迟的任务。这些平台的新增功能填补了Java
    EE的功能空白，这在早期架构中是非常难以克服的。
- en: Batch applications for the Java Platform 1.0 – JSR 352
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Java平台1.0的批处理应用程序 – JSR 352
- en: 'Batch jobs were another area of enterprise application development, which was
    not covered by earlier versions of Java EE. The new batch processing framework
    is used to provide a common solution to run tasks that are executed without user
    interaction. Java EE provides the developer with the following options:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 批处理作业是另一个企业级应用开发领域，在Java EE的早期版本中没有涉及。新的批处理框架被用来提供一个通用的解决方案来运行无需用户交互的任务。Java
    EE为开发者提供了以下选项：
- en: Batch runtime for the execution of jobs
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 批处理作业执行运行时
- en: A job description language (based on XML)
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于XML的作业描述语言
- en: The Java API for the implementation of the business logic for the batch tasks
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 批处理任务业务逻辑实现的Java API
- en: jBeret, which is the batching framework used in WildFly
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: jBeret，这是WildFly中使用的批处理框架
- en: Java API for JSON Processing 1.0 – JSR 353
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: JSON处理的Java API 1.0 – JSR 353
- en: 'Java EE 7 now comes with out-of-the-box JSON processing, so the developer is
    no longer forced to use external libraries for this task. The new API allows JSON
    processing to use two approaches: object model (DOM based) and streaming (event-based).'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Java EE 7现在自带了开箱即用的JSON处理功能，因此开发者不再被迫使用外部库来完成这项任务。新的API允许JSON处理使用两种方法：对象模型（基于DOM）和流式处理（基于事件）。
- en: Java API for WebSocket 1.0 – JSR 356
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: WebSocket 1.0的Java API – JSR 356
- en: To fully support the development of applications based on HTML5, Java EE 7 requires
    a standardized technology for two-way communication between the server and the
    user's browser. The WebSocket API allows the developer to define server-side endpoints,
    which will maintain a TCP connection for every client that will connect to them
    (using, for instance, a JavaScript API). Before the new specification, developers
    had to use vendor-specific libraries and not portable solutions to achieve the
    same goal.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完全支持基于HTML5的应用程序的开发，Java EE 7需要一种标准化的技术来实现服务器与用户浏览器之间的双向通信。WebSocket API允许开发者定义服务器端端点，这些端点将为每个连接到它们的客户端维护一个TCP连接（例如，使用JavaScript
    API）。在新规范之前，开发者必须使用供应商特定的库和非便携式解决方案来实现相同的目标。
- en: New features in WildFly
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: WildFly的新特性
- en: 'The eighth release of WildFly is based on modular architecture introduced in
    the previous release named JBoss AS 7\. It has improved on several key points,
    including areas of performance and management. The most important change for the
    developers is that this release implements the Java EE 7 standard completely.
    Some of the most notable improvements include the following:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: WildFly的第八次发布基于在之前版本JBoss AS 7中引入的模块化架构。它在多个关键点进行了改进，包括性能和管理领域。对于开发者来说，最重要的变化是这次发布完全实现了Java
    EE 7标准。其中一些最显著的改进包括以下内容：
- en: WildFly 8 implements all standards presented by Java EE 7 specifications, which
    are also described in this chapter.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WildFly 8实现了Java EE 7规范中提出的所有标准，这些标准也在本章中进行了描述。
- en: The web server module was completely rewritten under the name Undertow. It supports
    both blocking and non-blocking operations. Early performance tests (for example,
    [http://www.techempower.com/benchmarks/#section=data-r6&hw=i7&test=plaintext](http://www.techempower.com/benchmarks/#section=data-r6&hw=i7&test=plaintext))
    show major performance improvements in HTTP request handling. Undertow is also
    available as a separate project and is possible to be used without WildFly.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The final WildFly release has reduced the number of used ports. Now, it uses
    only two of them, one (`9990`) for management, JMX, and web administration, and
    the second one (`8080`) for standard services, including HTTP, WebSockets, remote
    JNDI, and EJB invocations.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, it is possible to limit a user's management permissions using the Management
    **role based access control** (**RBAC**). All configuration changes can be tracked
    using the audit log.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For previous releases, any upgrade operation requires a completely new server
    installation. WildFly brings the patching feature, allowing to install and rollback
    modules using management protocols.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the next section, we will describe all the required steps to install and
    start a new application server.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: Installing the server and client components
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The first step in learning about the application server will be to install all
    the necessary components on your machine in order to run it. The application server
    itself requires just a JDK environment to be installed.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: As far as hardware requirements are concerned, you should be aware that the
    server distribution, at the time of writing this, requires about 130 MB of hard
    disk space, and allocates a minimum of 64 MB and a maximum of 512 MB for a standalone
    server.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to get started, we will need to go over this checklist:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: Install JDK where WildFly will run
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install WildFly
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install the Eclipse development environment
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install the Maven build management tool
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At the end of this chapter, you will have all the instruments to get started
    with the application server.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: Installing Java SE
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The first mandatory requirement is to install a JDK 8 environment. The Java
    SE download site can be found at [http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html).
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: Choose the latest version of Java SE 8 and install it. If you don't know how
    to install it, please take a look at [http://docs.oracle.com/javase/8/docs/technotes/guides/install/install_overview.html](http://docs.oracle.com/javase/8/docs/technotes/guides/install/install_overview.html).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: Testing the installation
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Once you have completed your installation, run the `java -version` command
    from a command prompt to verify that it is correctly installed. Here is the expected
    output from a Windows machine:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Installing WildFly
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The JBoss WildFly application server can be downloaded for free from [http://wildfly.org/downloads/](http://wildfly.org/downloads/).
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see in the following screenshot, at the moment of writing this book,
    the latest stable release of WildFly is 8.1.0.Final, which features a Certified
    Java EE 7 full profile:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: '![Installing WildFly](img/00002.jpeg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
- en: Once you have chosen the appropriate server distribution, you will then be warned
    that this download is part of a community release and, as such, is not supported.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you need Enterprise support for your applications, you can opt for the Red
    Hat Enterprise Application Platform.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: Compared to the community version, the EAP has gone through different quality
    tests and might be different in terms of features/packaging. More information
    about the differences between EAP and the community version can be found at the
    beginning of this chapter. However, at the time of writing this book, EAP does
    not yet support Java EE 7, and no road map is publicly available.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: Installing WildFly is a piece of cake; it does not require anything else besides
    unpacking the `wildfly-8.1.0.Final.zip` archive.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: Windows users can simply use any uncompressing utility, such as built-in compressed
    folders (in newer Windows releases), WinZip, WinRAR, or 7-Zip taking care to choose
    a folder name that does not contain empty spaces and white spaces. Unix/Linux
    should use the `$ unzip wildfly-8.1.0.Final.zip` unzip shell command to explode
    the archive.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Security warning**'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: Unix/Linux users should be aware that WildFly does not require root privileges,
    as none of the default ports used by WildFly are below the privileged port range
    of `1024`. To reduce the risk of users gaining root privileges through WildFly,
    install and run WildFly as a non-root user.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: Starting WildFly
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'After you have installed WildFly, it is wise to perform a simple start up test
    to validate that there are no major problems with your Java VM / operating system
    combination. To test your installation, move to the `bin` directory of your `JBOSS_HOME`
    (the path to which you have unzipped your application server) directory and issue
    the following command:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following is a screenshot of a sample WildFly start-up console:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: '![Starting WildFly](img/00003.jpeg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
- en: The preceding command starts up a WildFly standalone instance, which is equivalent
    to starting the application server with the `run.bat/run.sh` script used by earlier
    JBoss AS releases. You will notice how amazingly fast the new release of the application
    server is; this is due to the modular architecture introduced in Version 7 of
    JBoss AS, which only starts up necessary parts of the application server container
    needed by the loaded applications.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: 'If you need to customize the start-up properties of your application server,
    open the `standalone.conf` file (or `standalone.conf.bat` for Windows users),
    where the memory requirements of Wildfly have been declared. Here is the Linux
    core section of this file:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: So, by default, the application server starts with a minimum memory requirement
    of 64 MB of heap space and a maximum of 512 MB. This will be just enough to get
    started; however, if you need to run more robust Java EE applications on it, you
    will likely require at least 1 GB of heap space or 2 GB or more, depending on
    your application type. Generally speaking, 32-bit machines cannot execute a process
    whose space exceeds 2 GB; however, on 64-bit machines, there is essentially no
    limit to the process size.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: 'You can verify that the server is reachable from the network by simply pointing
    your browser to the application server''s welcome page, which can be accessed
    from the well-known address, `http://localhost:8080`. The welcome page of WildFly
    is shown in the following screenshot:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '![Starting WildFly](img/00004.jpeg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
- en: Connecting to the server with the command-line interface
  id: totrans-137
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you have been using previous releases of the application server, you might
    have heard about the twiddle command-line utility that queried MBeans installed
    on the application server. This utility has been replaced by a more sophisticated
    interface named the command-line interface(**CLI**); it can be found in `JBOSS_HOME/bin`.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: 'Just launch the `jboss-cli.bat` script (or `jboss-cli.sh` for Linux users),
    and you will be able to manage the application server via a shell interface. This
    is shown in the following screenshot:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '![Connecting to the server with the command-line interface](img/00005.jpeg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
- en: We started an interactive shell session that can also use the command-line completion
    (by pressing the *Tab* key) to match partly typed command names. No more searches
    are needed to find the exact syntax of commands!
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the previous screenshot, we connected to the server using the `connect` command;
    it uses the loopback server address and plugs into port `9990` by default.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: The command-line interface is discussed in depth in [Chapter 9](part0048_split_000.html#page
    "Chapter 9. Managing the Application Server"), *Managing the Application Server*,
    which is all about server management interfaces; we will, however, get an initial
    taste of its basic functionalities in the next sections to get you accustomed
    to this powerful tool.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: Stopping WildFly
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The easiest way to stop WildFly is by sending an interrupt signal with *Ctrl*
    + *C*.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: 'However, if your WildFly process was launched in the background or, rather,
    is running on another machine, you can use the CLI interface to issue an immediate
    shutdown command:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Locating the shutdown script
  id: totrans-149
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'There is actually one more option to shut down the application server that
    is pretty useful, if you need to shut down the server from within a script. This
    option consists of passing the `--` connect option to the admin shell, thereby
    switching off the interactive mode as shown in the following command line:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Stopping WildFly on a remote machine
  id: totrans-152
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Shutting down the application server that is running on a remote machine is
    just a matter of providing the server''s remote address to the CLI, and for security
    reasons, a username and password, as shown in the following code snippet (see
    the next chapter to learn more about user creation):'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: However, you have to remember that you need access to a given port because often,
    it may be blocked by a firewall.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: Restarting WildFly
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The command-line interface contains many useful commands. One of the most interesting
    options is the ability to reload the AS configuration or parts of it using the
    `reload` command.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: 'When issued on the root node path of the AS server, the `reload` command can
    reload the services'' configuration:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Installing the Eclipse environment
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The development environment used in this book is Eclipse, which is known by
    Java developers worldwide, and it contains a huge set of plugins to expand its
    functionalities. Besides this, Eclipse is the first IDE that is compatible with
    the new application server.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: So, let's move to the download page of Eclipse, which is located at [http://www.eclipse.org](http://www.eclipse.org).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: 'From here, download the latest Enterprise Edition (at the time of writing this
    book, it is Version 4.4 and is also known as Luna). The compressed package contains
    all the Java EE plugins already installed. This is shown in the following screenshot:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '![Installing the Eclipse environment](img/00006.jpeg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
- en: Once you have unzipped the previously downloaded file, you will see a folder
    named `eclipse`. In this folder, you will find the Eclipse application (a big
    blue dot). It is recommended that you create a shortcut on the desktop to simplify
    the launching of Eclipse. Note that, just as with WildFly, Eclipse does not have
    an installation process. Once you have unzipped the file, you are done!
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: Installing JBoss Tools
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The next step will be installing the JBoss AS plugin that is a part of the
    suite of plugins named JBoss Tools. Installing new plugins in Eclipse is pretty
    simple; just follow these steps:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: From the menu, navigate to **Help** | **Install New Software**.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Then, click on the **Add** button, where you will enter JBoss Tools' download
    URL (along with a description), [http://download.jboss.org/jbosstools/updates/development/luna/](http://download.jboss.org/jbosstools/updates/development/luna/).
    This is shown in the following screenshot:![Installing JBoss Tools](img/00007.jpeg)
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: As you can see in the preceding screenshot, you need to check the **JBossAS
    Tools** plugin and move forward to the next option to complete the installation
    process.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-171
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Enter `JBossAS` into the filter field to quickly find the JBoss AS Tools plugin
    among the large set of JBoss Tools.
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Once done, restart the process when prompted.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: You can also download JBoss Tools as individual zip files for an offline installation.
    See JBoss Tools Downloads at [http://tools.jboss.org/downloads/](http://tools.jboss.org/downloads/).
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now, you should be able to see WildFly listed as a server by navigating to **New**
    | **Server** from the upper menu and expanding the **JBoss Community** option,
    as shown in the following screenshot:![Installing JBoss Tools](img/00008.jpeg)
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Completing the server installation in Eclipse is quite straightforward as it
    just requires pointing to the folder where your server distribution is; we will
    therefore leave this to you to implement as a practical exercise.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: Alternative development environments
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Since this book is all about development, we should also account for some other
    alternatives that might suit your programming style or your company standards
    better. So, another valid alternative is IntelliJ IDEA, which is available at
    [http://www.jetbrains.com/idea/index.html](http://www.jetbrains.com/idea/index.html).
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: IntelliJ IDEA is a code-centric IDE focused on developer productivity. The editor
    exhibits a nice understanding of your code and makes great suggestions right when
    you need them and is always ready to help you shape your code.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: Two versions of this product exist—Community edition and Ultimate edition—that
    require a license. In order to use Java EE and the WildFly plugin, you need to
    download the ultimate edition from [http://www.jetbrains.com/idea/download/index.html](http://www.jetbrains.com/idea/download/index.html)
    and then simply install it using the installation wizard.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have installed the Ultimate edition, you will be able to get started
    with developing applications with WildFly by going to **File** | **Settings**
    and choosing the **IDE Settings** option. Here, you can choose to add new application
    server environments. This is shown in the following screenshot:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: '![Alternative development environments](img/00009.jpeg)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
- en: Another development option that is quite popular among developers is NetBeans
    ([http://netbeans.org](http://netbeans.org)), which has support for WildFly in
    its releases 7.4 and 8.0, but requires installation of additional plugins available
    in the NetBeans plugins registry.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: Installing Maven
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Besides graphical tools, you are strongly encouraged to learn about Maven,
    the popular build and release management tool. By using Maven, you will enjoy
    the following things:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: A standard structure for all your projects
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A centralized and automatic management of dependencies
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Maven is distributed in several formats, for your convenience, and can be downloaded
    from [http://maven.apache.org/download.html](http://maven.apache.org/download.html).
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: Once the download is complete, unzip the distribution archive (for example,
    `apache-maven-3.1.1-bin.zip` for Windows) to the directory in which you wish to
    install Maven 3.1.0 (or the latest available version), for example, `C:\\Programs\apache-maven-3.1.1`.
    Some operating systems such as Linux or OS X offer Maven packages in their application
    repositories.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: Once done, add the `M2_HOME` environment variable to your system so that it
    will point to the folder where Maven has been unpacked.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: Next, update the `PATH` environment variable by adding the Maven binaries to
    your system path. For example, on the Windows platform, you should include `%M2_HOME%/bin`
    in order to make Maven available on the command line.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: Some additional Maven learning materials are available on the Sonatype website
    in the form of free books; refer to [http://www.sonatype.com/resources/books](http://www.sonatype.com/resources/books).
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: Testing the installation
  id: totrans-194
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Once you have completed your installation, run the `mvn` version to verify
    that Maven has been correctly installed. Refer to the following code snippet to
    verify the correct installation:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Note
  id: totrans-197
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Downloading the example code**'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: You can download the example code files for all Packt books you have purchased
    from your account at [http://www.packtpub.com](http://www.packtpub.com). If you
    purchased this book elsewhere, you can visit [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files e-mailed directly to you.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we ran our first mile on the track to application server development.
    We introduced the new features of the application server and had an overview of
    the Java Platform Enterprise Edition in Version 7, also known as Java EE 7.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: Next, we discussed the installation of the WildFly AS and all the core components
    that include JDK and a set of development tools, such as Eclipse and Maven, which
    will be your companions on this journey.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will summarize all the application server features with
    a special focus on the components and commands needed to deliver an application,
    which is the main aim of this book.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
