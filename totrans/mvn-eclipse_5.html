<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;5.&#xA0;Spicing Up a Maven Project"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05" class="calibre1"/>Chapter 5. Spicing Up a Maven Project</h1></div></div></div><p class="calibre7">So far we have built the base, and now we are finally ready to launch the rocket. Rocket! Exciting, isn't it? Let's put our knowledge from previous chapters to practice; we will use Maven to create a simple web application, MyDistance, which lets the user convert distance between different units. In the process of building this application, we will also learn to customize the project's information and generate different artifacts. The topics that will be covered in this chapter are categorized as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Creating the MyDistance project</li><li class="listitem">Changing the project information</li><li class="listitem">Adding dependencies</li><li class="listitem">Adding resources</li><li class="listitem">The application code<div class="book"><ul class="itemizedlist1"><li class="listitem">Adding a form to obtain an input</li><li class="listitem">Adding the servlet</li><li class="listitem">Adding a utility class</li></ul></div></li><li class="listitem">Running an application</li><li class="listitem">Writing unit tests</li><li class="listitem">Running unit tests</li><li class="listitem">Generating site documentation</li><li class="listitem">Generating unit tests—HTML reports</li><li class="listitem">Generating javadocs</li></ul></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Spicing Up a Maven Project">
<div class="book" title="Creating the MyDistance project"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch05lvl1sec32" class="calibre1"/>Creating the MyDistance project</h1></div></div></div><p class="calibre7">To create the <code class="email">MyDistance</code> application, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">From the menu, navigate to <span class="strong"><strong class="calibre8">File</strong></span> | <span class="strong"><strong class="calibre8">New</strong></span> | <span class="strong"><strong class="calibre8">Other...</strong></span>. A new project wizard window appears. Search for <code class="email">maven</code> in the textbox, select <span class="strong"><strong class="calibre8">Maven Project</strong></span>, and click on the <span class="strong"><strong class="calibre8">Next</strong></span> button, as shown in the following screenshot:<div class="mediaobject"><img src="../images/00048.jpeg" alt="Creating the MyDistance project" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="2">A <span class="strong"><strong class="calibre8">New Maven Project</strong></span> wizard appears; select the <span class="strong"><strong class="calibre8">Use default Workspace location</strong></span> checkbox, and <a id="id293" class="calibre1"/>ensure the <span class="strong"><strong class="calibre8">Create a simple project (skip archetype selection)</strong></span> checkbox is unchecked, as shown in the following screenshot:<div class="mediaobject"><img src="../images/00049.jpeg" alt="Creating the MyDistance project" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="3">Next, choose <a id="id294" class="calibre1"/>an archetype from the new archetype wizard. Since we are building a web application, in <span class="strong"><strong class="calibre8">Filter</strong></span>, search for <code class="email">webapp</code>, choose <span class="strong"><strong class="calibre8">maven-archetype-webapp</strong></span>, and click on <span class="strong"><strong class="calibre8">Next</strong></span>, as shown in the following screenshot:<div class="mediaobject"><img src="../images/00050.jpeg" alt="Creating the MyDistance project" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="4">Specify the<a id="id295" class="calibre1"/> Maven coordinates, also termed as <span class="strong"><strong class="calibre8">Group-Artifact-Version</strong></span> (<span class="strong"><strong class="calibre8">GAV</strong></span>)<a id="id296" class="calibre1"/> in technical parlance, with the following values, and click on <span class="strong"><strong class="calibre8">Finish</strong></span>:<div class="informalexample"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/></colgroup><thead class="calibre20"><tr class="calibre21"><th valign="bottom" class="calibre22">
<p class="calibre23">Field</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">Value</p>
</th></tr></thead><tbody class="calibre24"><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Group Id</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">com.packt.mvneclipse</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Artifact Id</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">MyDistance</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Version</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">0.0.1-SNAPSHOT</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Package</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">com.packt.chpt5.mydistance</code>
</p>
</td></tr></tbody></table></div><p class="calibre16">Your screen will look like the following screenshot once you perform the previous step:</p><div class="mediaobject"><img src="../images/00051.jpeg" alt="Creating the MyDistance project" class="calibre10"/></div><p class="calibre14"> </p><div class="note" title="Note"><h3 class="title2"><a id="note09" class="calibre1"/>Note</h3><p class="calibre7">A snapshot<a id="id297" class="calibre1"/> in Maven indicates the current development copy, that is, the current snapshot of the code. Maven checks for a new SNAPSHOT version in a remote repository at a configured interval, for a default time of 24 hours. For more information on<a id="id298" class="calibre1"/> Maven versions, refer to <a class="calibre1" href="http://docs.oracle.com/middleware/1212/core/MAVEN/maven_version.htm">http://docs.oracle.com/middleware/1212/core/MAVEN/maven_version.htm</a>.</p></div></li><li class="listitem" value="5">The web <a id="id299" class="calibre1"/>application skeleton gets created and the structure would look like the following screenshot:<div class="mediaobject"><img src="../images/00052.jpeg" alt="Creating the MyDistance project" class="calibre10"/></div><p class="calibre14"> </p></li></ol><div class="calibre15"/></div><p class="calibre7">Don't worry if<a id="id300" class="calibre1"/> you see a red cross that indicates an error in the project; we will learn more about it in the upcoming section, <span class="strong"><em class="calibre9">Application code</em></span>.</p></div></div>
<div class="book" title="Changing the project information"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec33" class="calibre1"/>Changing the project information</h1></div></div></div><p class="calibre7">Before we venture <a id="id301" class="calibre1"/>into further details of the code, let's customize the project information. Let's add information about the organization, license, and developers associated with it. To do this, let's open the <code class="email">pom</code> file and add the following code:</p><div class="informalexample"><pre class="programlisting">&lt;project &gt;
…....
  &lt;!-- Organization information --&gt;
    &lt;organization&gt; 
      &lt;name&gt;Packt Publishing&lt;/name&gt;
      &lt;url&gt;www.packtpub.com&lt;/url&gt;
    &lt;/organization&gt; 
  &lt;!-- License information  --&gt;
  &lt;licenses&gt;
    &lt;license&gt;
       &lt;name&gt;Apache 2&lt;/name&gt;
      &lt;url&gt;http://www.apache.org/licenses/LICENSE-2.0.txt&lt;/url&gt;
      &lt;distribution&gt;manual&lt;/distribution&gt;
        &lt;comments&gt;A Friendly license&lt;/comments&gt;
    &lt;/license&gt;
  &lt;/licenses&gt;
  &lt;!-- Developers Information --&gt;
  &lt;developers&gt;
    &lt;developer&gt;
      &lt;id&gt;foo&lt;/id&gt;
        &lt;name&gt;Foo foo&lt;/name&gt;
        &lt;email&gt;foo@foo.com&lt;/email&gt;
        &lt;url&gt;http://www.foofoo.net&lt;/url&gt;
        &lt;organization&gt;Packt&lt;/organization&gt;
        &lt;organizationUrl&gt;http://packtpub.com&lt;/organizationUrl&gt;
            &lt;roles&gt;
              &lt;role&gt;developer&lt;/role&gt;
            &lt;/roles&gt;
            &lt;timezone&gt;-8&lt;/timezone&gt;
    &lt;/developer&gt;
  &lt;/developers&gt;
.......
&lt;/project&gt;</pre></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note10" class="calibre1"/>Note</h3><p class="calibre7">For detailed<a id="id302" class="calibre1"/> information <a id="id303" class="calibre1"/>on the Maven model, visit <a class="calibre1" href="http://maven.apache.org/ref/3.2.1/maven-model/maven.html">http://maven.apache.org/ref/3.2.1/maven-model/maven.html</a>.</p></div></div>
<div class="book" title="Adding dependencies"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec34" class="calibre1"/>Adding dependencies</h1></div></div></div><p class="calibre7">Our project is a simple web<a id="id304" class="calibre1"/> application, and to begin, it <a id="id305" class="calibre1"/>will need JUnit as a dependency for testing and <code class="email">log4j</code> for logging purposes. As we progress further, we will add more dependencies progressively; the idea of this section is to show how to add dependencies in the <code class="email">pom</code> file. If we see our <code class="email">pom</code> file, we can see that JUnit is already present as a dependency; so, let's add <code class="email">log4j</code> as a dependency by adding the following code snippet:</p><div class="informalexample"><pre class="programlisting">&lt;project&gt;
…....
&lt;dependencies&gt;
…
&lt;!-- For logging purpose --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;log4j&lt;/groupId&gt;
      &lt;artifactId&gt;log4j&lt;/artifactId&gt;
      &lt;version&gt;1.2.17&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
…....
&lt;/project&gt;</pre></div><p class="calibre7">The complete <a id="id306" class="calibre1"/>resultant <code class="email">pom</code> file would look like the <a id="id307" class="calibre1"/>following:</p><div class="informalexample"><pre class="programlisting">&lt;project  
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.packt.mvneclipse&lt;/groupId&gt;
  &lt;artifactId&gt;MyDistance&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;
  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;MyDistance Maven Webapp&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
  &lt;!-- Organization information --&gt;
  &lt;organization&gt;
    &lt;name&gt;Packt Publishing&lt;/name&gt;
    &lt;url&gt;www.packtpub.com&lt;/url&gt;
  &lt;/organization&gt;
  
  &lt;!-- License information  --&gt;
  &lt;licenses&gt;
    &lt;license&gt;
       &lt;name&gt;Apache 2&lt;/name&gt;
       &lt;url&gt;http://www.apache.org/licenses/LICENSE-2.0.txt&lt;/url&gt;
       &lt;distribution&gt;manual&lt;/distribution&gt;
       &lt;comments&gt;A Friendly license&lt;/comments&gt;
    &lt;/license&gt;
  &lt;/licenses&gt;
  &lt;!-- Developers Information --&gt;
  &lt;developers&gt;
    &lt;developer&gt;
    &lt;id&gt;foo&lt;/id&gt;
      &lt;name&gt;Foo foo&lt;/name&gt;
      &lt;email&gt;foo@foo.com&lt;/email&gt;
      &lt;url&gt;http://www.foofoo.net&lt;/url&gt;
      &lt;organization&gt;Packt&lt;/organization&gt;
      &lt;organizationUrl&gt;http://packtpub.com&lt;/organizationUrl&gt;
      &lt;roles&gt;
        &lt;role&gt;developer&lt;/role&gt;
          &lt;/roles&gt;
            &lt;timezone&gt;-8&lt;/timezone&gt;
    &lt;/developer&gt;
    &lt;/developers&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- For logging purpose --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;log4j&lt;/groupId&gt;
      &lt;artifactId&gt;log4j&lt;/artifactId&gt;
      &lt;version&gt;1.2.17&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;finalName&gt;MyDistance&lt;/finalName&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre></div></div>
<div class="book" title="Adding resources"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec35" class="calibre1"/>Adding resources</h1></div></div></div><p class="calibre7">We are going to<a id="id308" class="calibre1"/> use <code class="email">log4j</code> to log in to the file or <a id="id309" class="calibre1"/>console. Log4j<a id="id310" class="calibre1"/> is configured via the <code class="email">log4j</code> properties file. Now let's create the properties file. To do so, navigate to <code class="email">src/main/resources</code>, right-click on resources and select <span class="strong"><strong class="calibre8">New</strong></span> | <span class="strong"><strong class="calibre8">Other...</strong></span>; a new wizard appears. Search for <code class="email">file</code> in the <span class="strong"><strong class="calibre8">Filter</strong></span> section, select <span class="strong"><strong class="calibre8">File</strong></span>, and click on <span class="strong"><strong class="calibre8">Next</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00053.jpeg" alt="Adding resources" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Next, a <span class="strong"><strong class="calibre8">File</strong></span> <a id="id311" class="calibre1"/>resource window appears; enter the<a id="id312" class="calibre1"/> filename as <code class="email">log4j.properties</code> and make sure the parent folder is <code class="email">MyDistance/src/main/resources</code> and click on <span class="strong"><strong class="calibre8">Finish</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00054.jpeg" alt="Adding resources" class="calibre10"/></div><p class="calibre11"> </p><div class="informalexample" title="Note"><h3 class="title2"><a id="note11" class="calibre1"/>Note</h3><p class="calibre7">Resources are placed in the <code class="email">src/main/resources</code> folder.</p></div><p class="calibre7">Once the file is <a id="id313" class="calibre1"/>created, add the following piece of <a id="id314" class="calibre1"/>code to set the different properties of <code class="email">log4j</code>. It attaches the pattern layout to split out information on the console, writes a log to the <code class="email">Mydistance.log</code> file, and is set to the <code class="email">DEBUG</code> level, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">#log4j Properties 
  log4j.rootLogger=DEBUG, consoleAppender, fileAppender

  log4j.appender.consoleAppender=org.apache.log4j.ConsoleAppender
  log4j.appender.consoleAppender.layout=org.apache.log4j.PatternLayout
  log4j.appender.consoleAppender.layout.ConversionPattern=[%t] %-5p  %c{1} %x - %m%n

  log4j.appender.fileAppender=org.apache.log4j.RollingFileAppender
  log4j.appender.fileAppender.layout=org.apache.log4j.PatternLayout
  log4j.appender.fileAppender.layout.ConversionPattern=[%t] %-5p  %c{1} %x - %m%n
  log4j.appender.fileAppender.File=Mydistance.log</pre></div><p class="calibre7">For more information on<a id="id315" class="calibre1"/> <code class="email">log4j</code>, refer to <a class="calibre1" href="http://logging.apache.org/log4j/1.2/">http://logging.apache.org/log4j/1.2/</a>.</p></div>

<div id="page" style="height:0pt"/><div class="book" title="The application code"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec36" class="calibre1"/>The application code</h1></div></div></div><p class="calibre7">The application is<a id="id316" class="calibre1"/> deliberately created in JSP or servlets to keep it simple and to <a id="id317" class="calibre1"/>avoid having familiarity with other frameworks to understand the example. Before we get into the basics of the application code, let's solve the error that Eclipse complains of in step 5 of the <span class="strong"><em class="calibre9">Creating a MyDistance Project</em></span> section. Add the following dependency in the <code class="email">pom</code> file and the error should vanish:</p><div class="informalexample"><pre class="programlisting">&lt;!-- Include servlet  API --&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
    &lt;version&gt;3.1.0&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
  &lt;/dependency&gt;</pre></div><p class="calibre7">The preceding dependency will also be required for writing servlets later in the <span class="strong"><em class="calibre9">Adding a Servlet</em></span> section.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note12" class="calibre1"/>Note</h3><p class="calibre7">The scope is provided, which means that the container will provide this dependency, and Maven will not include it in this project's output or war file. We discussed scopes in more detail in <a class="calibre1" title="Chapter 4. Building and Running a Project" href="part0031_split_000.html#page">Chapter 4</a>, <span class="strong"><em class="calibre9">Building and Running a Project</em></span>.</p></div><p class="calibre7">The application will require the<a id="id318" class="calibre1"/> following additional files:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">index.jsp</code>: This is a <a id="id319" class="calibre1"/>JSP file with a form that allows users to enter a distance, its unit, and the desired conversion unit</li><li class="listitem"><code class="email">DistanceServlet</code>: This<a id="id320" class="calibre1"/> is a servlet that processes the inputs from the form</li><li class="listitem"><code class="email">ConversionUtil</code>: This is a <a id="id321" class="calibre1"/>utility class<a id="id322" class="calibre1"/> that has a method to perform conversion between different units</li></ul></div></div>

<div class="book" title="The application code">
<div class="book" title="Adding a form to get an input"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch05lvl2sec27" class="calibre1"/>Adding a form to get an input</h2></div></div></div><p class="calibre7">Under <code class="email">src/main/webapp</code>, open the <code class="email">index.jsp</code> file, and add the following code to get the distance, its unit, and conversion<a id="id323" class="calibre1"/> unit as input. The form consists of an input box, two radio buttons to choose units, and a button to initiate the conversion, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">&lt;body&gt;
&lt;h2&gt;MyDistance Utility&lt;/h2&gt;
  &lt;form&gt;
    &lt;table&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;input type="text" id="mydistance" name='distance' placeholder="My Distance In"&gt;&lt;/td&gt;

        &lt;td&gt; &lt;input type="radio" name="distin" id="distin" value="km"&gt;KM&lt;br&gt;
        &lt;input type="radio" name="distin" id="distin" value="m"&gt;Metre&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;/tr&gt;
      &lt;tr&gt; 
        &lt;td&gt; &lt;label for="convert"&gt;Convert To&lt;/label&gt;&lt;/td&gt;
        &lt;td&gt; &lt;input type="radio" name="convertto" id="convertto" value="yd"&gt;Yard&lt;br&gt;
        &lt;input type="radio" name="convertto" id="convertto" value="mi"&gt;Miles&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;input type="button" id="submit" value='Convert'&gt;&lt;/td&gt;
      &lt;/tr&gt;
      
    &lt;/table&gt;
    &lt;div id="convertvalue"&gt; &lt;/div&gt;
  &lt;/form&gt;
&lt;/body&gt;</pre></div><p class="calibre7">If you like, you can add CSS styles to make the UI more pleasing. The preceding bare bones file results in something like this:</p><div class="mediaobject"><img src="../images/00055.jpeg" alt="Adding a form to get an input" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">We want to<a id="id324" class="calibre1"/> calculate the value and show the corresponding result beneath it using Ajax (jQuery Ajax). To achieve this, add the following piece of code:</p><div class="informalexample"><pre class="programlisting">&lt;head&gt;
  &lt;script src="http://code.jquery.com/jquery-latest.js"&gt;
  &lt;/script&gt;
  &lt;script&gt;
    $(document).ready(function() {
    $('#submit').click(function(event) {
      var mydistance=$('#mydistance').val();
  
      var mydistanceIn=$('[name=distin]:checked').val();
      var convertTo=$('[name=convertto]:checked').val();
      if(mydistanceIn==convertTo){
        alert("Cannot have same unit");
        return false;
      }
      console.log(mydistance+mydistanceIn+convertTo);
      $.get('mydistance',{distance:mydistance,distIn:mydistanceIn,convert:convertTo},function(responseText) { 
          $('#convertvalue').text(responseText);
        });
      });
    });
  &lt;/script&gt;
&lt;/head&gt;</pre></div></div></div>

<div class="book" title="The application code">
<div class="book" title="Adding a servlet"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec28" class="calibre1"/>Adding a servlet</h2></div></div></div><p class="calibre7">Before we add any<a id="id325" class="calibre1"/> Java files, create a folder, <code class="email">java</code>, under <code class="email">src/main</code> as Maven looks for Java files in this directory (all Java files should reside under it). Add the <code class="email">DistanceServlet</code> servlet in the <code class="email">com.packt.chpt5.mydistance</code> package. The servlet gets the request parameters, extracts it, and calls the corresponding conversion method in the utility class. The servlet would look like the following:</p><div class="informalexample"><pre class="programlisting">public class DistanceServlet extends HttpServlet {

  private static final long serialVersionUID = 1L;
  static Logger log=Logger.getLogger(DistanceServlet.class);
  public void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {
        double convertVal = 0;
        double distanceProvided =Double.parseDouble(req.getParameter("distance"));
    String distanceIn=req.getParameter("distIn");
    String convertTo=req.getParameter("convert");
    log.debug("Request Parameters ==&gt;"+"Distance-"+distanceProvided+distanceIn+" Conversion Unit- "+convertTo );
    ConversionUtil conversion= new ConversionUtil();
    if(distanceIn.equals("km") &amp;&amp; convertTo.equals("yd")){
      convertVal=conversion.convertkmToYard(distanceProvided);
    }

    if(distanceIn.equals("m") &amp;&amp; convertTo.equals("yd")){
        convertVal=conversion.convertMtoYard(distanceProvided);
    }

    if(distanceIn.equals("km") &amp;&amp; convertTo.equals("mi")){
        convertVal=conversion.convertKMToMile(distanceProvided);
    }

    if(distanceIn.equals("m") &amp;&amp; convertTo.equals("mi")){
      convertVal=conversion.convertMToMile(distanceProvided);
    }

    resp.setContentType("text/html");
      PrintWriter out = resp.getWriter();
      out.print("The converted value is "+convertVal);
      out.flush();
      out.close();

    }


}</pre></div><p class="calibre7">Add the<a id="id326" class="calibre1"/> following lines in the <code class="email">web.xml</code> file under <code class="email">src/main/webapp/WEB-INF</code>:</p><div class="informalexample"><pre class="programlisting">&lt;web-app&gt;
  &lt;display-name&gt;MyDistance Calculator&lt;/display-name&gt;
  &lt;servlet&gt;
        &lt;servlet-name&gt;mydistance&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.packt.chpt5.mydistance.DistanceServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;mydistance&lt;/servlet-name&gt; 
        &lt;url-pattern&gt;/mydistance&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</pre></div></div></div>

<div class="book" title="The application code">
<div class="book" title="Adding a utility class"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch05lvl2sec29" class="calibre1"/>Adding a utility class</h2></div></div></div><p class="calibre7">Add a <a id="id327" class="calibre1"/>utility class <code class="email">ConversionUtil</code> in the <code class="email">com.packt.chpt5.mydistance.util</code> package. A utility class contains methods to perform conversion across different distance units. Add the following code to the utility class:</p><div class="informalexample"><pre class="programlisting">public double convertKMToMile(double distance){
  return (distance*0.62137);
}
public double convertkmToYard(double distance){
  return distance*1093.6;
}


public double convertMToMile(double distance){
  return (distance/1000)*0.62137 ;
}
public double convertMtoYard(double distance){
  return (distance/1000)*1093.6;
}</pre></div></div></div>
<div class="book" title="Running an application"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec37" class="calibre1"/>Running an application</h1></div></div></div><p class="calibre7">Now we are done with <a id="id328" class="calibre1"/>coding. Let's run the coding and see how it works. The project is a web application, so it requires a servlet container to run. We will use the Tomcat container here. Add the following build plugin for the Tomcat that can actually host a Tomcat instance right from Maven and no installation is required:</p><div class="informalexample"><pre class="programlisting">    &lt;build&gt;
….
  &lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
    &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.1&lt;/version&gt;
  &lt;/plugin&gt;
  &lt;/plugins&gt;
    &lt;/build&gt;</pre></div><p class="calibre7">This will download all the dependencies from the repository. After the download is complete, right-click on the project, choose <span class="strong"><strong class="calibre8">Run As</strong></span> | <span class="strong"><strong class="calibre8">Run Configurations...</strong></span>, create the configuration in the configuration window specifying <span class="strong"><strong class="calibre8">Goals</strong></span> as <code class="email">tomcat7:run</code>, and click on <span class="strong"><strong class="calibre8">Run</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00056.jpeg" alt="Running an application" class="calibre10"/></div><p class="calibre11"> </p><div class="informalexample" title="Note"><h3 class="title2"><a id="note13" class="calibre1"/>Note</h3><p class="calibre7">The Tomcat plugin has the <code class="email">run</code> goal, which compiles and runs the application.</p></div><p class="calibre7">Similarly, we<a id="id329" class="calibre1"/> can add any other container and run the application in it. The running application will be available at <code class="email">http://localhost:8080/MyDistance/</code> and would look like the following screenshot (shown with a sample conversion):</p><div class="mediaobject"><img src="../images/00057.jpeg" alt="Running an application" class="calibre10"/></div><p class="calibre11"> </p></div>
<div class="book" title="Writing unit tests"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec38" class="calibre1"/>Writing unit tests</h1></div></div></div><p class="calibre7">Writing unit tests<a id="id330" class="calibre1"/> is a part of good practice in software development. Maven's <code class="email">test</code> phase executes unit tests and generates the corresponding report. In this section, we will learn about writing a simple unit test for our utility class <code class="email">ConversionUtil</code>, and in the next section, we will see how to execute it and generate reports.</p><p class="calibre7">All the unit test classes should go under <code class="email">src/test/java</code>. Create the corresponding folder in the <code class="email">MyDistance</code> project. Once the folder is in place, right-click on it and navigate to <span class="strong"><strong class="calibre8">New</strong></span> | <span class="strong"><strong class="calibre8">Other...</strong></span>. Once the wizard window appears, type in <code class="email">junit</code> in the <span class="strong"><strong class="calibre8">Filter</strong></span> section, select <span class="strong"><strong class="calibre8">JUnit Test Case</strong></span>, and click on <span class="strong"><strong class="calibre8">Next</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00058.jpeg" alt="Writing unit tests" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">In the window to <a id="id331" class="calibre1"/>follow, define the unit test class by filling in the following details and click on <span class="strong"><strong class="calibre8">Next</strong></span>, as shown in the preceding screenshot:</p><div class="informalexample"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/></colgroup><thead class="calibre20"><tr class="calibre21"><th valign="bottom" class="calibre22">
<p class="calibre23">Fields</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">Values</p>
</th></tr></thead><tbody class="calibre24"><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Source folder</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">MyDistance/src/test/java</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Package</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">com.packt.chpt5.mydistance.util</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Name</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">ConvertionUtilTest</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">
<span><strong class="calibre26">Class under test</strong></span>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">com.packt.chpt5.mydistance.util.ConversionUtil</code>
</p>
</td></tr></tbody></table></div><div class="mediaobject"><img src="../images/00059.jpeg" alt="Writing unit tests" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">A window to choose <a id="id332" class="calibre1"/>test methods will be shown, for which stubs will be generated as shown in the following screenshot. Make sure that all methods of the <code class="email">ConversionUtil</code> class are checked and click on <span class="strong"><strong class="calibre8">Finish</strong></span> as follows:</p><div class="mediaobject"><img src="../images/00060.jpeg" alt="Writing unit tests" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">The <code class="email">ConversionUtilTest</code> test class <a id="id333" class="calibre1"/>with the test method stubs will be generated. Edit<a id="id334" class="calibre1"/> the code of the class as follows:</p><div class="informalexample"><pre class="programlisting">private ConversionUtil conversion;

  @Override
  protected void setUp() throws Exception {

    super.setUp();
    conversion= new ConversionUtil();
  }

  public void testConvertKmToMile() {
    double actual=conversion.convertKMToMile(4);
    assertEquals(2.48548,actual,0.001);
  }

  public void testConvertkmToYard() {
    double actual=conversion.convertkmToYard(4);
    assertEquals(4374.45,actual,0.10);
  }

  public void testConvertMToMile() {
    double actual=conversion.convertMToMile(4000);
    assertEquals(2.48548,actual,0.001);
  }

  public void testConvertMtoYard() {
    double actual=conversion.convertMtoYard(4000);
    assertEquals(4374.45,actual,0.10);
  }

  @Override
  protected void tearDown() throws Exception {

    super.tearDown();
    conversion = null;
  }</pre></div><p class="calibre7">For more information on <a id="id335" class="calibre1"/>JUnit test cases, refer to <a class="calibre1" href="http://junit.org/">http://junit.org/</a>.</p></div>
<div class="book" title="Running unit tests"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec39" class="calibre1"/>Running unit tests</h1></div></div></div><p class="calibre7">Running the unit test<a id="id336" class="calibre1"/> in Maven is just specifying the phase test. To execute the unit test we wrote in the preceding section, right-click on the <code class="email">MyDistance</code> project, select <span class="strong"><strong class="calibre8">Run As</strong></span>, and click on <span class="strong"><strong class="calibre8">Maven Test</strong></span>. It will run the unit tests against the class and generate the report in the <code class="email">/target/surefire-reports/</code> folder, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00061.jpeg" alt="Running unit tests" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">You can see the results of unit test execution in the <code class="email">txt</code> and <code class="email">xml</code> format.</p></div>
<div class="book" title="Generating site documentation"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec40" class="calibre1"/>Generating site documentation</h1></div></div></div><p class="calibre7">One of the integral <a id="id337" class="calibre1"/>features of Maven is that it eases artifacts and site documentation generation. To generate site documentation, add the following dependency in the <code class="email">pom</code> file:</p><div class="informalexample"><pre class="programlisting">&lt;reporting&gt;
    &lt;plugins&gt;
    &lt;!--  Reporting -document generation --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-plugin-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.3&lt;/version&gt;
      &lt;/plugin&gt;
        &lt;plugin&gt;
      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-project-info-reports-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.7&lt;/version&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
    
  &lt;/reporting&gt;</pre></div><p class="calibre7">After adding the preceding dependencies, run the project with the goal as site, that is, in the <span class="strong"><strong class="calibre8">Run Configurations</strong></span> window, specify <span class="strong"><strong class="calibre8">Goals</strong></span> as <code class="email">site</code>, as shown in following screenshot:</p><div class="mediaobject"><img src="../images/00062.jpeg" alt="Generating site documentation" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Click on the <span class="strong"><strong class="calibre8">Run</strong></span> <a id="id338" class="calibre1"/>button and the documentation will be generated. The excerpts of the output in <span class="strong"><strong class="calibre8">Maven Console</strong></span> would look like the following:</p><div class="informalexample"><pre class="programlisting">[INFO] Generating "About" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Plugin Management" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Distribution Management" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Dependency Information" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Source Repository" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Mailing Lists" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Issue Tracking" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Continuous Integration" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Project Plugins" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Project License" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Project Team" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Project Summary" report    --- maven-project-info-reports-plugin:2.7
[INFO] Generating "Dependencies" report    --- maven-project-info-reports-plugin:2.7
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------</pre></div><p class="calibre7">The documentation would be generated in the <code class="email">target/site</code> folder and the expansion of the folder would look like the following:</p><div class="mediaobject"><img src="../images/00063.jpeg" alt="Generating site documentation" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">There is an <a id="id339" class="calibre1"/>HTML file for each type of detail ranging from <code class="email">project-info</code>, <code class="email">project reports</code>, <code class="email">project summary</code>, <code class="email">license</code>, <code class="email">plugin</code>, and so on, and <code class="email">index.html</code> being the start point that links every document. The <span class="strong"><strong class="calibre8">Project Summary</strong></span> page is shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00064.jpeg" alt="Generating site documentation" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">For more information on site<a id="id340" class="calibre1"/> and site plugins, please refer to <a class="calibre1" href="http://maven.apache.org/guides/mini/guide-site.html">http://maven.apache.org/guides/mini/guide-site.html</a> and <a class="calibre1" href="http://maven.apache.org/plugins/maven-site-plugin/">http://maven.apache.org/plugins/maven-site-plugin/</a>.</p></div>
<div class="book" title="Generating unit tests &#x2013; HTML reports"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec41" class="calibre1"/>Generating unit tests – HTML reports</h1></div></div></div><p class="calibre7">In the preceding section, we <a id="id341" class="calibre1"/>ran the unit tests, and the results were generated in the <code class="email">txt</code> and <code class="email">xml</code> format. Often, developers need to generate more readable reports. Also, as a matter of fact, the reports should be a part of site documentation for better collaboration and information available in one place. To generate an HTML report and make it a part of site documentation, add the dependency under the <code class="email">reporting</code> element as <code class="email">plugin</code> in the <code class="email">pom</code> file as follows:</p><div class="informalexample"><pre class="programlisting">&lt;reporting&gt;
    &lt;plugins&gt;
…...
&lt;!-- For HTML test report generation --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-report-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.17&lt;/version&gt;
      &lt;/plugin&gt;
…...
    &lt;/plugins&gt;
&lt;/reporting&gt;</pre></div><p class="calibre7">After the addition <a id="id342" class="calibre1"/>shown in the preceding code, run the <code class="email">site</code> phase from the previous section. The test reports would be available by navigating to <span class="strong"><strong class="calibre8">Project Documentation</strong></span> | <span class="strong"><strong class="calibre8">Project Reports</strong></span> | <span class="strong"><strong class="calibre8">Surefire Report</strong></span> of the navigation in <code class="email">index.html</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00065.jpeg" alt="Generating unit tests – HTML reports" class="calibre10"/></div><p class="calibre11"> </p></div>
<div class="book" title="Generating javadocs"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec42" class="calibre1"/>Generating javadocs</h1></div></div></div><p class="calibre7">We often need to generate<a id="id343" class="calibre1"/> API documentation of our code base. Having an API documentation increases collaboration, understanding, migration, and the transfer of knowledge becomes handy. To generate javadocs, add the following dependency in the <code class="email">reporting</code> element as follows:</p><div class="informalexample"><pre class="programlisting">&lt;reporting&gt;
    &lt;plugins&gt;
  …...
  &lt;!-- For Javadoc generation--&gt;
        &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.9.1&lt;/version&gt;
       &lt;/plugin&gt; 
  &lt;/plugins&gt;
&lt;/reporting&gt;</pre></div><p class="calibre7">After making the <a id="id344" class="calibre1"/>preceding changes to the <code class="email">pom</code> file, run the <code class="email">site</code> phase from the previous section. The APIs will be generated in the <code class="email">apidocs</code> and <code class="email">testapidocs</code> folders under <code class="email">target/site</code>. This can be navigated in the <code class="email">index.html</code> file, under the <span class="strong"><strong class="calibre8">Project Reports</strong></span> head with <span class="strong"><strong class="calibre8">JavaDocs</strong></span> and the <span class="strong"><strong class="calibre8">Test JavaDocs</strong></span> label, along with <span class="strong"><strong class="calibre8">Surefire-Reports</strong></span> as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00066.jpeg" alt="Generating javadocs" class="calibre10"/></div><p class="calibre11"> </p></div>
<div class="book" title="Summary"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec43" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">Well done! We have developed <code class="email">MyDistance</code>, a distance conversion utility web application. During the course of development, we learned adding dependencies, writing unit tests, executing them, generating site documentation, and generating javadocs for them. In the next chapter, we will learn about multimodule projects with Maven.</p></div></body></html>