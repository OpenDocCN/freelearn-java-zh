<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Using JBoss EAP6"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Using JBoss EAP6</h1></div></div></div><p>In the previous chapter, we have learned how to download and install JBoss EAP6. We also looked at the standalone mode and the domain mode of EAP6; in this chapter we'll start learning its basic usages. We will learn how to manage and configure the EAP6 server. The following topics will be covered in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Using the JBoss EAP6 management console to deploy a web application</li><li class="listitem" style="list-style-type: disc">Basic usages of the Command Line Interface management console</li><li class="listitem" style="list-style-type: disc">The design of the JBoss EAP6 management model</li></ul></div><p>First, we need to understand some basic configurations of the EAP6 management console. After configuring it properly, we can start the EAP6 server and use its management console.</p><div class="section" title="Configuring the JBoss EAP6 management console"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Configuring the JBoss EAP6 management console</h1></div></div></div><p>JBoss EAP6 has <a id="id100" class="indexterm"/>provided two management consoles—one is based on the web and another based on the <span class="strong"><strong>Command Line Interface</strong></span> (<span class="strong"><strong>CLI</strong></span>)<a id="id101" class="indexterm"/>.Before using them, we need to configure the management modules properly.</p><div class="section" title="Security realms"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec21"/>Security realms</h2></div></div></div><p>To use the <a id="id102" class="indexterm"/>management console, we must understand its authentication scheme. The authentication module used by JBoss EAP6 is called <a id="id103" class="indexterm"/>
<span class="strong"><strong>security realms</strong></span>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip08"/>Tip</h3><p>EAP6 uses security realms to gain secure access to the management interfaces.</p></div></div><p>Open <code class="literal">standalone.xml</code> in the standalone configuration. The relative settings are given as follows:</p><div class="informalexample"><pre class="programlisting">&lt;management&gt;
  &lt;security-realms&gt;
    &lt;security-realm name="ManagementRealm"&gt;
      &lt;authentication&gt;
        &lt;local default-user="$local"/&gt;
        &lt;properties path="mgmt-users.properties" relative-to="jboss.server.config.dir"/&gt;
      &lt;/authentication&gt;
    &lt;/security-realm&gt;
  &lt;/security-realms&gt;
  &lt;management-interfaces&gt;
    &lt;native-interface security-realm="ManagementRealm"&gt;
      &lt;socket-binding native="management-native"/&gt;
    &lt;/native-interface&gt;
    &lt;http-interface security-realm="ManagementRealm"&gt;
      &lt;socket-binding http="management-http"/&gt;
    &lt;/http-interface&gt;
  &lt;/management-interfaces&gt;
&lt;/management&gt;</pre></div><p>As shown in<a id="id104" class="indexterm"/> the preceding configuration, the realm that is used by the management module is called <code class="literal">ManagementRealm</code>. It's using a property file called <code class="literal">mgmt-users.properties</code> to store the user's password information. The <code class="literal">management-interfaces </code>defines the network socket that is bound to the management console. By default, the web management console is bound to the address <code class="literal">127.0.0.1:9990</code>, and the CLI is bound to the address <code class="literal">127.0.0.1:9999</code>. The following diagram gives a summary of the management console configuration:</p><div class="mediaobject"><img src="graphics/2432OS_02_01.jpg" alt="Security realms"/></div><p>Since we have understood the authentication scheme used by JBoss EAP6, we now need to create a user account to access the management console.</p></div><div class="section" title="Setting up an admin account"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec22"/>Setting up an admin account</h2></div></div></div><p>JBoss EAP6 has <a id="id105" class="indexterm"/>provided a command-line tool to generate user accounts for us. You will find it with the name <code class="literal">add-user.sh</code> in the <code class="literal">bin</code> folder. Let's use it to generate an administrator account. This process is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_02.jpg" alt="Setting up an admin account"/></div><p>In the process shown in the preceding screenshot, we create a user named <code class="literal">jbossadmin</code> of the type <span class="strong"><strong>Management User</strong></span>. This user belongs to the <code class="literal">ManagementRealm</code>, so we can use it to access the management console. Please note that the password must be more than eight characters long, and it should contain at least one alphabet, one number, and a symbol. So, I use the password <code class="literal">@packt000</code> for <code class="literal">jbossadmin</code>.</p><p>For the last option <span class="strong"><strong>Is this new user going to be used for one AS process to connect to another AS process?</strong></span>, we choose <span class="strong"><strong>no</strong></span>. In the later chapters, we'll create a user account for the remote server connection in the domain mode.</p></div></div></div>
<div class="section" title="Using the web-based management console"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Using the web-based management console</h1></div></div></div><p>Now let's try<a id="id106" class="indexterm"/> to use the EAP6 web management console in the standalone mode. Run <code class="literal">standalone.sh</code> in the <code class="literal">bin </code>folder of EAP6 to start up the server. Then, we access the web management console by its default address, <code class="literal">http://127.0.0.1:9990</code>. The management console will pop up a login window; enter the user account we've just created. The process is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_03.jpg" alt="Using the web-based management console"/></div><p>After login, we can see the main window of the management console, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_04.jpg" alt="Using the web-based management console"/></div><p>In the next section, <a id="id107" class="indexterm"/>we'll use the web-based management console to deploy a web application.</p><div class="section" title="Deploying a project in the standalone mode"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec23"/>Deploying a project in the standalone mode</h2></div></div></div><p>Now we can try <a id="id108" class="indexterm"/>to deploy a very simple web project named <code class="literal">cluster-demo1</code> into EAP6. It's a plain hello world project that contains a simple hello page, which shows the current time on the browser. To deploy this project into EAP6, we can click on the <span class="strong"><strong>Manage Deployments</strong></span> tab in the management console and then click on <span class="strong"><strong>Add</strong></span>.</p><div class="mediaobject"><img src="graphics/2432OS_02_05.jpg" alt="Deploying a project in the standalone mode"/></div><p>Then, we <a id="id109" class="indexterm"/>choose <code class="literal">cluster-demo1.war</code> and click on <span class="strong"><strong>Next&gt;&gt;</strong></span>.</p><div class="mediaobject"><img src="graphics/2432OS_02_06.jpg" alt="Deploying a project in the standalone mode"/></div><p>EAP6 will then<a id="id110" class="indexterm"/> ask us to verify the deployment names. We should accept the default name and click on <span class="strong"><strong>Save</strong></span>. This process is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_07.jpg" alt="Deploying a project in the standalone mode"/></div><p>As the project has been deployed, the console will be redirected to the <span class="strong"><strong>Available Deployments</strong></span> page. To start the deployed project, we need to select it and click on <span class="strong"><strong>En/Disable</strong></span>. This process is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_08.jpg" alt="Deploying a project in the standalone mode"/></div><p>And we need to<a id="id111" class="indexterm"/> confirm to enable this project. This is done by clicking on <span class="strong"><strong>Confirm</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_09.jpg" alt="Deploying a project in the standalone mode"/></div><p>Finally, we can see that the project has started, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_10.jpg" alt="Deploying a project in the standalone mode"/></div><p>Now, if we check the server output from the console, we can see that <code class="literal">cluster-demo1.war</code> is deployed as follows:</p><div class="informalexample"><pre class="programlisting">18:55:46,557 INFO[org.jboss.as.server.deployment](MSC servicethread 1-8)JBEAP6015876: Starting deployment of "cluster-demo1.war"(runtimename: "cluster-demo1.war")
18:55:46,622 INFO[org.jboss.web](ServerService Thread Pool --68)JBEAP6018210: Register webcontext: /cluster-demo1
18:55:46,638 INFO[org.jboss.as.server](HttpManagementService-threads - 21)JBEAP6018559: Deployed "cluster-demo1.war"(runtime-name : "cluster-demo1.war")</pre></div><p>Now, let's have<a id="id112" class="indexterm"/> a look at <code class="literal">standalone.xml</code>. We can see that the description of this deployment has been added as follows:</p><div class="informalexample"><pre class="programlisting">&lt;deployments&gt;
  &lt;deployment name="cluster-demo1.war" runtime-name="cluster-demo1.war"&gt;
    &lt;content sha1="3afbf9c1d6fe967e0ff7eb190b862700b693e431"/&gt;
  &lt;/deployment&gt;
&lt;/deployments&gt;
&lt;/server&gt;</pre></div><p>From the preceding code snippet, we can see that the content of the configuration file has been updated by the management console. Finally, let's check <code class="literal">standalone/data/content</code> as follows:</p><div class="informalexample"><pre class="programlisting">mini:jboss-eap-6.1weinanli$ tree standalone/data/content
standalone/data/content
└── 3a
└── fbf9c1d6fe967e0ff7eb190b862700b693e431
└── content</pre></div><p>From the preceding code snippet, we can see that the contents of the deployed project is hashed and stored in the <code class="literal">standalone/data/content</code> directory.</p><div class="section" title="Testing"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec05"/>Testing</h3></div></div></div><p>Now we <a id="id113" class="indexterm"/>can try to access the deployed project to see if it's running correctly. In the following code snippet, I used the <code class="literal">curl</code> command to test the connection:</p><div class="informalexample"><pre class="programlisting">$ curl http://127.0.0.1:8080/cluster-demo1/index.jsp
&lt;html&gt;
  &lt;body&gt;
    &lt;h2&gt;Hello World!&lt;/h2&gt;
    Hello! The time is now Wed Nov 20 15:50:22 CST 2013
&lt;/body&gt;
&lt;/html&gt;</pre></div><p>As shown in the preceding process, we can see the hello page from the console output.</p></div></div><div class="section" title="Deployment scanner"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec24"/>Deployment scanner</h2></div></div></div><p>The standalone mode <a id="id114" class="indexterm"/>supports the traditional hot deployment used in the previous versions of JBoss AS. This method lets you put your copied project into a directory, and then JBoss EAP6 will scan the directory periodically to deploy the project copied into it. This function is supported by the deployment-scanner subsystem, which is defined in <code class="literal">standalone.xml</code> as follows:</p><div class="informalexample"><pre class="programlisting">&lt;extension module="org.jboss.as.deployment-scanner"/&gt;</pre></div><p>The default setting for the subsystem in <code class="literal">standalone.xml</code> is given as follows:</p><div class="informalexample"><pre class="programlisting">&lt;subsystem &gt;
  &lt;deployment-scanner path="deployments" relativeto="jboss.server.base.dir" scan-interval="5000"/&gt;
&lt;/subsystem&gt;</pre></div><p>It will scan the standalone deployments directory every 5 seconds and deploy the newly added projects. We can try to use the deployment scanner to deploy <code class="literal">cluster-demo1.war</code>. Before that, we need to undeploy this project from the web management console.</p><div class="mediaobject"><img src="graphics/2432OS_02_11.jpg" alt="Deployment scanner"/></div><p>To undeploy the project, <a id="id115" class="indexterm"/>click on <span class="strong"><strong>En/Disable</strong></span> and then click on <span class="strong"><strong>Remove</strong></span>. After the project is undeployed, we can put <code class="literal">cluster-demo1.war</code> into <code class="literal">standalone/deployments</code> by using the following code:</p><div class="informalexample"><pre class="programlisting">$ mv cluster-demo1/target/cluster-demo1.war jboss-eap-6.1/standalone/deployments</pre></div><p>Because the deployment scanner is set to scan this directory every 5 seconds, we will wait for a while and we'll see that the project is deployed from the server output as follows:</p><div class="informalexample"><pre class="programlisting">00:21:05,963 INFO[org.jboss.as.server](DeploymentScanner-threads - 2)JBAS018559: Deployed "cluster-demo1.war"(runtime-name : "cluster-demo1.war")</pre></div><p>Now let's <a id="id116" class="indexterm"/>have a look at the <code class="literal">deployments</code> directory as follows:</p><div class="informalexample"><pre class="programlisting">README.txt                 cluster-demo1.war.deployed
cluster-demo1.warmod_cluster.sar</pre></div><p>We can see that there<a id="id117" class="indexterm"/> is a new file named <code class="literal">cluster-demo1.war.deployed</code> that was created automatically. This is the marker file that is created by the deployment scanner to mark the status of our project. Now, let's delete this file by using the following code:</p><div class="informalexample"><pre class="programlisting">$ rm cluster-demo1.war.deployed</pre></div><p>Wait a while and you can see the server output as follows:</p><div class="informalexample"><pre class="programlisting">00:26:21,289 INFO[org.jboss.as.server](DeploymentScanner-threads - 2)JBEAP6018558: Undeployed"cluster-demo1.war"(runtime-name: "cluster-demo1.war")</pre></div><p>Because we have deleted the <code class="literal">cluster-demo1.war.deployed</code> marker file, the scanner comes to know that we want to undeploy the project. So, it takes the action. Now let's check the <code class="literal">deployments</code> directory again by using the following code:</p><div class="informalexample"><pre class="programlisting">README.txt                   cluster-demo1.war.undeployed
cluster-demo1.warmod_cluster.sar</pre></div><p>We can see that the scanner created another marker file called <code class="literal">cluster-demo1.war.undeployed</code>, which marks the <code class="literal">cluster-demo1.war</code> file as undeployed. If we delete the <code class="literal">cluster-demo1.war.undeployed</code> file by using the following code:</p><div class="informalexample"><pre class="programlisting">$ rm cluster-demo1.war.undeployed</pre></div><p>Then the scanner will redeploy this project as follows:</p><div class="informalexample"><pre class="programlisting">00:29:41,499 INFO[org.jboss.as.server](DeploymentScanner-threads - 2)JBEAP6018559: Deployed "cluster-demo1.war"(runtime-name : "cluster-demo1.war")</pre></div><p>Now let's have a look at the <code class="literal">deployments</code> directory. We can see that the <code class="literal">cluster-demo1.war.deployed</code> marker file appeared again, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">README.txt                 cluster-demo1.war.deployed
cluster-demo1.warmod_cluster.sar</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>The deployment scanner can be used only in the standalone mode.</p></div></div></div></div>
<div class="section" title="Introducing JBoss DMR"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Introducing JBoss DMR</h1></div></div></div><p>JBoss DMR is<a id="id118" class="indexterm"/> the cornerstone of the JBoss management module. All the management actions will be translated into the management commands that are encapsulated in the DMR format. The deployment actions used by the deployment scanner or the management console are all translated into the DMR commands at last. For example, when the deployment scanner wants to deploy a project into EAP6, it will send the following JSON-like DMR commands to the deployment module. The following is the trimmed text of the command:</p><div class="informalexample"><pre class="programlisting">[{
  "operation" =&gt;"composite",
  "address" =&gt; [],
  "steps" =&gt; [
    {
      "operation" =&gt;"add",
      "address" =&gt; [("deployment" =&gt;"cluster-demo1.war")],
      "content" =&gt; [{
        "path" =&gt;"deployments/cluster-demo1.war",
        "relative-to" =&gt;"jboss.server.base.dir",
      }],
    },
    {
    "operation" =&gt;"deploy",
    "address" =&gt; [("deployment" =&gt;"cluster-demo1.war")]
    }
  ]
}]</pre></div><p>We can see that the deployment scanner has sent a composition operation that contains two operations: <code class="literal">add</code> and <code class="literal">deploy</code>. This means that EAP6 will first add this project into its scope and then start it. In the web management console, we see that these two actions are separated—we first add a project into EAP6 and then we click on <span class="strong"><strong>En/Disable</strong></span> to start it. Both the web management console and the command line interface send such kind of DMR commands to the deployment console.</p></div>
<div class="section" title="Deploying a project in the domain mode"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec20"/>Deploying a project in the domain mode</h1></div></div></div><p>Now let's learn <a id="id119" class="indexterm"/>how to deploy a project in the domain mode. When JBoss EAP6 is running under the domain mode, multiple servers can form a server group. When we deploy a project into a server group, all the servers in this group will get the project deployed. First, let's start JBoss EAP6 in the domain mode by <code class="literal">domain.sh</code>. Then, we will access the management console address, <code class="literal">http://127.0.0.1:9990</code>. The management console under the domain mode is different from the standalone mode. It's shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_12.jpg" alt="Deploying a project in the domain mode"/></div><p>The following are some notes <a id="id120" class="indexterm"/>about the management console is shown in the preceding screenshot:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">There is a <span class="strong"><strong>Server:</strong></span> section in the sidebar where we can check all the servers in different server groups.</li><li class="listitem">The marker indicates the running status of each server.</li><li class="listitem"><span class="strong"><strong>Ports:</strong></span> shows the port offsets of each server. Because these servers are running on the same machine, their ports must be offset to avoid confliction.</li><li class="listitem"><span class="strong"><strong>Profile:</strong></span> shows the profiles that the server group is bound to.</li><li class="listitem">The servers that belong to the same group have the same colors on the management console.</li><li class="listitem">We can start or stop a server in the management console.</li></ol></div><p>There are two server groups by default. Let's check the main-server-group in the following section.</p><div class="section" title="The main-server-group"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec25"/>The main-server-group</h2></div></div></div><p>We can see<a id="id121" class="indexterm"/> that the <span class="strong"><strong>main-server-group</strong></span> includes two servers by default. Let's deploy <code class="literal">cluster-demo1.war</code> into these groups. Please make sure that these two servers are started. If they are not, we can use the <span class="strong"><strong>Start Server</strong></span> function that is provided by the management console.</p><p>Now let's deploy <code class="literal">cluster-demo1.war</code>
<a id="id122" class="indexterm"/>. First, we need to click on the <span class="strong"><strong>Management Deployments</strong></span> tab that appears on the side bar. Then click on the <span class="strong"><strong>Content Repository</strong></span> tab, and click on <span class="strong"><strong>Add</strong></span>. This process is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_13.jpg" alt="The main-server-group"/></div><p>Now we will choose <code class="literal">cluster-demo1.war</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_14.jpg" alt="The main-server-group"/></div><p>Now we click<a id="id123" class="indexterm"/> on <span class="strong"><strong>Next&gt;&gt;</strong></span> and then click on <span class="strong"><strong>Save</strong></span>. Then, we can see that the project is deployed into <span class="strong"><strong>Content Repository</strong></span>. The result is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_15.jpg" alt="The main-server-group"/></div><p>We can see that the deployment process in the domain mode is different from the standalone mode. We don't directly deploy a project into servers. Instead, we add it into <span class="strong"><strong>Content Repository</strong></span> first and then deploy it to a server group. EAP6 will help us to deploy the project to all the servers in the group.</p><p>Now, let's <a id="id124" class="indexterm"/>deploy <code class="literal">cluster-demo1.war</code> to main-server-group. First click on the <span class="strong"><strong>Server Groups</strong></span> tab, and then click on <span class="strong"><strong>View&gt;</strong></span> of main-server-group, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_16.jpg" alt="The main-server-group"/></div><p>After clicking on <span class="strong"><strong>View&gt;</strong></span>, we enter the web page for <span class="strong"><strong>main-server-group</strong></span>. Then, we click on <span class="strong"><strong>Assign Name</strong></span> and select <code class="literal">cluster-demo1.war</code> to save it. This is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_17.jpg" alt="The main-server-group"/></div><p>Finally, let's enable the project. Click on <span class="strong"><strong>En/Disable</strong></span> and then click on <span class="strong"><strong>Confirm</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_18.jpg" alt="The main-server-group"/></div><p>After confirming <a id="id125" class="indexterm"/>the deployment, the project should be deployed to <span class="strong"><strong>server-one</strong></span> and <span class="strong"><strong>server-two</strong></span>. Let's verify this.</p><div class="section" title="Testing"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec06"/>Testing</h3></div></div></div><p>Now let's try<a id="id126" class="indexterm"/> to access the two servers. Please note that the master-server is located at port 8080 and slave-server has a port offset of 150, so the web port is 8080+150 = 8230. The results are as follows:</p><div class="mediaobject"><img src="graphics/2432OS_02_19.jpg" alt="Testing"/></div><p>From the preceding<a id="id127" class="indexterm"/> screenshot, we can see that <code class="literal">cluster-demo1.war</code> is deployed in both the servers.</p></div></div></div>
<div class="section" title="CLI Usages"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec21"/>CLI Usages</h1></div></div></div><p>The CLI provides <a id="id128" class="indexterm"/>a pure text environment for us to manage the EAP6 server, and it shares the same DMR model with the web management console. In this section, let's have a brief discussion about CLI usages.</p><div class="section" title="Connecting to CLI"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec26"/>Connecting to CLI</h2></div></div></div><p>The <a id="id129" class="indexterm"/>command to start the CLI is <code class="literal">jboss-cli.sh</code>, which is located in the <code class="literal">bin</code> folder. Make sure that you have started EAP6 in the standalone mode. Let's run the CLI command now. This process is shown in the following code:</p><div class="informalexample"><pre class="programlisting">$ ./jboss-cli.sh
You are disconnected at the moment. Type 'connect' to connect to the server or 'help' for the list of supported commands.
[disconnected /]</pre></div><p>Now that we have entered the CLI console, the next step is to use the <code class="literal">connect</code> command to enter the management console as follows:</p><div class="informalexample"><pre class="programlisting">[disconnected /] connect localhost
[standalone@localhost:9999 /]</pre></div><p>We have used the <code class="literal">connect</code> command to connect to the management console.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>You may have noticed that the CLI doesn't ask us to use the administrator account to log in. In the CLI, when we are connecting to the local EAP server, the authentication is bypassed.</p></div></div><p>As we have <a id="id130" class="indexterm"/>connected to the text management console, now let's learn some basic commands.</p><div class="section" title="ls"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec07"/>ls</h3></div></div></div><p>The first command we'll learn is <code class="literal">ls</code>
<a id="id131" class="indexterm"/>. It's similar to the <a id="id132" class="indexterm"/>
<code class="literal">ls</code> command used in the shell environment. This command lists the resources in JBoss EAP6, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_20.jpg" alt="ls"/></div><p>We can see that the resources are organized in a tree structure. This is similar to a file system and we can use the <code class="literal">ls</code> command to check the contents of the resources as if it's a directory. For example, we can check the resources in a subsystem, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_21.jpg" alt="ls"/></div></div><div class="section" title="cd"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec08"/>cd</h3></div></div></div><p>We can use the<a id="id133" class="indexterm"/> <code class="literal">cd</code> command<a id="id134" class="indexterm"/> to view resources as if they were directories. The usage is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_22.jpg" alt="cd"/></div><p>As shown in the preceding screenshot, we can use the <code class="literal">cd</code> command to traverse the resources.</p></div></div><div class="section" title="Basic commands"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec27"/>Basic commands</h2></div></div></div><p>The CLI provides a set of basic commands<a id="id135" class="indexterm"/> for us to use. We can press the <span class="emphasis"><em>Tab</em></span> key twice to see a list of these commands, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_23.jpg" alt="Basic commands"/></div><p>To understand <a id="id136" class="indexterm"/>the meaning of these commands, we can use the <span class="strong"><strong>--help</strong></span> option after a command name. For example, if we want to understand the usage of connect, we can use the <span class="strong"><strong>--help</strong></span> option as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_24.jpg" alt="Basic commands"/></div><p>Among the basic commands, I want to specifically introduce <code class="literal">echo-dmr</code> and <code class="literal">read-operation</code> because they are the most frequently used ones.</p><div class="section" title="echo-dmr"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec09"/>echo-dmr</h3></div></div></div><p>
<code class="literal">echo-dmr</code>
<a id="id137" class="indexterm"/> is used <a id="id138" class="indexterm"/>to build a DMR request for a command or operation. It is like a translator that translates the action into a DMR request. For example, if we want to understand how the <code class="literal">deploy</code> command constructs a DMR request, we can use <code class="literal">echo-dmr</code> to translate it:</p><div class="informalexample"><pre class="programlisting">[standalone@127.0.0.1:9999 /] echo-dmr deploy /cluster-demo1/cluster-demo1.war
{
  "operation" =&gt;"composite",
  "address" =&gt; [],
  "steps" =&gt; [
    {
      "operation" =&gt;"add",
      "address" =&gt; {"deployment" =&gt;"cluster-demo1.war"},
      "content" =&gt; [{"bytes" =&gt; bytes {
        ...
      }}]
    },
    {
      "operation" =&gt;"deploy",
      "address" =&gt; {"deployment" =&gt;"cluster-demo1.war"}
    }
  ]
}</pre></div><p>It's very clear <a id="id139" class="indexterm"/>to see the underlying details of the <code class="literal">deploy</code> command from the preceding DMR request.</p></div><div class="section" title="read-operation"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec10"/>read-operation</h3></div></div></div><p>In the<a id="id140" class="indexterm"/> CLI console, <a id="id141" class="indexterm"/>each resource has a set of operations that we can use on the resources. We can use <code class="literal">read-operation</code> to help us know the operations that could be operated on a resource. For example, if we want to find out what operations a web subsystem support, we can use <code class="literal">read-operation</code> as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_25.jpg" alt="read-operation"/></div><p>For example, in the list shown in the preceding screenshot, we see an operation named <span class="strong"><strong>read-operation-names</strong></span>. Let's<a id="id142" class="indexterm"/> try to use it as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_26.jpg" alt="read-operation"/></div><p>We see that the <code class="literal">read-operation-names</code> operation is very similar to the <code class="literal">read-operation</code> command; so what are their differences? Let's use <code class="literal">echo-dmr</code> to check it, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_27.jpg" alt="read-operation"/></div><p>From the DMR level, we can see that their translated DMR request is exactly the same.</p></div></div><div class="section" title="The GUI"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec28"/>The GUI</h2></div></div></div><p>EAP CLI also supports<a id="id143" class="indexterm"/> a GUI interface, which is actually a swing application. We can start it by using the <code class="literal">--gui</code> option as follows:</p><div class="informalexample"><pre class="programlisting">$ ./jboss-cli.sh --gui</pre></div><p>And the interface is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/2432OS_02_28.jpg" alt="The GUI"/></div><p>The GUI interface can also be used remotely. For example, if our management console is bound to a public IP address, we can access it from another machine with the GUI enabled by using the following command:</p><div class="informalexample"><pre class="programlisting">power:binweli$ ./jboss-cli.sh --controller=10.0.1.3:9999 --connect --gui</pre></div><p>And the GUI will be started from the remote machine.</p></div><div class="section" title="Deploying a project"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec29"/>Deploying a project</h2></div></div></div><p>Now let's use the CLI to<a id="id144" class="indexterm"/> deploy the project. The following command is used to do the deployment:</p><div class="informalexample"><pre class="programlisting">[standalone@localhost:9999 /] deploy /cluster-demo1/target/cluster-demo1.war</pre></div><p>After the project is deployed, we can see it under <code class="literal">deployment</code> as follows:</p><div class="informalexample"><pre class="programlisting">[standalone@localhost:9999 /] ls deployment
cluster-demo1.war</pre></div><p>Now, let's use the <code class="literal">undeploy</code> command to remove it as follows:</p><div class="informalexample"><pre class="programlisting">[standalone@localhost:9999 /] undeploy cluster-demo1.war</pre></div><p>Checking the contents in <code class="literal">deployment</code>, we can see that it's removed as follows:</p><div class="informalexample"><pre class="programlisting">[standalone@localhost:9999 /] ls deployment
[standalone@localhost:9999 /]</pre></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec22"/>Summary</h1></div></div></div><p>In this chapter, we have learned how to add the administrator account into JBoss EAP6. We have also learned to use the management model to deploy the projects into EAP6 when it's running in the standalone mode or the domain mode. Then, we had a closer look at the design of the EAP6 management model and the DMR layer. With this knowledge, I hope you have a good understanding of JBoss EAP6's structure and grasp its basic usages. From the next chapter, we'll start to set an EAP6 cluster.</p></div></body></html>