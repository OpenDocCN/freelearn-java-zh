<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;Building IcedTea"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Building IcedTea</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Building IcedTea 6</li><li class="listitem" style="list-style-type: disc">Building IcedTea 7</li><li class="listitem" style="list-style-type: disc">Building OpenJDK 7 with IcedTea patches</li><li class="listitem" style="list-style-type: disc">Building IcedTea 7 with NSS security provider</li><li class="listitem" style="list-style-type: disc">Building IcedTea 6 with SystemTap support</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec39"/>Introduction</h1></div></div></div><p><span class="strong"><strong>IcedTea</strong></span><a id="id176" class="indexterm"/> is a build and integration project for OpenJDK launched by Red Hat in June 2007. It allows users to build OpenJDK using free software tools. It also provides alternative open source implementations of the Java browser plugin and Java Web Start as part of the IcedTea-Web subproject.</p><p>Given the current state of the OpenJDK project itself, it is not easy to understand the full value of the IcedTea project. Some features of OpenJDK, which seem standard now, like the absence of binary components and an advanced build system, were pioneered in the IcedTea project.</p><p>The IcedTea project was started by Red Hat and the GNU classpath in 2007, soon after the Sun Java source code was published under an open source license. The main goal was to create a free Java package to include in GNU/Linux distributions. Popular distributions (such as Fedora or Arch) have strict requirements for included software. Generally speaking, the full source code must be available under the open source license, and binaries must be built using the free software build tools. At the time of the release, some OpenJDK modules (for example, font- and sound-related modules) were available in binary form only, and only a proprietary Sun Java compiler could be used for the build.</p><p>IcedTea incorporated the GNU Autoconf build system. This made it possible to use the GNU Compiler for Java to compile OpenJDK code and replace the binary modules with open source implementations. In 2008, the <code class="literal">IcedTea 6</code> binaries in the Fedora 9 distribution passed the Java Technology Compatibility Kit test suite successfully and became a fully compatible Java 6 implementation.</p><p>One distinguishable feature of the IcedTea project is <a id="id177" class="indexterm"/>
<span class="strong"><strong>bootstrap builds</strong></span>. Bootstrap mode means that the build process runs twice. First, the OpenJDK with some patches is built using the <span class="strong"><strong>GNU Compiler for Java</strong></span> (<span class="strong"><strong>GCJ</strong></span>)<a id="id178" class="indexterm"/> and then, the newly built binaries are used as the compiler for the resulting production build. In the early days of IcedTea, this process was the only way to ensure that no non-free binary parts were included (or accidentally leaked) into the resulting binaries from the non-free Sun Java compiler. Such bootstrapping with another compiler is a common procedure for free software. Besides preventing binary leaks, such a procedure can also be used to prevent possible malicious compiler bookmarks. For recent IcedTea versions, GCJ is not required for the built and prebuilt OpenJDK binaries, and can be used as the boot JDK without the full bootstrap process.</p><p>IcedTea is <a id="id179" class="indexterm"/>more open to new and experimental features than OpenJDK. It allows you to use alternative virtual machine implementations (such as Zero, Shark, and JamVM) and also supports cross-compiling for additional architectures (such as ARM, MIPS), which are not supported by OpenJDK.</p><p>IcedTea also provides more tight integration with an operating system. Originally, Sun Java distributions for Linux were made to be as self-contained as possible. Implementation of many standard features such as image processing support (PNG, JPG, GIF), compressing (ZIP), and cryptographic algorithms (elliptic curve-based ones) were included in the OpenJDK code base. These allow better portability but restrict users with older and possibly less secure versions of the open source libraries. Modern Linux distributions have advanced package management tools to control and update the common dependencies between packages. IcedTea has introduced the support for using some libraries from the host operating system, instead of using the versions included with OpenJDK.</p></div></div>
<div class="section" title="Building IcedTea 6"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec40"/>Building IcedTea 6</h1></div></div></div><p>The IcedTea<a id="id180" class="indexterm"/> project, historically, had a lot of changes in it compared to vanilla OpenJDK 6 source code. The number of changes went down eventually, as some of them were included in the main OpenJDK 6 source tree. Some of the changes, such as NIO2 API support (taken from OpenJDK 7), were experimental and were removed.</p><p>The changes are stored in the IcedTea source tree in the form of patches (different files) and not as changesets in a separate branch. This can confuse users who are not experienced with class Unix/Linux patch techniques and tools. The different files are stored in the <code class="literal">patches</code> directory and are applied to the OpenJDK source tree during the <code class="literal">configure</code> build step.</p><p>Contrary to<a id="id181" class="indexterm"/> OpenJDK 8, the GNU Autoconf build system is not integrated tightly into the IcedTea build process. The Autoconf <code class="literal">configure</code> step prepares the environment for building the OpenJDK sources and the standard (slightly patched) OpenJDK makefiles are run on the Autoconf <code class="literal">make</code> step.</p><p>In this recipe, we will build IcedTea 6 on Ubuntu 12.04 LTS amd64.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec132"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 (server or desktop version) running.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec133"/>How to do it...</h2></div></div></div><p>The following procedures will help you to build IcedTea 6:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the prepackaged binaries of OpenJDK 6:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-6-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-6</strong></span>
<span class="strong"><strong>sudo apt-get install libmotif-dev</strong></span>
</pre></div></li><li class="listitem">Download and decompress the <a id="id182" class="indexterm"/>appropriate <code class="literal">icedtea6*</code> source code tarball from <a class="ulink" href="http://icedtea.wildebeest.org/download/source/">http://icedtea.wildebeest.org/download/source/</a>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wget http://icedtea.wildebeest.org/download/source/icedtea6-1.13.1.tar.xz</strong></span>
<span class="strong"><strong>tar xJvf icedtea6-1.13.1.tar.xz</strong></span>
</pre></div></li><li class="listitem">Configure the build specifying the preinstalled OpenJDK path and disable the system's LCMS2 support:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure \</strong></span>
<span class="strong"><strong>--with-jdk-home=/usr/lib/jvm/java-6-openjdk-amd64 \</strong></span>
<span class="strong"><strong>--disable-system-lcms</strong></span>
</pre></div></li><li class="listitem">Start the build:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Wait for the build to finish.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec134"/>How it works...</h2></div></div></div><p>Prepackaged binaries of OpenJDK 6 are required because some of the build steps are run using the external Java runtime.</p><p>The <code class="literal">build-dep</code> command<a id="id183" class="indexterm"/> is used to install all the dependencies that are required to build the specified package. As Ubuntu-packaged OpenJDK 6 is quite close to the official OpenJDK 6, this command will install almost all the required dependencies.</p><p>The <code class="literal">libmotif-dev</code> package<a id="id184" class="indexterm"/> is the additional package that is required, and contains the Motif GUI toolkit header files.</p><p>In the configuration step, IcedTea checks the environment and prepares adjustments to the OpenJDK sources that are to be applied in build step.</p><p>In build step, the official<a id="id185" class="indexterm"/> OpenJDK 6 sources are downloaded and then adjusted in accordance with the build configuration. After that, the usual OpenJDK 6 build is run. Then, it is run for the second time using the results of the first build as a bootstrap JDK. The resulting binaries are produced by the second build.</p><p>Recent versions of IcedTea require the color management library LCMS Version 2.5 or higher. As such a version is not available in Ubuntu 12.04 repositories, we use LCMS bundled with OpenJDK sources.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec135"/>There's more...</h2></div></div></div><p>IcedTea has a much more flexible configuration compared to OpenJDK. Some of the options will be explored in later recipes in this chapter.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec136"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="link" href="ch02.html" title="Chapter 2. Building OpenJDK 6">Chapter 2</a>, <span class="emphasis"><em>Building OpenJDK 6</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">The IcedTea project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/Main_Page">http://icedtea.classpath.org/wiki/Main_Page</a></li><li class="listitem" style="list-style-type: disc">The acceptance speech <span class="emphasis"><em>Reflections on Trusting Trust</em></span> by Ken Thompson during the ACM A.M. Turing Award 1983, which can be found at <a class="ulink" href="http://cm.bell-labs.com/who/ken/trust.html">http://cm.bell-labs.com/who/ken/trust.html</a>.</li></ul></div></div></div>
<div class="section" title="Building IcedTea 7"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec41"/>Building IcedTea 7</h1></div></div></div><p>During the<a id="id186" class="indexterm"/> long years of development of OpenJDK 7, the build process was cleaned up and improved significantly. Many changes (such as replacing the binary plugins with open source components) were included in the main OpenJDK source tree after "soaking" in between other experimental changes in IcedTea.</p><p>Due to these changes, the IcedTea 7 source tree contains much fewer patches for OpenJDK 7 compared to its predecessor. Similar to IcedTea 6, Autoconf <code class="literal">configure</code> step applies patches and prepares the environment, and the <code class="literal">make</code> step runs the original OpenJDK 7 makefiles.</p><p>Source patches are mostly used for compatibility with platform Linux libraries (<code class="literal">zlib</code>, <code class="literal">libpng</code>, and so on) instead of ones contained in the source tree. Makefile patches, besides this task, are also used to change the Java launcher—version switch output. Many applications use these outputs to determine the version of JRE they run on. Besides the version number format, one notable change is that in Oracle the Java version line starts with the <code class="literal">java version &lt;version number&gt;</code> string, whereas the vanilla OpenJDK version line starts with <code class="literal">openjdk version &lt;version number&gt;</code>. While the version number can be modified using environment variables, this prefix cannot be modified. To achieve better compatibility with existing applications, IcedTea uses the makefile patch to change this prefix from <code class="literal">openjdk</code> to <code class="literal">java</code>.</p><p>In this recipe, we will build IcedTea 7 on Ubuntu 12.04 LTS.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec137"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 (server or desktop version) running.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec138"/>How to do it...</h2></div></div></div><p>The following procedures will help you to build Iced Tea 7:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the prepackaged binaries of OpenJDK 6:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-6-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-6</strong></span>
</pre></div></li><li class="listitem">Download and decompress the appropriate <code class="literal">icedtea-2*</code> source code tarball<a id="id187" class="indexterm"/> from <a class="ulink" href="http://icedtea.wildebeest.org/download/source/">http://icedtea.wildebeest.org/download/source/</a>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>http://icedtea.wildebeest.org/download/source/icedtea-2.4.5.tar.xz</strong></span>
<span class="strong"><strong>tar xJvf icedtea-2.4.5.tar.xz</strong></span>
</pre></div></li><li class="listitem">Configure the build, specifying the preinstalled OpenJDK path, and disable the system's LCMS2 support:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure \</strong></span>
<span class="strong"><strong>--with-jdk-home=/usr/lib/jvm/java-6-openjdk-amd64 \</strong></span>
<span class="strong"><strong>--disable-system-lcms</strong></span>
</pre></div></li><li class="listitem">Start the build:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Wait for the build to finish.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec139"/>How it works...</h2></div></div></div><p>The prepackaged <a id="id188" class="indexterm"/>binaries of OpenJDK 6 are required because some of the build steps are run using the external Java runtime.</p><p>The <code class="literal">build-dep</code> command<a id="id189" class="indexterm"/> is used to install all the dependencies that are required to build the specified package.</p><p>In the build step, the official OpenJDK 6 sources are downloaded and then adjusted in accordance with the build configuration. After that, the usual OpenJDK 6 build is run. Then, the OpenJDK 6 build is run a second time using the results of the first build as a bootstrap JDK. The resulting binaries are produced by the second build.</p><p>Recent versions of IcedTea require the color management library LCMS Version 2.5 or higher. As such a version is not available in Ubuntu 12.04 repositories, we used the LCMS bundled with OpenJDK sources.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec140"/>There's more...</h2></div></div></div><p>IcedTea has a much more flexible configuration compared to OpenJDK. Some of the options will be explored in the later recipes in this chapter.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec141"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">IcedTea project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/Main_Page">http://icedtea.classpath.org/wiki/Main_Page</a></li></ul></div></div></div>
<div class="section" title="Building OpenJDK 7 with IcedTea patches"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec42"/>Building OpenJDK 7 with IcedTea patches</h1></div></div></div><p>IcedTea 7 has<a id="id190" class="indexterm"/> a much shorter release cycle compared to OpenJDK 7. IcedTea releases roughly correspond to Oracle Java security releases and <a id="id191" class="indexterm"/>contain the same security patches where applicable, so, IcedTea 7 can be used to build up-to-date OpenJDK 7 builds on Windows and Mac OS X platforms.</p><p>Performing full IcedTea 7 builds on a non-Linux platform might be difficult because the build configuration step expects Linux as a host platform. Instead of this, the IcedTea project can be used to patch OpenJDK sources on Linux, and then the patched sources can be built on other platforms using the usual OpenJDK 7 build steps.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec142"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 (server or desktop version) running.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec143"/>How to do it...</h2></div></div></div><p>The following procedures will help you to prepare the OpenJDK 7 source code with IcedTea patches:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the prepackaged binaries of OpenJDK 6:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-6-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-6</strong></span>
</pre></div></li><li class="listitem">Download and decompress the appropriate <code class="literal">icedtea-2*</code> source code tarball from <a class="ulink" href="http://icedtea.wildebeest.org/download/source/">http://icedtea.wildebeest.org/download/source/</a>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>http://icedtea.wildebeest.org/download/source/icedtea-2.4.5.tar.xz</strong></span>
<span class="strong"><strong>tar xJvf icedtea-2.4.5.tar.xz</strong></span>
</pre></div></li><li class="listitem">Run the configuration script to enable the use of the libraries bundled with OpenJDK sources:<div class="informalexample"><pre class="programlisting">./configure \
--with-jdk-home=path/to/openjdk7 \
--with-rhino=path/to/rhino-1.7.4.jar \
--disable-bootstrap \
--disable-system-zlib \
--disable-system-jpeg \
--disable-system-png \
--disable-system-gif \
--disable-system-lcms \
--disable-system-pcsc \
--disable-compile-against-syscalls \
--disable-nss</pre></div></li><li class="listitem">Start the build process:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">During the build, the patched OpenJDK 7 source will be put into the <code class="literal">openjdk</code> directory. Copy this directory to a Windows or Mac OS X machine.</li><li class="listitem">Build the patched sources using the usual OpenJDK 7 build process, with the additional environment variables:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>export FT2_CFLAGS='-I$(FREETYPE_HEADERS_PATH) -I$(FREETYPE_HEADERS_PATH)/freetype2'</strong></span>
<span class="strong"><strong>export DISABLE_INTREE_EC=true</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec144"/>How it works...</h2></div></div></div><p>IcedTea 7 contains <a id="id192" class="indexterm"/>a set of patches that are applied (depending on configuration options) at the start of<a id="id193" class="indexterm"/> the build process. In this recipe, we do not want to build IcedTea itself, but we want to collect patched IcedTea sources to build them later, on another platform using the usual build process for OpenJDK 7, as described in <a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec145"/>There's more...</h2></div></div></div><p>Applying patches is performed in the early stages of the build. It is not necessary to wait for the IcedTea build to end: the build process can be interrupted after the patches are applied.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec146"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building IcedTea 7</em></span> recipe in this chapter</li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">IcedTea project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/Main_Page">http://icedtea.classpath.org/wiki/Main_Page</a></li></ul></div></div></div>
<div class="section" title="Building IcedTea 7 with the NSS security provider"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec43"/>Building IcedTea 7 with the NSS security provider</h1></div></div></div><p>OpenJDK <a id="id194" class="indexterm"/>supports pluggable modules for cryptography service implementation. Widely used modern cryptographic algorithms (such as ciphers, paddings, and so on) are usually available on multiple platforms. Different platforms can have different native implementations of these algorithms. These<a id="id195" class="indexterm"/> implementations can be more performant than OpenJDK internal ones because they can rely on the details of the platform they run on. Also, platform implementations can be used as bridges to the facilities of hardware crypto-devices such as smartcards or eTokens. OpenJDK pluggable crypto-providers allow you to use a wide range of cryptographic implementations through a single Java API interface.</p><p><span class="strong"><strong>Network Security Services</strong></span> (<span class="strong"><strong>NSS</strong></span>)<a id="id196" class="indexterm"/> is an open source cryptography library that was developed for the Netscape web browser and is currently maintained by the Mozilla Foundation. NSS provides implementation of a wide range of cryptographic algorithms that support <a id="id197" class="indexterm"/>
<span class="strong"><strong>Transport Layer Security</strong></span> (<span class="strong"><strong>TLS</strong></span>) and S/MIME and is used in the Firefox web browser, besides other software. NSS also has support for hardware crypto-devices (smartcards/eTokens).</p><p>IcedTea 7 can be built with support for NSS as a crypto-provider.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec147"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 (server or desktop version) running.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec148"/>How to do it...</h2></div></div></div><p>The following <a id="id198" class="indexterm"/>procedures will help you to build IcedTea 7 with NSS:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the prepackaged binaries of OpenJDK 6:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-6-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-6</strong></span>
</pre></div></li><li class="listitem">Download and decompress the appropriate <code class="literal">icedtea-2*</code> source code tarball from <a class="ulink" href="http://icedtea.wildebeest.org/download/source/">http://icedtea.wildebeest.org/download/source/</a>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>http://icedtea.wildebeest.org/download/source/icedtea-2.4.5.tar.xz</strong></span>
<span class="strong"><strong>tar xJvf icedtea-2.4.5.tar.xz</strong></span>
</pre></div></li><li class="listitem">Run the configuration script and enable the NSS crypto-provider:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure --with-jdk-home=/usr/lib/jvm/java-6-openjdk-amd64</strong></span>
<span class="strong"><strong>--disable-system-lcms</strong></span>
<span class="strong"><strong>--enable-nss</strong></span>
</pre></div></li><li class="listitem">Start the build:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Wait for the build to finish.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec149"/>How it works...</h2></div></div></div><p>OpenJDK <a id="id199" class="indexterm"/>supports pluggable cryptography <a id="id200" class="indexterm"/>implementations using unified service-provider interfaces. IcedTea 7 allows you to delegate cryptographic tasks to the platform NSS library.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec150"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building IcedTea 7</em></span> recipe from this chapter</li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">The Mozilla NSS developer documentation at <a class="ulink" href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS">https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS</a></li></ul></div></div></div>
<div class="section" title="Building IcedTea 6 with the SystemTap support"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec44"/>Building IcedTea 6 with the SystemTap support</h1></div></div></div><p>Applications<a id="id201" class="indexterm"/> running on modern operating systems usually<a id="id202" class="indexterm"/> communicate with the underlying OS kernel through<a id="id203" class="indexterm"/> <span class="strong"><strong>system calls</strong></span> (<span class="strong"><strong>syscalls</strong></span>) or through an intermediate platform API. Some operating systems provide advanced tracing tools to monitor the applications running, and for troubleshooting. Such tools (such as <code class="literal">dtrace</code> on Oracle Solaris) allow the user to intercept all application activity, syscalls, Unix signals processing, and so on, to diagnose performance and functional problems.</p><p>For proper support of tracing tools, applications should have <span class="emphasis"><em>probe-points</em></span> (or <span class="emphasis"><em>tracepoints</em></span>) compiled into their binaries.</p><p>SystemTap is a tracing tool and a scripting language for Linux-based operating systems. IcedTea 6 can be built with SystemTap support.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec151"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 (server or desktop version) running.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec152"/>How to do it...</h2></div></div></div><p>The following procedures will help you to build IcedTea 6 with SystemTap:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the prepackaged binaries of OpenJDK 6:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-6-jdk</strong></span>
</pre></div></li><li class="listitem">Install GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-6</strong></span>
<span class="strong"><strong>sudo apt-get install libmotif-dev</strong></span>
</pre></div></li><li class="listitem">Download <a id="id204" class="indexterm"/>and decompress the appropriate <code class="literal">icedtea6*</code> source code tarball from <a class="ulink" href="http://icedtea.wildebeest.org/download/source/">http://icedtea.wildebeest.org/download/source/</a>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wget http://icedtea.wildebeest.org/download/source/icedtea6-1.13.1.tar.xz</strong></span>
<span class="strong"><strong>tar xJvf icedtea6-1.13.1.tar.xz</strong></span>
</pre></div></li><li class="listitem">Configure <a id="id205" class="indexterm"/>the build, specifying the preinstalled OpenJDK path and disable the system's LCMS2 support:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure \</strong></span>
<span class="strong"><strong>--with-jdk-home=/usr/lib/jvm/java-6-openjdk-amd64 \</strong></span>
<span class="strong"><strong>--disable-system-lcms</strong></span>
<span class="strong"><strong>--enable-systemtap</strong></span>
</pre></div></li><li class="listitem">Start the build:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Wait for the build to finish.</li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec153"/>There's more...</h2></div></div></div><p>We built IcedTea 6 with the support of JVM user space markers. These markers allow SystemTap to probe various JVM events including the loading of classes, just-in-time translation of method, and garbage collection.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec154"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building IcedTea 6</em></span> recipe from this chapter</li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch02.html" title="Chapter 2. Building OpenJDK 6">Chapter 2</a>, <span class="emphasis"><em>Building OpenJDK 6</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">The SystemTap project website at <a class="ulink" href="https://sourceware.org/systemtap/">https://sourceware.org/systemtap/</a></li></ul></div></div></div></body></html>