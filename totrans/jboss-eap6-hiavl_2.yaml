- en: Chapter 2. Using JBoss EAP6
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 2 章。使用 JBoss EAP6
- en: 'In the previous chapter, we have learned how to download and install JBoss
    EAP6\. We also looked at the standalone mode and the domain mode of EAP6; in this
    chapter we''ll start learning its basic usages. We will learn how to manage and
    configure the EAP6 server. The following topics will be covered in this chapter:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们学习了如何下载和安装 JBoss EAP6。我们还了解了 EAP6 的独立模式和域模式；在本章中，我们将开始学习其基本用法。我们将学习如何管理和配置
    EAP6 服务器。本章将涵盖以下主题：
- en: Using the JBoss EAP6 management console to deploy a web application
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 JBoss EAP6 管理控制台部署 Web 应用程序
- en: Basic usages of the Command Line Interface management console
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 命令行界面管理控制台的基本用法
- en: The design of the JBoss EAP6 management model
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JBoss EAP6 管理模型的设计
- en: First, we need to understand some basic configurations of the EAP6 management
    console. After configuring it properly, we can start the EAP6 server and use its
    management console.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要了解 EAP6 管理控制台的一些基本配置。配置正确后，我们可以启动 EAP6 服务器并使用其管理控制台。
- en: Configuring the JBoss EAP6 management console
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 JBoss EAP6 管理控制台
- en: JBoss EAP6 has provided two management consoles—one is based on the web and
    another based on the **Command Line Interface** (**CLI**).Before using them, we
    need to configure the management modules properly.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: JBoss EAP6 提供了两个管理控制台——一个是基于 Web 的，另一个是基于 **命令行界面**（**CLI**）。在使用它们之前，我们需要正确配置管理模块。
- en: Security realms
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全领域
- en: To use the management console, we must understand its authentication scheme.
    The authentication module used by JBoss EAP6 is called **security realms**.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用管理控制台，我们必须了解其认证方案。JBoss EAP6 使用的认证模块被称为 **安全领域**。
- en: Tip
  id: totrans-10
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: EAP6 uses security realms to gain secure access to the management interfaces.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: EAP6 使用安全领域来获取对管理接口的安全访问。
- en: 'Open `standalone.xml` in the standalone configuration. The relative settings
    are given as follows:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `standalone.xml` 的独立配置中打开。相对设置如下：
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'As shown in the preceding configuration, the realm that is used by the management
    module is called `ManagementRealm`. It''s using a property file called `mgmt-users.properties`
    to store the user''s password information. The `management-interfaces` defines
    the network socket that is bound to the management console. By default, the web
    management console is bound to the address `127.0.0.1:9990`, and the CLI is bound
    to the address `127.0.0.1:9999`. The following diagram gives a summary of the
    management console configuration:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图配置所示，管理模块所使用的领域被称为 `ManagementRealm`。它使用一个名为 `mgmt-users.properties` 的属性文件来存储用户的密码信息。`management-interfaces`
    定义了绑定到管理控制台的网络套接字。默认情况下，Web 管理控制台绑定到地址 `127.0.0.1:9990`，而 CLI 绑定到地址 `127.0.0.1:9999`。以下图表给出了管理控制台配置的概述：
- en: '![Security realms](img/2432OS_02_01.jpg)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![安全领域](img/2432OS_02_01.jpg)'
- en: Since we have understood the authentication scheme used by JBoss EAP6, we now
    need to create a user account to access the management console.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经了解了 JBoss EAP6 使用的认证方案，我们现在需要创建一个用户账户来访问管理控制台。
- en: Setting up an admin account
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置管理员账户
- en: 'JBoss EAP6 has provided a command-line tool to generate user accounts for us.
    You will find it with the name `add-user.sh` in the `bin` folder. Let''s use it
    to generate an administrator account. This process is shown in the following screenshot:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: JBoss EAP6 为我们提供了一个命令行工具来生成用户账户。您可以在 `bin` 文件夹中找到名为 `add-user.sh` 的工具。让我们使用它来生成一个管理员账户。此过程在以下屏幕截图中显示：
- en: '![Setting up an admin account](img/2432OS_02_02.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![设置管理员账户](img/2432OS_02_02.jpg)'
- en: In the process shown in the preceding screenshot, we create a user named `jbossadmin`
    of the type **Management User**. This user belongs to the `ManagementRealm`, so
    we can use it to access the management console. Please note that the password
    must be more than eight characters long, and it should contain at least one alphabet,
    one number, and a symbol. So, I use the password `@packt000` for `jbossadmin`.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一个屏幕截图所示的过程中，我们创建了一个名为 `jbossadmin` 的 **管理用户** 类型的用户。此用户属于 `ManagementRealm`，因此我们可以使用它来访问管理控制台。请注意，密码长度必须超过八个字符，并且至少应包含一个字母、一个数字和一个符号。因此，我为
    `jbossadmin` 使用密码 `@packt000`。
- en: For the last option **Is this new user going to be used for one AS process to
    connect to another AS process?**, we choose **no**. In the later chapters, we'll
    create a user account for the remote server connection in the domain mode.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 对于最后一个选项 **此新用户是否将被用于一个 AS 进程连接到另一个 AS 进程？**，我们选择 **否**。在后面的章节中，我们将为域模式中的远程服务器连接创建用户账户。
- en: Using the web-based management console
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用基于网络的网络管理控制台
- en: 'Now let''s try to use the EAP6 web management console in the standalone mode.
    Run `standalone.sh` in the `bin` folder of EAP6 to start up the server. Then,
    we access the web management console by its default address, `http://127.0.0.1:9990`.
    The management console will pop up a login window; enter the user account we''ve
    just created. The process is shown in the following screenshot:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试在独立模式下使用 EAP6 网络管理控制台。在 EAP6 的 `bin` 文件夹中运行 `standalone.sh` 来启动服务器。然后，我们通过默认地址
    `http://127.0.0.1:9990` 访问网络管理控制台。管理控制台将弹出一个登录窗口；输入我们刚刚创建的用户账户。整个过程如下面的截图所示：
- en: '![Using the web-based management console](img/2432OS_02_03.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![使用基于网络的网络管理控制台](img/2432OS_02_03.jpg)'
- en: 'After login, we can see the main window of the management console, as shown
    in the following screenshot:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 登录后，我们可以看到管理控制台的主窗口，如下面的截图所示：
- en: '![Using the web-based management console](img/2432OS_02_04.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![使用基于网络的网络管理控制台](img/2432OS_02_04.jpg)'
- en: In the next section, we'll use the web-based management console to deploy a
    web application.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将使用基于网络的网络管理控制台来部署网络应用程序。
- en: Deploying a project in the standalone mode
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在独立模式下部署项目
- en: Now we can try to deploy a very simple web project named `cluster-demo1` into
    EAP6\. It's a plain hello world project that contains a simple hello page, which
    shows the current time on the browser. To deploy this project into EAP6, we can
    click on the **Manage Deployments** tab in the management console and then click
    on **Add**.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以尝试将一个非常简单的名为 `cluster-demo1` 的网络项目部署到 EAP6 中。这是一个简单的“你好，世界”项目，包含一个简单的问候页面，显示浏览器上的当前时间。要将此项目部署到
    EAP6 中，我们可以在管理控制台中点击 **Manage Deployments** 选项卡，然后点击 **Add**。
- en: '![Deploying a project in the standalone mode](img/2432OS_02_05.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_05.jpg)'
- en: Then, we choose `cluster-demo1.war` and click on **Next>>**.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们选择 `cluster-demo1.war` 并点击 **Next>>**。
- en: '![Deploying a project in the standalone mode](img/2432OS_02_06.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_06.jpg)'
- en: 'EAP6 will then ask us to verify the deployment names. We should accept the
    default name and click on **Save**. This process is shown in the following screenshot:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: EAP6 将要求我们验证部署名称。我们应该接受默认名称并点击 **Save**。这个过程如下面的截图所示：
- en: '![Deploying a project in the standalone mode](img/2432OS_02_07.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_07.jpg)'
- en: 'As the project has been deployed, the console will be redirected to the **Available
    Deployments** page. To start the deployed project, we need to select it and click
    on **En/Disable**. This process is shown in the following screenshot:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 由于项目已部署，控制台将重定向到 **Available Deployments** 页面。要启动已部署的项目，我们需要选择它并点击 **En/Disable**。这个过程如下面的截图所示：
- en: '![Deploying a project in the standalone mode](img/2432OS_02_08.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_08.jpg)'
- en: 'And we need to confirm to enable this project. This is done by clicking on
    **Confirm**, as shown in the following screenshot:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要确认以启用此项目。这是通过点击 **Confirm** 来完成的，如下面的截图所示：
- en: '![Deploying a project in the standalone mode](img/2432OS_02_09.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_09.jpg)'
- en: 'Finally, we can see that the project has started, as shown in the following
    screenshot:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以看到项目已启动，如下面的截图所示：
- en: '![Deploying a project in the standalone mode](img/2432OS_02_10.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![在独立模式下部署项目](img/2432OS_02_10.jpg)'
- en: 'Now, if we check the server output from the console, we can see that `cluster-demo1.war`
    is deployed as follows:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果我们检查控制台的服务器输出，我们可以看到 `cluster-demo1.war` 已按如下方式部署：
- en: '[PRE1]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now, let''s have a look at `standalone.xml`. We can see that the description
    of this deployment has been added as follows:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看 `standalone.xml`。我们可以看到，已添加了如下所示的部署描述：
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'From the preceding code snippet, we can see that the content of the configuration
    file has been updated by the management console. Finally, let''s check `standalone/data/content`
    as follows:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的代码片段中，我们可以看到配置文件的内容已被管理控制台更新。最后，让我们检查 `standalone/data/content` 如下：
- en: '[PRE3]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: From the preceding code snippet, we can see that the contents of the deployed
    project is hashed and stored in the `standalone/data/content` directory.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的代码片段中，我们可以看到已部署项目的内容已被哈希并存储在 `standalone/data/content` 目录中。
- en: Testing
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试
- en: 'Now we can try to access the deployed project to see if it''s running correctly.
    In the following code snippet, I used the `curl` command to test the connection:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以尝试访问已部署的项目，以查看它是否运行正确。在下面的代码片段中，我使用了 `curl` 命令来测试连接：
- en: '[PRE4]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: As shown in the preceding process, we can see the hello page from the console
    output.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述的过程所示，我们可以从控制台输出中看到hello页面。
- en: Deployment scanner
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 部署扫描器
- en: 'The standalone mode supports the traditional hot deployment used in the previous
    versions of JBoss AS. This method lets you put your copied project into a directory,
    and then JBoss EAP6 will scan the directory periodically to deploy the project
    copied into it. This function is supported by the deployment-scanner subsystem,
    which is defined in `standalone.xml` as follows:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 独立模式支持在JBoss AS先前版本中使用的传统热部署。此方法允许您将复制的项目放入目录中，然后JBoss EAP6将定期扫描该目录以部署其中复制的项目。此功能由部署扫描器子系统支持，该子系统在`standalone.xml`中定义如下：
- en: '[PRE5]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The default setting for the subsystem in `standalone.xml` is given as follows:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '`standalone.xml`中子系统的默认设置如下所示：'
- en: '[PRE6]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: It will scan the standalone deployments directory every 5 seconds and deploy
    the newly added projects. We can try to use the deployment scanner to deploy `cluster-demo1.war`.
    Before that, we need to undeploy this project from the web management console.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 它将每5秒扫描一次独立部署目录，并部署新添加的项目。我们可以尝试使用部署扫描器部署`cluster-demo1.war`。在此之前，我们需要从Web管理控制台卸载此项目。
- en: '![Deployment scanner](img/2432OS_02_11.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![部署扫描器](img/2432OS_02_11.jpg)'
- en: 'To undeploy the project, click on **En/Disable** and then click on **Remove**.
    After the project is undeployed, we can put `cluster-demo1.war` into `standalone/deployments`
    by using the following code:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 要卸载项目，请点击**启用/禁用**，然后点击**移除**。项目卸载后，我们可以使用以下代码将`cluster-demo1.war`文件放入`standalone/deployments`目录：
- en: '[PRE7]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Because the deployment scanner is set to scan this directory every 5 seconds,
    we will wait for a while and we''ll see that the project is deployed from the
    server output as follows:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 由于部署扫描器被设置为每5秒扫描此目录一次，我们将等待一会儿，然后我们会看到项目从服务器输出中部署如下：
- en: '[PRE8]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now let''s have a look at the `deployments` directory as follows:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看一下以下所示的`deployments`目录：
- en: '[PRE9]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'We can see that there is a new file named `cluster-demo1.war.deployed` that
    was created automatically. This is the marker file that is created by the deployment
    scanner to mark the status of our project. Now, let''s delete this file by using
    the following code:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到一个名为`cluster-demo1.war.deployed`的新文件被自动创建。这是部署扫描器创建的标记文件，用于标记我们项目的状态。现在，让我们使用以下代码删除此文件：
- en: '[PRE10]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Wait a while and you can see the server output as follows:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 等待一会儿，你可以看到以下服务器输出：
- en: '[PRE11]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Because we have deleted the `cluster-demo1.war.deployed` marker file, the scanner
    comes to know that we want to undeploy the project. So, it takes the action. Now
    let''s check the `deployments` directory again by using the following code:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已删除`cluster-demo1.war.deployed`标记文件，扫描器得知我们想要卸载项目。因此，它采取了行动。现在让我们再次使用以下代码检查`deployments`目录：
- en: '[PRE12]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'We can see that the scanner created another marker file called `cluster-demo1.war.undeployed`,
    which marks the `cluster-demo1.war` file as undeployed. If we delete the `cluster-demo1.war.undeployed`
    file by using the following code:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到扫描器创建了一个名为`cluster-demo1.war.undeployed`的另一个标记文件，该文件标记了`cluster-demo1.war`文件为已卸载。如果我们使用以下代码删除`cluster-demo1.war.undeployed`文件：
- en: '[PRE13]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Then the scanner will redeploy this project as follows:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，扫描器将重新部署此项目如下：
- en: '[PRE14]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now let''s have a look at the `deployments` directory. We can see that the
    `cluster-demo1.war.deployed` marker file appeared again, as shown in the following
    code:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看一下`deployments`目录。我们可以看到`cluster-demo1.war.deployed`标记文件再次出现，如下所示：
- en: '[PRE15]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Note
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The deployment scanner can be used only in the standalone mode.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 部署扫描器只能在独立模式下使用。
- en: Introducing JBoss DMR
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍JBoss DMR
- en: 'JBoss DMR is the cornerstone of the JBoss management module. All the management
    actions will be translated into the management commands that are encapsulated
    in the DMR format. The deployment actions used by the deployment scanner or the
    management console are all translated into the DMR commands at last. For example,
    when the deployment scanner wants to deploy a project into EAP6, it will send
    the following JSON-like DMR commands to the deployment module. The following is
    the trimmed text of the command:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: JBoss DMR是JBoss管理模块的基石。所有管理操作都将转换为封装在DMR格式中的管理命令。部署扫描器或管理控制台使用的部署操作最终都将转换为DMR命令。例如，当部署扫描器想要将项目部署到EAP6时，它将向部署模块发送以下类似JSON的DMR命令。以下是该命令的裁剪文本：
- en: '[PRE16]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We can see that the deployment scanner has sent a composition operation that
    contains two operations: `add` and `deploy`. This means that EAP6 will first add
    this project into its scope and then start it. In the web management console,
    we see that these two actions are separated—we first add a project into EAP6 and
    then we click on **En/Disable** to start it. Both the web management console and
    the command line interface send such kind of DMR commands to the deployment console.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到部署扫描器已发送一个包含两个操作：`添加`和`部署`的操作。这意味着EAP6将首先将此项目添加到其作用域中，然后启动它。在Web管理控制台中，我们看到这两个动作是分开的——我们首先将一个项目添加到EAP6中，然后点击**启用/禁用**来启动它。Web管理控制台和命令行界面都会向部署控制台发送此类DMR命令。
- en: Deploying a project in the domain mode
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在域模式下部署项目
- en: 'Now let''s learn how to deploy a project in the domain mode. When JBoss EAP6
    is running under the domain mode, multiple servers can form a server group. When
    we deploy a project into a server group, all the servers in this group will get
    the project deployed. First, let''s start JBoss EAP6 in the domain mode by `domain.sh`.
    Then, we will access the management console address, `http://127.0.0.1:9990`.
    The management console under the domain mode is different from the standalone
    mode. It''s shown in the following screenshot:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们学习如何在域模式下部署项目。当JBoss EAP6在域模式下运行时，多个服务器可以形成一个服务器组。当我们向服务器组部署项目时，该组中的所有服务器都将部署该项目。首先，让我们通过`domain.sh`启动JBoss
    EAP6的域模式。然后，我们将访问管理控制台地址，`http://127.0.0.1:9990`。域模式下的管理控制台与独立模式不同。如下截图所示：
- en: '![Deploying a project in the domain mode](img/2432OS_02_12.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![在域模式下部署项目](img/2432OS_02_12.jpg)'
- en: 'The following are some notes about the management console is shown in the preceding
    screenshot:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些关于前一个截图所示的管理控制台内容的笔记：
- en: There is a **Server:** section in the sidebar where we can check all the servers
    in different server groups.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在侧边栏中有一个**服务器**部分，我们可以检查不同服务器组中的所有服务器。
- en: The marker indicates the running status of each server.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 标记表示每个服务器的运行状态。
- en: '**Ports:** shows the port offsets of each server. Because these servers are
    running on the same machine, their ports must be offset to avoid confliction.'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**端口**：显示每个服务器的端口偏移量。因为这些服务器运行在同一台机器上，它们的端口必须偏移以避免冲突。'
- en: '**Profile:** shows the profiles that the server group is bound to.'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**配置文件**：显示服务器组绑定的配置文件。'
- en: The servers that belong to the same group have the same colors on the management
    console.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 属于同一组的服务器在管理控制台上有相同的颜色。
- en: We can start or stop a server in the management console.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以在管理控制台中启动或停止服务器。
- en: There are two server groups by default. Let's check the main-server-group in
    the following section.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下有两个服务器组。让我们在下一节检查**主服务器组**。
- en: The main-server-group
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 主服务器组
- en: We can see that the **main-server-group** includes two servers by default. Let's
    deploy `cluster-demo1.war` into these groups. Please make sure that these two
    servers are started. If they are not, we can use the **Start Server** function
    that is provided by the management console.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，默认情况下**主服务器组**包括两个服务器。让我们将这些组部署`cluster-demo1.war`。请确保这两个服务器已启动。如果没有，我们可以使用管理控制台提供的**启动服务器**功能。
- en: 'Now let''s deploy `cluster-demo1.war` . First, we need to click on the **Management
    Deployments** tab that appears on the side bar. Then click on the **Content Repository**
    tab, and click on **Add**. This process is shown in the following screenshot:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们部署`cluster-demo1.war`。首先，我们需要点击侧边栏上出现的**管理部署**选项卡。然后点击**内容仓库**选项卡，并点击**添加**。此过程如下截图所示：
- en: '![The main-server-group](img/2432OS_02_13.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器组](img/2432OS_02_13.jpg)'
- en: 'Now we will choose `cluster-demo1.war`, as shown in the following screenshot:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将选择`cluster-demo1.war`，如下截图所示：
- en: '![The main-server-group](img/2432OS_02_14.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器组](img/2432OS_02_14.jpg)'
- en: 'Now we click on **Next>>** and then click on **Save**. Then, we can see that
    the project is deployed into **Content Repository**. The result is shown in the
    following screenshot:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们点击**下一步>>**然后点击**保存**。然后，我们可以看到项目已部署到**内容仓库**。结果如下截图所示：
- en: '![The main-server-group](img/2432OS_02_15.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![主服务器组](img/2432OS_02_15.jpg)'
- en: We can see that the deployment process in the domain mode is different from
    the standalone mode. We don't directly deploy a project into servers. Instead,
    we add it into **Content Repository** first and then deploy it to a server group.
    EAP6 will help us to deploy the project to all the servers in the group.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，在域模式下的部署过程与独立模式不同。我们不会直接将项目部署到服务器上。相反，我们首先将其添加到**内容库**中，然后将其部署到服务器组。EAP6将帮助我们部署项目到组中的所有服务器。
- en: 'Now, let''s deploy `cluster-demo1.war` to main-server-group. First click on
    the **Server Groups** tab, and then click on **View>** of main-server-group, as
    shown in the following screenshot:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将`cluster-demo1.war`部署到main-server-group。首先点击**服务器组**标签，然后点击main-server-group的**查看>**，如图所示：
- en: '![The main-server-group](img/2432OS_02_16.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![The main-server-group](img/2432OS_02_16.jpg)'
- en: 'After clicking on **View>**, we enter the web page for **main-server-group**.
    Then, we click on **Assign Name** and select `cluster-demo1.war` to save it. This
    is shown in the following screenshot:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**查看>**后，我们进入**main-server-group**的网页。然后，我们点击**分配名称**并选择`cluster-demo1.war`进行保存。这如图所示：
- en: '![The main-server-group](img/2432OS_02_17.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![The main-server-group](img/2432OS_02_17.jpg)'
- en: 'Finally, let''s enable the project. Click on **En/Disable** and then click
    on **Confirm**, as shown in the following screenshot:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们启用项目。点击**启用/禁用**，然后点击**确认**，如图所示：
- en: '![The main-server-group](img/2432OS_02_18.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![The main-server-group](img/2432OS_02_18.jpg)'
- en: After confirming the deployment, the project should be deployed to **server-one**
    and **server-two**. Let's verify this.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 确认部署后，项目应该部署到**server-one**和**server-two**。让我们验证这一点。
- en: Testing
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试
- en: 'Now let''s try to access the two servers. Please note that the master-server
    is located at port 8080 and slave-server has a port offset of 150, so the web
    port is 8080+150 = 8230\. The results are as follows:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们尝试访问两个服务器。请注意，主服务器位于端口8080，从服务器有一个150的端口偏移量，因此Web端口是8080+150=8230。结果如下：
- en: '![Testing](img/2432OS_02_19.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![Testing](img/2432OS_02_19.jpg)'
- en: From the preceding screenshot, we can see that `cluster-demo1.war` is deployed
    in both the servers.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的截图可以看出，`cluster-demo1.war`已部署在两个服务器上。
- en: CLI Usages
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CLI使用方法
- en: The CLI provides a pure text environment for us to manage the EAP6 server, and
    it shares the same DMR model with the web management console. In this section,
    let's have a brief discussion about CLI usages.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: CLI为我们提供了一个纯文本环境来管理EAP6服务器，并且它与Web管理控制台共享相同的DMR模型。在本节中，让我们简要讨论CLI的使用。
- en: Connecting to CLI
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到CLI
- en: 'The command to start the CLI is `jboss-cli.sh`, which is located in the `bin`
    folder. Make sure that you have started EAP6 in the standalone mode. Let''s run
    the CLI command now. This process is shown in the following code:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 启动CLI的命令是`jboss-cli.sh`，它位于`bin`文件夹中。确保您已以独立模式启动EAP6。现在让我们运行CLI命令。这个过程如图所示：
- en: '[PRE17]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Now that we have entered the CLI console, the next step is to use the `connect`
    command to enter the management console as follows:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经进入了CLI控制台，下一步是使用`connect`命令进入管理控制台，如下所示：
- en: '[PRE18]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: We have used the `connect` command to connect to the management console.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经使用了`connect`命令来连接到管理控制台。
- en: Note
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You may have noticed that the CLI doesn't ask us to use the administrator account
    to log in. In the CLI, when we are connecting to the local EAP server, the authentication
    is bypassed.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经注意到CLI没有要求我们使用管理员账户登录。在CLI中，当我们连接到本地EAP服务器时，身份验证被绕过。
- en: As we have connected to the text management console, now let's learn some basic
    commands.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经连接到文本管理控制台，现在让我们学习一些基本命令。
- en: ls
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ls
- en: 'The first command we''ll learn is `ls` . It''s similar to the `ls` command
    used in the shell environment. This command lists the resources in JBoss EAP6,
    as shown in the following screenshot:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要学习的第一个命令是`ls`。它类似于在shell环境中使用的`ls`命令。此命令列出JBoss EAP6中的资源，如图所示：
- en: '![ls](img/2432OS_02_20.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![ls](img/2432OS_02_20.jpg)'
- en: 'We can see that the resources are organized in a tree structure. This is similar
    to a file system and we can use the `ls` command to check the contents of the
    resources as if it''s a directory. For example, we can check the resources in
    a subsystem, as shown in the following screenshot:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到资源是以树状结构组织的。这类似于文件系统，我们可以使用`ls`命令来检查资源的内容，就像检查目录一样。例如，我们可以检查子系统中的资源，如图所示：
- en: '![ls](img/2432OS_02_21.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![ls](img/2432OS_02_21.jpg)'
- en: cd
  id: totrans-130
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: cd
- en: 'We can use the `cd` command to view resources as if they were directories.
    The usage is shown in the following screenshot:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`cd`命令查看资源，就像它们是目录一样。用法如下面的截图所示：
- en: '![cd](img/2432OS_02_22.jpg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![cd](img/2432OS_02_22.jpg)'
- en: As shown in the preceding screenshot, we can use the `cd` command to traverse
    the resources.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 如前一个截图所示，我们可以使用`cd`命令遍历资源。
- en: Basic commands
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Basic commands
- en: 'The CLI provides a set of basic commands for us to use. We can press the *Tab*
    key twice to see a list of these commands, as shown in the following screenshot:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: CLI为我们提供了一套基本命令。我们可以按两次*Tab*键来查看这些命令的列表，如下面的截图所示：
- en: '![Basic commands](img/2432OS_02_23.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![Basic commands](img/2432OS_02_23.jpg)'
- en: 'To understand the meaning of these commands, we can use the **--help** option
    after a command name. For example, if we want to understand the usage of connect,
    we can use the **--help** option as shown in the following screenshot:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 要理解这些命令的含义，我们可以在命令名后使用`--help`选项。例如，如果我们想了解connect的用法，我们可以使用`--help`选项，如下面的截图所示：
- en: '![Basic commands](img/2432OS_02_24.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![Basic commands](img/2432OS_02_24.jpg)'
- en: Among the basic commands, I want to specifically introduce `echo-dmr` and `read-operation`
    because they are the most frequently used ones.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在基本命令中，我想特别介绍`echo-dmr`和`read-operation`，因为它们是最常用的。
- en: echo-dmr
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: echo-dmr
- en: '`echo-dmr` is used to build a DMR request for a command or operation. It is
    like a translator that translates the action into a DMR request. For example,
    if we want to understand how the `deploy` command constructs a DMR request, we
    can use `echo-dmr` to translate it:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '`echo-dmr`用于为命令或操作构建DMR请求。它就像一个翻译器，将动作翻译成DMR请求。例如，如果我们想了解`deploy`命令如何构建DMR请求，我们可以使用`echo-dmr`来翻译它：'
- en: '[PRE19]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: It's very clear to see the underlying details of the `deploy` command from the
    preceding DMR request.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的DMR请求中，我们可以清楚地看到`deploy`命令的底层细节。
- en: read-operation
  id: totrans-144
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: read-operation
- en: 'In the CLI console, each resource has a set of operations that we can use on
    the resources. We can use `read-operation` to help us know the operations that
    could be operated on a resource. For example, if we want to find out what operations
    a web subsystem support, we can use `read-operation` as shown in the following
    screenshot:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在CLI控制台中，每个资源都有一组我们可以对其执行的操作。我们可以使用`read-operation`来帮助我们了解可以操作的资源上的操作。例如，如果我们想找出Web子系统支持哪些操作，我们可以使用`read-operation`，如下面的截图所示：
- en: '![read-operation](img/2432OS_02_25.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![read-operation](img/2432OS_02_25.jpg)'
- en: 'For example, in the list shown in the preceding screenshot, we see an operation
    named **read-operation-names**. Let''s try to use it as shown in the following
    screenshot:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在前面截图所示的列表中，我们看到一个名为**read-operation-names**的操作。让我们尝试使用它，如下面的截图所示：
- en: '![read-operation](img/2432OS_02_26.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![read-operation](img/2432OS_02_26.jpg)'
- en: 'We see that the `read-operation-names` operation is very similar to the `read-operation`
    command; so what are their differences? Let''s use `echo-dmr` to check it, as
    shown in the following screenshot:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到`read-operation-names`操作与`read-operation`命令非常相似；那么它们之间有什么区别呢？让我们使用`echo-dmr`来检查它，如下面的截图所示：
- en: '![read-operation](img/2432OS_02_27.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![read-operation](img/2432OS_02_27.jpg)'
- en: From the DMR level, we can see that their translated DMR request is exactly
    the same.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 从DMR层面来看，我们可以看到它们的翻译DMR请求完全相同。
- en: The GUI
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: GUI
- en: 'EAP CLI also supports a GUI interface, which is actually a swing application.
    We can start it by using the `--gui` option as follows:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: EAP CLI还支持GUI界面，实际上是一个Swing应用程序。我们可以通过使用`--gui`选项来启动它，如下所示：
- en: '[PRE20]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'And the interface is shown in the following screenshot:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 接口如下面的截图所示：
- en: '![The GUI](img/2432OS_02_28.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![The GUI](img/2432OS_02_28.jpg)'
- en: 'The GUI interface can also be used remotely. For example, if our management
    console is bound to a public IP address, we can access it from another machine
    with the GUI enabled by using the following command:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: GUI界面也可以远程使用。例如，如果我们的管理控制台绑定了一个公网IP地址，我们可以使用以下命令通过另一个机器上的GUI访问它：
- en: '[PRE21]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: And the GUI will be started from the remote machine.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: GUI将从远程机器启动。
- en: Deploying a project
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 部署项目
- en: 'Now let''s use the CLI to deploy the project. The following command is used
    to do the deployment:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们使用CLI来部署项目。以下命令用于部署：
- en: '[PRE22]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'After the project is deployed, we can see it under `deployment` as follows:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 项目部署后，我们可以在`deployment`下看到它，如下所示：
- en: '[PRE23]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Now, let''s use the `undeploy` command to remove it as follows:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用`undeploy`命令来删除它，如下所示：
- en: '[PRE24]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Checking the contents in `deployment`, we can see that it''s removed as follows:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 检查`deployment`中的内容，我们可以看到它被删除，如下所示：
- en: '[PRE25]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Summary
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we have learned how to add the administrator account into JBoss
    EAP6\. We have also learned to use the management model to deploy the projects
    into EAP6 when it's running in the standalone mode or the domain mode. Then, we
    had a closer look at the design of the EAP6 management model and the DMR layer.
    With this knowledge, I hope you have a good understanding of JBoss EAP6's structure
    and grasp its basic usages. From the next chapter, we'll start to set an EAP6
    cluster.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何将管理员账户添加到 JBoss EAP6。我们还学习了在 EAP6 以独立模式或域模式运行时，如何使用管理模型将项目部署到 EAP6。然后，我们更深入地了解了
    EAP6 管理模型和 DMR 层的设计。有了这些知识，我希望你对 JBoss EAP6 的结构有一个良好的理解，并掌握了其基本用法。从下一章开始，我们将开始设置
    EAP6 集群。
