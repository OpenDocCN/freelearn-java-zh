<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Getting Started"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started</h1></div></div></div><p>In this chapter, we will cover the basic tasks related to getting started with Apache Maven:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Installing Maven on Microsoft Windows</li><li class="listitem" style="list-style-type: disc">Installing Maven on Mac OS X</li><li class="listitem" style="list-style-type: disc">Installing Maven on Linux</li><li class="listitem" style="list-style-type: disc">Changing the JDK used by Maven</li><li class="listitem" style="list-style-type: disc">Creating a simple project with Maven</li><li class="listitem" style="list-style-type: disc">Building a simple project with Maven</li><li class="listitem" style="list-style-type: disc">Changing the location of the Maven repository</li><li class="listitem" style="list-style-type: disc">Running Maven behind an HTTP proxy server</li><li class="listitem" style="list-style-type: disc">Understanding the standard directory layout</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Introduction</h1></div></div></div><p>Apache Maven<a id="id0" class="indexterm"/> is a popular tool for build automation, primarily Java projects. Maven addresses two aspects of building software. First, it describes how a software is built and, second, it describes its dependencies. It uses conventions for the build procedure. An XML file describes the software project being built, its dependencies on other external modules and components, the build order, directories, and required plugins. It comes with predefined targets to perform certain well-defined tasks, such as code compilation and its packaging. Maven dynamically downloads Java libraries and Maven plugins from one or more repositories, such as the <a id="id1" class="indexterm"/>
<span class="strong"><strong>Maven Central Repository</strong></span>, and stores them locally.</p><p>Ever since Maven 1.0 was released in 2004, it has gained popularity and is today the build tool for a large number of open source and commercial projects.</p><p>If you are reading this book, then you are not here to understand why Maven is required. You are here to explore Maven and unleash the potential that it offers. The objective of this book is to make the reader aware of Maven's various features, which include installation, configuration, and simple to complex usage by means of examples, illustrations, and working projects.</p><div class="section" title="A brief comparison with other build automation tools"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>A brief comparison with other build automation tools</h2></div></div></div><p>Let's briefly discuss some build automation tools:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Make</strong></span>: If you are from the <a id="id2" class="indexterm"/>C programming world, chances are you have used <a id="id3" class="indexterm"/>Make. Makefiles are not platform-independent. They are not natively compatible with Windows. Thus, they are unsuited to build Java projects.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Ant</strong></span>: This is modeled after<a id="id4" class="indexterm"/> Make and has targets and dependencies. Each target has a set of tasks. Ant<a id="id5" class="indexterm"/> doesn't have any conventions. It is procedural and does not have the concept of a build lifecycle. Maven has conventions, is declarative, and has a lifecycle.</li></ul></div><p>In this chapter, we will cover the basics of Maven—installing the software, verifying the installation, and creating, implementing, and building a simple Java project. We will also cover a few advanced items, such as changing the location of the repository or running Maven behind an HTTP proxy server as it could be relevant to those who have issues with the way Maven works by default.</p><p>Let us start by setting up Maven. We will cover how to do this on the three popular operating systems, namely Microsoft Windows, Mac OS X, and Linux.</p></div></div></div>
<div class="section" title="Installing Maven on Microsoft Windows"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Installing Maven on Microsoft Windows</h1></div></div></div><p>At the time of writing<a id="id6" class="indexterm"/> this book, Microsoft Windows 8.1 is<a id="id7" class="indexterm"/> the latest version of Microsoft Windows. While the screenshots and output will be for Microsoft Windows 8.1, the steps are similar for earlier (and possibly later) versions as well.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Getting ready</h2></div></div></div><p>As Maven requires a Java platform, first ensure that you have installed the Java environment on your system, <span class="strong"><strong>Java Development Kit</strong></span> (<span class="strong"><strong>JDK</strong></span>)<a id="id8" class="indexterm"/> specifically; <span class="strong"><strong>Java Runtime Environment</strong></span> (<span class="strong"><strong>JRE</strong></span>)<a id="id9" class="indexterm"/> is not sufficient.</p><p>You can verify whether Java is installed on your system by opening <span class="strong"><strong>Add or Remove Programs</strong></span>. If you see something similar to the following screenshot, JDK is installed on your system:</p><div class="mediaobject"><img src="graphics/6124OS_01_01.jpg" alt="Getting ready"/></div><p>You can also verify the<a id="id10" class="indexterm"/> program folder structure from Microsoft Windows<a id="id11" class="indexterm"/> Explorer:</p><div class="mediaobject"><img src="graphics/6124OS_01_09.jpg" alt="Getting ready"/></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>How to do it...</h2></div></div></div><p>Let's start installing Java and Maven by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set the variable <code class="literal">JAVA_HOME</code> to point to the Java installation that you want Maven to use; for example, you can do this by setting <code class="literal">JAVA_HOME</code> variable in the following way:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\projects\apache_maven_cookbook&gt;set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_20</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>Note that this setting will not be persisted once the command prompt is closed. To persist this, set <span class="strong"><strong>Environment Variables...</strong></span> using the <span class="strong"><strong>Control Panel</strong></span> option, as described later for the <code class="literal">M2_HOME</code> variable.</p></div></div></li><li class="listitem">If JDK is <a id="id12" class="indexterm"/>not installed on your system, now<a id="id13" class="indexterm"/> is the time to download and install it from the <a id="id14" class="indexterm"/>Oracle Java SE download page at <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.<p>Once it is installed, ensure <code class="literal">JAVA_HOME</code> is set as described earlier.</p><p>Now that we have set up Java, let us download and set up Maven.</p></li><li class="listitem">Go to <a class="ulink" href="http://maven.apache.org/">http://maven.apache.org/</a> and click <a id="id15" class="indexterm"/>on the <span class="strong"><strong>Download</strong></span> link.</li><li class="listitem">The links to the latest stable versions of Maven are displayed.</li><li class="listitem">The binaries are available in both, <code class="literal">.zip</code> and <code class="literal">.tar.gz</code> formats. Choose one of them.</li><li class="listitem">Extract the downloaded binary to a folder you want Maven to reside in. In this case I have chosen <code class="literal">C:\software</code>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>It is best to avoid folders with spaces as some features of Maven or its plugins might not work.</p></div></div></li><li class="listitem">Ensure the contents are similar to the following screenshot:<div class="mediaobject"><img src="graphics/6124OS_01_02.jpg" alt="How to do it..."/></div></li></ol></div><p>The preceding screenshot displays a list of directories contained in Maven.</p><p>Now let's briefly discuss what these directories contain:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">bin</code> folder <a id="id16" class="indexterm"/>contains the batch files and shell<a id="id17" class="indexterm"/> scripts to run Maven on various platforms.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">boot</code> folder contains the jars required for Maven to start.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">conf</code> folder contains the default <code class="literal">settings.xml</code> file used by Maven.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">lib</code> folder contains the libraries used by Maven. It also contains an <code class="literal">ext</code> folder in which third-party extensions, which can extend or override the default Maven implementation, can be placed.</li></ul></div><p>Now let us make sure we can run Maven from the command prompt by carrying out the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>Control Panel</strong></span>:<div class="mediaobject"><img src="graphics/6124OS_01_03.jpg" alt="How to do it..."/></div></li><li class="listitem">Choose <span class="strong"><strong>Advanced system settings</strong></span>:<div class="mediaobject"><img src="graphics/6124OS_01_04.jpg" alt="How to do it..."/></div></li><li class="listitem">Click on<a id="id18" class="indexterm"/> <span class="strong"><strong>Environment Variables...</strong></span>. Add<a id="id19" class="indexterm"/> the <code class="literal">M2_HOME</code> variable and set it to the folder where Maven was extracted.<div class="mediaobject"><img src="graphics/6124OS_01_05.jpg" alt="How to do it..."/></div></li><li class="listitem">Edit the <code class="literal">PATH</code> variable to include Maven's <code class="literal">bin</code> folder:<div class="mediaobject"><img src="graphics/6124OS_01_06.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>How it works...</h2></div></div></div><p>A Maven<a id="id20" class="indexterm"/> installation is essentially a set of JAR files, configuration <a id="id21" class="indexterm"/>files, and a Microsoft Windows batch file, <code class="literal">mvn.bat</code>.</p><p>The <code class="literal">mvn</code> command essentially runs this batch file. It first checks for <code class="literal">JAVA_HOME</code>. This file is present in the <code class="literal">bin</code> folder of the Maven installation and, hence, it needs to be in <code class="literal">PATH</code>.</p><p>If the batch file does not find <code class="literal">JAVA_HOME</code>, it looks for <code class="literal">Java</code> in its <code class="literal">PATH</code>. This can lead to unexpected results, as typically the <code class="literal">Java</code> in <code class="literal">PATH</code> is usually the JRE and not the JDK.</p><p>The batch file then looks for <code class="literal">M2_HOME</code>, which is the location of the Maven installation. It does this so that it can load the libraries that are present.</p><p>Additionally, it also reads values specified in <code class="literal">MAVEN_OPTS</code>. This variable allows you to run Maven with an additional heap size and other Java parameters.</p><p>Using the values for <code class="literal">JAVA_HOME</code>, <code class="literal">M2_HOME</code>, and <code class="literal">Maven_OPTS</code>, the batch file runs its main class <code class="literal">org.codehaus.plexus.classworlds.launcher.Launcher</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>There's more...</h2></div></div></div><p>Verify your Maven installation using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a command prompt in Microsoft Windows and run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\software\apache-maven-cookbook&gt;mvn -version</strong></span>
</pre></div></li><li class="listitem">The following output should be displayed:<div class="informalexample"><pre class="programlisting">Apache Maven 3.2.5 (12a6b3acb947671f09b81f49094c53f426d8cea1; 2014-12-14T22:59:23+05:30)
Maven home: C:\software\apache-maven-3.2.5
Java version: 1.7.0_67, vendor: Oracle Corporation
Java home: C:\Program Files\Java\jdk1.7.0_67\jre
Default locale: en_IN, platform encoding: Cp1252
<span class="strong"><strong>OS name: "windows 8.1", version: "6.3", arch: "amd64", family: "windows"</strong></span>
</pre></div></li></ol></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec18"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple project with Maven</em></span> recipe in this chapter</li></ul></div></div></div>
<div class="section" title="Installing Maven on Mac OS X"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Installing Maven on Mac OS X</h1></div></div></div><p>Let us look at the steps to<a id="id22" class="indexterm"/> install Maven on Mac OS X. This applies to the <a id="id23" class="indexterm"/>latest version of Mac OS X, namely Yosemite.</p><p>Earlier, Apple provided Java for Mac, but stopped doing so from Java 7 onwards. Apple Java is not available on recent versions of Mac OS X.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec19"/>Getting ready</h2></div></div></div><p>Let us check if the Java environment is available on your Mac:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the terminal and run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/libexec/java_home -v 1.7</strong></span>
</pre></div></li><li class="listitem">See if you get an output similar to the following:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/Library/Java/JavaVirtualMachines/jdk1.7.0_71.jdk/Contents/Home</strong></span>
</pre></div></li><li class="listitem">Run the following command to check if you have Java 8:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/libexec/java_home -v 1.8</strong></span>
</pre></div></li><li class="listitem">This should give the following output if Java exists:<div class="informalexample"><pre class="programlisting">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home</pre></div><p>As you can see, my system has both Java 1.7 and 1.8.</p></li><li class="listitem">Set <code class="literal">JAVA_HOME</code> to the desired JDK. This can be done in two ways, depending on what you desire:<p>If this is for the duration of the session, run the following command:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home</strong></span>
</pre></div><p>If this is permanent, add the preceding line in <code class="literal">.bash_profile</code> in your <code class="literal">HOME</code> folder</p></li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>Ensure you have the JDK installation and not JRE.</p></div></div><p>If Java is not present, download and install Java from the Oracle Java download page<a id="id24" class="indexterm"/> at <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.</p><p>Once installed, verify the<a id="id25" class="indexterm"/> Java installation by following the preceding <a id="id26" class="indexterm"/>steps.</p><p>Now, let us set up Maven on Mac OS X.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec20"/>How to do it...</h2></div></div></div><p>Let's download Maven from its official website by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="http://maven.apache.org/">http://maven.apache.org/</a> and <a id="id27" class="indexterm"/>click on the <span class="strong"><strong>Download</strong></span> link. Links to the latest stable versions of Maven will be displayed.</li><li class="listitem">The binaries are available in both <code class="literal">.zip</code> and <code class="literal">.tar.gz</code> formats. Choose one of them.</li><li class="listitem">Extract the downloaded binary to the folder you want Maven to reside in. The typical location for the Mac is <code class="literal">/usr/local</code> folder.</li><li class="listitem">You will need a super user (su) or administrator access to place the contents in the <code class="literal">/usr/local</code> folder. If you do not have access, you can place the contents in a subfolder of your <code class="literal">HOME</code> folder.</li><li class="listitem">Ensure the contents are similar to the following output by executing the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/local/apache-maven-3.2.5$ ls -l</strong></span>
</pre></div><p>The output is shown as:</p><div class="informalexample"><pre class="programlisting">total 27
-rw-r--r--    1 root    wheel    17464 Aug 12 02:29 LICENSE
-rw-r--r--    1 root    wheel      182 Aug 12 02:29 NOTICE
-rw-r--r--    1 root    wheel     2508 Aug 12 02:26 README.txt
drwxr-xr-x    8 root    wheel     4096 Aug 19 13:41 bin
drwxr-xr-x    3 root    wheel        0 Aug 19 13:41 boot
drwxr-xr-x    4 root    wheel        0 Oct 14 17:39 conf
<span class="strong"><strong>drwxr-xr-x   67 root    wheel    28672 Aug 19 13:41 lib</strong></span>
</pre></div></li><li class="listitem">Set the <code class="literal">M2_HOME</code> variable as follows:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export M2_HOME=/usr/local/apache-maven-3.2.5</strong></span>
</pre></div></li><li class="listitem">Update the <code class="literal">PATH</code> to include Maven's <code class="literal">bin</code> folder:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export PATH=$PATH:$M2_HOME/bin</strong></span>
</pre></div></li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>Like <code class="literal">JAVA_HOME</code>, the preceding settings can be persisted by updating <code class="literal">.bash_profile</code> with the preceding lines.</p></div></div><p>In the preceding steps, we <a id="id28" class="indexterm"/>discussed the steps to download Maven from<a id="id29" class="indexterm"/> its official website. We will now discuss installing Maven using brew. Brew is a popular application on Mac OS X to install open source software. If you have brew installed on your Mac OS X, run the following command to install Maven:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>brew install maven</strong></span>
</pre></div><p>The output for the preceding command will be displayed as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6124OS_01_10.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec21"/>How it works...</h2></div></div></div><p>The Maven installation is essentially a set of JAR files, configuration files, and a Mac OS X shell script, namely <code class="literal">mvn</code>.</p><p>The <code class="literal">mvn</code> command essentially runs this script. It first checks for <code class="literal">JAVA_HOME</code>. This file is present in the <code class="literal">bin</code> folder of the Maven installation and, hence, it needs to be in <code class="literal">PATH</code>.</p><p>If the shell script does not find <code class="literal">JAVA_HOME</code>, it looks for <code class="literal">Java</code> in its <code class="literal">PATH</code>. This can lead to unexpected results, as typically the <code class="literal">Java</code> in <code class="literal">PATH</code> is usually the JRE installation and not JDK.</p><p>The shell script then looks for <code class="literal">M2_HOME</code>, which is the location for the Maven installation. It does this so that it can load the libraries that are present.</p><p>Additionally, it also reads values specified in <code class="literal">MAVEN_OPTS</code>. This variable allows you to run Maven with an additional heap size and other Java parameters.</p><p>Using the <a id="id30" class="indexterm"/>values for <code class="literal">JAVA_HOME</code>, <code class="literal">M2_HOME</code>, and <code class="literal">MAVEN_OPTS</code>, the <a id="id31" class="indexterm"/>shell script runs its main class <code class="literal">org.codehaus.plexus.classworlds.launcher.Launcher</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec22"/>There's more...</h2></div></div></div><p>Verify your Maven installation using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a command prompt and run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn –version</strong></span>
</pre></div></li><li class="listitem">The output for the preceding command should be displayed as shown in the following screenshot:<div class="mediaobject"><img src="graphics/6124OS_01_11.jpg" alt="There's more..."/></div></li></ol></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec23"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple project with Maven</em></span> recipe in this chapter</li></ul></div></div></div>
<div class="section" title="Installing Maven on Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Installing Maven on Linux</h1></div></div></div><p>Let us look at the<a id="id32" class="indexterm"/> steps to install Maven on Linux.</p><p>While there are many<a id="id33" class="indexterm"/> flavors of Linux (Ubuntu, Fedora, RHEL, SUSE, CentOS, and so on), the steps to set up Maven are similar.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec24"/>Getting ready</h2></div></div></div><p>Maven needs Java, specifically the Java Development Kit (JDK). Using the following steps, let us check if it is installed in your Linux system, which is a bit tricky:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a terminal and run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>java -version</strong></span>
</pre></div></li><li class="listitem">See if you get an output similar to the following:<div class="informalexample"><pre class="programlisting">java version "1.7.0_65"
<span class="strong"><strong>OpenJDK Runtime Environment (rhel-2.5.1.2.el6_5-x86_64 u65-b17)</strong></span>
</pre></div><p>The preceding output will still not tell you where your Java is installed, which is required to set <code class="literal">JAVA_HOME</code>. You can get this information by performing the next set of steps.</p></li><li class="listitem">Check if <code class="literal">javac</code> <a id="id34" class="indexterm"/>works; it does only if JDK is installed, not <a id="id35" class="indexterm"/>JRE:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>$ javac -version</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>javac 1.7.0_65</strong></span>
</pre></div></li><li class="listitem">Find the location of the <code class="literal">javac</code> command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>$ which javac</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/bin/javac</strong></span>
</pre></div></li><li class="listitem">In the preceding output, <code class="literal">javac</code> is a symbolic link to the actual location of the file. Try to determine this location in the following way:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>$ readlink /usr/bin/javac</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/etc/alternatives/javac</strong></span>
</pre></div></li><li class="listitem">By executing the preceding command, we again got the symbolic link. To get the path to the location of <code class="literal">javac</code>, we execute the following command again:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>$ readlink /etc/alternatives/javac</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/lib/jvm/java-1.7.0-openjdk.x86_64/bin/javac</strong></span>
</pre></div></li><li class="listitem">We have now located the folder where JDK is installed:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/lib/jvm/java-1.7.0-openjdk.x86_64/</strong></span>
</pre></div></li><li class="listitem">Set <code class="literal">JAVA_HOME</code> to the preceding folder. This can be done in two ways, depending on what you desire:<p>If it is for the duration of the session, run the following command:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export JAVA_HOME=/usr/lib/jvm/java-1.7.0-openjdk.x86_64/</strong></span>
</pre></div><p>If this is permanent, add the preceding line in <code class="literal">.bash_profile</code> in your <code class="literal">HOME</code> folder.</p></li></ol></div><p>If Java is not present, download and install Java from the Oracle Java download page<a id="id36" class="indexterm"/> at <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.</p><p>If you have an rpm-based Linux distribution, you can download and install <code class="literal">rpm</code>. Otherwise, you can download the <code class="literal">.tar.gz</code> format of the distribution and extract it to a folder of your choice.</p><p>In the earlier case, you know exactly where Java is installed and can set <code class="literal">JAVA_HOME</code> correspondingly. Once installed, verify the Java installation by following the preceding steps.</p><p>Now, let us set up Maven on Linux.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec25"/>How to do it...</h2></div></div></div><p>To set up Maven on<a id="id37" class="indexterm"/> Linux, perform <a id="id38" class="indexterm"/>the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go<a id="id39" class="indexterm"/> to <a class="ulink" href="http://maven.apache.org/">http://maven.apache.org/</a> and click on the <span class="strong"><strong>Download</strong></span> link. The links to latest stable versions of Maven will be displayed.</li><li class="listitem">The binaries are available in both <code class="literal">.zip</code> and <code class="literal">.tar.gz</code> formats. For Mac OS X and Linux, the preferred download format is <code class="literal">.tar.gz</code>.</li><li class="listitem">Extract the downloaded binary to a folder you want Maven to reside in. The typical location in Linux is the <code class="literal">/usr/local</code> folder.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>You will need a super user (su) or administrator access to place contents in the <code class="literal">/usr/local</code> folder. If you do not have access, you can place this in a subfolder of your <code class="literal">HOME</code> folder.</p></div></div></li><li class="listitem">Execute the following command, and ensure the contents of the <code class="literal">apache-maven-3.2.5</code> folder are similar to the following output:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>/usr/local/apache-maven-3.2.5$ ls -l</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting">total 27
-rw-r--r--    1 root    root    17464 Aug 12 02:29 LICENSE
-rw-r--r--    1 root    root      182 Aug 12 02:29 NOTICE
-rw-r--r--    1 root    root     2508 Aug 12 02:26 README.txt
drwxr-xr-x    8 root    root     4096 Aug 19 13:41 bin
drwxr-xr-x    3 root    root        0 Aug 19 13:41 boot
drwxr-xr-x    4 root    root        0 Oct 14 17:39 conf
<span class="strong"><strong>drwxr-xr-x   67 root    root    28672 Aug 19 13:41 lib</strong></span>
</pre></div></li><li class="listitem">Set the <code class="literal">M2_HOME</code> variable as follows:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export M2_HOME=/usr/local/apache-maven-3.2.5</strong></span>
</pre></div></li><li class="listitem">Update <code class="literal">PATH</code> to include Maven's <code class="literal">bin</code> folder:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export PATH=$PATH:$M2_HOME/bin</strong></span>
</pre></div></li></ol></div><p>Like <code class="literal">JAVA_HOME</code>, the preceding settings can be persisted by updating <code class="literal">.bash_profile</code>.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec26"/>How it works...</h2></div></div></div><p>The Maven <a id="id40" class="indexterm"/>installation is essentially a set of JAR files, configuration<a id="id41" class="indexterm"/> files, and a Linux shell script, namely <code class="literal">mvn</code>.</p><p>The <code class="literal">mvn</code> command essentially runs this script. It first checks for <code class="literal">JAVA_HOME</code>. This file is present in the <code class="literal">bin</code> folder of the Maven installation and hence needs to be in <code class="literal">PATH</code>.</p><p>If the shell script does not find <code class="literal">JAVA_HOME</code>, it looks for <code class="literal">java</code> in its <code class="literal">PATH</code>. This can lead to unexpected results, as typically, the <code class="literal">Java</code> in <code class="literal">PATH</code> is usually JRE and not JDK.</p><p>The shell script then looks for <code class="literal">M2_HOME</code>, which is the location of the Maven installation. It does this so that it can load the libraries that are present.</p><p>Additionally, it also reads values specified in <code class="literal">MAVEN_OPTS</code>. This variable allows you to run Maven with an additional heap size and other Java parameters.</p><p>Using the values for <code class="literal">JAVA_HOME</code>, <code class="literal">M2_HOME</code>, and <code class="literal">MAVEN_OPTS</code>, the shell script runs its <code class="literal">org.codehaus.plexus.classworlds.launcher.Launcher</code> main class.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec27"/>There's more...</h2></div></div></div><p>Using the following steps, let's confirm that Maven has been set up correctly, by running a Maven command:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a command prompt and run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn –version</strong></span>
</pre></div></li><li class="listitem">The following output should be displayed:<div class="informalexample"><pre class="programlisting">Apache Maven 3.2.5 (12a6b3acb947671f09b81f49094c53f426d8cea1; 2014-12-14T22:59:23+05:30)
Maven home: /usr/local/maven
Java version: 1.7.0_65, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.65.x86_64/jre
Default locale: en_US, platform encoding: ANSI_X3.4-1968
<span class="strong"><strong>OS name: "linux", version: "2.6.32-279.22.1.el6.x86_64", arch: "amd64", family: "unix"</strong></span>
</pre></div></li></ol></div><p>If you get an error, recheck <a id="id42" class="indexterm"/>the <a id="id43" class="indexterm"/>installation steps and repeat them.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec28"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple project with Maven</em></span> recipe in this chapter</li></ul></div></div></div>
<div class="section" title="Changing the JDK used by Maven"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Changing the JDK used by Maven</h1></div></div></div><p>It is possible to have more <a id="id44" class="indexterm"/>than one version of JDK installed on your system. By following some simple steps, you can specify and/or change the JDK to be used by Maven.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec29"/>How to do it...</h2></div></div></div><p>You will recall that, in the earlier section, we used Java SE 7. Let us now change to Java SE 8. To change the JDK version to Java SE 8 on Microsoft Windows, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the command prompt, run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_20</strong></span>
</pre></div></li><li class="listitem">For Linux or Mac, the command will be:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>export JAVA_HOME=&lt;java-8-home-folder&gt;</strong></span>
</pre></div></li><li class="listitem">Now, run the following command to check the version of Maven installed:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn –version</strong></span>
</pre></div></li><li class="listitem">To check the version of Maven installed on Microsoft Windows, run the following command from the command prompt. You should get the following output. The output will be similar for Linux and Mac:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\projects\apache-maven-cookbook&gt;mvn -version</strong></span>
</pre></div><p>The output for the preceding command is shown as:</p><div class="informalexample"><pre class="programlisting">Apache Maven 3.2.5 (12a6b3acb947671f09b81f49094c53f426d8cea1; 2014-12-14T22:59:23+05:30)
Maven home: C:\software\apache-maven-3.2.5
Java version: 1.8.0_20, vendor: Oracle Corporation
Java home: C:\Program Files\Java\jdk1.8.0_20\jre
Default locale: en_IN, platform encoding: Cp1252
<span class="strong"><strong>OS name: "windows 8.1", version: "6.3", arch: "amd64", family: "windows"</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec30"/>How it works...</h2></div></div></div><p>Maven always uses the <a id="id45" class="indexterm"/>JDK specified by <code class="literal">JAVA_HOME</code>, no matter how many JDK installations are available on the system. This allows the user the flexibility to change JDKs as required or based on the project.</p><p>Hence, it is important to ensure <code class="literal">JAVA_HOME</code> is defined. In the absence of this variable, Maven attempts to detect the presence of Java from <code class="literal">PATH</code>. This is typically JRE and not JDK.</p></div></div>
<div class="section" title="Creating a simple project with Maven"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Creating a simple project with Maven</h1></div></div></div><p>Now that we have set up <a id="id46" class="indexterm"/>Maven on our favorite operating system and <a id="id47" class="indexterm"/>verified that it works fine, it is time to create a simple Java project.</p><p>Maven makes it easy to bootstrap a new project by creating a bunch of files and folders following accepted conventions.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec31"/>How to do it...</h2></div></div></div><p>Let's start creating the first simple project using Maven, by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open a command prompt and change the directory to the folder in which you want to create your first Maven project.</li><li class="listitem">Run the following command:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn archetype:generate -DgroupId=com.packt.cookbook -DartifactId=simple-project -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false</strong></span>
</pre></div><p>You can change the <code class="literal">groupId</code> and <code class="literal">artifactId</code> values in the preceding command as per your requirement.</p></li><li class="listitem">You will see Maven downloading a bunch of files:<div class="informalexample"><pre class="programlisting">Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom
<span class="strong"><strong>Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom (4 KB at 1.4 KB/sec)</strong></span>
</pre></div></li><li class="listitem">Then it will start generating sources:<div class="informalexample"><pre class="programlisting">[INFO] &gt;&gt;&gt; maven-archetype-plugin:2.2:generate (default-cli) &gt; generate-sources
<span class="strong"><strong>@ standalone-pom &gt;&gt;&gt;</strong></span>
</pre></div></li><li class="listitem">When Maven<a id="id48" class="indexterm"/> has completed generating <a id="id49" class="indexterm"/>sources, it will create the project that we want:<div class="informalexample"><pre class="programlisting">[INFO] Using following parameters for creating project from Old (1.x) Archetype:
maven-archetype-quickstart:1.0
[INFO] ----------------------------------------------------------------------------
[INFO] Parameter: groupId, Value: com.packt.cookbook
[INFO] Parameter: packageName, Value: com.packt.cookbook
[INFO] Parameter: package, Value: com.packt.cookbook
[INFO] Parameter: artifactId, Value: simple-project
[INFO] Parameter: basedir, Value: C:\projects\apache-maven-cookbook
[INFO] Parameter: version, Value: 1.0-SNAPSHOT
<span class="strong"><strong>[INFO] project created from Old (1.x) Archetype in dir: C:\projects\apache-maven-cookbook\simple-project</strong></span>
</pre></div></li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip06"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a> for all the Packt Publishing books you have purchased. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec32"/>How it works...</h2></div></div></div><p>Did you get an while error running the preceding command to create your simple project?</p><p>One possibility is that your Maven is behind an HTTP proxy server. If so, see the <span class="emphasis"><em>Running Maven behind an HTTP proxy server</em></span> recipe in this chapter.</p><p>Let's look at the folder structure that is created:</p><div class="mediaobject"><img src="graphics/6124OS_01_07.jpg" alt="How it works..."/></div><p>You will notice the following things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Maven project configuration file <code class="literal">pom.xml</code> is created in the root of the <code class="literal">simple-project</code> folder. We will explore this file in detail in subsequent sections.</li><li class="listitem" style="list-style-type: disc">A bunch <a id="id50" class="indexterm"/>of folders are created:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">src\main\java</code>: This is for Java source files</li><li class="listitem" style="list-style-type: disc"><code class="literal">src\test\java</code>: This is for Java test source files</li><li class="listitem" style="list-style-type: disc"><code class="literal">src\main\resources</code>: This is for resource files for the project</li><li class="listitem" style="list-style-type: disc"><code class="literal">src\test\resources</code>: This is for resource files for the test</li></ul></div></li><li class="listitem" style="list-style-type: disc">Within each of the preceding folders, a folder structure corresponding to the <code class="literal">groupId</code> (<code class="literal">org.packt.cookbook</code>) is created.</li></ul></div><p>The following are essentially Maven conventions at work:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Maven expects all Java source files to reside <code class="literal">in src\main\java</code></li><li class="listitem" style="list-style-type: disc">Similarly, it expects all Java test files to reside in <code class="literal">src\test\java</code></li><li class="listitem" style="list-style-type: disc">It expects all project resources to reside in <code class="literal">src\main\resources</code> and test resources to reside in <code class="literal">src\test\resources</code></li><li class="listitem" style="list-style-type: disc">It expects that source files will typically have the same package structure as the <code class="literal">groupId</code> parameter (though this is not mandatory)</li><li class="listitem" style="list-style-type: disc">Two sample classes, namely <code class="literal">App.java</code> and <code class="literal">AppTest.java</code>, are also created and it is not expected that they will be used beyond testing how Maven works</li></ul></div><p>The <code class="literal">mvn</code> command that we used in the <span class="emphasis"><em>Creating a simple project with Maven</em></span> recipe in this chapter, tries to invoke the <code class="literal">generate</code> goal of the <code class="literal">archetype</code> plugin with the specified command-line parameters.</p><p>The default Maven<a id="id51" class="indexterm"/> installation has minimal features. All features of <a id="id52" class="indexterm"/>Maven are available as Maven plugins. When given a plugin name, Maven knows where to download it from and then run it.</p><p>In this case, Maven downloads the <code class="literal">archetype</code> plugin. This plugin, in turn, can depend on another plugin. In this case, the latter plugin gets downloaded. This happens in a recursive fashion and, at the end of the process, all the relevant plugins required to run the specified command are downloaded.</p><p>These plugins are placed in your local repository, which is a location in your system. Once downloaded, these are never downloaded again unless deleted.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec33"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Running Maven behind an HTTP proxy server</em></span> recipe in this chapter</li></ul></div></div></div>
<div class="section" title="Building a simple project with Maven"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Building a simple project with Maven</h1></div></div></div><p>Let us now build the <a id="id53" class="indexterm"/>project that was created in the preceding <a id="id54" class="indexterm"/>section.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec34"/>How to do it...</h2></div></div></div><p>To build the previously created simple project with Maven, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the command prompt and run the following command, changing the directory to the folder the project was created:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong>mvn package</strong></span>
</pre></div></li><li class="listitem">Observe the following things in the output:<p>Notice the following warning (we will see how to resolve this later in this book):</p><div class="informalexample"><pre class="programlisting">[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ simple-project ---
<span class="strong"><strong>[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources,</strong></span>
<span class="strong"><strong>i.e. build is platform dependent!</strong></span>
</pre></div><p>Check if the sources are compiled:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ simple-project</strong></span>
</pre></div><p>Check if the tests are run:</p><div class="informalexample"><pre class="programlisting">[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ simple-project ---
[INFO] Surefire report directory: C:\projects\apache-maven-cookbook\simple-project\target\surefire-reports
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.packt.cookbook.AppTest
<span class="strong"><strong>Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec</strong></span>
</pre></div></li><li class="listitem">A JAR file is now created.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec35"/>How it works...</h2></div></div></div><p>In the <code class="literal">mvn package</code> command, the <code class="literal">package</code> parameter is a phase in the build lifecycle. Maven has a default <a id="id55" class="indexterm"/>build lifecycle that has a number of phases. Each<a id="id56" class="indexterm"/> phase will execute every phase prior to it in order along with the specified phase. In this case, the <code class="literal">package</code> phase executes in the following order:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Validate</li><li class="listitem" style="list-style-type: disc">Compile</li><li class="listitem" style="list-style-type: disc">Test</li><li class="listitem" style="list-style-type: disc">Package</li></ul></div><p>The <code class="literal">validate</code> phase <a id="id57" class="indexterm"/>makes sure that the project (specifically the <code class="literal">pom.xml</code> file that describes the project) is in order and all the necessary information to run the project is available.</p><p>The <code class="literal">compile</code> phase<a id="id58" class="indexterm"/> compiles the sources.</p><p>The <code class="literal">test</code> phase<a id="id59" class="indexterm"/> compiles the <a id="id60" class="indexterm"/>test sources and then runs the test using a <a id="id61" class="indexterm"/>suitable test framework. In the earlier example, the <span class="strong"><strong>JUnit</strong></span><a id="id62" class="indexterm"/> framework is used to run the tests.</p><p>The <code class="literal">package</code> phase packages <a id="id63" class="indexterm"/>the artifacts to the format specified in the <code class="literal">pom.xml</code> file.</p></div></div>
<div class="section" title="Changing the location of the Maven repository"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Changing the location of the Maven repository</h1></div></div></div><p>There are three types of Maven repositories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Local</strong></span>: This is the<a id="id64" class="indexterm"/> repository in your computer filesystem</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Remote</strong></span>: This is the<a id="id65" class="indexterm"/> repository from where the required Maven files get downloaded</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mirrors</strong></span>: These are <a id="id66" class="indexterm"/>repository managers, such as <span class="strong"><strong>Nexus</strong></span><a id="id67" class="indexterm"/> and <a id="id68" class="indexterm"/><span class="strong"><strong>Artifactory</strong></span>, that mirror various repositories</li></ul></div><p>You will have seen <a id="id69" class="indexterm"/>Maven downloading a number of <a id="id70" class="indexterm"/>files (called poms and jars). Let us see where they are located in your computer:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Go to your <code class="literal">HOME</code> folder (<code class="literal">C:\Users\username</code>) in the case of Microsoft Windows, <code class="literal">/Users/username</code> for Mac, and, <code class="literal">/home/username</code> (or a similar location) for Linux</li><li class="listitem" style="list-style-type: disc">You will notice the <code class="literal">.m2</code> folder and within that, a subfolder called <code class="literal">repository</code><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip07"/>Tip</h3><p>Any folder that starts with a dot (<code class="literal">.</code>) is typically hidden from view. You will need to change your folder viewer settings to see it.</p></div></div></li><li class="listitem" style="list-style-type: disc">You will see a number of folders and files that are used by Maven</li></ul></div><p>You may want to change this location for the following reasons:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You may want to conserve space in the <code class="literal">C</code> drive and store these folders and files in the <code class="literal">D</code> drive on Microsoft Windows.</li><li class="listitem" style="list-style-type: disc">You may want to take a back up of the contents. Backup software usually backs up contents in specific folders of the filesystem.</li><li class="listitem" style="list-style-type: disc">Your organization may have a policy for all users to store a local repository in the same folder.</li></ul></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec36"/>How to do it...</h2></div></div></div><p>To change the location of the Maven repository, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a file called <code class="literal">settings.xml</code> in the <code class="literal">.m2</code> folder.</li><li class="listitem">Add the following contents to the settings.xml file that you just created:<div class="informalexample"><pre class="programlisting">&lt;settings 
  
 xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
                      http://maven.apache.org/xsd/settings-1.0.0.xsd"&gt;
    <span class="strong"><strong>&lt;localRepository&gt;C:/software/maven&lt;/localRepository&gt;</strong></span>
&lt;/settings&gt;</pre></div><p>Notice the highlighted part of the preceding code. We have changed the location of the repository contents to C:\software\maven. You can change it to any valid folder name.</p></li><li class="listitem">Delete the <code class="literal">repository</code> subfolder and run the <code class="literal">mvn package</code> command again.<p>You will now notice that the <code class="literal">repository</code> folder is not created in the <code class="literal">.m2</code> folder. Instead, it is created in <code class="literal">C:\software\maven</code>.</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec37"/>How it works...</h2></div></div></div><p>Maven determines<a id="id71" class="indexterm"/> the location of the local repository in the following <a id="id72" class="indexterm"/>way:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If <code class="literal">settings.xml</code> exists in the user's <code class="literal">.m2</code> folder, which contains the <code class="literal">&lt;localRepository&gt;</code> tag, then Maven uses its contents to determine the location</li><li class="listitem" style="list-style-type: disc">If not, Maven will check if <code class="literal">localRepository</code> is explicitly defined in the default <code class="literal">settings.xml</code>, present in the <code class="literal">conf</code> folder of the Maven installation</li><li class="listitem" style="list-style-type: disc">If it is not present there, Maven will use the default value for the local repository, which is the user's <code class="literal">.m2</code> folder</li></ul></div></div></div>
<div class="section" title="Running Maven behind an HTTP proxy server"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Running Maven behind an HTTP proxy server</h1></div></div></div><p>Most organizations do not<a id="id73" class="indexterm"/> allow devices in their network to<a id="id74" class="indexterm"/> access the Internet directly for security and other reasons. In such cases, typically, a proxy server comes into picture. The proxy server details are specified in the browser or any other location where access to the Internet is required.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec38"/>How to do it...</h2></div></div></div><p>Let's start running Maven behind an HTTP proxy server, by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a <code class="literal">settings.xml</code> file in the <code class="literal">.m2</code> folder in your <code class="literal">HOME</code> directory, if it does not exist already.</li><li class="listitem">Add the following code within the <code class="literal">settings</code> tag:<div class="informalexample"><pre class="programlisting">  &lt;proxies&gt;
    &lt;proxy&gt;
      &lt;id&gt;myproxy&lt;/id&gt;
      &lt;active&gt;true&lt;/active&gt;
      &lt;protocol&gt;http&lt;/protocol&gt;
      &lt;host&gt;proxy.myorg.com&lt;/host&gt;
      &lt;port&gt;8080&lt;/port&gt;
      &lt;username&gt;proxyuser&lt;/username&gt;
      &lt;password&gt;somepassword&lt;/password&gt;
      &lt;nonProxyHosts&gt;*.myorg.com &lt;/nonProxyHosts&gt;
    &lt;/proxy&gt;
  &lt;/proxies&gt;</pre></div></li></ol></div><p>If the proxy server does not need authentication, the <code class="literal">username</code> and <code class="literal">password</code> tags can be omitted.</p><p>The <code class="literal">nonProxyHosts</code> tag allows you to specify locations that can be accessed directly (for instance, your intranet). This can be skipped if not relevant.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec39"/>How it works...</h2></div></div></div><p>Maven needs Internet access to download plugins and dependencies. When Maven runs, it reads the user's <code class="literal">settings.xml</code> file, if it exists. It checks for any active proxy settings and applies the same.</p><p>Maven uses the values in the proxy settings to download any artifacts from the repository. If there are no artifacts to be downloaded, then these values are not used.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>The<a id="id75" class="indexterm"/> HTTP proxy server may work <a id="id76" class="indexterm"/>only in your organization's network. If you are running Maven from a different network, you may want to turn off the HTTP proxy server. This can be done by setting the <code class="literal">active</code> tag to <code class="literal">false</code> in the preceding code.</p></div></div></div></div>
<div class="section" title="Understanding the standard directory layout"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Understanding the standard directory layout</h1></div></div></div><p>When we built our sample Java<a id="id77" class="indexterm"/> project earlier, we saw files being compiled, tests being run, and a JAR being generated. We do not know where these artifacts were created.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec40"/>How to do it...</h2></div></div></div><p>Let's find where the artifacts were created by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to the folder that has the sample Maven project.</li><li class="listitem">Open the <code class="literal">target</code> subfolder that was created:<div class="mediaobject"><img src="graphics/6124OS_01_08.jpg" alt="How to do it..."/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec41"/>How it works...</h2></div></div></div><p>When Maven runs, it puts all the contents that it generates into a separate folder. This is to distinguish it from any user-generated content. Let us examine the contents of this folder:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">classes</code> folder: Compiled source files are placed in this folder. This folder will also contain resources, such as XML and property files that are part of the source, placed in <code class="literal">src/main/resources</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">test-classes</code> folder: Compiled test source files are available in this folder. In addition, it also contains test resources, which are files required for the purpose of testing, but not for running the project.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">surefire-reports</code> folder: Test reports are separately placed in this folder. Typically, both XML and HTML report formats are available. The latter can be opened in the browser, while the former can be integrated with a code coverage tool.</li><li class="listitem" style="list-style-type: disc">The <a id="id78" class="indexterm"/>output <code class="literal">.jar</code> file: The generated project artifact is also present in this folder.</li><li class="listitem" style="list-style-type: disc">Two other folders—<code class="literal">maven-archiver</code> and <code class="literal">maven-status</code>—hold information used by Maven during the build.</li></ul></div></div></div></body></html>