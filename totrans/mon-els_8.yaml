- en: Chapter 8. Looking Forward
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This final chapter discusses the next major release of Elasticsearch, version
    5.0, which is a significant upgrade over 2.3.2\. It introduces a number of API
    enhancements, in addition to several performance and reliability updates. Many
    of these changes will, for better or for worse, affect your interaction with and
    monitoring of an Elasticsearch cluster.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: 'The specific topics we''ll discuss in this chapter include:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Elasticsearch 5 overview
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Upgrading to Elasticsearch 5
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitoring Elasticsearch 5
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Elasticsearch 5 overview
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Elasticsearch 5 will follow Elasticsearch 2 as the next major software release.
    Although this may be chronologically jarring, Elastic.co purposefully jumped from
    version 2 to 5 to better synchronize the updated version of Elasticsearch with
    several other Elastic.co products, including Kibana, Logstash, Marvel (called
    **Monitoring** in 5.0), and more. This update will help ensure that all Elastic.co
    software running on a cluster is both compatible and up-to-date.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: 'There are hundreds of new changes being introduced in version 5, but a few
    relevant highlights include:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: Compatibility between the Elasticsearch 2 API and Elasticsearch 5
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Indices from Elasticsearch 2 can be migrated to version 5:'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Indices from Elasticsearch 1 must first be migrated to version 2 before migrating
    them to version 5
  id: totrans-11
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Marvel is renamed Monitoring
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Elasticsearch-Logstash-Kibana stack is renamed the **Elastic Stack**
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The plugin API no longer supports site plugins, including plugins such as Elasticsearch-head,
    Bigdesk, and Kopf
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The warmers API is removed in favor of eager field data loading and disk-based
    norms
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lucene version upgraded from 5 to 6
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Several configuration changes, including removal of all system environment variables,
    such as `ES_HEAP`, in favor of Java VM command-line arguments
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`text` and `keyword` mapping types deprecated in favor of `string` type'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`bin/plugin` renamed to `bin/elasticsearch-plugin`'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Elasticsearch-head, Bigdesk, and Kopf have not yet been updated to be compatible
    with Elasticsearch 5\. When they are upgraded, they will run as standalone applications,
    similar to Kibana.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: Performance and reliability
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Elasticsearch 5 introduces several performance and reliability improvements,
    including:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: Indexing performance improved 15-20% for small documents
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lucene 6 improves search time by 25% and decreases disk space usage by 50% for
    numeric, date, and geospatial fields
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `elasticsearch.yml` settings file is now strictly validated, meaning Elasticsearch
    won't start if there is a configuration error
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If a production node (meaning a node that isn't bound to the `localhost` address)
    doesn't have enough file handles available, or doesn't have permission to lock
    the system's memory usage via the `mlockall` setting, it will throw an exception
    and won't start
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data loss
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Elasticsearch 2 has a well-publicized, ongoing issue in which, in rare circumstances
    involving networking problems and a network partition, Elasticsearch can drop
    data during ingestion.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: 'Writes made to Elasticsearch during the network partition will be confirmed,
    but not all will actually make it to the index. The Elasticsearch team has made
    a strong effort to address this problem, and many—but not all—instances of the
    bug are fixed in the new version. In consideration of this, contemplate the following
    when building an Elasticsearch-backed application in both version 2 and version
    5:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: Don't use Elasticsearch as a primary data store. Instead, use a database such
    as HBase, Cassandra, PostgreSQL, or another, depending on your data size and requirements.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Be sure to verify that the number of data records in your primary data store
    match those in Elasticsearch.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Have a plan to re-index data in the event of data loss.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While data loss is *very* unlikely, the potential impact is huge and it is important
    to have a plan of action in place.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Upgrading to Elasticsearch 5.0
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Elasticsearch 5 version will be released soon. It''s a good idea to start testing
    your cluster''s compatibility with the new version. To help with the upgrade process,
    Elastic.co offers a tool called the **Elasticsearch Migration Helper**. Install
    this tool as an Elasticsearch 2.3 plugin:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Note
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The Elasticsearch Migration Helper is only compatible with Elasticsearch 2.3.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: 'After installing the plugin, open it in the browser by visiting `http://elasticsearch-node-01:9200/_plugin/elasticsearch-migration/`,
    as seen in the following screenshot:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '![Upgrading to Elasticsearch 5.0](img/B03798_08_01.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
- en: Elasticsearch Migration Helper
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Cluster Checkup** diagnostic will display a report of the necessary updates
    before using Elasticsearch 5:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: '![Upgrading to Elasticsearch 5.0](img/B03798_08_02.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
- en: Elasticsearch Migration Helper configuration check report
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: The **Cluster Checkup** shows us that we'll have to remove some incompatible
    plugins before moving to Elasticsearch 5, including Elasticsearch-head, Kopf,
    and the Marvel Agent. We'll also have to update a few system and node configuration
    settings before upgrading.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: After fixing all of these configuration issues, we can use the Elasticsearch
    Migration Helper to enable the deprecation log. This log file records anytime
    we call an Elasticsearch API method that will be deprecated or removed in version
    5\.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows how to enable the deprecation log from the Elasticsearch
    Migration Helper:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: '![Upgrading to Elasticsearch 5.0](img/B03798_08_03.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
- en: Click the Enable/Disable link to activate the deprecation log
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the log is enabled, it can be found at:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: When to upgrade
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: After running the Elasticsearch Migration Helper and correcting all relevant
    errors and warnings, it's safe to upgrade to Elasticsearch 5 in a development
    environment. You can now test the application to ensure that everything works
    with the new version. Pay close attention to the deprecation log and note things
    that you'll need to fix.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: Since this is such a major release, it may be worth delaying your production
    upgrade until a few months after the General Availability release. As with any
    new piece of software, there may be bugs with early versions of Elasticsearch
    5 that will be fixed shortly after it is made generally available.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: Monitoring Elasticsearch 5
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Elastic.co rebranded its suite of monitoring tools, including the Elasticsearch-Logstash-Kibana
    (ELK) stack, in Elasticsearch 5\. Marvel is now renamed **Monitoring** and comes
    bundled with some additional monitoring tools. The ELK stack is now just the **Elastic
    Stack**.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: 'The Elasticsearch X-Pack is a premium suite of monitoring tools that Elastic.co
    charges an annual fee for running in production. The X-Pack consists of the following
    tools:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: '**Monitoring**: Previously Marvel'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Shield**: Adds authentication, access control, and HTTPS support to Elasticsearch'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Watcher**: Similar to Nagios, but with some Elasticsearch-specific features,
    such as sending email alerts if a query runs slow'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Graph**: Network-graph data visualization tool'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Reporting**: Generates PDF reports based on data in Kibana'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Kibana and Marvel also received an updated look and feel, as seen in the following
    screenshots:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '![Monitoring Elasticsearch 5](img/B03798_08_04.jpg)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
- en: Kibana updated look and feel
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: '![Monitoring Elasticsearch 5](img/B03798_08_05.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
- en: Marvel is now Monitoring with an updated look and feel
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This chapter examined the upcoming Elasticsearch 5 release, discussed upgrading
    to version 5, and touched on the new monitoring tools available in the Elasticsearch
    X-Pack. Some takeaways from this chapter include:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: Elasticsearch 5 has some big performance and reliability gains, but also some
    breaking changes to the API.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Elasticsearch-head, Bigdesk, and Kopf are not yet compatible with Elasticsearch
    5.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Elasticsearch 5 is a major release, and upgrading from version 2 may not be
    a simple process. Be sure to run the Elasticsearch Migration Helper before upgrading.
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Elasticsearch X-Pack provides a suite of monitoring tools for Elasticsearch
    5, but isn't free.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thanks for reading *Monitoring Elasticsearch*. I hope you learned some new techniques
    for monitoring and troubleshooting an Elasticsearch cluster. If you take only
    one thing away from reading this book, I hope it is to be meticulous and to test
    at every step of the way when troubleshooting issues that pop up when working
    with Elasticsearch.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: If you feel like giving back to the Elasticsearch community, please consider
    making contributions to the Elasticsearch-head, Bigdesk, or Kopf projects. These
    are all excellent open source tools that make the lives of everyone working with
    Elasticsearch easier. And, as mentioned in this chapter, they all need to be re-architected
    and updated to work with Elasticsearch 5.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你愿意回馈Elasticsearch社区，请考虑为Elasticsearch-head、Bigdesk或Kopf项目做出贡献。这些都是优秀的开源工具，让使用Elasticsearch的每个人的生活变得更轻松。正如本章所述，它们都需要重新架构和更新以与Elasticsearch
    5兼容。
- en: Note
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'You can read more about the following topics here:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在这里了解更多关于以下主题的信息：
- en: 'Elasticsearch-head: [https://github.com/mobz/elasticsearch-head](https://github.com/mobz/elasticsearch-head)'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Elasticsearch-head: [https://github.com/mobz/elasticsearch-head](https://github.com/mobz/elasticsearch-head)'
- en: 'Bigdesk: [https://github.com/lukas-vlcek/bigdesk](https://github.com/lukas-vlcek/bigdesk)'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Bigdesk: [https://github.com/lukas-vlcek/bigdesk](https://github.com/lukas-vlcek/bigdesk)'
- en: 'Kopf: [https://github.com/lmenezes/elasticsearch-kopf](https://github.com/lmenezes/elasticsearch-kopf)'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Kopf: [https://github.com/lmenezes/elasticsearch-kopf](https://github.com/lmenezes/elasticsearch-kopf)'
- en: 'Also, feel free to reach out to me on Twitter: `@dwnoble`.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你也可以在Twitter上联系我：`@dwnoble`。
