<html><head></head><body>
<div id="_idContainer013">
<h1 class="chapter-number" id="_idParaDest-36"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-37"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.2.1">Jakarta RESTful Web Services</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.3.1">Representational State Transfer</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.5.1">REST</span></strong><span class="koboSpan" id="kobo.6.1">) is </span><a id="_idIndexMarker078"/><span class="koboSpan" id="kobo.7.1">an architectural style in which web services are viewed as resources and can be identified</span><a id="_idIndexMarker079"/><span class="koboSpan" id="kobo.8.1"> by </span><strong class="bold"><span class="koboSpan" id="kobo.9.1">Uniform Resource </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.10.1">Identifiers </span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">(</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.12.1">URIs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.14.1">Web services developed using the REST styles are known as RESTful web services. </span><span class="koboSpan" id="kobo.14.2">We can develop</span><a id="_idIndexMarker080"/><span class="koboSpan" id="kobo.15.1"> RESTful web services in Jakarta EE via the </span><strong class="bold"><span class="koboSpan" id="kobo.16.1">Jakarta RESTful Web Services API</span></strong><span class="koboSpan" id="kobo.17.1">, commonly</span><a id="_idIndexMarker081"/><span class="koboSpan" id="kobo.18.1"> known as </span><strong class="bold"><span class="koboSpan" id="kobo.19.1">Jakarta REST</span></strong><span class="koboSpan" id="kobo.20.1">. </span><span class="koboSpan" id="kobo.20.2">In this chapter, we will cover how to develop RESTful web services using </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">Jakarta REST.</span></span></p>
<p><span class="koboSpan" id="kobo.22.1">The following topics will be covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.24.1">Introduction to RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">web services</span></span></li>
<li><span class="koboSpan" id="kobo.26.1">Developing a simple RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">web service</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">Developing a RESTful web </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">service client</span></span></li>
<li><span class="koboSpan" id="kobo.30.1">Seamlessly converting between Java </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">and JSON</span></span></li>
<li><span class="koboSpan" id="kobo.32.1">Query and </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">path parameters</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.34.1">Server-sent events</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.35.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.36.1">Code samples for this chapter can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">at </span></span><a href="https://github.com/PacktPublishing/Jakarta-EE-Application-Development/tree/main/ch03_src"><span class="No-Break"><span class="koboSpan" id="kobo.38.1">https://github.com/PacktPublishing/Jakarta-EE-Application-Development/tree/main/ch03_src</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.39.1">.</span></span></p>
<h1 id="_idParaDest-38"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.40.1">Introduction to RESTful web services</span></h1>
<p><span class="koboSpan" id="kobo.41.1">RESTful web services </span><a id="_idIndexMarker082"/><span class="koboSpan" id="kobo.42.1">are very flexible. </span><span class="koboSpan" id="kobo.42.2">RESTful web services can consume several types of different MIME types, although they are typically written to consume and/or produce data</span><a id="_idIndexMarker083"/><span class="koboSpan" id="kobo.43.1"> in </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">JavaScript Object Notation</span></strong><span class="koboSpan" id="kobo.45.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.46.1">JSON</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">) format.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.48.1">MIME types</span></p>
<p class="callout"><span class="koboSpan" id="kobo.49.1">MIME stands for Multipurpose Internet Mail Extensions; it is used to indicate the data type that is consumed or produced by RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">web services.</span></span></p>
<p><span class="koboSpan" id="kobo.51.1">Web services must support one or more of the following six </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">HTTP methods:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.53.1">GET</span></strong><span class="koboSpan" id="kobo.54.1"> – By </span><a id="_idIndexMarker084"/><span class="koboSpan" id="kobo.55.1">convention, a GET request is used to retrieve an </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">existing resource</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.57.1">POST</span></strong><span class="koboSpan" id="kobo.58.1"> – By </span><a id="_idIndexMarker085"/><span class="koboSpan" id="kobo.59.1">convention, a POST request is used to update an </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">existing resource</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.61.1">PUT</span></strong><span class="koboSpan" id="kobo.62.1"> – By </span><a id="_idIndexMarker086"/><span class="koboSpan" id="kobo.63.1">convention, a PUT request is used to create or replace a </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">new resource</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.65.1">DELETE</span></strong><span class="koboSpan" id="kobo.66.1"> – By </span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.67.1">convention, a DELETE request is used to delete an </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">existing resource</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.69.1">HEAD</span></strong><span class="koboSpan" id="kobo.70.1"> – By </span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.71.1">convention, a HEAD request returns an HTTP header with </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">no body</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.73.1">PATCH</span></strong><span class="koboSpan" id="kobo.74.1"> – By </span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.75.1">convention, a PATCH request is used for partial </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">resource modification</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.77.1">We develop a RESTful web service with Jakarta REST by creating a class with annotated methods that are invoked when our web service receives one of the preceding HTTP request methods. </span><span class="koboSpan" id="kobo.77.2">Once we have developed and deployed our RESTful web service, we need to develop a client that will send requests to our service. </span><span class="koboSpan" id="kobo.77.3">Frontend web technologies are frequently used to develop RESTful web service clients. </span><span class="koboSpan" id="kobo.77.4">However, Jakarta REST includes a standard client-side API that we can use to develop RESTful web service clients </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">in Java.</span></span></p>
<h1 id="_idParaDest-39"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.79.1">Developing a simple RESTful web service</span></h1>
<p><span class="koboSpan" id="kobo.80.1">In this section, we will develop a simple web service to illustrate how we can make methods </span><a id="_idIndexMarker090"/><span class="koboSpan" id="kobo.81.1">in our service respond to the different HTTP </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">request methods.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">Developing a RESTful web service using Jakarta REST is simple and straightforward. </span><span class="koboSpan" id="kobo.83.2">Each of our RESTful web services needs to be </span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.84.1">invoked via its </span><strong class="bold"><span class="koboSpan" id="kobo.85.1">Unique Resource Identifier</span></strong><span class="koboSpan" id="kobo.86.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.87.1">URI</span></strong><span class="koboSpan" id="kobo.88.1">). </span><span class="koboSpan" id="kobo.88.2">Our RESTful web service URI is specified by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">@Path</span></strong><span class="koboSpan" id="kobo.90.1"> annotation, which we need to use to decorate our RESTful web service </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">resource class.</span></span></p>
<p><span class="koboSpan" id="kobo.92.1">When developing RESTful web services, we need to develop methods that will be invoked when our web service receives an HTTP request. </span><span class="koboSpan" id="kobo.92.2">We need to implement methods to handle one or more of the six types of requests that RESTful web services handle – GET, POST, PUT, DELETE, HEAD </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">and/or PATCH.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.94.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.95.1">We will only cover the most frequently used HTTP request types as implementing all HTTP request types is </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">very similar.</span></span></p>
<p><span class="koboSpan" id="kobo.97.1">Jakarta REST provides annotations that we can use to decorate methods in our web service. </span><span class="koboSpan" id="kobo.97.2">For example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">@GET</span></strong><span class="koboSpan" id="kobo.99.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.100.1">@POST</span></strong><span class="koboSpan" id="kobo.101.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.102.1">@PUT</span></strong><span class="koboSpan" id="kobo.103.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">@DELETE</span></strong><span class="koboSpan" id="kobo.105.1"> are used to implement the corresponding HTTP methods. </span><span class="koboSpan" id="kobo.105.2">Decorating a method in our web service with one of these annotations will make it respond to the corresponding HTTP </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">method request.</span></span></p>
<p><span class="koboSpan" id="kobo.107.1">Additionally, each method in our service must produce and/or consume a specific MIME type. </span><span class="koboSpan" id="kobo.107.2">The MIME type to be produced needs to be specified with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.108.1">@Produces</span></strong><span class="koboSpan" id="kobo.109.1"> annotation. </span><span class="koboSpan" id="kobo.109.2">Similarly, the MIME type to be consumed must be specified with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.110.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.111.1">Consumes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.112.1"> annotation.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">The following example illustrates the concepts we have </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">just explained:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.115.1">
package com.ensode.jakartaeebook.jakartarestintro.service;
//imports omitted for brevity
</span><strong class="bold"><span class="koboSpan" id="kobo.116.1">@Path("customer")</span></strong><span class="koboSpan" id="kobo.117.1">
public class CustomerResource {
  private static final Logger LOG =
      Logger.getLogger(CustomerResource.class.getName());
  </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">@GET</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.119.1">  @Produces(MediaType.APPLICATION_JSON)</span></strong><span class="koboSpan" id="kobo.120.1">
  public String getCustomer() {
    LOG.log(Level.INFO, "{0}.getCustomer() invoked",
        this.getClass().getCanonicalName());
    return """
              {
                "customer": {
                  "id": 123,
                  "firstName": "Joseph",
                  "middleName": "William",
                  "lastName": "Graystone"
                }
              }
              """;
  }
  </span><strong class="bold"><span class="koboSpan" id="kobo.121.1">@PUT</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.122.1">  @Consumes(MediaType.APPLICATION_JSON)</span></strong><span class="koboSpan" id="kobo.123.1">
  public void createCustomer(String customerJson) {
    LOG.log(Level.INFO, "{0}.createCustomer() invoked",
        this.getClass().getCanonicalName());
    LOG.log(Level.INFO, "customerJson = {0}", customerJson);
  }
  </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">@POST</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.125.1">  @Consumes(MediaType.APPLICATION_JSON)</span></strong><span class="koboSpan" id="kobo.126.1">
  public void updateCustomer(String customerJson) {
    LOG.log(Level.INFO, "{0}.updateCustomer() invoked",
      this.getClass().getCanonicalName());
    LOG.log(Level.INFO, "customerJson = {0}", customerJson);
  }
}</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.127.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.128.1">Please note that this example does not </span><em class="italic"><span class="koboSpan" id="kobo.129.1">really</span></em><span class="koboSpan" id="kobo.130.1"> do anything. </span><span class="koboSpan" id="kobo.130.2">The purpose of the example is to illustrate how to make different methods in our RESTful web service resource class respond to the different </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">HTTP methods.</span></span></p>
<p><span class="koboSpan" id="kobo.132.1">Notice </span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.133.1">that this class is annotated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">@Path</span></strong><span class="koboSpan" id="kobo.135.1"> annotation. </span><span class="koboSpan" id="kobo.135.2">This annotation designates the URI for our RESTful web service. </span><span class="koboSpan" id="kobo.135.3">The complete URI for our service will include the protocol, server name, port, context root, the REST resources path (see the next sub-section), and the value passed to </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">this annotation.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">Assuming our web service was deployed to a server called </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">example.com</span></strong><span class="koboSpan" id="kobo.139.1">, using the HTTP protocol on port </span><strong class="source-inline"><span class="koboSpan" id="kobo.140.1">8080</span></strong><span class="koboSpan" id="kobo.141.1">, and has a context root of </span><strong class="source-inline"><span class="koboSpan" id="kobo.142.1">jakartarestintro</span></strong><span class="koboSpan" id="kobo.143.1"> and a REST resources path of </span><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">resources</span></strong><span class="koboSpan" id="kobo.145.1">, then the complete URI for our service would be </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.147.1">
http://example.com:8080/jakartarestintro/resources/customer</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.148.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.149.1">Since web browsers generate a GET request when pointed to a URL, we can test the GET method of our service simply by pointing the browser to our </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">service’s URI.</span></span></p>
<p><span class="koboSpan" id="kobo.151.1">Notice</span><a id="_idIndexMarker093"/><span class="koboSpan" id="kobo.152.1"> that each of the methods in our class is annotated with one of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">@GET</span></strong><span class="koboSpan" id="kobo.154.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">@POST</span></strong><span class="koboSpan" id="kobo.156.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">@PUT</span></strong><span class="koboSpan" id="kobo.158.1"> annotations. </span><span class="koboSpan" id="kobo.158.2">These annotations make our methods respond to the corresponding </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">HTTP method.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.160.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.161.1">HTTP DELETE requests typically require a parameter. </span><span class="koboSpan" id="kobo.161.2">We will cover them in the </span><em class="italic"><span class="koboSpan" id="kobo.162.1">Path and query parameters</span></em><span class="koboSpan" id="kobo.163.1"> section later in </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">the chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.165.1">Additionally, if our method returns data to the client, we declare the MIME type of the data to be returned in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">@Produces</span></strong><span class="koboSpan" id="kobo.167.1"> annotation. </span><span class="koboSpan" id="kobo.167.2">In our example, only the </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.169.1"> method returns data to the client. </span><span class="koboSpan" id="kobo.169.2">We wish to return data in JSON format; therefore, we set the value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">@Produces</span></strong><span class="koboSpan" id="kobo.171.1"> annotation to the Jakarta REST-provided </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">MediaType.APPLICATION_JSON</span></strong><span class="koboSpan" id="kobo.173.1"> constant, which has a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">"application/json"</span></strong><span class="koboSpan" id="kobo.175.1">. </span><span class="koboSpan" id="kobo.175.2">Similarly, if our method needs to consume data from the client, we need to specify the MIME type of the data to be consumed; this is done via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">@Consumes</span></strong><span class="koboSpan" id="kobo.177.1"> annotation. </span><span class="koboSpan" id="kobo.177.2">All methods except </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.179.1"> in our service consume data. </span><span class="koboSpan" id="kobo.179.2">In all cases, we expect the data to be in JSON format; therefore, we again specify </span><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">MediaType.APPLICATION_JSON</span></strong><span class="koboSpan" id="kobo.181.1"> as the MIME type to </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">be consumed.</span></span></p>
<p><span class="koboSpan" id="kobo.183.1">Before moving on, it is worth mentioning that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">@Path</span></strong><span class="koboSpan" id="kobo.185.1"> annotation can be used both at the class level and at the method level. </span><span class="koboSpan" id="kobo.185.2">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">@Path</span></strong><span class="koboSpan" id="kobo.187.1"> annotation at the method level allows us to write multiple methods that handle the same HTTP request type in a single RESTful web service. </span><span class="koboSpan" id="kobo.187.2">For example, if we needed a second method in our example RESTful web service, we would simply add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">@Path</span></strong><span class="koboSpan" id="kobo.189.1"> annotation </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">to it:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.191.1">
  @GET
  @Produces(MediaType.TEXT_PLAIN)
  </span><strong class="bold"><span class="koboSpan" id="kobo.192.1">@Path("customername")</span></strong><span class="koboSpan" id="kobo.193.1">
  public String getCustomerName() {
    return "Joseph Graystone";
  }</span></pre> <p><span class="koboSpan" id="kobo.194.1">The URI </span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.195.1">of this particular endpoint would be the value we used in our method-level </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">@Path</span></strong><span class="koboSpan" id="kobo.197.1"> annotation, appended to the URI of our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">web service.</span></span></p>
<p><span class="koboSpan" id="kobo.199.1">In our example, the URI of our RESTful web service would be something like  </span><a href="http://localhost:8080/jakartarestintro/resources/customer/"><span class="koboSpan" id="kobo.200.1">http://localhost:8080/jakartarestintro/resources/customer/</span></a><span class="koboSpan" id="kobo.201.1">, assuming we deployed to our local workstation and the server is listening on </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">port </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">8080</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.205.1">The URI for the endpoint with the method-level annotation would then be </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">curl</span></strong><span class="koboSpan" id="kobo.207.1"> http://localhost:8080/jakartarestintro/resources/customer/customername. </span><span class="koboSpan" id="kobo.207.2">Notice that the value of the method-level </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">@Path</span></strong><span class="koboSpan" id="kobo.209.1"> annotation was appended to the “root” URI of our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">web service.</span></span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.211.1">Configuring the REST resources path for our application</span></h2>
<p><span class="koboSpan" id="kobo.212.1">As briefly </span><a id="_idIndexMarker095"/><span class="koboSpan" id="kobo.213.1">mentioned in the previous section, before successfully deploying a RESTful web service developed using Jakarta REST, we need to configure the REST resources path for our application. </span><span class="koboSpan" id="kobo.213.2">We can do this by developing a class that extends </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">jakarta.ws.rs.core.Application</span></strong><span class="koboSpan" id="kobo.215.1"> and decorating it with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.217.1">ApplicationPath</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.218.1"> annotation.</span></span></p>
<h3><span class="koboSpan" id="kobo.219.1">Configuring via the @ApplicationPath annotation</span></h3>
<p><span class="koboSpan" id="kobo.220.1">To configure </span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.221.1">our REST resources path, all we need to do is write a class that extends </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">jakarta.ws.rs.core.Application</span></strong><span class="koboSpan" id="kobo.223.1">, and decorate it with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">@ApplicationPath</span></strong><span class="koboSpan" id="kobo.225.1"> annotation; the value passed to this annotation is the REST resources path for </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">our services.</span></span></p>
<p><span class="koboSpan" id="kobo.227.1">The </span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.228.1">following code sample illustrates </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">this process:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.230.1">
package com.ensode.jakartaeebook.jakartarestintro.service.config;
//imports omitted for brevity
</span><strong class="bold"><span class="koboSpan" id="kobo.231.1">@ApplicationPath("resources")</span></strong><span class="koboSpan" id="kobo.232.1">
public class JakartaRestConfig extends Application {
}</span></pre> <p><span class="koboSpan" id="kobo.233.1">Notice that the class does not have to implement any methods. </span><span class="koboSpan" id="kobo.233.2">It simply needs to extend </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">jakarta.ws.rs.Application</span></strong><span class="koboSpan" id="kobo.235.1"> and be annotated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">@ApplicationPath</span></strong><span class="koboSpan" id="kobo.237.1"> annotation. </span><span class="koboSpan" id="kobo.237.2">The class must be public, may have any name, and may be placed in </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">any package.</span></span></p>
<h3><span class="koboSpan" id="kobo.239.1">Testing our web service</span></h3>
<p><span class="koboSpan" id="kobo.240.1">As we </span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.241.1">mentioned earlier, web browsers send a GET request to any URLs we point them to. </span><span class="koboSpan" id="kobo.241.2">Therefore, the easiest way to test GET requests to our service is to simply point the browser to our service’s URI, as illustrated in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.242.1">Figure 3</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.243.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer012">
<span class="koboSpan" id="kobo.245.1"><img alt="Figure ﻿3.1 – HTTP GET request from a web browser" src="image/B21231_3.1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.246.1">Figure 3.1 – HTTP GET request from a web browser</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.247.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.248.1">Firefox includes a JSON viewer that by default parses the JSON data and displays it in a user-friendly manner. </span><span class="koboSpan" id="kobo.248.2">To view the actual JSON string sent by our service in Firefox, we need to click on the </span><strong class="bold"><span class="koboSpan" id="kobo.249.1">Raw </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.250.1">Data</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.251.1"> tab.</span></span></p>
<p><span class="koboSpan" id="kobo.252.1">Web browsers </span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.253.1">only support HTTP GET and POST requests. </span><span class="koboSpan" id="kobo.253.2">To test a POST request through the browser, we would have to write a web application containing an HTML form that has an action attribute value of our service’s URI. </span><span class="koboSpan" id="kobo.253.3">Although trivial for a single service, it can become cumbersome to do this for every RESTful web service </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">we develop.</span></span></p>
<p><span class="koboSpan" id="kobo.255.1">Thankfully, there is a popular open source command-line utility called </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">curl</span></strong><span class="koboSpan" id="kobo.257.1"> that we can use to test our web services. </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">curl</span></strong><span class="koboSpan" id="kobo.259.1"> is included with most Linux distributions, and can be easily downloaded for Windows, macOS, and several other platforms. </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">curl</span></strong><span class="koboSpan" id="kobo.261.1"> can be downloaded </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">at </span></span><a href="http://curl.haxx.se/"><span class="No-Break"><span class="koboSpan" id="kobo.263.1">http://curl.haxx.se/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.264.1">.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">curl</span></strong><span class="koboSpan" id="kobo.266.1"> can send all HTTP request method types (GET, POST, PUT,  DELETE, etc.) to our service. </span><span class="koboSpan" id="kobo.266.2">Our server’s response will simply be displayed on the command-line console. </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">curl</span></strong><span class="koboSpan" id="kobo.268.1"> takes an </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">-X</span></strong><span class="koboSpan" id="kobo.270.1"> command-line option, which allows us to specify what request method to send. </span><span class="koboSpan" id="kobo.270.2">To send a GET request, we simply need to type the following into the </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">command line:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.272.1">
curl -XGET http://localhost:8080/jakartarestintro/resources/customer</span></pre> <p><span class="koboSpan" id="kobo.273.1">Doing so results in the </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">following output:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.275.1">
{
  "customer": {
    "id": 123,
    "firstName": "Joseph",
    "middleName": "William",
    "lastName": "Graystone"
  }
}</span></pre> <p><span class="koboSpan" id="kobo.276.1">This, unsurprisingly, is </span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.277.1">the same output we saw when we pointed our browser to the </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">service’s URI.</span></span></p>
<p><span class="koboSpan" id="kobo.279.1">The default request method for </span><strong class="source-inline"><span class="koboSpan" id="kobo.280.1">curl</span></strong><span class="koboSpan" id="kobo.281.1"> is GET; therefore, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">-X</span></strong><span class="koboSpan" id="kobo.283.1"> parameter in our preceding example is redundant. </span><span class="koboSpan" id="kobo.283.2">We could have achieved the same result by invoking the following command from the </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">command line:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.285.1">
curl http://localhost:8080/jakartarestintro/resources/customer</span></pre> <p><span class="koboSpan" id="kobo.286.1">After submitting any of the two preceding commands and examining the application server log, we should see the output of the logging statements we added to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">getCustomer()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.288.1"> method:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.289.1">
com.ensode.jakartaeebook.jakartarestintro.service.CustomerResource.getCustomer() invoked|#]</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.290.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.291.1">The exact location of the application server log depends on the Jakarta EE implementation we are using. </span><span class="koboSpan" id="kobo.291.2">For GlassFish, when using the default domain, it can be found at </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">[glassfish </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">installation directory]/glassfish/domains/domain1/logs/server.log</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.295.1">For all other request method types, we need to send some data to our service. </span><span class="koboSpan" id="kobo.295.2">This can be accomplished by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">--data</span></strong><span class="koboSpan" id="kobo.297.1"> command-line argument </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">curl</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.301.1">
curl -XPUT -HContent-type:application/json --data "{
  "customer": {
    "id": 321,
    "firstName": "Amanda",
    "middleName": "Zoe",
    "lastName": "Adams"
  }
}" http://localhost:8080/jakartarestintro/resources/customer</span></pre> <p><span class="koboSpan" id="kobo.302.1">We need </span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.303.1">to specify the MIME type via </span><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">curl</span></strong><span class="koboSpan" id="kobo.305.1">’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">-H</span></strong><span class="koboSpan" id="kobo.307.1"> command-line argument using the format seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">preceding example.</span></span></p>
<p><span class="koboSpan" id="kobo.309.1">We can verify that the preceding command worked as expected by inspecting the application </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">server log:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.311.1">
com.ensode.jakartaeebook.jakartarestintro.service.CustomerResource.createCustomer() invoked|#]
  customerJson = {
  customer: {
    id: 321,
    firstName: Amanda,
    middleName: Zoe,
    lastName: Adams
  }
}|#]</span></pre> <p><span class="koboSpan" id="kobo.312.1">We can test other request method types just </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">as easily:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.314.1">
curl -XPOST -HContent-type:application/json --data "{
  "customer": {
    "id": 321,
    "firstName": "Amanda",
    "middleName": "Tamara",
    "lastName": "Adams"
  }
}" http://localhost:8080/jakartarestintro/resources/customer</span></pre> <p><span class="koboSpan" id="kobo.315.1">This results </span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.316.1">in the following output in the application </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">server log:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.318.1">
com.ensode.jakartaeebook.jakartarestintro.service.CustomerResource.updateCustomer() invoked|#]
  customerJson = {
  customer: {
    id: 321,
    firstName: Amanda,
    middleName: Tamara,
    lastName: Adams
  }
}|#]</span></pre> <p><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">curl</span></strong><span class="koboSpan" id="kobo.320.1"> allows us to quickly test our RESTful web services. </span><span class="koboSpan" id="kobo.320.2">However, in a real application, we need to develop RESTful web service clients to invoke our RESTful web services and retrieve data from them. </span><span class="koboSpan" id="kobo.320.3">Jakarta REST provides a client API we can use for </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">this purpose.</span></span></p>
<h1 id="_idParaDest-41"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.322.1">Developing a RESTful web service client</span></h1>
<p><span class="koboSpan" id="kobo.323.1">Although </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">curl</span></strong><span class="koboSpan" id="kobo.325.1"> allows us to quickly test our RESTful web services and is a developer-friendly tool, we </span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.326.1">need a way for our Java applications to invoke the RESTful web services we develop. </span><span class="koboSpan" id="kobo.326.2">Jakarta REST includes a client-side API we can use to develop RESTful web </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">service clients.</span></span></p>
<p><span class="koboSpan" id="kobo.328.1">The following example illustrates how to use the Jakarta REST </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">client API:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.330.1">
package com.ensode.jakartaeebook.jakartarestintroclient;
//imports omitted for brevity
public class App {
  public static void main(String[] args) {
    App app = new App();
    app.insertCustomer();
  }
  public void insertCustomer() {
    String customerJson = """
                          {
                            "customer": {
                              "id": 234,
                              "firstName": "Tamara",
                              "middleName": "Adeline",
                              "lastName": "Graystone"
                            }
                          }
                          """;
        </span><strong class="bold"><span class="koboSpan" id="kobo.331.1">Client client = ClientBuilder.newClient();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.332.1">        client.target(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.333.1">          "</span></strong><span class="koboSpan" id="kobo.334.1">http://localhost:8080/</span><strong class="bold"><span class="koboSpan" id="kobo.335.1">" +</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.336.1">          "jakartarestintro/resources/customer").</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.337.1">          request().put(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.338.1">            Entity.entity(customerJson,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.339.1">              MediaType.APPLICATION_JSON),</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.340.1">              String.class);</span></strong><span class="koboSpan" id="kobo.341.1">
    }
}</span></pre> <p><span class="koboSpan" id="kobo.342.1">The</span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.343.1"> first thing we need to do is create an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.344.1">jakarta.ws.rs.client.Client</span></strong><span class="koboSpan" id="kobo.345.1"> by invoking the static </span><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">newClient()</span></strong><span class="koboSpan" id="kobo.347.1"> method on the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">jakarta.ws.rs.client.ClientBuilder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.349.1"> class.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">We then invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">target()</span></strong><span class="koboSpan" id="kobo.352.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.353.1">Client</span></strong><span class="koboSpan" id="kobo.354.1"> instance, passing the URI of our RESTful web service as a parameter. </span><span class="koboSpan" id="kobo.354.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.355.1">target()</span></strong><span class="koboSpan" id="kobo.356.1"> method returns an instance of a class implementing the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">jakarta.ws.rs.client.WebTarget</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.358.1"> interface.</span></span></p>
<p><span class="koboSpan" id="kobo.359.1">At this point, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">request()</span></strong><span class="koboSpan" id="kobo.361.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">WebTarget</span></strong><span class="koboSpan" id="kobo.363.1"> instance. </span><span class="koboSpan" id="kobo.363.2">This method returns an implementation of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">jakarta.ws.rs.client.Invocation.Builder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.365.1"> interface.</span></span></p>
<p><span class="koboSpan" id="kobo.366.1">In this particular example, we are sending an HTTP PUT request to our RESTful web service; therefore, at this point, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">put()</span></strong><span class="koboSpan" id="kobo.368.1"> method of our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">Invocation.Builder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.370.1"> implementation.</span></span></p>
<p><span class="koboSpan" id="kobo.371.1">The first parameter of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">put()</span></strong><span class="koboSpan" id="kobo.373.1"> method is a </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">jakarta.ws.rs.client.Entity</span></strong><span class="koboSpan" id="kobo.375.1"> instance; we can create one on the fly by invoking the static </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">entity()</span></strong><span class="koboSpan" id="kobo.377.1"> method on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">Entity</span></strong><span class="koboSpan" id="kobo.379.1"> class. </span><span class="koboSpan" id="kobo.379.2">The first parameter for this method is the object we wish to pass to our RESTful web service, and the second parameter is the string representation of the MIME type of the data we will be passing to the RESTful web service. </span><span class="koboSpan" id="kobo.379.3">In our example, we are using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">MediaType.APPLICATION_JSON</span></strong><span class="koboSpan" id="kobo.381.1"> constant, which resolves to </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">"application/json"</span></strong><span class="koboSpan" id="kobo.383.1">. </span><span class="koboSpan" id="kobo.383.2">The second parameter of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">put()</span></strong><span class="koboSpan" id="kobo.385.1"> method is the type of response the client expects from the service. </span><span class="koboSpan" id="kobo.385.2">In our case we expect a </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">String</span></strong><span class="koboSpan" id="kobo.387.1">; therefore, we used </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">String.class</span></strong><span class="koboSpan" id="kobo.389.1"> for this parameter. </span><span class="koboSpan" id="kobo.389.2">After we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.390.1">put()</span></strong><span class="koboSpan" id="kobo.391.1"> method, an HTTP PUT request is </span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.392.1">sent to our RESTful web service and the method we decorated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">@Put</span></strong><span class="koboSpan" id="kobo.394.1"> annotation (</span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">createCustomer()</span></strong><span class="koboSpan" id="kobo.396.1"> in our example) is invoked. </span><span class="koboSpan" id="kobo.396.2">There are similar </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">get()</span></strong><span class="koboSpan" id="kobo.398.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">post()</span></strong><span class="koboSpan" id="kobo.400.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">delete()</span></strong><span class="koboSpan" id="kobo.402.1"> methods we can invoke to send the corresponding HTTP requests to our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">web service.</span></span></p>
<p><span class="koboSpan" id="kobo.404.1">Now that we’ve seen how to develop both RESTFul web services and clients, we’ll take a look at how Jakarta EE can seamlessly convert between Java </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">and JSON.</span></span></p>
<h1 id="_idParaDest-42"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.406.1">Seamlessly converting between Java and JSON</span></h1>
<p><span class="koboSpan" id="kobo.407.1">RESTful web services transfer data in plain text, typically, but this is not limited to JSON-formatted data. </span><span class="koboSpan" id="kobo.407.2">In our examples so far, we have been sending and receiving JSON strings between our RESTful services and </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">their clients.</span></span></p>
<p><span class="koboSpan" id="kobo.409.1">Frequently, we </span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.410.1">would like to populate Java objects from the JSON data we receive, manipulate the data somehow, and then build a JSON string to send as a response. </span><span class="koboSpan" id="kobo.410.2">The population of Java objects from JSON, and the generation of JSON data from Java objects, is so common that the Jakarta REST implementation provides a way to do it seamlessly </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">and automatically.</span></span></p>
<p><span class="koboSpan" id="kobo.412.1">In previous examples in this chapter, we have been sending and receiving raw JSON data as strings. </span><span class="koboSpan" id="kobo.412.2">Our sample data contains customer information such as first name, middle name, and last name. </span><span class="koboSpan" id="kobo.412.3">To make this data easier to manipulate, we would typically populate a Java object with this data; for example, we could parse the JSON data and populate an instance of the following </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">Java class:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.414.1">
package com.ensode.jakartaeebook.javajson.entity;
public class Customer {
  private Long id;
  private String firstName;
  private String middleName;
  private String lastName;
  public Customer() {
  }
  public Customer(Long id, String firstName,
    String middleName, String lastName) {
    //constructor body omitted for brevity
  }
  //getters,setters and toString() method omitted for brevity
}</span></pre> <p><span class="koboSpan" id="kobo.415.1">Notice </span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.416.1">how the instance variable names of our </span><strong class="source-inline"><span class="koboSpan" id="kobo.417.1">Customer</span></strong><span class="koboSpan" id="kobo.418.1"> class match the names of the properties of our JSON data; Jakarta REST is smart enough to populate each variable with the corresponding JSON property. </span><span class="koboSpan" id="kobo.418.2">As long as the property names and variable names match, Jakarta REST can populate our Java object automatically (the types, needless to say, must match as well; an error would occur trying to populate a variable of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.419.1">Integer</span></strong><span class="koboSpan" id="kobo.420.1"> type with a textual value, </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">for example).</span></span></p>
<p><span class="koboSpan" id="kobo.422.1">The following example illustrates how we can implement a RESTful web service that seamlessly </span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.423.1">converts the JSON data it receives to a </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">Java object:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.425.1">
package com.ensode.jakartaeebook.javajson.service;
//imports omitted for brevity
@Path("customer")
public class CustomerResource {
  private static final Logger LOG =
    Logger.getLogger(CustomerResource.class.getName());
  private final Customer customer;
  public CustomerResource() {
    customer = new Customer(1L, "David",
      "Raymond", "Heffelfinger");
  }
  @GET
  </span><strong class="bold"><span class="koboSpan" id="kobo.426.1">@Produces(MediaType.APPLICATION_JSON)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.427.1">  public Customer getCustomer()</span></strong><span class="koboSpan" id="kobo.428.1"> {
    LOG.log(Level.INFO, "{0}.getCustomer() invoked",
      this.getClass().getCanonicalName());
    return customer;
  }
  @POST
  </span><strong class="bold"><span class="koboSpan" id="kobo.429.1">@Consumes(MediaType.APPLICATION_JSON)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.430.1">  public void updateCustomer(Customer customer)</span></strong><span class="koboSpan" id="kobo.431.1"> {
    LOG.log(Level.INFO, "got the following customer: {0}",
      customer);
  }
  @PUT
  </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">@Consumes(MediaType.APPLICATION_JSON)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.433.1">  public void createCustomer(Customer customer)</span></strong><span class="koboSpan" id="kobo.434.1"> {
    LOG.log(Level.INFO, "customer = {0}", customer);
  }
}</span></pre> <p><span class="koboSpan" id="kobo.435.1">Notice all we</span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.436.1"> had to do was to change the type of the parameters for our methods to be of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.437.1">Customer</span></strong><span class="koboSpan" id="kobo.438.1"> type (our simple example POJO); previously, they were of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.439.1">String</span></strong><span class="koboSpan" id="kobo.440.1"> type. </span><span class="koboSpan" id="kobo.440.2">Similarly, we changed the type of the return value from </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">String</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.442.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.443.1">Customer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.445.1">Notice</span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.446.1"> we don’t have to do anything special in our code to populate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">Customer</span></strong><span class="koboSpan" id="kobo.448.1"> object, or to generate a JSON string to send as a response; it is all taken care of behind the scenes by </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">Jakarta REST.</span></span></p>
<p><span class="koboSpan" id="kobo.450.1">To illustrate this seamless conversion, let’s use </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">curl</span></strong><span class="koboSpan" id="kobo.452.1"> to send a request to our </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">modified service:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.454.1">
curl -XPUT -HContent-type:application/json --data '{
  "id": 1,
  "firstName": "Bruce",
  "middleName": "Arnold",
  "lastName": "Stallone"
}' http://localhost:8080/jakartarestjavajson/resources/customer</span></pre> <p><span class="koboSpan" id="kobo.455.1">Notice that in our </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">curl</span></strong><span class="koboSpan" id="kobo.457.1"> command, we are sending JSON data to our Jakarta REST service. </span><span class="koboSpan" id="kobo.457.2">If we inspect the application server log, we can see the </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">following output:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.459.1">
  com.ensode.jakartaeebook.javajson.service.CustomerResource.createCustomer() invoked|#]
  </span><strong class="bold"><span class="koboSpan" id="kobo.460.1">customer = Customer{id=1, firstName=Bruce, middleName=Arnold, lastName=Stallone}|#]</span></strong></pre> <p><span class="koboSpan" id="kobo.461.1">In the</span><a id="_idIndexMarker111"/><span class="koboSpan" id="kobo.462.1"> application server log, we see the output of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">toString()</span></strong><span class="koboSpan" id="kobo.464.1"> method of our </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">Customer</span></strong><span class="koboSpan" id="kobo.466.1"> class, illustrating that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">createCustomer(Customer customer)</span></strong><span class="koboSpan" id="kobo.468.1"> method in our service was invoked, and it seamlessly populated its customer parameter with the raw JSON data we sent it with our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">curl</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.470.1"> command.</span></span></p>
<p><span class="koboSpan" id="kobo.471.1">When using </span><a id="_idIndexMarker112"/><span class="koboSpan" id="kobo.472.1">non-Java clients, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">curl</span></strong><span class="koboSpan" id="kobo.474.1">, or RESTful web service clients written in languages other than Java, we need to send raw JSON data to our service from the client side, as illustrated in our example. </span><span class="koboSpan" id="kobo.474.2">When writing clients in Java, we can take advantage of the Jakarta REST client API, which allows seamless conversion from Java to JSON on the client side as well. </span><span class="koboSpan" id="kobo.474.3">The following example illustrates how to </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">do this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.476.1">
package com.ensode.jakartarestjavajsonclient;
//imports omitted for brevity
public class App {
  public static void main(String[] args) {
    App app = new App();
    app.insertCustomer();
  }
  public void insertCustomer() {
    </span><strong class="bold"><span class="koboSpan" id="kobo.477.1">Customer customer = new Customer(456L, "Daniel",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.478.1">      "Robert","Hanson");</span></strong><span class="koboSpan" id="kobo.479.1">
    Client client = ClientBuilder.newClient();
    </span><strong class="bold"><span class="koboSpan" id="kobo.480.1">client.target(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.481.1">      "http://localhost:8080/"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.482.1">       + "jakartarestjavajson/resources/customer").</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.483.1">      request().put(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.484.1">        Entity.entity(customer, MediaType.APPLICATION_JSON),</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.485.1">      Customer.class);</span></strong><span class="koboSpan" id="kobo.486.1">
  }
}</span></pre> <p><span class="koboSpan" id="kobo.487.1">In this </span><a id="_idIndexMarker113"/><span class="koboSpan" id="kobo.488.1">updated client, we simply create an instance of our </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">Customer</span></strong><span class="koboSpan" id="kobo.490.1"> class. </span><span class="koboSpan" id="kobo.490.2">Then we can pass it as a parameter to the static </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">entity()</span></strong><span class="koboSpan" id="kobo.492.1"> method of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">Entity</span></strong><span class="koboSpan" id="kobo.494.1"> class, and pass the corresponding type (</span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">Customer.class</span></strong><span class="koboSpan" id="kobo.496.1">, in our example) to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">put()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.498.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.499.1">After running </span><a id="_idIndexMarker114"/><span class="koboSpan" id="kobo.500.1">our client code, we can see the following output in the application </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">server log:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.502.1">
  com.ensode.jakartaeebook.javajson.service.CustomerResource.createCustomer() invoked|#]
  customer = Customer{id=456, firstName=Daniel, middleName=Robert, lastName=Hanson}|#]</span></pre> <p><span class="koboSpan" id="kobo.503.1">Our client seamlessly converted our </span><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">Customer</span></strong><span class="koboSpan" id="kobo.505.1"> instance to a JSON string, and invoked our RESTful web service, which in turn converted the sent JSON back to a </span><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">Customer</span></strong><span class="koboSpan" id="kobo.507.1"> instance; all behind the scenes, saving us a lot of </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">drudge work.</span></span></p>
<p><span class="koboSpan" id="kobo.509.1">So far, in all of our examples, we have been passing a JSON string (either directly or indirectly) as a body to the HTTP requests we have been sending to our RESTful web services. </span><span class="koboSpan" id="kobo.509.2">It is also possible to pass parameters to our RESTful web services. </span><span class="koboSpan" id="kobo.509.3">The following section illustrates how to </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">do that.</span></span></p>
<h1 id="_idParaDest-43"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.511.1">Query and path parameters</span></h1>
<p><span class="koboSpan" id="kobo.512.1">In our previous examples, we have been working with a RESTful web service to manage a single customer object. </span><span class="koboSpan" id="kobo.512.2">In real life, this would obviously not be very helpful. </span><span class="koboSpan" id="kobo.512.3">The common case is to develop a RESTful web service to handle a collection of objects (customers, in our example). </span><span class="koboSpan" id="kobo.512.4">To determine what specific object in the collection we are working with, we can pass parameters to our RESTful web services. </span><span class="koboSpan" id="kobo.512.5">There are two types of parameters we can use: </span><strong class="bold"><span class="koboSpan" id="kobo.513.1">query</span></strong><span class="koboSpan" id="kobo.514.1"> and </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.515.1">path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.516.1"> parameters.</span></span></p>
<h2 id="_idParaDest-44"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.517.1">Query parameters</span></h2>
<p><span class="koboSpan" id="kobo.518.1">We can </span><a id="_idIndexMarker115"/><span class="koboSpan" id="kobo.519.1">add parameters to methods that will handle HTTP requests in our web service. </span><span class="koboSpan" id="kobo.519.2">Parameters decorated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">@QueryParam</span></strong><span class="koboSpan" id="kobo.521.1"> annotation will be retrieved from the </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">request URL.</span></span></p>
<p><span class="koboSpan" id="kobo.523.1">The following example illustrates how to use query parameters in RESTful web services using </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">Jakarta REST:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.525.1">
package com.ensode.jakartaeebook.queryparams.service;
//imports omitted for brevity
@Path("customer")
public class CustomerResource {
  private static final Logger LOG =
    Logger.getLogger(CustomerResource.class.getName());
  private final Customer customer;
  public CustomerResource() {
    customer = new Customer(1L, "Samuel",
      "Joseph", "Willow");
  }
  @GET
  @Produces(MediaType.APPLICATION_JSON)
</span><strong class="bold"><span class="koboSpan" id="kobo.526.1">  public Customer getCustomer(@QueryParam("id") Long id)</span></strong><span class="koboSpan" id="kobo.527.1"> {
    LOG.log(Level.INFO,
     "{0}.getCustomer() invoked, id = {1}", new Object[]
     {this.getClass().getCanonicalName(), id});
    return new Customer(id, "Dummy", null, "Customer");
  }
  @DELETE
  @Consumes(MediaType.APPLICATION_JSON)
</span><strong class="bold"><span class="koboSpan" id="kobo.528.1">  public void deleteCustomer(@QueryParam("id") Long id)</span></strong><span class="koboSpan" id="kobo.529.1"> {
 LOG.log(Level.INFO,
      "{0}.deleteCustomer() invoked, id = {1}",
      new Object[]
    {this.getClass().getCanonicalName(), id});
  }
  //additional methods deleted for brevity
}</span></pre> <p><span class="koboSpan" id="kobo.530.1">In our updated example, we added a parameter to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.532.1"> method, which, as </span><a id="_idIndexMarker116"/><span class="koboSpan" id="kobo.533.1">we may recall, is decorated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">@GET</span></strong><span class="koboSpan" id="kobo.535.1"> annotation so that it is invoked when our RESTful web service receives an HTTP GET request. </span><span class="koboSpan" id="kobo.535.2">We annotated the parameter with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">@QueryParam</span></strong><span class="koboSpan" id="kobo.537.1"> annotation; the value of this annotation (</span><strong class="source-inline"><span class="koboSpan" id="kobo.538.1">id </span></strong><span class="koboSpan" id="kobo.539.1">in our example) is the name of the parameter to use when sending a request to </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">our service.</span></span></p>
<p><span class="koboSpan" id="kobo.541.1">We can pass a query parameter to the web service’s URL just like we pass query parameters to any URL. </span><span class="koboSpan" id="kobo.541.2">For HTTP GET requests, we could simply type our RESTful web service’s URL into the browser, or we could use </span><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">curl</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.543.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.544.1">
curl -XGET -HContent-type:application/json http://localhost:8080/queryparams/resources/customer?id=1</span></pre> <p><span class="koboSpan" id="kobo.545.1">Either way, we should see the corresponding output in the application </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">server log:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.547.1">
com.ensode.jakartaeebook.queryparams.service.CustomerResource.getCustomer() invoked, id = 1|#]</span></pre> <p><span class="koboSpan" id="kobo.548.1">Plus, we should see the following response from our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.549.1">web service:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.550.1">
{"firstName":"Dummy","id":1,"lastName":"Customer"}</span></pre> <p><span class="koboSpan" id="kobo.551.1">Notice the response is a JSON representation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.552.1">Customer</span></strong><span class="koboSpan" id="kobo.553.1"> object we return in our </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.555.1"> object. </span><span class="koboSpan" id="kobo.555.2">We didn’t have to explicitly create the JSON data; Jakarta REST took care of it </span><span class="No-Break"><span class="koboSpan" id="kobo.556.1">for us.</span></span></p>
<p><span class="koboSpan" id="kobo.557.1">We added a </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">deleteCustomer()</span></strong><span class="koboSpan" id="kobo.559.1"> method to our RESTful web service, and we annotated this method with </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">@DELETE</span></strong><span class="koboSpan" id="kobo.561.1"> so that it responds to HTTP DELETE requests. </span><span class="koboSpan" id="kobo.561.2">Just like with </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.563.1">, we added a parameter to this method and annotated it with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">QueryParam</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.566.1"> annotation.</span></span></p>
<p><span class="koboSpan" id="kobo.567.1">We can send our RESTful web service using </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">curl</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.569.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.570.1">
curl -XDELETE -HContent-type:application/json http://localhost:8080/queryparams/resources/customer?</span><span class="P---URL"><span class="koboSpan" id="kobo.571.1">id=2</span></span></pre> <p><span class="koboSpan" id="kobo.572.1">Our </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">deleteCustomer()</span></strong><span class="koboSpan" id="kobo.574.1"> will be invoked as expected, as evidenced by the output in the application </span><span class="No-Break"><span class="koboSpan" id="kobo.575.1">server log:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.576.1">
com.ensode.jakartaeebook.queryparams.service.CustomerResource.deleteCustomer() invoked, id = 2|#]</span></pre> <h3><span class="koboSpan" id="kobo.577.1">Sending query parameters via the Jakarta REST client API</span></h3>
<p><span class="koboSpan" id="kobo.578.1">The </span><a id="_idIndexMarker117"/><span class="koboSpan" id="kobo.579.1">Jakarta REST client API provides a straightforward way of sending query parameters to RESTful web services. </span><span class="koboSpan" id="kobo.579.2">The following example illustrates how to </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">do this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.581.1">
package com.ensode.jakartaeebook.queryparamsclient;
//imports omitted for brevity
public class App {
  public static void main(String[] args) {
    App app = new App();
    app.getCustomer();
  }
  public void getCustomer() {
    Client client = ClientBuilder.newClient();
    Customer customer = client.target(
      "http://localhost:8080/"
      + "queryparams/resources/customer").
</span><span class="koboSpan" id="kobo.581.2">      </span><strong class="bold"><span class="koboSpan" id="kobo.582.1">queryParam("id", 1L)</span></strong><span class="koboSpan" id="kobo.583.1">.
</span><span class="koboSpan" id="kobo.583.2">        request().get(Customer.class);
      System.out.println(String.format(
        "Received the following customer information:\n%s",
      customer));
    }
}</span></pre> <p><span class="koboSpan" id="kobo.584.1">As we can see, all we need to do to pass a parameter is to invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.585.1">queryParam()</span></strong><span class="koboSpan" id="kobo.586.1"> method on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">jakarta.ws.rs.client.WebTarget</span></strong><span class="koboSpan" id="kobo.588.1"> instance returned by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">target()</span></strong><span class="koboSpan" id="kobo.590.1"> method invocation on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">Client</span></strong><span class="koboSpan" id="kobo.592.1"> instance. </span><span class="koboSpan" id="kobo.592.2">The first argument to this method is</span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.593.1"> the parameter name and must match the value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">@QueryParam</span></strong><span class="koboSpan" id="kobo.595.1"> annotation on the web service. </span><span class="koboSpan" id="kobo.595.2">The second parameter is the value that we need to pass to the web service. </span><span class="koboSpan" id="kobo.595.3">If our web service accepts multiple parameters, we can chain </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">queryParam()</span></strong><span class="koboSpan" id="kobo.597.1"> method invocations, using one for each parameter our RESTful web </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">service expects.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.599.1">Path parameters</span></h2>
<p><span class="koboSpan" id="kobo.600.1">Another way we can </span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.601.1">pass parameters to our RESTful web services is via path parameters. </span><span class="koboSpan" id="kobo.601.2">The following example illustrates how to develop a Jakarta REST web service that accepts </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">path parameters:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.603.1">
package com.ensode.jakartaeebook.pathparams.service;
//imports omitted for brevity
@Path("/customer/")
public class CustomerResource {
  private static final Logger LOG =
    Logger.getLogger(CustomerResource.class.getName());
  private Customer customer;
  public CustomerResource() {
    customer = new Customer(1L, "William",
            "Daniel", "Graystone");
  }
  @GET
  @Produces(MediaType.APPLICATION_JSON)
  </span><strong class="bold"><span class="koboSpan" id="kobo.604.1">@Path("{id}/")</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.605.1">  public Customer getCustomer(@PathParam("id") Long id)</span></strong><span class="koboSpan" id="kobo.606.1"> {
    return customer;
  }
  @PUT
  @Consumes(MediaType.APPLICATION_JSON)
  public void createCustomer(Customer customer) {
    LOG.log(Level.INFO, "customer = {0}", customer);
  }
  @POST
  @Consumes(MediaType.APPLICATION_JSON)
  public void updateCustomer(Customer customer) {
    LOG.log(Level.INFO, "customer= {0}", customer);
  }
  @DELETE
  @Consumes(MediaType.APPLICATION_JSON)
  </span><strong class="bold"><span class="koboSpan" id="kobo.607.1">@Path("{id}/")</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.608.1">  public void deleteCustomer(@PathParam("id") Long id)</span></strong><span class="koboSpan" id="kobo.609.1"> {
    LOG.log(Level.INFO, "customer = {0}", customer);
  }
}</span></pre> <p><span class="koboSpan" id="kobo.610.1">Any method </span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.611.1">that accepts a path parameter must be annotated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">@Path</span></strong><span class="koboSpan" id="kobo.613.1"> annotation. </span><span class="koboSpan" id="kobo.613.2">The value attribute of this annotation must be formatted as </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">"{paramName}/"</span></strong><span class="koboSpan" id="kobo.615.1">, where </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">paramName</span></strong><span class="koboSpan" id="kobo.617.1"> is the parameter the method expects to receive. </span><span class="koboSpan" id="kobo.617.2">Additionally, method parameters must be decorated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.618.1">@PathParam</span></strong><span class="koboSpan" id="kobo.619.1"> annotation. </span><span class="koboSpan" id="kobo.619.2">The value of this annotation must match the parameter name declared in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">@Path</span></strong><span class="koboSpan" id="kobo.621.1"> annotation for </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">the method.</span></span></p>
<p><span class="koboSpan" id="kobo.623.1">We can pass </span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.624.1">path parameters from the command line by adjusting our web service’s URI as appropriate; for example, to pass an id parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.625.1">1</span></strong><span class="koboSpan" id="kobo.626.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">getCustomer() </span></strong><span class="koboSpan" id="kobo.628.1">method (which handles HTTP GET requests), we could do it from the command line </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.630.1">
curl -XGET -HContent-type:application/json http://localhost:8080/pathparams/resources/customer/1</span></pre> <p><span class="koboSpan" id="kobo.631.1">This returns the expected output of a JSON representation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">Customer</span></strong><span class="koboSpan" id="kobo.633.1"> object returned by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.634.1">getCustomer()</span></strong><span class="koboSpan" id="kobo.635.1"> method, as seen in </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.637.1">
{"firstName":"William","id":1,"lastName":"Graystone","middleName":"Daniel"}</span></pre> <h3><span class="koboSpan" id="kobo.638.1">Sending path parameters via the Jakarta REST client API</span></h3>
<p><span class="koboSpan" id="kobo.639.1">Sending</span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.640.1"> path parameters to a web service via the Jakarta REST client API is straightforward; all we need to do is add a couple of method invocations to specify the path parameter and its value. </span><span class="koboSpan" id="kobo.640.2">The following example illustrates how to </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">do this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.642.1">
package com.ensode.jakartaeebook.pathparamsclient;
//imports omitted for brevity
public class App {
  public static void main(String[] args) {
    App app = new App();
    app.getCustomer();
  }
  public void getCustomer() {
    Client client = ClientBuilder.newClient();
    Customer customer = client.target(
    http://localhost:8080/pathparams/resources/customer
    "http://localhost:8080/"
      + "pathparams/resources/customer").
</span><span class="koboSpan" id="kobo.642.2">      </span><strong class="bold"><span class="koboSpan" id="kobo.643.1">path("{id}").</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.644.1">      resolveTemplate("id", 1L).</span></strong><span class="koboSpan" id="kobo.645.1">
      request().get(Customer.class);
      System.out.println("Received the following "
        + "customer information:");
      System.out.println("Id: " + customer.getId());
      System.out.println("First Name: " +
        customer.getFirstName());
      System.out.println("Middle Name: " +
        customer.getMiddleName());
      System.out.println("Last Name: " +
        customer.getLastName());
    }
}</span></pre> <p><span class="koboSpan" id="kobo.646.1">In this </span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.647.1">example, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">path()</span></strong><span class="koboSpan" id="kobo.649.1"> method on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">WebTarget</span></strong><span class="koboSpan" id="kobo.651.1"> instance returned by </span><strong class="source-inline"><span class="koboSpan" id="kobo.652.1">client.target()</span></strong><span class="koboSpan" id="kobo.653.1">; this method appends the specified path to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.654.1">WebTarget</span></strong><span class="koboSpan" id="kobo.655.1"> instance. </span><span class="koboSpan" id="kobo.655.2">The value of this method must match the value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">@Path</span></strong><span class="koboSpan" id="kobo.657.1"> annotation in our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">web service.</span></span></p>
<p><span class="koboSpan" id="kobo.659.1">After invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.660.1">path()</span></strong><span class="koboSpan" id="kobo.661.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">WebTarget</span></strong><span class="koboSpan" id="kobo.663.1"> instance, we then need to invoke </span><strong class="source-inline"><span class="koboSpan" id="kobo.664.1">resolveTemplate()</span></strong><span class="koboSpan" id="kobo.665.1">. </span><span class="koboSpan" id="kobo.665.2">The first parameter for this method is the name of the parameter (without the curly braces), and the second parameter is the value we wish to pass as a parameter to our RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">web service.</span></span></p>
<p><span class="koboSpan" id="kobo.667.1">If we </span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.668.1">need to pass more than one parameter to one of our web services, we simply need to use the following format for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">@Path</span></strong><span class="koboSpan" id="kobo.670.1"> parameter at the </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">method level:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.672.1">
@Path("/{paramName1}/{paramName2}/")</span></pre> <p><span class="koboSpan" id="kobo.673.1">Then annotate the corresponding method arguments with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.674.1">@PathParam</span></strong><span class="koboSpan" id="kobo.675.1"> annotation </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.677.1">
public String someMethod(
  @PathParam("paramName1") String param1,
  @PathParam("paramName2") String param2)</span></pre> <p><span class="koboSpan" id="kobo.678.1">The web service can then be invoked by modifying the web service’s URI to pass the parameters in the order specified in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.679.1">@Path</span></strong><span class="koboSpan" id="kobo.680.1"> annotation. </span><span class="koboSpan" id="kobo.680.2">For example, the following URI would pass the values </span><strong class="source-inline"><span class="koboSpan" id="kobo.681.1">1</span></strong><span class="koboSpan" id="kobo.682.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.683.1">2</span></strong><span class="koboSpan" id="kobo.684.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">paramName1</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.686.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">paramName2</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">:</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.689.1">http://localhost:8080/contextroot/resources/customer/1/2</span></span></p>
<p><span class="koboSpan" id="kobo.690.1">This URI will work either from the command line or through a web service client we develop with the Jakarta REST </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">client API.</span></span></p>
<p><span class="koboSpan" id="kobo.692.1">All examples we’ve seen so far involve RESTful web services responding to an HTTP request from the client. </span><span class="koboSpan" id="kobo.692.2">We can have our RESTful web services send data to clients without necessarily having to respond to a request; this can be achieved via </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">server-sent events.</span></span></p>
<h1 id="_idParaDest-46"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.694.1">Server-sent events</span></h1>
<p><span class="koboSpan" id="kobo.695.1">Typically, every</span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.696.1"> interaction between a web service and its client is initiated by the client. </span><span class="koboSpan" id="kobo.696.2">The client sends a request (typically GET, POST, PUT, or DELETE), and then receives a response from the server. </span><span class="koboSpan" id="kobo.696.3">Server-sent events technology allows RESTful web services to “take the initiative” to send messages to clients; that is, to send data that is not a response to a client request. </span><span class="koboSpan" id="kobo.696.4">Server-sent events are useful for sending data continuously to a client for applications such as stock tickers, newsfeeds, and </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">sports scores.</span></span></p>
<p><span class="koboSpan" id="kobo.698.1">The following</span><a id="_idIndexMarker126"/><span class="koboSpan" id="kobo.699.1"> example illustrates how to implement this functionality into our Jakarta REST </span><span class="No-Break"><span class="koboSpan" id="kobo.700.1">web services:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.701.1">
package com.ensode.jakartaeebook.serversentevents
// imports omitted for brevity
@ApplicationScoped
@Path("serversentevents")
public class SseResource {
  private   SseBroadcaster sseBroadcaster;
  private OutboundSseEvent.Builder eventBuilder;
  private ScheduledExecutorService scheduledExecutorService;
  private Double stockValue = 10.0;
  //initialization and cleanup methods omitted for brevity
  </span><strong class="bold"><span class="koboSpan" id="kobo.702.1">@Context</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.703.1">  public void setSse(Sse sse) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.704.1">    this.eventBuilder = sse.newEventBuilder();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.705.1">    this.sseBroadcaster = sse.newBroadcaster();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.706.1">  }</span></strong><span class="koboSpan" id="kobo.707.1">
  @GET
  @Path("subscribe")
  @Produces(MediaType.SERVER_SENT_EVENTS)
</span><strong class="bold"><span class="koboSpan" id="kobo.708.1">  public void subscribe(@Context SseEventSink sseEventSink)</span></strong><span class="koboSpan" id="kobo.709.1"> {
    LOG.info(String.format("%s.subscribe() invoked",
      this.getClass().getName()));
    </span><strong class="bold"><span class="koboSpan" id="kobo.710.1">this.sseBroadcaster.register(sseEventSink);</span></strong><span class="koboSpan" id="kobo.711.1">
  }
  public void sendEvents() {
    scheduledExecutorService.scheduleAtFixedRate(() -&gt; {
      </span><strong class="bold"><span class="koboSpan" id="kobo.712.1">final OutboundSseEvent outboundSseEvent = eventBuilder</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.713.1">        .name("ENSD stock ticker value")</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.714.1">        .data(String.class, String.format("%.2f",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.715.1">          stockValue))</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.716.1">        .build();</span></strong><span class="koboSpan" id="kobo.717.1">
      LOG.info(String.format("broadcasting event: %.2f",
        stockValue));
      </span><strong class="bold"><span class="koboSpan" id="kobo.718.1">sseBroadcaster.broadcast(outboundSseEvent);</span></strong><span class="koboSpan" id="kobo.719.1">
      stockValue += 0.9;
    }, 5, 5, TimeUnit.SECONDS);
  }
}</span></pre> <p><span class="koboSpan" id="kobo.720.1">The preceding </span><a id="_idIndexMarker127"/><span class="koboSpan" id="kobo.721.1">example simulates sending stock prices for a fictitious company to the client.  </span><span class="koboSpan" id="kobo.721.2">To send server-sent events to the client, we need to utilize instances of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">SseEventSink</span></strong><span class="koboSpan" id="kobo.723.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">Sse</span></strong><span class="koboSpan" id="kobo.725.1"> classes, as illustrated in </span><span class="No-Break"><span class="koboSpan" id="kobo.726.1">our example.</span></span></p>
<p><span class="koboSpan" id="kobo.727.1">We can inject an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.728.1">Sse</span></strong><span class="koboSpan" id="kobo.729.1"> by creating a setter method and annotating it with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">@Context</span></strong><span class="koboSpan" id="kobo.731.1"> annotation. </span><span class="koboSpan" id="kobo.731.2">We never invoke this setter method directly; instead, the Jakarta EE runtime invokes it, passing an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">Sse</span></strong><span class="koboSpan" id="kobo.733.1"> we can use to send our events. </span><span class="koboSpan" id="kobo.733.2">We then invoke </span><strong class="source-inline"><span class="koboSpan" id="kobo.734.1">newEventBuilder()</span></strong><span class="koboSpan" id="kobo.735.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.736.1">newBroadCaster()</span></strong><span class="koboSpan" id="kobo.737.1"> methods on the injected </span><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">Sse</span></strong><span class="koboSpan" id="kobo.739.1"> instance to obtain </span><strong class="source-inline"><span class="koboSpan" id="kobo.740.1">OutboundSseEvent.Builder</span></strong><span class="koboSpan" id="kobo.741.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">SseBroadcaster</span></strong><span class="koboSpan" id="kobo.743.1"> instances, which we will need to create and </span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">broadcast events.</span></span></p>
<p><span class="koboSpan" id="kobo.745.1">In order to </span><a id="_idIndexMarker128"/><span class="koboSpan" id="kobo.746.1">receive events, clients need to register with our Jakarta REST service; we implemented an endpoint in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.747.1">subscribe()</span></strong><span class="koboSpan" id="kobo.748.1"> method of our example for this purpose. </span><span class="koboSpan" id="kobo.748.2">This endpoint has a “subscribe” path; clients sending an HTTP GET request to this endpoint will be subscribed to receive events from our service. </span><span class="koboSpan" id="kobo.748.3">Notice we annotated the </span><strong class="source-inline"><span class="koboSpan" id="kobo.749.1">SseEventSink</span></strong><span class="koboSpan" id="kobo.750.1"> parameter in our </span><strong class="source-inline"><span class="koboSpan" id="kobo.751.1">subscribe()</span></strong><span class="koboSpan" id="kobo.752.1"> method with </span><strong class="source-inline"><span class="koboSpan" id="kobo.753.1">@Context</span></strong><span class="koboSpan" id="kobo.754.1">; this results in the Jakarta EE runtime injecting an </span><strong class="source-inline"><span class="koboSpan" id="kobo.755.1">SseEventSink</span></strong><span class="koboSpan" id="kobo.756.1"> instance we can use to register the client. </span><span class="koboSpan" id="kobo.756.2">We accomplish this by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">broadcast()</span></strong><span class="koboSpan" id="kobo.758.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.759.1">SseBroadCaster</span></strong><span class="koboSpan" id="kobo.760.1"> instance, and passing the injected </span><strong class="source-inline"><span class="koboSpan" id="kobo.761.1">SseEventSink</span></strong><span class="koboSpan" id="kobo.762.1"> instance as </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">a parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.764.1">To broadcast an event, we first need to build an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.765.1">OutboundSseEvent</span></strong><span class="koboSpan" id="kobo.766.1"> via our instance </span><span class="No-Break"><span class="koboSpan" id="kobo.767.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.768.1">OutboundSseEvent.Builder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.769.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.770.1">We give our event a name by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.771.1">name()</span></strong><span class="koboSpan" id="kobo.772.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">OutboundSseEvent.Builder</span></strong><span class="koboSpan" id="kobo.774.1"> instance, then set the data to send to the client via its </span><strong class="source-inline"><span class="koboSpan" id="kobo.775.1">data()</span></strong><span class="koboSpan" id="kobo.776.1"> method. </span><span class="koboSpan" id="kobo.776.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">data()</span></strong><span class="koboSpan" id="kobo.778.1"> method takes two arguments; the first one is the type of data we are sending to the client (</span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">String</span></strong><span class="koboSpan" id="kobo.780.1">, in our case), and the second one is the actual data we send to </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">the client.</span></span></p>
<p><span class="koboSpan" id="kobo.782.1">Once we have set our event’s name and data via the corresponding method, we build an </span><strong class="source-inline"><span class="koboSpan" id="kobo.783.1">OutboundSseEvent</span></strong><span class="koboSpan" id="kobo.784.1"> instance by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.785.1">build()</span></strong><span class="koboSpan" id="kobo.786.1"> method </span><span class="No-Break"><span class="koboSpan" id="kobo.787.1">on </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.788.1">OutboundSseEvent.Builder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.789.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.790.1">Once we have built our </span><strong class="source-inline"><span class="koboSpan" id="kobo.791.1">OutboundSseEvent</span></strong><span class="koboSpan" id="kobo.792.1"> instance, we send it to the client by passing it as a parameter to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.793.1">broadcast()</span></strong><span class="koboSpan" id="kobo.794.1"> method of </span><strong class="source-inline"><span class="koboSpan" id="kobo.795.1">SseBroadcaster</span></strong><span class="koboSpan" id="kobo.796.1">. </span><span class="koboSpan" id="kobo.796.2">In our example, we calculate a new value for the simulated stock price (for simplicity, we simply increase the value by 0.9), and broadcast a new event with the updated value every </span><span class="No-Break"><span class="koboSpan" id="kobo.797.1">five seconds.</span></span></p>
<h2 id="_idParaDest-47"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.798.1">Testing server-sent events</span></h2>
<p><span class="koboSpan" id="kobo.799.1">We can </span><a id="_idIndexMarker129"/><span class="koboSpan" id="kobo.800.1">make sure our server-sent events are working properly by using </span><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">curl</span></strong><span class="koboSpan" id="kobo.802.1">; we can simply send an HTTP GET request to the endpoint we created for clients to subscribe to our events </span><span class="No-Break"><span class="koboSpan" id="kobo.803.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.804.1">
curl -XGET http://localhost:8080/serversentevents/resources/serversentevents/subscribe</span></pre> <p><span class="koboSpan" id="kobo.805.1">As soon as we run this, we should see the output in the application server log confirming that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">subscribe()</span></strong><span class="koboSpan" id="kobo.807.1"> method </span><span class="No-Break"><span class="koboSpan" id="kobo.808.1">was invoked:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.809.1">
com.ensode.jakartaeebook.serversentevents.SseResource.subscribe() invoked|#]</span></pre> <p><span class="koboSpan" id="kobo.810.1">Within </span><a id="_idIndexMarker130"/><span class="koboSpan" id="kobo.811.1">five seconds, we should start seeing output from </span><strong class="source-inline"><span class="koboSpan" id="kobo.812.1">curl</span></strong><span class="koboSpan" id="kobo.813.1"> indicating it is </span><span class="No-Break"><span class="koboSpan" id="kobo.814.1">receiving events:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.815.1">
event: ENSD stock ticker value
data: 10.00
event: ENSD stock ticker value
data: 10.90
event: ENSD stock ticker value
data: 11.80</span></pre> <p><span class="koboSpan" id="kobo.816.1">The value next to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">event</span></strong><span class="koboSpan" id="kobo.818.1"> label is the name we gave to our event. </span><strong class="source-inline"><span class="koboSpan" id="kobo.819.1">data</span></strong><span class="koboSpan" id="kobo.820.1"> is the actual value we sent from our service as the </span><span class="No-Break"><span class="koboSpan" id="kobo.821.1">event data.</span></span></p>
<p><span class="koboSpan" id="kobo.822.1">By testing our server-sent events code with </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">curl</span></strong><span class="koboSpan" id="kobo.824.1">, we can rest assured that our server-side code is working properly. </span><span class="koboSpan" id="kobo.824.2">That way, if things are not working properly when developing a client, we can eliminate the server as a “suspect” when debugging </span><span class="No-Break"><span class="koboSpan" id="kobo.825.1">our code.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.826.1">Developing a server-sent events client</span></h2>
<p><span class="koboSpan" id="kobo.827.1">The</span><a id="_idIndexMarker131"/><span class="koboSpan" id="kobo.828.1"> Jakarta REST client API provides a way to consume server-sent events. </span><span class="koboSpan" id="kobo.828.2">The following example illustrates how to </span><span class="No-Break"><span class="koboSpan" id="kobo.829.1">do this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.830.1">
package com.ensode.jakartaeebook.serversenteventsclient;
//imports omitted for brevity
public class App {
  public static void main(String[] args) {
    App app = new App();
    app.listenForEvents();
  }
  public void listenForEvents() {
    final SseEventSource.Builder sseEventSourceBuilder;
    final SseEventSource sseEventSource;
    </span><strong class="bold"><span class="koboSpan" id="kobo.831.1">final Client client = ClientBuilder.newClient();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.832.1">    final WebTarget webTarget = client.target(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.833.1">      "http://localhost:8080/serversentevents/"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.834.1">        + "resources/serversentevents/subscribe");</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.835.1">    sseEventSourceBuilder =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.836.1">      SseEventSource.target(webTarget);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.837.1">    sseEventSource = sseEventSourceBuilder.build();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.838.1">    sseEventSource.register((inboundSseEvent) -&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.839.1">      System.out.println("Received the following event:");</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.840.1">      System.out.println(String.format("Event name: %s",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.841.1">        inboundSseEvent.getName()));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.842.1">      System.out.println(String.format("Event data: %s\n",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.843.1">        inboundSseEvent.readData()));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.844.1">    });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.845.1">    sseEventSource.open();</span></strong><span class="koboSpan" id="kobo.846.1">
  }
}</span></pre> <p><span class="koboSpan" id="kobo.847.1">First, we</span><a id="_idIndexMarker132"/><span class="koboSpan" id="kobo.848.1"> need to obtain a </span><strong class="source-inline"><span class="koboSpan" id="kobo.849.1">jakarta.ws.rs.client.Client</span></strong><span class="koboSpan" id="kobo.850.1"> instance by invoking the static  </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">ClientBuilder.newClient()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.852.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.853.1">We then obtain an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.854.1">jakarta.ws.rs.client.WebTarget</span></strong><span class="koboSpan" id="kobo.855.1"> by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.856.1">target()</span></strong><span class="koboSpan" id="kobo.857.1"> method on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.858.1">Client</span></strong><span class="koboSpan" id="kobo.859.1"> instance we retrieved in the previous step, and passing the URI of the endpoint we created for clients to subscribe as </span><span class="No-Break"><span class="koboSpan" id="kobo.860.1">a parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.861.1">The next step is to obtain an </span><strong class="source-inline"><span class="koboSpan" id="kobo.862.1">SseEventSource.Builder</span></strong><span class="koboSpan" id="kobo.863.1"> instance by invoking the static </span><strong class="source-inline"><span class="koboSpan" id="kobo.864.1">SseEventSource.target()</span></strong><span class="koboSpan" id="kobo.865.1"> method, and passing our </span><strong class="source-inline"><span class="koboSpan" id="kobo.866.1">WebTarget</span></strong><span class="koboSpan" id="kobo.867.1"> instance as </span><span class="No-Break"><span class="koboSpan" id="kobo.868.1">a parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.869.1">We then get an </span><strong class="source-inline"><span class="koboSpan" id="kobo.870.1">SseEventSource</span></strong><span class="koboSpan" id="kobo.871.1"> instance by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.872.1">build()</span></strong><span class="koboSpan" id="kobo.873.1"> method on our instance </span><span class="No-Break"><span class="koboSpan" id="kobo.874.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.875.1">SseEventSource.Builder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.876.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.877.1">Next, we register our client by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">register()</span></strong><span class="koboSpan" id="kobo.879.1"> method on our </span><strong class="source-inline"><span class="koboSpan" id="kobo.880.1">sseEventSource</span></strong><span class="koboSpan" id="kobo.881.1"> instance. </span><span class="koboSpan" id="kobo.881.2">This method takes an implementation of the functional interface </span><strong class="source-inline"><span class="koboSpan" id="kobo.882.1">java.util.function.Consumer</span></strong><span class="koboSpan" id="kobo.883.1"> as a parameter; for convenience, we implement this interface inline as a lambda expression. </span><span class="koboSpan" id="kobo.883.2">In our example, we simply output the event name and data we received to the console, via simple </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.884.1">System.out.println()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.885.1"> invocations.</span></span></p>
<p><span class="koboSpan" id="kobo.886.1">Finally, we open the connection to our RESTful web service by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.887.1">open()</span></strong><span class="koboSpan" id="kobo.888.1"> method on our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.889.1">SseEventSource</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.890.1"> instance.</span></span></p>
<p><span class="koboSpan" id="kobo.891.1">When we run our client, we see the </span><span class="No-Break"><span class="koboSpan" id="kobo.892.1">expected output:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.893.1">
Received the following event:
Event name: ENSD stock ticker value
Event data: 10.00
Received the following event:
Event name: ENSD stock ticker value
Event data: 10.90
Received the following event:
Event name: ENSD stock ticker value
Event data: 11.80</span></pre> <p><span class="koboSpan" id="kobo.894.1">For </span><a id="_idIndexMarker133"/><span class="koboSpan" id="kobo.895.1">simplicity, our example is a stand-alone Java application we can run on the command line; the same principles apply when developing RESTful web services that act as clients for other RESTful </span><span class="No-Break"><span class="koboSpan" id="kobo.896.1">web services.</span></span></p>
<h2 id="_idParaDest-49"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.897.1">JavaScript server-sent events client</span></h2>
<p><span class="koboSpan" id="kobo.898.1">So far, all</span><a id="_idIndexMarker134"/><span class="koboSpan" id="kobo.899.1"> of our client examples have either used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.900.1">curl</span></strong><span class="koboSpan" id="kobo.901.1"> command-line utility or the Jakarta REST client API. </span><span class="koboSpan" id="kobo.901.2">It is very common to use JavaScript code running on a browser as a RESTful web service; therefore, in this section, we will take that approach. </span><span class="koboSpan" id="kobo.901.3">The following example illustrates an HTML/JavaScript client receiving </span><span class="No-Break"><span class="koboSpan" id="kobo.902.1">server-sent events:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.903.1">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Stock Ticker Monitor&lt;/title&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; 
          charset=UTF-8"&gt;
    &lt;/head&gt;
    &lt;body onload="getStockTickerValues()"&gt;
        &lt;h2&gt;Super fancy stock ticker monitor&lt;/h2&gt;
        &lt;table cellspacing="0" cellpadding="0"&gt;
            &lt;tr&gt;
                &lt;td&gt;ENSD Stock Ticker Value: &lt;/td&gt;
                &lt;td&gt;&amp;nbsp;&lt;span id="stickerVal"&gt;&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;button&gt;Buy!&lt;/button&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;script&gt;
            function getStockTickerValues() {
                </span><strong class="bold"><span class="koboSpan" id="kobo.904.1">var source = new EventSource(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.905.1">                  "resources/serversentevents/subscribe");</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.906.1">                source.addEventListener(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.907.1">                  'ENSD stock ticker value', function (e) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.908.1">                    console.log('event received', e);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.909.1">                    document.getElementById(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.910.1">                      "stickerVal").innerHTML =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.911.1">                      event.data;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.912.1">                });</span></strong><span class="koboSpan" id="kobo.913.1">
            }
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</span></pre> <p><span class="koboSpan" id="kobo.914.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.915.1">getStockTickerValues()</span></strong><span class="koboSpan" id="kobo.916.1"> JavaScript function creates an </span><strong class="source-inline"><span class="koboSpan" id="kobo.917.1">EventSource</span></strong><span class="koboSpan" id="kobo.918.1"> object. </span><span class="koboSpan" id="kobo.918.2">This constructor takes a </span><strong class="source-inline"><span class="koboSpan" id="kobo.919.1">String</span></strong><span class="koboSpan" id="kobo.920.1"> representing the URL used to subscribe to receive events as a parameter. </span><span class="koboSpan" id="kobo.920.2">In our case, we used a relative URL since the preceding HTML/JavaScript code is hosted in the same server as the server code; if this wasn’t the case, we </span><a id="_idIndexMarker135"/><span class="koboSpan" id="kobo.921.1">would have needed to use a </span><span class="No-Break"><span class="koboSpan" id="kobo.922.1">complete URL.</span></span></p>
<p><span class="koboSpan" id="kobo.923.1">We implement the functionality to be executed when the client receives an event by adding an event listener to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.924.1">EventSource</span></strong><span class="koboSpan" id="kobo.925.1"> instance via its </span><strong class="source-inline"><span class="koboSpan" id="kobo.926.1">addEventListener()</span></strong><span class="koboSpan" id="kobo.927.1"> function. </span><span class="koboSpan" id="kobo.927.2">This function takes the event name (notice that the value matches the name we sent in the Java code for our RESTful web service), and a function to be executed when an event is received. </span><span class="koboSpan" id="kobo.927.3">In our example, we simply update the contents of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.928.1">&lt;span&gt;</span></strong><span class="koboSpan" id="kobo.929.1"> tag with the data of the </span><span class="No-Break"><span class="koboSpan" id="kobo.930.1">received message.</span></span></p>
<h1 id="_idParaDest-50"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.931.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.932.1">In this chapter, we discussed how to easily develop RESTful web services using </span><span class="No-Break"><span class="koboSpan" id="kobo.933.1">Jakarta REST.</span></span></p>
<p><span class="koboSpan" id="kobo.934.1">We covered the </span><span class="No-Break"><span class="koboSpan" id="kobo.935.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.936.1">How to develop a RESTful web service by adding a few simple annotations to </span><span class="No-Break"><span class="koboSpan" id="kobo.937.1">our code</span></span></li>
<li><span class="koboSpan" id="kobo.938.1">How to automatically generate </span><span class="No-Break"><span class="koboSpan" id="kobo.939.1">JSON data</span></span></li>
<li><span class="koboSpan" id="kobo.940.1">How to automatically parse JSON data it receives as </span><span class="No-Break"><span class="koboSpan" id="kobo.941.1">a request</span></span></li>
<li><span class="koboSpan" id="kobo.942.1">How to pass parameters to our RESTful web services via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.943.1">@PathParam</span></strong><span class="koboSpan" id="kobo.944.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.945.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.946.1">QueryParam</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.947.1"> annotations</span></span></li>
<li><span class="koboSpan" id="kobo.948.1">How to implement server-sent events and server-sent </span><span class="No-Break"><span class="koboSpan" id="kobo.949.1">event clients</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.950.1">RESTful web services have become immensely popular in recent years; they are now the preferred way of developing web applications and are also heavily used when developing applications utilizing a microservices architecture. </span><span class="koboSpan" id="kobo.950.2">As seen in this chapter, Jakarta EE allows us to implement RESTful web services by adding a few simple annotations to our </span><span class="No-Break"><span class="koboSpan" id="kobo.951.1">Java classes.</span></span></p>
</div>
</body></html>