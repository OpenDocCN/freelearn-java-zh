<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Writing Feature Files" id="aid-E9OE1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Writing Feature Files</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Writing your first Feature file with one Scenario</li><li class="listitem">Creating Scenarios with different Steps</li><li class="listitem">Creating a Scenario with the And and But keywords</li><li class="listitem">Writing a Feature file with multiple Scenarios</li><li class="listitem">Adding Background to Feature files</li><li class="listitem">Sending multiple arguments in Steps</li><li class="listitem">Using complex data types to store data</li><li class="listitem">Implementing Scenario Outlines</li><li class="listitem">Creating a Feature file in a language other than English</li><li class="listitem">Combining Scenarios, Background, and Scenario Outlines</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Introduction</h1></div></div></div><p>In Cucumber Framework, business requirements are specified in Feature files, which are written in the Gherkin Language. So it becomes very important for us to understand the power and usage of the Gherkin language to come up with efficient and optimized Feature files. <a id="id0" class="indexterm"/>
<a id="id1" class="indexterm"/>
</p><p>This chapter will cover the usage of the Gherkin language to write meaningful and smart Feature files. We will start with some simple recipes to create a Feature file with one Scenario and will gradually move to recipes that are more complex where we create Feature files with multiple Scenarios, Backgrounds, and Scenario Outlines. We will also cover concepts and keywords, such as Feature, Scenario, Steps, Background, Scenario Outline and Data Tables.</p><div class="note" title="Note"><h3 class="title"><a id="note02"/>Note</h3><p>In this chapter, we will only focus on Feature files. Step Definitions and automation libraries will be covered in later chapters. Initially, you may not understand everything about the concepts in this chapter, but things will become clearer as you read on.</p></div></div></div>
<div class="section" title="Writing your first Feature file with one Scenario" id="aid-F8901"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Writing your first Feature file with one Scenario</h1></div></div></div><p>Let's assume you are a <span class="strong"><strong>Product Owner</strong></span> (<span class="strong"><strong>PO</strong></span>) or a <span class="strong"><strong>Business Analyst</strong></span> (<span class="strong"><strong>BA</strong></span>). Your team is creating a web<a id="id2" class="indexterm"/> application and you need to write specifications for that application. A very simple and basic specification for that web application is<a id="id3" class="indexterm"/> when we enter the URL of that application in a browser, the application should load. So how do we write this specification in Cucumber? We <a id="id4" class="indexterm"/>will be covering this in this recipe.</p><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>How to do it…</h2></div></div></div><p>In this recipe, we are going to create a simple Feature file with only one Scenario that tests whether the web page has loaded or not.</p><p>Let's create a <code class="literal">page_load.feature</code> file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>  Feature:</strong></span> Test Git web Application
  In order to Test Git web Application
  As a user
  I want to specify the application flow

  <span class="strong"><strong>Scenario:</strong></span> Web Site loads
  application page load should be quick
  
  <span class="strong"><strong>Given</strong></span> application URL is ready with the user
  <span class="strong"><strong>When</strong></span> user enters the URL in browser
  <span class="strong"><strong>Then</strong></span> application page loads</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>How it works…</h2></div></div></div><p>In Cucumber we write our requirements in plain English like Language, <span class="strong"><strong>Gherkin</strong></span>. Gherkin is a domain-specific language that has a very well-defined syntax. It works on the basis of some predefined <a id="id5" class="indexterm"/>
<span class="strong"><strong>keywords</strong></span>. In the preceding example, the highlighted portions of the text are Gherkin's keywords and the rest is dependent on the application under test.</p><p>Let's understand each keyword in more detail.</p><div class="section" title="Feature"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec01"/>Feature</h3></div></div></div><a id="id6" class="indexterm"/><p>In Cucumber, Feature files contain business requirements. The text that immediately follows the Feature keyword, and is in the same line, is the Title of the Feature file. Three (optional) Text lines that follow the Feature keyword line are Intent of the Feature file and intent text is whatever we want to write, up until the first Scenario. Feature file should contain either Scenario or Scenario Outline. The naming conventions for Feature files should be<a id="id7" class="indexterm"/> lowercase with<a id="id8" class="indexterm"/> underscores, for example, <code class="literal">login.feature</code> and <code class="literal">home_page.feature</code>. The names of Scenarios and Feature files must be unique.</p></div><div class="section" title="Scenarios"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec02"/>Scenarios</h3></div></div></div><p>Scenarios are like test cases and start with the Scenario keyword in a new line (different from the Feature intent). The text that immediately follows the Scenario keyword, and is on the same line, is the <a id="id9" class="indexterm"/>
<span class="strong"><strong>Scenario Title</strong></span>. Three (optional) Text lines that follow the Scenario keyword line are <span class="strong"><strong>Intent</strong></span> of the Scenario. All Scenarios perform following:<a id="id10" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Get the system into a particular state</li><li class="listitem">Poke it (perform some action)</li><li class="listitem">Examine the new state</li></ul></div></div><div class="section" title="Steps"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec03"/>Steps</h3></div></div></div><p>Scenarios contain Steps which are equivalent to<a id="id11" class="indexterm"/> test Steps and use the following keywords to denote them: Given, When, Then, But, and And (case sensitive).</p><div class="note" title="Note"><h3 class="title"><a id="note03"/>Note</h3><p>When you save the Feature files mentioned in this chapter and run them, in the first run, Cucumber is going to give errors for the missing Step Definition files, along with suggestions for Step Definitions. To resolve these errors, copy the suggestions given by Cucumber and paste them into a default Step Definition file.</p></div></div></div></div>
<div class="section" title="Creating Scenarios with different Steps" id="aid-G6PI1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Creating Scenarios with different Steps</h1></div></div></div><p>When we specify a business requirement, we need<a id="id12" class="indexterm"/> to specify the pre-conditions, user actions, and expected output. Let's first understand what each of these mean:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Pre-condition</strong></span>: This sets the <span class="strong"><strong>Application Under Test</strong></span> (<span class="strong"><strong>AUT</strong></span>) in a state where the test case can be<a id="id13" class="indexterm"/> executed, or establishing the application context.</li><li class="listitem"><span class="strong"><strong>User action</strong></span>: This refers to<a id="id14" class="indexterm"/> the action that a user performs that is in line with the Scenario objective.</li><li class="listitem"><span class="strong"><strong>Expected output</strong></span>: This refers<a id="id15" class="indexterm"/> to the application's response after the user action.</li></ul></div><p>So let's have this specification written in Cucumber in this recipe.</p><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>How to do it…</h2></div></div></div><p>In this recipe, we are going to update the Feature file we created in the previous recipe by using the keywords <code class="literal">Given</code>, <code class="literal">When</code> and <code class="literal">Then</code>
</p><div class="informalexample"><pre class="programlisting">Feature: login Page
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: checking pre-condition, action and results
    <span class="strong"><strong>Given</strong></span> user is on Application landing page
    <span class="strong"><strong>When</strong></span> user clicks Sign in button
    <span class="strong"><strong>Then</strong></span> user is on login screen</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>How it works…</h2></div></div></div><p>A Cucumber Scenario consists of Steps identified with keywords such as Given, When, Then, And, But, and so on. These have been defined as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Given</strong></span>: Preconditions are<a id="id16" class="indexterm"/> mentioned in the <code class="literal">Given</code> keyword. The Steps of the Given keyword put the system in to a known state, which is necessary for the user action. Avoid talking about user interaction in Given Steps.</li><li class="listitem"><span class="strong"><strong>When</strong></span>: The purpose <a id="id17" class="indexterm"/>of the <code class="literal">When</code> Steps is to describe the user action.</li><li class="listitem"><span class="strong"><strong>Then</strong></span>: The purpose <a id="id18" class="indexterm"/>of <code class="literal">Then</code> Steps is to observe the expected output. The observations should be related to the business value/benefit of your Feature description.</li></ul></div></div></div>
<div class="section" title="Creating a Scenario with the And and But keywords" id="aid-H5A41"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Creating a Scenario with the And and But keywords</h1></div></div></div><p>When we specify a business requirement, sometimes there are multiple pre-conditions, user actions, and expected outcomes. So how do we write these specifications in Cucumber?<a id="id19" class="indexterm"/> <a id="id20" class="indexterm"/> <a id="id21" class="indexterm"/>
<a id="id22" class="indexterm"/> </p><div class="section" title="Getting ready…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>Getting ready…</h2></div></div></div><p>Based on what we have learned so far we know how to create Scenarios with one Given, When, and Then keyword. Now, if we<a id="id23" class="indexterm"/> need to add multiple <span class="strong"><strong>Steps</strong></span>, then we can update our Feature file like this:</p><div class="informalexample"><pre class="programlisting">Feature: login Page
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: without and &amp; but
    <span class="strong"><strong>Given</strong></span> user is on Application landing page
    <span class="strong"><strong>Given</strong></span> Sign in button is present on screen
    <span class="strong"><strong>When</strong></span> user clicks on Sign in button
    <span class="strong"><strong>Then</strong></span> user can see login screen
    <span class="strong"><strong>When</strong></span> user enters "ShankarGarg" in username field
    <span class="strong"><strong>When</strong></span> user enters "123456" in password field
    <span class="strong"><strong>When</strong></span> user clicks Sign in button
    <span class="strong"><strong>Then</strong></span> user is on home page
    <span class="strong"><strong>Then</strong></span> title of home page is "GitHub"</pre></div><p>The problem here is that the keywords <code class="literal">Given</code>, <code class="literal">When</code>, and <code class="literal">Then</code> are repeated and the readability is thus<a id="id24" class="indexterm"/> affected. Having readable Feature files is one of biggest advantages of Cucumber. So<a id="id25" class="indexterm"/> how do we maintain the readability of Feature files? Let's figure this out in this recipe.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>How to do it…</h2></div></div></div><p>In this recipe, we are going<a id="id26" class="indexterm"/> to add one more Scenario and will use the <code class="literal">And</code> and <code class="literal">But</code> keywords:</p><div class="informalexample"><pre class="programlisting">Feature: login Page
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: with and &amp; but
    Given user is on Application landing page
    <span class="strong"><strong>And</strong></span> Sign in button is present on screen
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "ShankarGarg" in username field
    <span class="strong"><strong>And</strong></span> user enters "123456" in password field
    <span class="strong"><strong>And</strong></span> user clicks Sign in button
    Then user is on home page
    <span class="strong"><strong>And</strong></span> title of home page is "GitHub"
    <span class="strong"><strong>But</strong></span> Sign in button is not present</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec18"/>How it works…</h2></div></div></div><p>The <code class="literal">And</code> and <code class="literal">But</code> keywords<a id="id27" class="indexterm"/> will be useful here. These keywords help to increase the expressiveness <a id="id28" class="indexterm"/>and readability of the Feature file:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>And</strong></span>: This is used for statements that are an addition to the previous Steps and represent positives<a id="id29" class="indexterm"/> statements.</li><li class="listitem"><span class="strong"><strong>But</strong></span>: This is used for<a id="id30" class="indexterm"/> statements that are an addition to previous Steps and represent negative statements.</li></ul></div><div class="note" title="Note"><h3 class="title"><a id="note04"/>Note</h3><p>In a Step Definitions file, <code class="literal">And</code> and <code class="literal">But</code> are listed as Given/When/Then, the keyword that they appear after. There are no <code class="literal">And</code> and <code class="literal">But</code> keywords in Step Definitions.</p></div></div></div>
<div class="section" title="Writing a Feature file with multiple Scenarios" id="aid-I3QM1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Writing a Feature file with multiple Scenarios</h1></div></div></div><a id="id31" class="indexterm"/><p>Feature files contain possible Scenarios for a particular functionality. This is like writing all possible requirements that a Feature should meet when it is implemented. So let's write these specifications in Cucumber in the following section.</p><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec19"/>How to do it…</h2></div></div></div><p>We will create a new Feature file called <code class="literal">home_page.feature</code>, which will cover the functionality of the default content of <a class="ulink" href="https://github.com/">https://github.com/</a>, the <span class="strong"><strong>Bootcamp</strong></span> section, and the top banner content. We will create a different Scenario for each functionality. Take a look at the following screenshot for more clarity:</p><div class="mediaobject"><img src="../Images/image00123.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p><div class="informalexample"><pre class="programlisting">Feature: Home Page
  In order to test Home Page of application
  As a Registered user
  I want to specify the features of home page

  Scenario: Home Page Default content
    Given user is on Github home page
    Then user gets a GitHub bootcamp section
    And username is also displayed on right corner

  Scenario: GitHub Bootcamp Section
    Given user is on GitHub home page
    When user focuses on GitHub Bootcamp Section
    Then user gets an option to setup git
    And user gets an option to create repository
    And user gets an option to Fork Repository
    And user gets an option to work together

  Scenario: Top Banner content
    Given user is on GitHub home page
    When user focuses on Top Banner
    Then user gets an option of home page
    And user gets an option to search
    And user gets settings options
    And user gets an option to logout</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec20"/>How it works…</h2></div></div></div><p>A Cucumber<a id="id32" class="indexterm"/> Feature file can have any number of Scenarios as required. Some points to keep in mind are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">One Feature file normally focuses on one functionality of the application, such as login page, home page, and so on.</li><li class="listitem">One Scenario refers to one sub-Feature of that functionality, such as the new customer page, delete customer page, and so on.</li></ul></div><p>When we have multiple Scenarios in a Feature file, we should always follow the Stateless Scenarios Guideline. Let's understand this guideline better—each Scenario must make sense and should be executed independently of any other Scenario. The result of one Scenario/Feature should not affect the other Scenario.</p><p>These are the benefits <a id="id33" class="indexterm"/>of independent Scenarios:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Feature files are easier and fun to understand</li><li class="listitem">You can only run a subset of Scenarios, as all the required Steps of a Scenario are mentioned in the Scenario itself</li><li class="listitem">In comparison to dependent Scenarios, independent Scenarios will be more eligible candidates for <span class="emphasis"><em>parallel execution</em></span><div class="note" title="Note"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a> for all the Packt Publishing books you have purchased. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></li></ul></div></div></div>
<div class="section" title="Adding Backgrounds to Feature files" id="aid-J2B81"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Adding Backgrounds to Feature files</h1></div></div></div><a id="id34" class="indexterm"/><p>When we write Feature files, we write multiple Scenarios. Now all of these Scenarios start from one particular point. If I'm writing home page Scenarios, then I need to start the flow from the login functionality. So it is better to write the repetitive Steps at one place rather than in all Scenarios. Let's understand how to do this in the next Section.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec21"/>Getting ready</h2></div></div></div><p>Based on what we have learned so far, this is what our Feature file will look like:</p><div class="informalexample"><pre class="programlisting">Feature: Home Page
  In order to test Home Page of application
  As a Registered user
  I want to specify the features of home page

  Scenario: Home Page Default content
    Given a registered user exists
    Given user is on GitHub login page
    When user enters username
    And user enters password
    And user clicks on login button
    Then user is on Application home page
    And user gets a GitHub bootcamp section

  Scenario: GitHub Bootcamp Section
    Given user is on GitHub loginpage
    When user enters username
    And user enters password
    And user clicks on login button
    Then user is on Application home page
    When user focuses on GitHub Bootcamp Section
    Then user gets an option to setup git

  Scenario: Top Banner content
    Given user is on GitHub login page
    When user enters username
    And user enters password
    And user clicks on login button
    Then user is on Application home page
    When user focuses on Top Banner
    Then user gets a logout option</pre></div><p>The problem <a id="id35" class="indexterm"/>here is that first five statements are repeated in all the Scenarios. This affects the readability of the Feature files, and there is a lot of duplicated effort.</p><p>The problems with this way of writing<a id="id36" class="indexterm"/> Feature files are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Repetition</strong></span>: Many statements<a id="id37" class="indexterm"/> are repeated in all the Scenarios</li><li class="listitem"><span class="strong"><strong>Readability</strong></span>: The readability <a id="id38" class="indexterm"/>of the Feature files is affected.</li><li class="listitem"><span class="strong"><strong>Duplication</strong></span>: <a id="id39" class="indexterm"/>Copying these Steps to all the Scenarios is redundant.</li><li class="listitem"><span class="strong"><strong>Maintainability</strong></span>: Even if a single <a id="id40" class="indexterm"/>Step changes, we have to change all occurrences.</li></ul></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec22"/>How to do it…</h2></div></div></div><p>We are going to update the <code class="literal">home_page.feature</code> file and we are going to use the <code class="literal">Background</code> keyword to put the common Steps across all the Scenarios in one place:</p><div class="informalexample"><pre class="programlisting">Feature: Home Page
  In order to test Home Page of application
  As a Registered user
  I want to specify the features of home page

<span class="strong"><strong>  Background: flow till home page</strong></span>
<span class="strong"><strong>    Given user is on Application home page</strong></span>
<span class="strong"><strong>    When user enters username</strong></span>
<span class="strong"><strong>    And user enters password</strong></span>
<span class="strong"><strong>    And user clicks on login button</strong></span>
<span class="strong"><strong>    Then user is on Application home page</strong></span>

  Scenario: Home Page Default content
    Then user gets a GitHub bootcamp section

  Scenario: GitHub Bootcamp Section
    When user focuses on GitHub Bootcamp Section
    Then user gets an option to setup git

  Scenario: Top Banner content
    When user focuses on Top Banner
    Then user gets an option of home page</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec23"/>How it works…</h2></div></div></div><p>Here, we have <a id="id41" class="indexterm"/>used the Background keyword. All the Steps mentioned in the Background keyword will be executed before each Scenario or Scenario Outline in a Feature file. Let's understand this keyword in greater detail:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">There can be only one Background in one Feature file and it allows us to set a precondition for all Scenarios in a Feature file.</li><li class="listitem">A Background is like a Scenario, containing a number of Steps.</li><li class="listitem">Background is run before each Scenario, but after the <span class="strong"><strong>BeforeScenario</strong></span> Hooks. (We will read about Hooks in <a class="link" title="Chapter 3. Enabling Fixtures" href="part0036.xhtml#aid-12AK81">Chapter 3</a>, <span class="emphasis"><em>Enabling Fixtures</em></span>).</li><li class="listitem">The title and multiline description / intent of Background are optional.</li><li class="listitem">Since the Steps mentioned in Background will be run for all Scenarios in a Feature file, we need to be careful when adding the Steps to Background. For example, we should not add a Step that is not common to all Scenarios.</li></ul></div><p>This is what the output of the preceding file looks like:</p><div class="mediaobject"><img src="../Images/image00124.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>Don't use<a id="id42" class="indexterm"/> <code class="literal">Background</code> to set up a complicated state unless that state is actually something the client needs to know.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Keep your <code class="literal">Background</code> section short because you expect a person to remember these Steps when you are adding a new Scenario</li><li class="listitem">Make your <code class="literal">Background</code> section vivid, because that way it will be easier for a person to remember it</li></ul></div></div></div>
<div class="section" title="Sending multiple arguments in Steps" id="aid-K0RQ1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Sending multiple arguments in Steps</h1></div></div></div><p>When we talk <a id="id43" class="indexterm"/>about testing, data-driven testing is a very famous approach. Until now, we have focused on what our Steps intend to do. The questions that now come to mind are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Can our Steps also send test data?</li><li class="listitem">What kind of test data can our Steps send?</li><li class="listitem">Can we send mixed data types in one single Step?</li></ul></div><p>Put on a BA's shoes and let's write some Scenarios for the GitHub user registration page and login functionality.</p><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec24"/>How to do it…</h2></div></div></div><p>We are going<a id="id44" class="indexterm"/> to update the <code class="literal">login.feature</code> file and add two Scenarios, where we are going to pass arguments in Steps:</p><div class="informalexample"><pre class="programlisting">Feature: login Page
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: New User Registration
    Given user is on Application landing page
    When user enters "ShankarGarg" in username field
    And user enters "sgarg@gmail.com" in password field
    And user enters "123456" in password field
    And user clicks on Signup for GitHub button
    Then user is successfully registered

  Scenario: login
    Given user is on Application landing page
    And Sign in button is present on screen
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "ShankarGarg" in username field
    And user enters "123456" in password field
    And user clicks Sign in button
    Then user is on home page
    And title of home page is "GitHub"</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec25"/>How it works…</h2></div></div></div><p>In the preceding Feature file, focus on the text written in <code class="literal">" "</code>. This is our test data. The text mentioned in between <code class="literal">" "</code> in Steps is associated to Capture groups in Step Definition files.</p><p>An example of Step Definition for one of the Steps is:</p><div class="informalexample"><pre class="programlisting">@When("^user enters \"(.*?)\" in username field$")
  public void user_enters_in_username_field(String userName) {
      //print the value of data passed from Feature file
      System.out.println(userName);
  }</pre></div><p>The output of the preceding <code class="literal">System.out.println</code> will be <code class="literal">ShankarGarg</code> (test data that we have passed in<a id="id45" class="indexterm"/> the Feature file).</p><div class="note" title="Note"><h3 class="title"><a id="note05"/>Note</h3><p>Now, since you have learned how to pass test data in Steps, try your hand at the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Send String and integer data in the same Step.</li><li class="listitem">Send a List in a Step; for example: "Monday, Tuesday, Wednesday".</li></ul></div></div></div></div>
<div class="section" title="Using complex data types to store data" id="aid-KVCC1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Using complex data types to store data</h1></div></div></div><p>In the previous recipe, we learnt how we can send data in Steps, which can be used by the application for<a id="id46" class="indexterm"/> processing. The data that we have sent up to this point has been <a id="id47" class="indexterm"/>either Strings or integers. But what if we want to send data structures that are more complex and span across multiple lines?</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec26"/>Getting ready</h2></div></div></div><p>Let's write a Scenario for this functionality—we want to verify whether various users exist or not:</p><div class="informalexample"><pre class="programlisting">Scenario: Existing user Verification
    Given user is on Application landing page
    Then we verify user "Shankar" with password "P@ssword123", phone "999" exists
    Then we verify user "Ram" with password "P@ssword456", phone " 888" exists
    Then we verify user "Sham" with password "P@ssword789", phone "666" exists</pre></div><p>The problem with this approach of writing Feature files is that Feature files are not expressive enough and there is a lot of repetition.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec27"/>How to do it…</h2></div></div></div><p>We are going to add one more Scenario to the <code class="literal">login.feature</code> file, and we are going to use Data Table to send a large set of test data along a Step:</p><div class="informalexample"><pre class="programlisting">Scenario: Existing user Verification
 
Given user is on Application landing page
<span class="strong"><strong>    Then we verify following user exists</strong></span>
<span class="strong"><strong>      | name    | email           | phone |</strong></span>
<span class="strong"><strong>      | Shankar | sgarg@email.com | 999   |</strong></span>
<span class="strong"><strong>      | Ram     | ram@email.com   | 888   |</strong></span>
<span class="strong"><strong>      | Sham    | sham@email.org  | 666   |</strong></span>
</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec28"/>How it works…</h2></div></div></div><p>Here we have used Data Tables. Tables as arguments to Steps are handy for specifying larger datasets. Let's understand Data Tables in more detail:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Tables as arguments to Steps are handy to specify larger datasets.</li><li class="listitem">The first row of a Data Table is always the header row, where we specify the headers for each column. All the other rows in a Data Table are data rows, which contain the actual data that will be used by the application.</li><li class="listitem">Data tables will be passed to the Step Definition as the last argument.</li><li class="listitem">Don't confuse<a id="id48" class="indexterm"/> Data Tables with Scenario Outline tables.</li><li class="listitem">Data tables are very easy to handle in Step Definition files as well. This is what a sample Step Definition code looks like:<div class="informalexample"><pre class="programlisting">@Then("^we verify following user exists$")
public void we_verify_following_user_exists(DataTable userDetails){
  //Write the code to handle Data Table
  List&lt;List&lt;String&gt;&gt; data = userdetails.raw();
  System.out.println(data.get(1).get(1));
}</pre></div></li></ul></div><p>In the preceding<a id="id49" class="indexterm"/> code sample, the Data Table has been converted into a List of String and can be handled very easily thereafter.</p><div class="note" title="Note"><h3 class="title"><a id="note06"/>Note</h3><p>Data table transformation has been explained in detail in the Transforming Data Tables to parse test data recipe in <a class="link" title="Chapter 2. Creating Step Definitions" href="part0026.xhtml#aid-OPEK1">Chapter 2</a>, <span class="emphasis"><em>Creating Step Definitions</em></span>.</p></div></div></div>
<div class="section" title="Implementing Scenario Outlines" id="aid-LTSU1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Implementing Scenario Outlines</h1></div></div></div><p>In the previous recipe, we learnt how <a id="id50" class="indexterm"/>we can send test data in Steps itself, which can be used by the application for processing. Until now, the data was associated with one particular Step (implemented by Data Tables); but what if I want to send data which is related to the whole Scenario, and what if I want to repeat all the Steps of a Scenario again and again for different sets of data? This is a classic case of data-driven testing. This will be implemented by using a Scenario Outline.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec29"/>Getting ready</h2></div></div></div><p>Let's create a Scenario for a login functionality where we want to test all the possible Scenarios where<a id="id51" class="indexterm"/> the login will fail. Based on what we have learned so far, this is how our Scenario will look:</p><div class="informalexample"><pre class="programlisting">  Scenario: login fail - wrong username
    Given user is on Application landing page
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "wrongusername" in username field
    And user enters "123456" in password field
    And user clicks Sign in button
    Then user gets login failed error message

  Scenario: login fail - wrong password
    Given user is on Application landing page
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "ShankarGarg" in username field
    And user enters "wrongpassword" in password field
    And user clicks Sign in button
    Then user gets login failed error message</pre></div><p>In terms of syntax, there is no problem in this code. Cucumber will treat it as well as any other, but the problem is for the person writing the Feature file. If you look closely, only the dataset is changing and all the other Steps are the same. These are the following problems with this approach to creating Feature files:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Copying and pasting Scenarios to use different values can quickly become tedious and repetitive.</li><li class="listitem">If tomorrow only one Step changes, it has to be changed in all the Scenarios. So, maintainability and reusability are big issues.</li></ul></div><p>To avoid these problems, let's look at the next section and understand how we can solve them.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec30"/>How to do it…</h2></div></div></div><p>Here, we are going to use the <code class="literal">Scenario Outline</code> keyword and add one Scenario Outline to test possible login Scenarios:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Scenario Outline: Login fail - possible combinations</strong></span>
    Given user is on Application landing page
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "&lt;UserName&gt;" in username field
    And user enters "&lt;Password&gt;" in password field
    And user clicks Sign in button
<span class="strong"><strong>    Then user gets login failed error message</strong></span>

<span class="strong"><strong>    Examples: </strong></span>
<span class="strong"><strong>      | UserName      | Password      |</strong></span>
<span class="strong"><strong>      | wrongusername | 123456        |</strong></span>
<span class="strong"><strong>      | ShankarGarg   | wrongpassword |</strong></span>
<span class="strong"><strong>      | wrongusername | wrongpassword |</strong></span>
</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec31"/>How it works…</h2></div></div></div><p>Here we have<a id="id52" class="indexterm"/> used the <code class="literal">Scenario Outline</code> keyword and we have merged all three Scenarios in to one Scenario Outline. One advantage of the Scenario Outline is that our Feature file is now compact and expressive. Let's understand Scenario Outline in more detail:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Scenario Outline allow us to send test data to Scenarios through the use of a template with placeholders.</li><li class="listitem">A Scenario Outline is run once for each row in the Examples section beneath it (not counting the first row of column headers).</li><li class="listitem">A Scenario Outline is a template that is never directly run. It uses placeholders, which are contained within <code class="literal">&lt; &gt;</code> in the Scenario Outline's Steps.</li><li class="listitem">Think of a placeholder like a variable. It is replaced with a real value from the <code class="literal">Examples</code> table row, where the text between the placeholder's angle brackets matches that of the table column header. <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">In the first execution, when Cucumber encounters the first Step with placeholders, which is <code class="literal">When user enters &lt;UserName&gt; in username field</code> in our case, Cucumber looks for a column with the header <code class="literal">UserName</code> in the <code class="literal">Examples</code> table.</li><li class="listitem">If there is no column with <code class="literal">UserName</code> in the <code class="literal">Examples</code> table, then Cucumber does not give an error but instead considers <code class="literal">&lt;UserName&gt;</code> as a String and passes it to Step Definition as it is.</li><li class="listitem">If Cucumber finds a column with the header <code class="literal">UserName</code>, then it picks the first row data from this column and replaces <code class="literal">UserName</code> with that value, which is <code class="literal">wrongusername</code> in our case, and sends this value to Step Definition.</li><li class="listitem">Cucumber repeats this process for all <code class="literal">&lt; &gt;</code> for one round of execution.</li><li class="listitem">So, for the first execution, this is how our Scenario Outline will look:<div class="informalexample"><pre class="programlisting">Given user is on Application landing page
When user clicks on Sign in button
Then user is displayed login screen
When user enters "wrongusername" in username field
And user enters "123456" in password field
And user clicks Sign in button
Then user gets login failed error message</pre></div></li></ul></div></li><li class="listitem">The value substituted for the placeholder changes with each subsequent run of the Scenario Outline. The values from the second row are taken for the second execution and so on, until the end of the <code class="literal">Examples</code> table is reached.</li><li class="listitem">The Scenario <a id="id53" class="indexterm"/>Outline itself is useless without an <code class="literal">Examples</code> table, which Lists the rows of values to be substituted for each placeholder.<div class="note" title="Note"><h3 class="title"><a id="note07"/>Note</h3><p>Now that you have leaned the concept of Scenario Outline, try implementing the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Write a Scenario Outline with multiple arguments in one Step.</li><li class="listitem">Can you create a Scenario Outline with multiple examples? You can group examples of positive tests and negative tests in different tables.</li></ul></div></div></li></ul></div></div></div>
<div class="section" title="Creating a Feature file in a language other than English" id="aid-MSDG1"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Creating a Feature file in a language other than English</h1></div></div></div><p>Most of us have worked in<a id="id54" class="indexterm"/> teams spanning multiple geographies, and we would agree that some of us are more comfortable in native languages as compared to English. We are able to express ourselves better, and we are also able to express everything. So what if our BA or PO is more comfortable in Danish compared to English? Let's write the specification in a language other than English in Cucumber.</p><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec32"/>How to do it…</h2></div></div></div><p>This is a sample English Feature file, which we will convert into different languages.</p><div class="informalexample"><pre class="programlisting">Feature: sample application
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: sample scenario
    Given user is on application page
    When user clicks login button
    Then user is on home page</pre></div><p>To create the Feature file in Danish (<code class="literal">Danish.feature</code>):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># language: da</strong></span>
Egenskab: prøve ansøgning
     For at teste login side
     Som registreret bruger
     Jeg ønsker at angive login betingelser

  Scenarie: prøve scenario
    Givet brugeren er på ansøgning side
    Når brugeren klikker login knap
    Så Derefter bruger er på hjemmesiden</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec33"/>How it works…</h2></div></div></div><p>Cucumber allows us to<a id="id55" class="indexterm"/> write Feature files in around 40 spoken languages, thus empowering the teams whose first language is not English to write Feature files which are as robust as English language Feature files. The header <code class="literal"># language: da</code> in the first line of the Feature tells Cucumber what language will be used in the Feature file. By default, the language is English. If we want to write Feature files in another language, the Feature files must be saved with <code class="literal">"UTF-8" encoding</code>.</p><p>In a single project, we can have Feature files in multiple languages; but for one Feature file, only one language will work.</p><div class="note" title="Note"><h3 class="title"><a id="note08"/>Note</h3><p>For all languages, there is no difference in how Step definitions are generated.</p></div></div></div>
<div class="section" title="Combining Scenarios, Backgrounds, and Scenario Outlines" id="aid-NQU21"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec19"/>Combining Scenarios, Backgrounds, and Scenario Outlines</h1></div></div></div><p>Until now we have<a id="id56" class="indexterm"/> learned about Scenarios, Steps, Background, and <a id="id57" class="indexterm"/>Scenario Outline individually. But when a BA or a PO has to write the<a id="id58" class="indexterm"/> Feature file,<a id="id59" class="indexterm"/> they have to combine<a id="id60" class="indexterm"/> all these keywords to come up with a very <a id="id61" class="indexterm"/>efficient and expressive Feature file.</p><p>Consider writing a Feature file for a login functionality where the latter meets the following criteria:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">The user should get an option to log in from the application's home page</li><li class="listitem">To log in, a user should have a username and password</li><li class="listitem">After a successful login, the user should be redirected to the home page</li><li class="listitem">In case of an <a id="id62" class="indexterm"/>unsuccessful login, the user should get the appropriate message</li><li class="listitem">The user should <a id="id63" class="indexterm"/>also get an option to register new users on the home page</li><li class="listitem">The user should<a id="id64" class="indexterm"/> also be able to verify which users exist in the application (this Feature is not present on<a id="id65" class="indexterm"/> the GitHub landing page but has been added for to clarify concepts)<div class="note" title="Note"><h3 class="title"><a id="note09"/>Note</h3><p>All these requirements are specific to the behavior of the application, and none of them are concerned with how you implement these requirements.</p></div></li></ul></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec34"/>How to do it…</h2></div></div></div><p>Now we are<a id="id66" class="indexterm"/> going to use all the keywords we have<a id="id67" class="indexterm"/> explored until now, and we are going to create a <code class="literal">login.feature</code> file that specifies all the aforementioned <a id="id68" class="indexterm"/>requirements:</p><div class="informalexample"><pre class="programlisting">Feature: login Page
  In order to test login page
  As a Registered user
  I want to specify the login conditions

  Scenario: login flow
    Given user is on Application landing page
    And Sign in button is present on screen
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "ShankarGarg" in username field
    And user enters "123456" in password field
    And user clicks Sign in button
    Then user is on home page
    And title of home page is "GitHub"

  Scenario Outline: Login fail - possible combinations
    Given user is on Application landing page
    When user clicks on Sign in button
    Then user is displayed login screen
    When user enters "&lt;UserName&gt;" in username field
    And user enters "&lt;Password&gt;" in password field
    And user clicks Sign in button
    Then user gets login failed error message

    Examples: 
      | UserName      | Password      |
      | wrongusername | 123456        |
      | ShankarGarg   | wrongpassword |
      | wrongusername | wrongpassword |

  Scenario: Existing user Verification
    Given user is on Application landing page
    Then we verify following user exists
      | Name    | Email           | Phone |
      | Shankar | sgarg@email.com | 999   |
      | Ram     | ram@email.com   | 888   |
      | Sham    | sham@email.org  | 666   |

  Scenario: New User Registration
    Given user is on Application landing page
    When user enters "ShankarGarg" in username field
    And user enters "sgarg@gmail.com" in password field
    And user enters "123456" in password field
    And user clicks on Signup for GitHub button
    Then user is successfully registered</pre></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec35"/>How it works…</h2></div></div></div><p>Here we have<a id="id69" class="indexterm"/> combined all the keywords and<a id="id70" class="indexterm"/> concepts discussed until now in this chapter. Let's go through each requirement one<a id="id71" class="indexterm"/> by one and analyze how and with<a id="id72" class="indexterm"/> which keyword<a id="id73" class="indexterm"/> we specified these requirements:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">User should get an option to<a id="id74" class="indexterm"/> log in from the application home page—Scenario</li><li class="listitem">For login, a user should<a id="id75" class="indexterm"/> have a username and password—Scenario</li><li class="listitem">After successful login, the user should be redirected to the home page—Scenario</li><li class="listitem">In case of unsuccessful login, the user should get the appropriate message—Scenario Outline</li><li class="listitem">The user should<a id="id76" class="indexterm"/> also get an option to register new users on the home page—Scenario</li><li class="listitem">The user<a id="id77" class="indexterm"/> should also be able to verify which users<a id="id78" class="indexterm"/> exist in the application—Data Table</li></ul></div></div></div></body></html>