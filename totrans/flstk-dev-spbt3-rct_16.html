<html><head></head><body>
  <div id="_idContainer268" class="Basic-Text-Frame">
    <h1 class="chapterNumber">13</h1>
    <h1 id="_idParaDest-165" class="chapterTitle">Adding CRUD Functionalities</h1>
    <p class="normal">This chapter describes how we can implement <strong class="keyWord">Create</strong>, <strong class="keyWord">Read</strong>, <strong class="keyWord">Update</strong>, and <strong class="keyWord">Delete</strong> (<strong class="keyWord">CRUD</strong>) functionalities in our frontend. We are going to use the components that we learned about in <em class="chapterRef">Chapter 11</em>, <em class="italic">Useful Third-Party Components for React</em>. We will fetch data from our backend and present the data in a table. Then, we will implement the delete, edit, and create functionalities. In the final part of this chapter, we will add features so that we can export our data to a CSV file.</p>
    <p class="normal">In this chapter, we will cover the following topics:</p>
    <ul>
      <li class="bulletList">Creating the list page</li>
      <li class="bulletList">Adding the delete functionality</li>
      <li class="bulletList">Adding the add functionality</li>
      <li class="bulletList">Adding the edit functionality</li>
      <li class="bulletList">Exporting the data to CSV</li>
    </ul>
    <h1 id="_idParaDest-166" class="heading-1">Technical requirements</h1>
    <p class="normal">The Spring Boot <code class="inlineCode">cardatabase</code> application that we created in <em class="chapterRef">Chapter 12</em>, <em class="italic">Setting Up the Frontend for Our Spring Boot RESTful Web Service</em>, (the unsecured backend) is required, as is the React app that we created in the same chapter, <code class="inlineCode">carfront</code>.</p>
    <p class="normal">The following GitHub link will also be required: <a href="https://github.com/PacktPublishing/Full-Stack-Development-with-Spring-Boot-3-and-React-Fourth-Edition/tree/main/Chapter13"><span class="url">https://github.com/PacktPublishing/Full-Stack-Development-with-Spring-Boot-3-and-React-Fourth-Edition/tree/main/Chapter13</span></a>.</p>
    <h1 id="_idParaDest-167" class="heading-1">Creating the list page</h1>
    <p class="normal">In this first section, we will create the list page<a id="_idIndexMarker646"/> to show cars with paging, filtering, and sorting features:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Run your unsecured Spring Boot backend. The cars can be fetched by sending the <code class="inlineCode">GET</code> request to the <code class="inlineCode">http://localhost:8080/api/cars</code> URL, as shown in <em class="chapterRef">Chapter 4</em>, <em class="italic">Creating a RESTful Web Service with Spring Boot</em>. Now, let’s inspect the JSON data from the response. The array of cars can be found in the <code class="inlineCode">_embedded.cars</code> node of the JSON response data:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_01.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.1: Fetching cars</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Open the <code class="inlineCode">carfront</code> React app with Visual Studio Code (the React app we created in the previous chapter).</li>
      <li class="numberedList">We are using React Query for networking, so we have to initialize the query provider first.</li>
    </ol>
    <div class="note">
      <p class="normal">You learned the basics of React Query in <em class="chapterRef">Chapter 10</em>, <em class="italic">Consuming the REST API with React</em>.</p>
    </div>
    <p class="normal">The <code class="inlineCode">QueryClientProvider</code> component is used to connect and provide <code class="inlineCode">QueryClient</code> to your application. Open your <code class="inlineCode">App.tsx</code> file and add the highlighted imports<a id="_idIndexMarker647"/> and components to your <code class="inlineCode">App</code> component:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-title">AppBar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/AppBar'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Toolbar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Toolbar'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Typography</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Typography'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Container</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Container'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">CssBaseline</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/CssBaseline'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { </strong><strong class="hljs-title-slc">QueryClient</strong><strong class="hljs-slc">, </strong><strong class="hljs-title-slc">QueryClientProvider</strong><strong class="hljs-slc"> } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@tanstack/react-</strong></span>
  <span class="code-highlight"><strong class="hljs-string-slc">query'</strong><strong class="hljs-slc">;</strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> queryClient = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">QueryClient</strong><strong class="hljs-slc">();</strong></span>
<span class="hljs-keyword">function</span> <span class="hljs-title">App</span>() {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Container</span><span class="hljs-tag"> </span><span class="hljs-attr">maxWidth</span><span class="hljs-tag">=</span><span class="hljs-string">"xl"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">CssBaseline</span><span class="hljs-tag"> /&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">AppBar</span><span class="hljs-tag"> </span><span class="hljs-attr">position</span><span class="hljs-tag">=</span><span class="hljs-string">"static"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Toolbar</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Typography</span><span class="hljs-tag"> </span><span class="hljs-attr">variant</span><span class="hljs-tag">=</span><span class="hljs-string">"h6"</span><span class="hljs-tag">&gt;</span>
        Car Shop
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">Typography</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">Toolbar</span><span class="hljs-tag">&gt;</span>
     <span class="hljs-tag">&lt;/</span><span class="hljs-name">AppBar</span><span class="hljs-tag">&gt;</span>
     <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">QueryClientProvider</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">client</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{queryClient}</strong><strong class="hljs-tag-slc">&gt;</strong></span>
     <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">QueryClientProvider</strong><strong class="hljs-tag-slc">&gt;</strong></span>
   <span class="hljs-tag">&lt;/</span><span class="hljs-name">Container</span><span class="hljs-tag">&gt;</span>
  )
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">App</span>;
</code></pre>
    <p class="normal">Now, let’s fetch some cars.</p>
    <h2 id="_idParaDest-168" class="heading-2">Fetching data from the backend</h2>
    <p class="normal">Once we know how to fetch<a id="_idIndexMarker648"/> cars from the backend, we will be ready to implement<a id="_idIndexMarker649"/> the list page to show the cars. The following steps describe this in practice:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">When your app has multiple components, it is recommended that you create a folder for them. Create a new folder<a id="_idIndexMarker650"/> called <code class="inlineCode">components</code> in the <code class="inlineCode">src</code> folder. With Visual Studio Code, you can create a folder<a id="_idIndexMarker651"/> by right-clicking the folder in the sidebar file explorer and selecting <strong class="screenText">New Folder...</strong> from the menu:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_02.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.2: New folder</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Create a new file called <code class="inlineCode">Carlist.tsx</code> in the <code class="inlineCode">components</code> folder. Your project structure should look like the following:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_03.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.3: Project structure</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Open the <code class="inlineCode">Carlist.tsx</code> file in the editor view and write the base code of the component, as follows:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">Carlist</span>;
</code></pre>
      </li>
      <li class="numberedList">Now, when we are using<a id="_idIndexMarker652"/> TypeScript, we have to define the type for our car data. Let’s create a new file<a id="_idIndexMarker653"/> where we define our types. Create a file called <code class="inlineCode">types.ts</code> in the <code class="inlineCode">src</code> folder of your project. From the response, you can see that the car object looks like the following, and it contains all the car properties and also links:
        <pre class="programlisting code"><code class="hljs-code">{
    <span class="hljs-string">"</span><span class="hljs-string">brand"</span>: <span class="hljs-string">"Ford"</span>,
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"Mustang"</span>,
    <span class="hljs-string">"color"</span>: <span class="hljs-string">"Red"</span>,
    <span class="hljs-string">"registrationNumber"</span>: <span class="hljs-string">"ADF-1121"</span>,
    <span class="hljs-string">"modelYear"</span>: <span class="hljs-number">2023</span>,
    <span class="hljs-string">"</span><span class="hljs-string">price"</span>: <span class="hljs-number">59000</span>,
    <span class="hljs-string">"_links"</span>: {
      <span class="hljs-string">"self"</span>: {
         <span class="hljs-string">"href"</span>: <span class="hljs-string">"http</span> <span class="hljs-string">://localhost</span> <span class="hljs-string">:8080/api/cars/1"</span>
      },
      <span class="hljs-string">"car"</span>: {
         <span class="hljs-string">"href"</span>: <span class="hljs-string">"http</span> <span class="hljs-string">://localhost</span> <span class="hljs-string">:8080/api/cars/1"</span>
      },
      <span class="hljs-string">"owner"</span>: {
         <span class="hljs-string">"</span><span class="hljs-string">href"</span>: <span class="hljs-string">"http</span> <span class="hljs-string">://localhost</span> <span class="hljs-string">:8080/api/cars/1/owner"</span>
      }
    }
}
</code></pre>
      </li>
      <li class="numberedList">Create the following <code class="inlineCode">CarResponse</code> type in the <code class="inlineCode">types.ts</code> file and export it so that we can use it in files where it is needed:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title">CarResponse</span> = {
  <span class="hljs-attr">brand</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">registrationNumber</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">modelYear</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">price</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">_links</span>: {
    <span class="hljs-attr">self</span>: {
      <span class="hljs-attr">href</span>: <span class="hljs-built_in">string</span>;
    },
    <span class="hljs-attr">car</span>: {
      <span class="hljs-attr">href</span>: <span class="hljs-built_in">string</span>;
    },
    <span class="hljs-attr">owner</span>: {
      <span class="hljs-attr">href</span>: <span class="hljs-built_in">string</span>;
    }
  };
}
</code></pre>
      </li>
      <li class="numberedList">Next, we will create<a id="_idIndexMarker654"/> a function that fetches cars from our backend<a id="_idIndexMarker655"/> by sending a <code class="inlineCode">GET</code> request to the <code class="inlineCode">http://localhost:8080/api/cars</code> endpoint. The function returns a <strong class="keyWord">promise</strong> that contains an array<a id="_idIndexMarker656"/> of <code class="inlineCode">CarResponse</code> objects that we defined in our <code class="inlineCode">types.ts</code> file. We can use the <code class="inlineCode">Promise&lt;Type&gt;</code> generic, where <code class="inlineCode">Type</code> indicates the resolved value type of the promise. Open the <code class="inlineCode">Carlist.tsx</code> file and add the following imports and function:
        <pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { </strong><strong class="hljs-title-slc">CarResponse</strong><strong class="hljs-slc"> } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'../types'</strong><strong class="hljs-slc">;</strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> axios </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'axios'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> getCars = </strong><strong class="hljs-keyword-slc">async</strong><strong class="hljs-slc"> (): </strong><strong class="hljs-title-slc">Promise</strong><strong class="hljs-slc">&lt;</strong><strong class="hljs-title-slc">CarResponse</strong><strong class="hljs-slc">[]&gt; =&gt; {</strong></span>
    <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> response = </strong><strong class="hljs-keyword-slc">await</strong><strong class="hljs-slc"> axios.</strong><strong class="hljs-title-slc">get</strong><strong class="hljs-slc">(</strong><strong class="hljs-string-slc">"http</strong></span> <span class="code-highlight"><strong class="hljs-string-slc">://localhost</strong></span> <span class="code-highlight"><strong class="hljs-string-slc">:8080/api/</strong></span>
                                      <span class="code-highlight"><strong class="hljs-string-slc">cars"</strong><strong class="hljs-slc">);</strong></span>
    <span class="code-highlight"><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> response.</strong><strong class="hljs-property-slc">data</strong><strong class="hljs-slc">.</strong><strong class="hljs-property-slc">_embedded</strong><strong class="hljs-slc">.</strong><strong class="hljs-property-slc">cars</strong><strong class="hljs-slc">;</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">}</strong></span>
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">Carlist</span>;
</code></pre>
      </li>
      <li class="numberedList">Next, we will<a id="_idIndexMarker657"/> use the <code class="inlineCode">useQuery</code> hook<a id="_idIndexMarker658"/> to fetch cars:
        <pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { useQuery } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@tanstack/react-query'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">CarResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="hljs-keyword">const</span> getCars = <span class="hljs-keyword">async</span> (): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">CarResponse</span>[]&gt; =&gt; {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title">get</span>(<span class="hljs-string">"http</span> <span class="hljs-string">://localhost</span> <span class="hljs-string">:8080/api/</span>
<span class="hljs-string">                                      cars"</span>);
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>.<span class="hljs-property">_embedded</span>.<span class="hljs-property">cars</span>;
  }
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> { data, error, isSuccess } = </strong><strong class="hljs-title-slc">useQuery</strong><strong class="hljs-slc">({</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">queryKey</strong><strong class="hljs-slc">: [</strong><strong class="hljs-string-slc">"cars"</strong><strong class="hljs-slc">], </strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">queryFn</strong><strong class="hljs-slc">: getCars</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">});</strong></span>
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">Carlist</span>;
</code></pre>
    <div class="packt_tip">
      <p class="normal">The <code class="inlineCode">useQuery</code> hook uses TypeScript generics because it doesn’t fetch data and doesn’t know the type of your data. However, React Query can infer the type of the data, so we don’t have to do it manually here using generics. If you explicitly set generics, the code looks like this:</p>
      <pre class="programlisting code"><code class="hljs-code">useQuery&lt;CarResponse[], Error&gt;
</code></pre>
    </div>
      </li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">We will use <strong class="keyWord">conditional rendering</strong> to check if the fetch is successful and if there are any<a id="_idIndexMarker659"/> errors. If <code class="inlineCode">isSuccess</code> is <code class="inlineCode">false</code>, it means the data fetching is still in progress and, in this case, a loading message is returned. We also check if <code class="inlineCode">error</code> is <code class="inlineCode">true</code>, which indicates there’s an error, and an error message is returned. When data is available, we use the <code class="inlineCode">map</code> function to transform car objects into table rows in the <code class="inlineCode">return</code> statement and add the <code class="inlineCode">table</code> element:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">if</span> (!isSuccess) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Loading...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Error when fetching cars...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> {
  <span class="hljs-keyword">return</span> ( 
     <span class="hljs-tag">&lt;</span><span class="hljs-name">table</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">tbody</span><span class="hljs-tag">&gt;</span>
        {
         data.map((car: CarResponse) =&gt; 
            <span class="hljs-tag">&lt;</span><span class="hljs-name">tr</span><span class="hljs-tag"> </span><span class="hljs-attr">key</span><span class="hljs-tag">=</span><span class="hljs-string">{car._links.self.href}</span><span class="hljs-tag">&gt;</span>
              <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.brand}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
              <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.model}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
              <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.color}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
             <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.registrationNumber}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
             <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.modelYear}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
             <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.price}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;/</span><span class="hljs-name">tr</span><span class="hljs-tag">&gt;</span>)
          }
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">tbody</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">table</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
      </li>
      <li class="numberedList">Finally, we have to import <a id="_idIndexMarker660"/>and render the <code class="inlineCode">Carlist</code> component <a id="_idIndexMarker661"/>in our <code class="inlineCode">App.tsx</code> file. In the <code class="inlineCode">App.tsx</code> file, add the <code class="inlineCode">import</code> statement, and then render the <code class="inlineCode">Carlist</code> component inside the <code class="inlineCode">QueryClientProvider</code> component, as highlighted. <code class="inlineCode">QueryClientProvider</code> is a component that provides the React Query context to your components, and it should wrap the components where you are making REST API requests from:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-title">AppBar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/AppBar'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Toolbar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Toolbar'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Typography</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Typography'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Container</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Container'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">CssBaseline</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/CssBaseline'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title">QueryClient</span>, <span class="hljs-title">QueryClientProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-</span>
<span class="hljs-string">  query'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">Carlist</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'./components/Carlist'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">const</span> queryClient = <span class="hljs-keyword">new</span> <span class="hljs-title">QueryClient</span>();
<span class="hljs-keyword">function</span> <span class="hljs-title">App</span>() {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Container</span><span class="hljs-tag"> </span><span class="hljs-attr">maxWidth</span><span class="hljs-tag">=</span><span class="hljs-string">"xl"</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">CssBaseline</span><span class="hljs-tag"> /&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">AppBar</span><span class="hljs-tag"> </span><span class="hljs-attr">position</span><span class="hljs-tag">=</span><span class="hljs-string">"static"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Toolbar</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">Typography</span><span class="hljs-tag"> </span><span class="hljs-attr">variant</span><span class="hljs-tag">=</span><span class="hljs-string">"h6"</span><span class="hljs-tag">&gt;</span>
          Car shop
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">Typography</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">Toolbar</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">AppBar</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">QueryClientProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">client</span><span class="hljs-tag">=</span><span class="hljs-string">{queryClient}</span><span class="hljs-tag">&gt;</span>
        <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Carlist</strong><strong class="hljs-tag-slc"> /&gt;</strong></span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">QueryClientProvider</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">Container</span><span class="hljs-tag">&gt;</span>
  )
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">App</span>;
</code></pre>
      </li>
      <li class="numberedList">Now, if you start the React app<a id="_idIndexMarker662"/> using the <code class="inlineCode">npm run dev</code> command, you should<a id="_idIndexMarker663"/> see the following list page. Note that your backend should also be running:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_04.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.4: Car frontend</p>
    <h2 id="_idParaDest-169" class="heading-2">Using environment variables</h2>
    <p class="normal">Let’s do some code refactoring <a id="_idIndexMarker664"/>before we move on. The server URL can be repeated<a id="_idIndexMarker665"/> multiple times in the source code when we create more CRUD functionalities, and it will change when the backend is deployed to a server other than the local host; therefore, it is better to define it as an <strong class="keyWord">environment variable</strong>. Then, when the URL value changes, we only have to modify it in one place.</p>
    <p class="normal">When using Vite, environment variable names should start with the text <code class="inlineCode">VITE_</code>. Only variables prefixed with <code class="inlineCode">VITE_</code> are exposed to your source code:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Create a new <code class="inlineCode">.env</code> file in the root folder of our app. Open the file in the editor and add the following line to the file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-attr">VITE_API_URL</span>=http://localhost:<span class="hljs-number">8080</span>
</code></pre>
      </li>
      <li class="numberedList">We will also separate all API call functions into their own module. Create a new folder named <code class="inlineCode">api</code> in the <code class="inlineCode">src</code> folder of your project. Create a new file called <code class="inlineCode">carapi.ts</code> in the <code class="inlineCode">api</code> folder, and now your project structure should look like the following:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_05.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.5: Project structure</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Copy the <code class="inlineCode">getCars</code> function from the <code class="inlineCode">Carlist.tsx</code> file to the <code class="inlineCode">carapi.ts</code> file. Add <code class="inlineCode">export</code> at the beginning of the function so that we can use it in other components. In Vite, the environment variables<a id="_idIndexMarker666"/> are exposed to your app<a id="_idIndexMarker667"/> source code via <code class="inlineCode">import.meta.env</code> as strings. Then, we can import the server URL environment variable to our <code class="inlineCode">getCars</code> function and use it there. We also need to import <code class="inlineCode">axios</code> and the <code class="inlineCode">CarResponse</code> type into the <code class="inlineCode">carapi.ts</code> file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// carapi.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">CarResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">export</strong></span> <span class="hljs-keyword">const</span> getCars = <span class="hljs-keyword">async</span> (): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">CarResponse</span>[]&gt; =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title">get</span>(<span class="code-highlight"><strong class="hljs-string-slc">`</strong><strong class="hljs-subst-slc">${</strong><strong class="hljs-keyword-slc">import</strong><strong class="hljs-subst-slc">.meta.env.VITE_API_URL}</strong><strong class="hljs-string-slc">/</strong></span>
                                    <span class="code-highlight"><strong class="hljs-string-slc">api/cars`</strong></span>);
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>.<span class="hljs-property">_embedded</span>.<span class="hljs-property">cars</span>;
}
</code></pre>
      </li>
      <li class="numberedList">Now, we can remove the <code class="inlineCode">getCars</code> function and unused <code class="inlineCode">axios</code> import from the <code class="inlineCode">Carlist.tsx</code> file and import it from the <code class="inlineCode">carapi.ts</code> file. The source code should appear as follows:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-comment">// Remove getCars function and import it from carapi.ts</span>
<span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { getCars } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'../api/carapi'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="hljs-keyword">const</span> { data, error, isSuccess } = <span class="hljs-title">useQuery</span>({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"cars"</span>], 
    <span class="hljs-attr">queryFn</span>: getCars
  });
  <span class="hljs-keyword">if</span> (!isSuccess) {
    <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Loading...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Error when fetching cars...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-tag">&lt;</span><span class="hljs-name">table</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">tbody</span><span class="hljs-tag">&gt;</span>
        {
        data.map((car: CarResponse) =&gt; 
          <span class="hljs-tag">&lt;</span><span class="hljs-name">tr</span><span class="hljs-tag"> </span><span class="hljs-attr">key</span><span class="hljs-tag">=</span><span class="hljs-string">{car._links.self.href}</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.brand}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.model}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.color}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.registrationNumber}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.modelYear}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span>{car.price}<span class="hljs-tag">&lt;/</span><span class="hljs-name">td</span><span class="hljs-tag">&gt;</span> 
          <span class="hljs-tag">&lt;/</span><span class="hljs-name">tr</span><span class="hljs-tag">&gt;</span>)
        }
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">tbody</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">table</span><span class="hljs-tag">&gt;</span>
    );
    }
  }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">Carlist</span>;
</code></pre>
      </li>
    </ol>
    <p class="normal">After these<a id="_idIndexMarker668"/> refactoring<a id="_idIndexMarker669"/> steps, you should see the car list page like previously.</p>
    <h2 id="_idParaDest-170" class="heading-2">Adding paging, filtering, and sorting</h2>
    <p class="normal">We have already used<a id="_idIndexMarker670"/> the <code class="inlineCode">ag-grid</code> component to implement a data grid in <em class="chapterRef">Chapter 11</em>, <em class="italic">Useful Third-Party Components for React</em>, and it could<a id="_idIndexMarker671"/> be used here as well. Instead, we will<a id="_idIndexMarker672"/> use the new MUI <code class="inlineCode">DataGrid</code> component<a id="_idIndexMarker673"/> to get paging, filtering, and sorting<a id="_idIndexMarker674"/> features<a id="_idIndexMarker675"/> out of the box:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Stop the development server by pressing <em class="keystroke">Ctrl</em> + <em class="keystroke">C</em> in the terminal.</li>
      <li class="numberedList">We will install the MUI data grid community version. The following is the installation command at the time of writing, but you should check the latest installation command and usage from the MUI documentation:
        <pre class="programlisting con"><code class="hljs-con">npm install @mui/x-data-grid
</code></pre>
      </li>
      <li class="numberedList">After installation, restart the app.</li>
      <li class="numberedList">Import the <code class="inlineCode">DataGrid</code> component into your <code class="inlineCode">Carlist.tsx</code> file. We will also import <code class="inlineCode">GridColDef</code>, which is a type for the column definitions in the MUI data grid:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> { <span class="hljs-title">DataGrid</span>, <span class="hljs-title">GridColDef</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/x-data-grid'</span>;
</code></pre>
      </li>
      <li class="numberedList">The grid columns <a id="_idIndexMarker676"/>are defined in the <code class="inlineCode">columns</code> variable, which has the type <code class="inlineCode">GridColDef[]</code>. The column <code class="inlineCode">field</code> property defines where <a id="_idIndexMarker677"/>data in the columns is coming<a id="_idIndexMarker678"/> from; we are using<a id="_idIndexMarker679"/> our car object <a id="_idIndexMarker680"/>properties. The <code class="inlineCode">headerName</code> prop can be used to set the title of the columns. We will<a id="_idIndexMarker681"/> also set the width of the columns. Add the following column definition code inside the <code class="inlineCode">Carlist</code> component:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">const</span> <span class="hljs-attr">columns</span>: <span class="hljs-title">GridColDef</span>[] = [
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'brand'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'</span><span class="hljs-string">Brand'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'model'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'</span><span class="hljs-string">color'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Color'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'registrationNumber'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Reg.nr.'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'modelYear'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model Year'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'price'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'</span><span class="hljs-string">Price'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
];
</code></pre>
      </li>
      <li class="numberedList">Then, remove the <code class="inlineCode">table</code> and all its child elements from the component’s <code class="inlineCode">return</code> statement and add the <code class="inlineCode">DataGrid</code> component. Also remove the unused <code class="inlineCode">CarResponse</code> import that we used in the <code class="inlineCode">map</code> function. The data source of the data grid is the <code class="inlineCode">data</code>, which contains fetched cars and is defined using the <code class="inlineCode">rows</code> prop. The <code class="inlineCode">DataGrid</code> component requires all rows to have a unique ID property that is defined using the <code class="inlineCode">getRowId</code> prop. We can use the <code class="inlineCode">link</code> field of the car object because that contains the unique car ID (<code class="inlineCode">_links.self.href</code>). Refer to the source code of the following <code class="inlineCode">return</code> statement:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">if</span> (!isSuccess) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Loading...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Error when fetching cars...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> {
  <span class="hljs-keyword">return</span> (
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">DataGrid</strong></span>
      <span class="code-highlight"><strong class="hljs-attr-slc">rows</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{data}</strong></span>
      <span class="code-highlight"><strong class="hljs-attr-slc">columns</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{columns}</strong></span>
      <span class="code-highlight"><strong class="hljs-attr-slc">getRowId</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{row</strong><strong class="hljs-tag-slc"> =&gt;</strong><strong class="hljs-slc"> row._links.self.href}</strong></span>
    <span class="code-highlight"><strong class="hljs-slc">/&gt;</strong></span>
  );
}
</code></pre>
      </li>
    </ol>
    <p class="normal">With the MUI <code class="inlineCode">DataGrid</code> component, we implemented<a id="_idIndexMarker682"/> all the necessary features<a id="_idIndexMarker683"/> for our table <a id="_idIndexMarker684"/>with only a small<a id="_idIndexMarker685"/> amount of coding. Now, the list page<a id="_idIndexMarker686"/> looks like<a id="_idIndexMarker687"/> the following:</p>
    <figure class="mediaobject"><img src="../Images/B19818_13_06.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.6: Car frontend</p>
    <p class="normal">Data grid columns can be filtered using the column menu and clicking the <strong class="screenText">Filter</strong> menu item. You can also set the visibility of the columns from the column menu:</p>
    <figure class="mediaobject"><img src="../Images/B19818_13_07.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.7: Column menu</p>
    <p class="normal">Next, we will implement the delete functionality.</p>
    <h1 id="_idParaDest-171" class="heading-1">Adding the delete functionality</h1>
    <p class="normal">Items can be deleted<a id="_idIndexMarker688"/> from the database by sending the <code class="inlineCode">DELETE</code> method request to the <code class="inlineCode">http://localhost:8080/api/cars/{carId}</code> endpoint. If we look at the JSON response data, we can see that each car contains a link to itself, which can be accessed from the <code class="inlineCode">_links.self.href</code> node, as shown in the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B19818_13_08.jpg" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.8: Car link</p>
    <p class="normal">We already used the <code class="inlineCode">link</code> field<a id="_idIndexMarker689"/> in the previous section to set a unique ID for every row in the grid. That row ID can be used in deletion, as we will see later.</p>
    <p class="normal">The following steps demonstrate how to implement the delete functionality:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">First, we will create a button for each row in the MUI <code class="inlineCode">DataGrid</code>. When we need more complex cell content, we can use the <code class="inlineCode">renderCell</code> column property to define how a cell’s contents are rendered. 
    <p class="normal">Let’s add a new column to the table using <code class="inlineCode">renderCell</code> to render the <code class="inlineCode">button</code> element. The <code class="inlineCode">params</code> argument that is passed to the function is a row object that contains all values from a row. The type of <code class="inlineCode">params</code> is <code class="inlineCode">GridCellParams</code>, which is provided by MUI. In our case, it contains a link to a car in each row, and that is needed in the deletion. The link is in the row’s <code class="inlineCode">_links.self.href</code> property, and we will pass this value to a <code class="inlineCode">delete</code> function. Let’s first show an alert with the ID when a button is pressed to test that the button is working properly. Refer to the following source code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Import GridCellParams</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">DataGrid</span>, <span class="hljs-title">GridColDef</span>, <span class="code-highlight"><strong class="hljs-title-slc">GridCellParams</strong></span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/x-data-</span>
<span class="hljs-string">  grid'</span>;
<span class="hljs-comment">// Add delete button column to columns</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">columns</span>: <span class="hljs-title">GridColDef</span>[] = [
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'brand'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Brand'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'model'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'color'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Color'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'registrationNumber'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Reg.nr.'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'modelYear'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model Year'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'price'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Price'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  <span class="code-highlight"><strong class="hljs-slc">{</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">field</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">'delete'</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">headerName</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">width</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">90</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">sortable</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">filterable</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">disableColumnMenu</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">renderCell</strong><strong class="hljs-slc">: </strong><strong class="hljs-function-slc">(</strong><strong class="hljs-params-slc">params: GridCellParams</strong><strong class="hljs-function-slc">) =&gt;</strong><strong class="hljs-slc"> (</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc"> </strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">onClick</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{()</strong><strong class="hljs-tag-slc"> =&gt;</strong><strong class="hljs-slc"> alert(params.row._links.car.href)}</strong></span>
        <span class="code-highlight"><strong class="hljs-slc">&gt;</strong></span>
        <span class="code-highlight"><strong class="hljs-slc">Delete</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc">&gt;</strong></span>
    <span class="code-highlight"><strong class="hljs-slc">),</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">},</strong></span>
];
</code></pre>
    <p class="normal">We don’t want to enable<a id="_idIndexMarker690"/> sorting and filtering for the <code class="inlineCode">button</code> column, so the <code class="inlineCode">filterable</code> and <code class="inlineCode">sortable</code> props are set to <code class="inlineCode">false</code>. We also disable the column menu in this column by setting the <code class="inlineCode">disableColumnMenu</code> prop to <code class="inlineCode">true</code>. The button invokes the <code class="inlineCode">onDelClick</code> function when pressed and passes a link (<code class="inlineCode">row.id</code>) to the function as an argument, and the link value is shown in an alert.</p></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Now, you should see a <strong class="screenText">delete</strong> button in each row. If you press any of the buttons, you can see an alert that shows the link for the car. To delete a car, we should send a <code class="inlineCode">DELETE</code> request to its link:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_09.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.9: Delete button</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Next, we will implement<a id="_idIndexMarker691"/> the <code class="inlineCode">deleteCar</code> function, which sends the <code class="inlineCode">DELETE</code> request to a car link using the Axios <code class="inlineCode">delete</code> method. A <code class="inlineCode">DELETE</code> request to the backend returns a deleted car object. We will implement the <code class="inlineCode">deleteCar</code> function in the <code class="inlineCode">carapi.ts</code> file and export it. Open the <code class="inlineCode">carapi.ts</code> file and add the following function there:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// carapi.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> deleteCar = <span class="hljs-keyword">async</span> (<span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">CarResponse</span>&gt; =&gt;
{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title">delete</span>(link);
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}
</code></pre>
      </li>
      <li class="numberedList">We use the React Query <code class="inlineCode">useMutation</code> hook to handle deletion. We saw an example in <em class="chapterRef">Chapter 10</em>. First, we have to add the <code class="inlineCode">useMutation</code> import to the <code class="inlineCode">Carlist.tsx</code> file. We will also import the <code class="inlineCode">deleteCar</code> function from the <code class="inlineCode">carapi.ts</code> file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">import</span> { useQuery, <span class="code-highlight"><strong class="hljs-slc">useMutation</strong></span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>;
<span class="hljs-keyword">import</span> { getCars, <span class="code-highlight"><strong class="hljs-slc">deleteCar</strong></span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/carapi'</span>;
</code></pre>
      </li>
      <li class="numberedList">Add the <code class="inlineCode">useMutation</code> hook, which calls our <code class="inlineCode">deleteCar</code> function:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">const</span> { mutate } = <span class="hljs-title">useMutation</span>(deleteCar, {
   <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// Car deleted</span>
    },
    <span class="hljs-attr">onError</span>: <span class="hljs-function">(</span><span class="hljs-params">err</span><span class="hljs-function">) =&gt;</span> {
      <span class="hljs-variable">console</span>.<span class="hljs-title">error</span>(err);
    },
});
</code></pre>
      </li>
      <li class="numberedList">Then, call <code class="inlineCode">mutate</code> in our delete<a id="_idIndexMarker692"/> button and pass the car link as an argument:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx columns</span>
{
    <span class="hljs-attr">field</span>: <span class="hljs-string">'delete'</span>,
    <span class="hljs-attr">headerName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-number">90</span>,
    <span class="hljs-attr">sortable</span>: <span class="hljs-literal">false</span>,
       <span class="hljs-attr">filterable</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">disableColumnMenu</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">renderCell</span>: <span class="hljs-function">(</span><span class="hljs-params">params: GridCellParams</span><span class="hljs-function">) =&gt;</span> (
       <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span>
<span class="hljs-tag">        </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{()</span><span class="hljs-tag"> =&gt;</span> <span class="code-highlight"><strong class="hljs-slc">mutate(params.row._links.car.href)</strong></span>}
        &gt;
        Delete
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
    ),
  },
});
</code></pre>
      </li>
      <li class="numberedList">Now, if you start the app and press the <strong class="screenText">delete</strong> button, the car is deleted from the database, but it still exists in the frontend. You can manually refresh the browser, after which the car disappears from the table.</li>
      <li class="numberedList">We can also refresh the frontend automatically when a car is deleted. In React Query, the fetched data<a id="_idIndexMarker693"/> is saved to a cache that the query client handles. The <code class="inlineCode">QueryClient</code> has a <strong class="keyWord">query invalidation</strong> feature that we can use to fetch data again. First, we have to import and call the <code class="inlineCode">useQueryClient</code> hook function, which returns the current query client:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">import</span> { useQuery, useMutation, <span class="code-highlight"><strong class="hljs-slc">useQueryClient</strong></span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/</span>
<span class="hljs-string">  react-query'</span>;
<span class="hljs-keyword">import</span> { deleteCar } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/carapi'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title">DataGrid</span>, <span class="hljs-title">GridColDef</span>, <span class="hljs-title">GridCellParams</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/x-data-</span>
<span class="hljs-string">  grid'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> queryClient = </strong><strong class="hljs-title-slc">useQueryClient</strong><strong class="hljs-slc">();</strong></span>
  <span class="hljs-comment">// continue...</span>
</code></pre>
      </li>
      <li class="numberedList">The <code class="inlineCode">queryClient</code> has an <code class="inlineCode">invalidateQueries</code> method that we can call to re-fetch our data after successful<a id="_idIndexMarker694"/> deletion. You can pass the key of the query that you want to re-fetch. Our query key for fetching cars is <code class="inlineCode">cars</code>, which we defined in our <code class="inlineCode">useQuery</code> hook:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">const</span> { mutate } = <span class="hljs-title">useMutation</span>(deleteCar, {
    <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="code-highlight"><strong class="hljs-slc">queryClient.</strong><strong class="hljs-title-slc">invalidateQueries</strong><strong class="hljs-slc">({ </strong><strong class="hljs-attr-slc">queryKey</strong><strong class="hljs-slc">: [</strong><strong class="hljs-string-slc">'cars'</strong><strong class="hljs-slc">] });</strong></span>
    },
    <span class="hljs-attr">onError</span>: <span class="hljs-function">(</span><span class="hljs-params">err</span><span class="hljs-function">) =&gt;</span> {
      <span class="hljs-variable">console</span>.<span class="hljs-title">error</span>(err);
    },
  });
</code></pre>
      </li>
    </ol>
    <p class="normal">Now, every time a car is deleted, all the cars are fetched again. The car disappears from the list when the <strong class="screenText">Delete</strong> button is pressed. After a deletion, you can restart the backend to re-populate the database.</p>
    <p class="normal">You can also see that when you click any row in the grid, the row is selected. You can disable that by setting<a id="_idIndexMarker695"/> the <code class="inlineCode">disableRowSelectionOnClick</code> prop in the grid to <code class="inlineCode">true</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;<span class="hljs-title">DataGrid</span>
  rows={cars}
  columns={columns}
  <span class="code-highlight"><strong class="hljs-slc">disableRowSelectionOnClick={</strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">}</strong></span>
  getRowId={<span class="hljs-params">row</span><span class="hljs-function"> =&gt;</span> row.<span class="hljs-property">_links</span>.<span class="hljs-property">self</span>.<span class="hljs-property">href</span>}
/&gt;
</code></pre>
    <h2 id="_idParaDest-172" class="heading-2">Displaying a toast message</h2>
    <p class="normal">It would be nice<a id="_idIndexMarker696"/> to show the user some feedback in the case of a successful deletion, or if there are any errors. Let’s implement a <strong class="keyWord">toast message</strong> to show the status<a id="_idIndexMarker697"/> of the deletion. For this, we are going to use the MUI <code class="inlineCode">Snackbar</code> component:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">First, we have to import the <code class="inlineCode">Snackbar</code> component by adding the following <code class="inlineCode">import</code> statement to our <code class="inlineCode">Carlist.tsx</code> file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-title">Snackbar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Snackbar'</span>;
</code></pre>
      </li>
      <li class="numberedList">The <code class="inlineCode">Snackbar</code> component’s <code class="inlineCode">open</code> prop value is a boolean, and if it is <code class="inlineCode">true</code>, the component is shown; otherwise, it is hidden. Let’s import the <code class="inlineCode">useState</code> hook and define a state called <code class="inlineCode">open</code> to handle the visibility of our <code class="inlineCode">Snackbar</code> component. The initial value is <code class="inlineCode">false</code> because the message is shown only after the deletion:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">//Carlist.tsx</span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { useState } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'react'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">import</span> { useQuery, useMutation, useQueryClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/</span>
<span class="hljs-string">  react-query'</span>;
<span class="hljs-keyword">import</span> { deleteCar } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/carapi'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title">DataGrid</span>, <span class="hljs-title">GridColDef</span>, <span class="hljs-title">GridCellParams</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/x-data-</span>
<span class="hljs-string">  grid'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">Snackbar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Snackbar'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title">Carlist</span>() {
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> [open, setOpen] = </strong><strong class="hljs-title-slc">useState</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">);</strong></span>
  <span class="hljs-keyword">const</span> queryClient = <span class="hljs-title">useQueryClient</span>();
  <span class="hljs-comment">// continue...</span>
</code></pre>
      </li>
      <li class="numberedList">Next, we add the <code class="inlineCode">Snackbar</code> component in the <code class="inlineCode">return</code> statement after the MUI <code class="inlineCode">DataGrid</code> component. The <code class="inlineCode">autoHideDuration</code> prop defines the time in milliseconds after which the <code class="inlineCode">onClose</code> function is called automatically and the message disappears. The <code class="inlineCode">message</code> prop defines the message to display. We also have to wrap the <code class="inlineCode">DataGrid</code> and <code class="inlineCode">Snackbar</code> components inside the fragment (<code class="inlineCode">&lt;&gt;&lt;/&gt;</code>):
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">if</span> (!isSuccess) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Loading...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error) {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>Error when fetching cars...<span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
}
<span class="hljs-keyword">else</span> {
  <span class="hljs-keyword">return</span> (
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;&gt;</strong></span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DataGrid</span>
<span class="hljs-tag">        </span><span class="hljs-attr">rows</span><span class="hljs-tag">=</span><span class="hljs-string">{data}</span>
<span class="hljs-tag">        </span><span class="hljs-attr">columns</span><span class="hljs-tag">=</span><span class="hljs-string">{columns}</span>
<span class="hljs-tag">        </span><span class="hljs-attr">disableRowSelectionOnClick</span><span class="hljs-tag">=</span><span class="hljs-string">{true}</span>
<span class="hljs-tag">        </span><span class="hljs-attr">getRowId</span><span class="hljs-tag">=</span><span class="hljs-string">{row</span><span class="hljs-tag"> =&gt;</span> row._links.self.href} /&gt;
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Snackbar</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">open</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{open}</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">autoHideDuration</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{2000}</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">onClose</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{()</strong><strong class="hljs-tag-slc"> =&gt;</strong><strong class="hljs-slc"> setOpen(false)}</strong></span>
        <span class="code-highlight"><strong class="hljs-slc">message="Car deleted" /&gt;</strong></span>
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/&gt;</strong></span>
);
</code></pre>
      </li>
      <li class="numberedList">Finally, we set<a id="_idIndexMarker698"/> the <code class="inlineCode">open</code> state to <code class="inlineCode">true</code> after the successful deletion in our <code class="inlineCode">useMutation</code> hook:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">const</span> { mutate } = <span class="hljs-title">useMutation</span>(deleteCar, {
  <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="code-highlight"><strong class="hljs-title-slc">setOpen</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">);</strong></span>
    queryClient.<span class="hljs-title">invalidateQueries</span>([<span class="hljs-string">"cars"</span>]);
  },
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(</span><span class="hljs-params">err</span><span class="hljs-function">) =&gt;</span> {
    <span class="hljs-variable">console</span>.<span class="hljs-title">error</span>(err);
  },
});
</code></pre>
      </li>
    </ol>
    <p class="normal">Now, you will see<a id="_idIndexMarker699"/> the toast message<a id="_idIndexMarker700"/> when the car is deleted, as shown in the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B19818_13_10.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.10: Toast message</p>
    <h2 id="_idParaDest-173" class="heading-2">Adding a confirmation dialog window</h2>
    <p class="normal">To avoid accidental deletion<a id="_idIndexMarker701"/> of a car, it would be useful to have a confirmation<a id="_idIndexMarker702"/> dialog after the <strong class="screenText">Delete</strong> button has been pressed. We will implement this using the <code class="inlineCode">window</code> object’s <code class="inlineCode">confirm</code> method. It opens a dialog with an optional message and returns <code class="inlineCode">true</code> if you press the <strong class="screenText">OK</strong> button. Add <code class="inlineCode">confirm</code> to the delete button’s <code class="inlineCode">onClick</code> event handler:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx columns</span>
{
  <span class="hljs-attr">field</span>: <span class="hljs-string">'</span><span class="hljs-string">delete'</span>,
  <span class="hljs-attr">headerName</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">width</span>: <span class="hljs-number">90</span>,
  <span class="hljs-attr">sortable</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">filterable</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">disableColumnMenu</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">renderCell</span>: <span class="hljs-function">(</span><span class="hljs-params">params: GridCellParams</span><span class="hljs-function">) =&gt;</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span>
<span class="hljs-tag">      </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{()</span><span class="hljs-tag"> =&gt;</span> <span class="code-highlight"><strong class="hljs-slc">{</strong></span>
<span class="hljs-tag">        </span><span class="code-highlight"><strong class="hljs-slc">if (window.confirm(`Are you sure you want to delete ${params.row.</strong></span>
                            <span class="code-highlight"><strong class="hljs-slc">brand} ${params.row.model}?`)) {</strong></span>
          <span class="code-highlight"><strong class="hljs-slc">mutate(params.row._links.car.href);</strong></span>
        <span class="code-highlight"><strong class="hljs-slc">}</strong></span>
      <span class="code-highlight"><strong class="hljs-slc">}}</strong></span>
    &gt;
      Delete
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
  ),
}
</code></pre>
    <p class="normal">In the confirmation message, we have used ES6 string interpolation to display the car’s brand and model. (Note! Remember to use backticks.)</p>
    <p class="normal">If you press the <strong class="screenText">Delete</strong> button<a id="_idIndexMarker703"/> now, the confirmation dialog will open and the car<a id="_idIndexMarker704"/> will only be deleted if you press the <strong class="screenText">OK</strong> button:</p>
    <figure class="mediaobject"><img src="../Images/B19818_13_11.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.11: Confirmation dialog</p>
    <p class="normal">Next, we will begin the implementation of the functionality to add a new car.</p>
    <h1 id="_idParaDest-174" class="heading-1">Adding the add functionality</h1>
    <p class="normal">The next step is to add<a id="_idIndexMarker705"/> an add functionality to the frontend. We will implement this using the MUI modal dialog.</p>
    <div class="note">
      <p class="normal">We went through the MUI modal form in <em class="chapterRef">Chapter 11</em>, <em class="italic">Useful Third-Party Components for React</em>.</p>
    </div>
    <p class="normal">We will add the <strong class="screenText">New Car</strong> button to the user interface, which opens the modal form when it is pressed. The modal form contains all the fields that are required to add a new car, as well as the buttons for saving and canceling.</p>
    <p class="normal">The following steps show you<a id="_idIndexMarker706"/> how to create the add functionality using the modal dialog component:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Create a new file called <code class="inlineCode">AddCar.tsx</code> in the <code class="inlineCode">components</code> folder and write some functional component base code to the file, as shown here. Add the imports for the MUI <code class="inlineCode">Dialog</code> component:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-title">Dialog</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Dialog'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogActions</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogActions'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogContent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogContent'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogTitle</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogTitle'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title">AddCar</span>() {
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">AddCar</span>;
</code></pre>
      </li>
      <li class="numberedList">We have already defined the type for our <code class="inlineCode">Car</code> response data (a car object with links). Let’s also create a type for the car object that doesn’t contain links, because the user doesn’t enter links in the form. We need this for the state where we will save a new car. Add the following <code class="inlineCode">Car</code> type to your <code class="inlineCode">types.ts</code> file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title">Car</span> = {
  <span class="hljs-attr">brand</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">registrationNumber</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">modelYear</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">price</span>: <span class="hljs-built_in">number</span>;
}
</code></pre>
      </li>
      <li class="numberedList">Declare a state of type <code class="inlineCode">Car</code> that contains all car fields using the <code class="inlineCode">useState</code> hook. For the dialog, we also need a boolean state to define the visibility of the dialog form:
        <pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { useState } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'react'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">import</span> <span class="hljs-title">Dialog</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/Dialog'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogActions</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogActions'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogContent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogContent'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">DialogTitle</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/material/DialogTitle'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> { </strong><strong class="hljs-title-slc">Car</strong><strong class="hljs-slc"> } </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'../types'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">function</span> <span class="hljs-title">AddCar</span>() {
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> [open, setOpen] = </strong><strong class="hljs-title-slc">useState</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">);</strong></span>
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> [car, setCar] = useState&lt;</strong><strong class="hljs-title-slc">Car</strong><strong class="hljs-slc">&gt;({</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">brand</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">model</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">color</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">registrationNumber</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">modelYear</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">price</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">0</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">});</strong></span>
    
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">AddCar</span>;
</code></pre>
      </li>
      <li class="numberedList">Next, we add two functions<a id="_idIndexMarker707"/> to close and open the dialog form. The <code class="inlineCode">handleClose</code> and <code class="inlineCode">handleOpen</code> functions set the value of the <code class="inlineCode">open</code> state, which affects the visibility of the modal form:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
<span class="hljs-comment">// Open the modal form</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleClickOpen</span> = () =&gt; {
  <span class="hljs-title">setOpen</span>(<span class="hljs-literal">true</span>);
};
  
<span class="hljs-comment">// Close the modal form</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleClose</span> = () =&gt; {
  <span class="hljs-title">setOpen</span>(<span class="hljs-literal">false</span>);
};
</code></pre>
      </li>
      <li class="numberedList">Add the <code class="inlineCode">Dialog</code> component inside the <code class="inlineCode">AddCar</code> component’s <code class="inlineCode">return</code> statement. The form contains the MUI <code class="inlineCode">Dialog</code> component with buttons and the input fields that are required to collect the car data. The button that opens the modal window, which will be shown on the car list page, must be outside of the <code class="inlineCode">Dialog</code> component. All input fields should have a <code class="inlineCode">name</code> attribute with a value that is the same as the name of the state the value will be saved to. Input fields also have the <code class="inlineCode">onChange</code> prop, which saves the value to the <code class="inlineCode">car</code> state by invoking the <code class="inlineCode">handleChange</code> function. The <code class="inlineCode">handleChange</code> function dynamically updates the <code class="inlineCode">car</code> state by creating a new object with the existing state properties and updating a property based on the input <a id="_idIndexMarker708"/>element’s name and the new value entered by the user:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleChange</span> = (<span class="hljs-params">event : React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;
{
  <span class="hljs-title">setCar</span>({...car, [event.<span class="hljs-property">target</span>.<span class="hljs-property">name</span>]:
      event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>});
}
<span class="hljs-keyword">return</span>(
  <span class="hljs-tag">&lt;&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClickOpen}</span><span class="hljs-tag">&gt;</span>New Car<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Dialog</span><span class="hljs-tag"> </span><span class="hljs-attr">open</span><span class="hljs-tag">=</span><span class="hljs-string">{open}</span><span class="hljs-tag"> </span><span class="hljs-attr">onClose</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>New car<span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogContent</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Brand"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"brand"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.brand}</span><span class="hljs-tag"> </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Model"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"model"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.model}</span><span class="hljs-tag"> </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Color"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"color"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.color}</span><span class="hljs-tag"> </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Year"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"modelYear"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.modelYear}</span><span class="hljs-tag"> </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Reg.nr"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"registrationNumber"</span>
<span class="hljs-tag">          </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.registrationNumber} </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">placeholder</span><span class="hljs-tag">=</span><span class="hljs-string">"Price"</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"price"</span>
<span class="hljs-tag">           </span><span class="hljs-attr">value</span><span class="hljs-tag">=</span><span class="hljs-string">{car.price}</span><span class="hljs-tag"> </span><span class="hljs-attr">onChange</span><span class="hljs-tag">=</span><span class="hljs-string">{handleChange}/</span><span class="hljs-tag">&gt;&lt;</span><span class="hljs-name">br</span><span class="hljs-tag">/&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogContent</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogActions</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>Cancel<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>Save<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogActions</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">Dialog</span><span class="hljs-tag">&gt;</span>            
  <span class="hljs-tag">&lt;/&gt;</span>
);
</code></pre>
      </li>
      <li class="numberedList">Implement the <code class="inlineCode">addCar</code> function in the <code class="inlineCode">carapi.ts</code> file, which will send the <code class="inlineCode">POST</code> request to the backend <code class="inlineCode">api/cars</code> endpoint. We are using the Axios <code class="inlineCode">post</code> method to send <code class="inlineCode">POST</code> requests. The request will include the new car object inside the body and the <code class="inlineCode">'Content-Type':'application/json'</code> header. We also need to import the <code class="inlineCode">Car</code> type because<a id="_idIndexMarker709"/> we are passing a new car object as an argument to the function:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// carapi.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">CarResponse</span>, <span class="hljs-title">Car</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
<span class="hljs-comment">// Add a new car</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> addCar = <span class="hljs-keyword">async</span> (<span class="hljs-attr">car</span>: <span class="hljs-title">Car</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">CarResponse</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title">post</span>(<span class="hljs-string">`</span><span class="hljs-subst">${</span><span class="hljs-keyword">import</span><span class="hljs-subst">.meta.env.VITE_API_</span>
<span class="hljs-subst">                   URL}</span><span class="hljs-string">/api/cars`</span>, car, {
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
    },  
  });
  
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
}
</code></pre>
      </li>
      <li class="numberedList">Next, we use the React Query <code class="inlineCode">useMutation</code> hook, like we did in the delete functionality. We also invalidate the cars query after the car has been added successfully. The <code class="inlineCode">addCar</code> function that we use in the <code class="inlineCode">useMutation</code> hook is imported from the <code class="inlineCode">carapi.ts</code> file. Add the following imports and the <code class="inlineCode">useMutation</code> hook to your <code class="inlineCode">AddCar.tsx</code> file. We also need to get the query client from the context using the <code class="inlineCode">useQueryClient</code> hook. Remember that context is used to provide access to the query client to components deep in the component tree:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
<span class="hljs-comment">// Add the following imports</span>
<span class="hljs-keyword">import</span> { useMutation, useQueryClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>;
<span class="hljs-keyword">import</span> { addCar } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/carapi'</span>;
<span class="hljs-comment">// Add inside the AddCar component function</span>
<span class="hljs-keyword">const</span> queryClient = <span class="hljs-title">useQueryClient</span>();
<span class="hljs-comment">// Add inside the AddCar component function</span>
<span class="hljs-keyword">const</span> { mutate } = <span class="hljs-title">useMutation</span>(addCar, {
  <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
    queryClient.<span class="hljs-title">invalidateQueries</span>([<span class="hljs-string">"cars"</span>]);
  },
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(</span><span class="hljs-params">err</span><span class="hljs-function">) =&gt;</span> {
    <span class="hljs-variable">console</span>.<span class="hljs-title">error</span>(err);
  },
});
</code></pre>
      </li>
      <li class="numberedList">Import the <code class="inlineCode">AddCar</code> component into the <code class="inlineCode">Carlist.tsx</code> file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title">AddCar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./AddCar'</span>;
</code></pre>
      </li>
      <li class="numberedList">Add the <code class="inlineCode">AddCar</code> component<a id="_idIndexMarker710"/> to the <code class="inlineCode">Carlist.tsx</code> file’s <code class="inlineCode">return</code> statement. You also have to import the <code class="inlineCode">AddCar</code> component. Now, the <code class="inlineCode">return</code> statement of the <code class="inlineCode">Carlist.tsx</code> file should appear as follows:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-comment">// Add the following import</span>
<span class="hljs-keyword">import</span> <span class="hljs-title">AddCar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./AddCar'</span>;
<span class="hljs-comment">// Render the AddCar component </span>
<span class="hljs-keyword">return</span> (
  <span class="hljs-tag">&lt;&gt;</span>
<span class="hljs-tag">    </span><span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">AddCar</strong><strong class="hljs-tag-slc"> /&gt;</strong></span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">DataGrid</span>
<span class="hljs-tag">      </span><span class="hljs-attr">rows</span><span class="hljs-tag">=</span><span class="hljs-string">{data}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">columns</span><span class="hljs-tag">=</span><span class="hljs-string">{columns}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">disableRowSelectionOnClick</span><span class="hljs-tag">=</span><span class="hljs-string">{true}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">getRowId</span><span class="hljs-tag">=</span><span class="hljs-string">{row</span><span class="hljs-tag"> =&gt;</span> row._links.self.href}/&gt;
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Snackbar</span>
<span class="hljs-tag">      </span><span class="hljs-attr">open</span><span class="hljs-tag">=</span><span class="hljs-string">{open}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">autoHideDuration</span><span class="hljs-tag">=</span><span class="hljs-string">{2000}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">onClose</span><span class="hljs-tag">=</span><span class="hljs-string">{()</span><span class="hljs-tag"> =&gt;</span> setOpen(false)}
      message="Car deleted"
    /&gt;
  <span class="hljs-tag">&lt;/&gt;</span>
);
</code></pre>
      </li>
      <li class="numberedList">If you start the car shop app, it should now look like the following:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_12.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.12: Car Shop</p>
    <p class="normal">If you press the <strong class="screenText">New Car</strong> button, it should open the modal form.</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="11">To save a new car, create a function<a id="_idIndexMarker711"/> called <code class="inlineCode">handleSave</code> in the <code class="inlineCode">AddCar.tsx</code> file. The <code class="inlineCode">handleSave</code> function calls <code class="inlineCode">mutate</code>. Then, we set the <code class="inlineCode">car</code> state back to its initial state, and the modal form is closed:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
<span class="hljs-comment">// Save car and close modal form</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleSave</span> = () =&gt; {
  <span class="hljs-title">mutate</span>(car);   
  <span class="hljs-title">setCar</span>({ <span class="hljs-attr">brand</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">model</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">''</span>,  <span class="hljs-attr">registrationNumber</span>:<span class="hljs-string">''</span>,
           <span class="hljs-attr">modelYear</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">0</span> });
  <span class="hljs-title">handleClose</span>();
}
</code></pre>
      </li>
      <li class="numberedList">Finally, we have to change the <code class="inlineCode">AddCar</code> component’s <code class="inlineCode">onClick</code> save button to call the <code class="inlineCode">handleSave</code> function:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
&lt;<span class="hljs-title">DialogActions</span>&gt;
  <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>Cancel<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{</span><span class="code-highlight"><strong class="hljs-string-slc">handleSave</strong></span><span class="hljs-string">}</span><span class="hljs-tag">&gt;</span>Save<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
&lt;/<span class="hljs-title">DialogActions</span>&gt;
</code></pre>
      </li>
      <li class="numberedList">Now, you can open the modal form by pressing the <strong class="screenText">New Car</strong> button. You will see that there is placeholder text in each field when it is empty. You can fill out the form with data and press the <strong class="screenText">Save</strong> button. At this point, the form doesn’t have a nice appearance, but we<a id="_idIndexMarker712"/> are going to style it in the next chapter:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_13.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.13: Add new car</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="14">After saving, the list page is refreshed, and the new car can be seen in the list:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_14.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.14: Car Shop</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="15">Now, we can do some code refactoring. When we start to implement the edit functionality, we will actually need the same fields in the <strong class="screenText">Edit</strong> form as in the <strong class="screenText">New Car</strong> form. Let’s create a new component that renders the text fields in our <strong class="screenText">New Car</strong> form. The idea is that we are splitting the text fields into their own component, which can then be used in both the <strong class="screenText">New Car</strong> and <strong class="screenText">Edit</strong> forms. Create a new file called <code class="inlineCode">CarDialogContent.tsx</code> in the <code class="inlineCode">components</code> folder. We have to pass the <code class="inlineCode">car</code> object and the <code class="inlineCode">handleChange</code> function to the component using <code class="inlineCode">props</code>. To do that, we create a new type called <code class="inlineCode">DialogFormProps</code>. We can define this type in the same file<a id="_idIndexMarker713"/> because we don’t need it in any other file:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// CarDialogContent.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">Car</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
type <span class="hljs-title">DialogFormProps</span> = {
  <span class="hljs-attr">car</span>: <span class="hljs-title">Car</span>;
  <span class="hljs-attr">handleChange</span>: <span class="hljs-function">(</span><span class="hljs-params">event: React.ChangeEvent&lt;HTMLInputElement&gt;</span><span class="hljs-function">) =&gt;</span>
    <span class="hljs-keyword">void</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title">CarDialogContent</span>(<span class="hljs-params">{ car, handleChange }: DialogFormProps</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">CarDialogContent</span>;
</code></pre>
      </li>
      <li class="numberedList">Then, we can move our <code class="inlineCode">DialogContent</code> component from the <code class="inlineCode">AddCar</code> component to the <code class="inlineCode">CarDialogContent</code> component. Your code should look like the following:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// CarDialogContent.tsx</span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">DialogContent</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@mui/material/DialogContent'</strong></span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title">Car</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
type <span class="hljs-title">DialogFormProps</span> = {
  <span class="hljs-attr">car</span>: <span class="hljs-title">Car</span>;
  <span class="hljs-attr">handleChange</span>: <span class="hljs-function">(</span><span class="hljs-params">event: React.ChangeEvent&lt;HTMLInputElement&gt;</span><span class="hljs-function">) =&gt;</span>
    <span class="hljs-keyword">void</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title">CarDialogContent</span>(<span class="hljs-params">{ car, handleChange}: DialogFormProps</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">DialogContent</strong><strong class="hljs-tag-slc">&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Brand"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"brand"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.brand}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Model"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"model"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.model}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Color"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"color"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.color}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Year"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">modelYear"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.modelYear}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Reg.nr."</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"registrationNumber"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.registrationNumber}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">placeholder</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">Price"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">name</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"price"</strong></span>
        <span class="code-highlight"><strong class="hljs-attr-slc">value</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car.price}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong></span>
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">DialogContent</strong><strong class="hljs-tag-slc">&gt;</strong></span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">CarDialogContent</span>;
</code></pre>
      </li>
      <li class="numberedList">Now, we can import<a id="_idIndexMarker714"/> the <code class="inlineCode">CarDialogContent</code> to the <code class="inlineCode">AddCar</code> component and render it inside the <code class="inlineCode">Dialog</code> component. Pass the <code class="inlineCode">car</code> state and the <code class="inlineCode">handleChange</code> function to the component using props. Also, remove the unused MUI <code class="inlineCode">DialogContent</code> import from the <code class="inlineCode">AddCar</code> component:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// AddCar.tsx</span>
<span class="hljs-comment">// Add the following import </span>
<span class="hljs-comment">// and remove unused imports: DialogContent</span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">CarDialogContent</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'./CarDialogContent'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-comment">// render CarDialogContent and pass props</span>
<span class="hljs-keyword">return</span>(
  <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClickOpen}</span><span class="hljs-tag">&gt;</span>New Car<span class="hljs-tag">&lt;/</span><span class="hljs-name">Button</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Dialog</span><span class="hljs-tag"> </span><span class="hljs-attr">open</span><span class="hljs-tag">=</span><span class="hljs-string">{open}</span><span class="hljs-tag"> </span><span class="hljs-attr">onClose</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>New car<span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>
        <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">CarDialogContent</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">car</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">handleChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;</strong></span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogActions</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">Button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>Cancel<span class="hljs-tag">&lt;/</span><span class="hljs-name">Button</span><span class="hljs-tag">&gt;</span>
         <span class="hljs-tag">&lt;</span><span class="hljs-name">Button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleSave}</span><span class="hljs-tag">&gt;</span>Save<span class="hljs-tag">&lt;/</span><span class="hljs-name">Button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogActions</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">Dialog</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
);
</code></pre>
      </li>
      <li class="numberedList">Try to add a new car, and it should<a id="_idIndexMarker715"/> work like it did before the refactoring.</li>
    </ol>
    <p class="normal">Next, we will begin to implement the edit functionality.</p>
    <h1 id="_idParaDest-175" class="heading-1">Adding the edit functionality</h1>
    <p class="normal">We will implement the edit functionality<a id="_idIndexMarker716"/> by adding the <strong class="screenText">Edit</strong> button to each table row. When the row <strong class="screenText">Edit</strong> button is pressed, it opens a modal form where the user can edit the existing car and save their changes. The idea is that we pass car data from the grid row to the edit form, and the form fields are populated when the form is opened:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">First, create a file called <code class="inlineCode">EditCar.tsx</code> in the <code class="inlineCode">components</code> folder. We have to define a <code class="inlineCode">FormProps</code> type for our props, and this can be defined inside our component because we don’t need this type anywhere else. The type of data that will be passed to the <code class="inlineCode">EditCar</code> component is the <code class="inlineCode">CarResponse</code> type. We will also create a state for car data like we did in the add functionality section. The code for the <code class="inlineCode">EditCar.tsx</code> file looks like the following:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title">Car</span>, <span class="hljs-title">CarResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
type <span class="hljs-title">FormProps</span> = {
  <span class="hljs-attr">cardata</span>: <span class="hljs-title">CarResponse</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title">EditCar</span>(<span class="hljs-params">{ cardata }: FormProps</span>) {
  <span class="hljs-keyword">const</span> [car, setCar] = useState&lt;<span class="hljs-title">Car</span>&gt;({
    <span class="hljs-attr">brand</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">model</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">registrationNumber</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">modelYear</span>: <span class="hljs-number">0</span>,  
    <span class="hljs-attr">price</span>: <span class="hljs-number">0</span>
  });
 
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;&lt;/&gt;</span>
  );  
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">EditCar</span>;
</code></pre>
      </li>
      <li class="numberedList">We will create a dialog<a id="_idIndexMarker717"/> that will be opened when the <strong class="screenText">Edit</strong> button is pressed. We need the <code class="inlineCode">open</code> state to define if the dialog is visible or hidden. Add the functions that open and close the <code class="inlineCode">Dialog</code> component and save updates:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">Dialog</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@mui/material/Dialog'</strong><strong class="hljs-slc">;</strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">DialogActions</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@mui/material/DialogActions'</strong><strong class="hljs-slc">;</strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">DialogTitle</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'@mui/material/DialogTitle'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">Car</span>, <span class="hljs-title">CarResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
type <span class="hljs-title">FormProps</span> = {
  <span class="hljs-attr">cardata</span>: <span class="hljs-title">CarResponse</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title">EditCar</span>(<span class="hljs-params">{ cardata }: FormProps</span>) {
  <span class="hljs-keyword">const</span> [open, setOpen] = <span class="hljs-title">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [car, setCar] = useState&lt;<span class="hljs-title">Car</span>&gt;({
    <span class="hljs-attr">brand</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">model</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">registrationNumber</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">modelYear</span>: <span class="hljs-number">0</span>,  
    <span class="hljs-attr">price</span>: <span class="hljs-number">0</span>
  });
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">handleClickOpen</strong><strong class="hljs-slc"> = () =&gt; {</strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc">setOpen</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">);</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">};</strong></span>
    
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">handleClose</strong><strong class="hljs-slc"> = () =&gt; {</strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc">setOpen</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">);</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">};</strong></span>
         
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">handleSave</strong><strong class="hljs-slc"> = () =&gt; {</strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc">setOpen</strong><strong class="hljs-slc">(</strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">);</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">}</strong></span>
  <span class="hljs-keyword">return</span>(
    <span class="hljs-tag">&lt;&gt;</span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onClick</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleClickOpen}</strong><strong class="hljs-tag-slc">&gt;</strong></span>
        <span class="code-highlight"><strong class="hljs-slc">Edit</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc">&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Dialog</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">open</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{open}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onClose</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleClose}</strong><strong class="hljs-tag-slc">&gt;</strong></span>
        <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">DialogTitle</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Edit car</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">DialogTitle</strong><strong class="hljs-tag-slc">&gt;</strong></span>
        <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">DialogActions</strong><strong class="hljs-tag-slc">&gt;</strong></span>
          <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onClick</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleClose}</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Cancel</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc">&gt;</strong></span>
          <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">onClick</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleSave}</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Save</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">button</strong><strong class="hljs-tag-slc">&gt;</strong></span>
        <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">DialogActions</strong><strong class="hljs-tag-slc">&gt;</strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">Dialog</strong><strong class="hljs-tag-slc">&gt;</strong></span>
    <span class="hljs-tag">&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title">EditCar</span>;
</code></pre>
      </li>
      <li class="numberedList">Next, we will import the <code class="inlineCode">CarDialogContent</code> component and render it inside the <code class="inlineCode">Dialog</code> component. We also<a id="_idIndexMarker718"/> need to add the <code class="inlineCode">handleChange</code> function, which saves edited values to the <code class="inlineCode">car</code> state. We pass in the <code class="inlineCode">car</code> state and the <code class="inlineCode">handleChange</code> function using the props, as we did earlier with the add functionality:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-comment">// Add the following import</span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">CarDialogContent</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'./CarDialogContent'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-comment">// Add handleChange function</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleChange</span> = (<span class="hljs-params">event : React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;
{
  <span class="hljs-title">setCar</span>({...car, [event.<span class="hljs-property">target</span>.<span class="hljs-property">name</span>]: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>});
}
<span class="hljs-comment">// render CarDialogContent inside the Dialog</span>
<span class="hljs-keyword">return</span>(
  <span class="hljs-tag">&lt;&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClickOpen}</span><span class="hljs-tag">&gt;</span>
      Edit
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Dialog</span><span class="hljs-tag"> </span><span class="hljs-attr">open</span><span class="hljs-tag">=</span><span class="hljs-string">{open}</span><span class="hljs-tag"> </span><span class="hljs-attr">onClose</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>Edit car<span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogTitle</span><span class="hljs-tag">&gt;</span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">CarDialogContent</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">car</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{car}</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">handleChange</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{handleChange}/</strong><strong class="hljs-tag-slc">&gt;</strong></span>
      &lt;DialogActions&gt;
        <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleClose}</span><span class="hljs-tag">&gt;</span>Cancel<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{handleSave}</span><span class="hljs-tag">&gt;</span>Save<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">DialogActions</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">Dialog</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/&gt;</span>
);
</code></pre>
      </li>
      <li class="numberedList">Now, we will set the values<a id="_idIndexMarker719"/> of the <code class="inlineCode">car</code> state using the props in the <code class="inlineCode">handleClickOpen</code> function:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleClickOpen</span> = () =&gt; {
  <span class="code-highlight"><strong class="hljs-title-slc">setCar</strong><strong class="hljs-slc">({</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">brand</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">brand</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">model</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">model</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">color</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">color</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">registrationNumber</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">registrationNumber</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">modelYear</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">modelYear</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">price</strong><strong class="hljs-slc">: cardata.</strong><strong class="hljs-property-slc">price</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">});</strong></span>
  <span class="hljs-title">setOpen</span>(<span class="hljs-literal">true</span>);
};
</code></pre>
      </li>
    </ol>
    <p class="normal">Our form will be populated with the values from the car object that is passed to the component in props.</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">In this step, we will add the edit functionality to our data grid in the <code class="inlineCode">Carlist</code> component. Open the <code class="inlineCode">Carlist.tsx</code> file and import the <code class="inlineCode">EditCar</code> component. Create a new column that renders the <code class="inlineCode">EditCar</code> component using the <code class="inlineCode">renderCell</code> column property, as we did in the delete functionality section. We pass the row object to the <code class="inlineCode">EditCar</code> component, and that object contains the car object:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Carlist.tsx</span>
<span class="hljs-comment">// Add the following import</span>
<span class="code-highlight"><strong class="hljs-keyword-slc">import</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">EditCar</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">from</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">'./EditCar'</strong><strong class="hljs-slc">;</strong></span>
<span class="hljs-comment">// Add a new column</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">columns</span>: <span class="hljs-title">GridColDef</span>[] = [
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'brand'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'</span><span class="hljs-string">Brand'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'model'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'</span><span class="hljs-string">color'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Color'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'registrationNumber'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Reg.nr.'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'modelYear'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'Model Year'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  {<span class="hljs-attr">field</span>: <span class="hljs-string">'price'</span>, <span class="hljs-attr">headerName</span>: <span class="hljs-string">'</span><span class="hljs-string">Price'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>},
  <span class="code-highlight"><strong class="hljs-slc">{</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">field</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">'edit'</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">headerName</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">width</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">90</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">sortable</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">filterable</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">disableColumnMenu</strong><strong class="hljs-slc">: </strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">,</strong></span>
    <span class="code-highlight"><strong class="hljs-attr-slc">renderCell</strong><strong class="hljs-slc">: </strong><strong class="hljs-function-slc">(</strong><strong class="hljs-params-slc">params: GridCellParams</strong><strong class="hljs-function-slc">) =&gt;</strong><strong class="hljs-slc"> </strong></span>
      <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">EditCar</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">cardata</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">{params.row}</strong><strong class="hljs-tag-slc"> /&gt;</strong></span>
  <span class="code-highlight"><strong class="hljs-slc">},</strong></span>
  {
    <span class="hljs-attr">field</span>: <span class="hljs-string">'delete'</span>,
    <span class="hljs-attr">headerName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-number">90</span>,
    <span class="hljs-attr">sortable</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">filterable</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">disableColumnMenu</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">renderCell</span>: <span class="hljs-function">(</span><span class="hljs-params">params: GridCellParams</span><span class="hljs-function">) =&gt;</span> (
      <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span>
<span class="hljs-tag">        </span><span class="hljs-attr">onClick</span><span class="hljs-tag">=</span><span class="hljs-string">{()</span><span class="hljs-tag"> =&gt;</span> {
          if (window.confirm(`Are you sure you want to delete
              ${params.row.brand} ${params.row.model}?`))
            mutate(params.row._links.car.href)
        }}&gt;
        Delete
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
    ),
  },
];
</code></pre>
      </li>
      <li class="numberedList">Now, you should see the <strong class="screenText">Edit</strong> button<a id="_idIndexMarker720"/> in each table row in your car list. When you press the <strong class="screenText">Edit</strong> button, it should open the car form and populate fields using the car from the row where you pressed the button:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_15.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.15: Edit button</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">Next, we have to implement<a id="_idIndexMarker721"/> the update request that sends an updated car to the backend. To update the car data, we have to send a <code class="inlineCode">PUT</code> request to the <code class="inlineCode">http://localhost:8080/api/cars/[carid]</code> URL. The link will be the same as it is for the delete functionality. The request contains the updated car object inside the body, and the <code class="inlineCode">'Content-Type':'application/json'</code> header that we also set for the add functionality. For the update functionality, we need a new type. In React Query, the mutation function can only take one parameter, but in our case, we have to send the car object (<code class="inlineCode">Car</code> type) and its link. 
    <p class="normal">We can solve that by passing an object that contains both values. Open the <code class="inlineCode">types.ts</code> file and create the following type, called <code class="inlineCode">CarEntry</code>:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title">CarEntry</span> = {
  <span class="hljs-attr">car</span>: <span class="hljs-title">Car</span>;
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
}
</code></pre></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">Then, open the <code class="inlineCode">carapi.ts</code> file, create the following function, and export it. The function gets the <code class="inlineCode">CarEntry</code> type object as an argument and it has <code class="inlineCode">car</code> and <code class="inlineCode">url</code> properties, where we get the values that are needed in the request:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// carapi.ts</span>
<span class="hljs-comment">// Add CarEntry to import</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">CarResponse</span>, <span class="hljs-title">Car</span>, <span class="code-highlight"><strong class="hljs-title-slc">CarEntry</strong></span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
<span class="hljs-comment">// Add updateCar function</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> updateCar = <span class="hljs-keyword">async</span> (<span class="hljs-attr">carEntry</span>: <span class="hljs-title">CarEntry</span>):
  <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">CarResponse</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title">put</span>(carEntry.<span class="hljs-property">url</span>, carEntry.<span class="hljs-property">car</span>, {
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
  });
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
}
</code></pre>
      </li>
      <li class="numberedList">Next, we import the <code class="inlineCode">updateCar</code> function into the <code class="inlineCode">EditCar</code> component and use the <code class="inlineCode">useMutation</code> hook to send<a id="_idIndexMarker722"/> a request. We invalidate the cars query to re-fetch the list after a successful edit; therefore, we also have to get the query client:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-comment">// Add the following imports</span>
<span class="hljs-keyword">import</span> { updateCar } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/carapi'</span>;
<span class="hljs-keyword">import</span> { useMutation, useQueryClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>;
<span class="hljs-comment">// Get query client</span>
<span class="hljs-keyword">const</span> queryClient = <span class="hljs-title">useQueryClient</span>();
<span class="hljs-comment">// Use useMutation hook</span>
<span class="hljs-keyword">const</span> { mutate } = <span class="hljs-title">useMutation</span>(updateCar, {
  <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
    queryClient.<span class="hljs-title">invalidateQueries</span>([<span class="hljs-string">"cars"</span>]);
  },
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(</span><span class="hljs-params">err</span><span class="hljs-function">) =&gt;</span> {
    <span class="hljs-variable">console</span>.<span class="hljs-title">error</span>(err);
  }
});
</code></pre>
      </li>
      <li class="numberedList">Then, we call <code class="inlineCode">mutate</code> in the <code class="inlineCode">handleSave</code> function. As was already mentioned, <code class="inlineCode">mutate</code> only accepts one parameter, and we have to pass the car object and URL; therefore, we create an object that contains both values and pass that one. We also need to import the <code class="inlineCode">CarEntry</code> type:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// EditCar.tsx</span>
<span class="hljs-comment">// Add CarEntry import</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title">Car</span>, <span class="hljs-title">CarResponse</span>, <span class="hljs-title">CarEntry</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>;
<span class="hljs-comment">// Modify handleSave function</span>
<span class="hljs-keyword">const</span> <span class="hljs-title">handleSave</span> = () =&gt; {
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> url = cardata.</strong><strong class="hljs-property-slc">_links</strong><strong class="hljs-slc">.</strong><strong class="hljs-property-slc">self</strong><strong class="hljs-slc">.</strong><strong class="hljs-property-slc">href</strong><strong class="hljs-slc">;</strong></span>
  <span class="code-highlight"><strong class="hljs-keyword-slc">const</strong><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc">carEntry</strong><strong class="hljs-slc">: </strong><strong class="hljs-title-slc">CarEntry</strong><strong class="hljs-slc"> = {car, url}</strong></span>
  <span class="code-highlight"><strong class="hljs-title-slc">mutate</strong><strong class="hljs-slc">(carEntry);</strong></span>
  <span class="code-highlight"><strong class="hljs-title-slc">setCar</strong><strong class="hljs-slc">({ </strong><strong class="hljs-attr-slc">brand</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">, </strong><strong class="hljs-attr-slc">model</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">, </strong><strong class="hljs-attr-slc">color</strong><strong class="hljs-slc">: </strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,  </strong><strong class="hljs-attr-slc">registrationNumber</strong><strong class="hljs-slc">:</strong><strong class="hljs-string-slc">''</strong><strong class="hljs-slc">,</strong></span>
           <span class="code-highlight"><strong class="hljs-attr-slc">modelYear</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">, </strong><strong class="hljs-attr-slc">price</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc"> });</strong></span>
  <span class="hljs-title">setOpen</span>(<span class="hljs-literal">false</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Finally, if you press the <strong class="screenText">Edit</strong> button<a id="_idIndexMarker723"/> in the table, it opens the modal form and displays the car from that row. The updated values are saved to the database when you press the <strong class="screenText">Save</strong> button:
    <figure class="mediaobject"><img src="../Images/B19818_13_16.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.16: Edit car</p>
    <p class="normal">Similarly, if you press the <strong class="screenText">New Car</strong> button, it will open an empty form and save the new car to the database when the form is filled and the <strong class="screenText">Save</strong> button is pressed. We used one component to handle both use cases by using the component props.</p></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="12">You can also see what happens in the backend when you edit a car. If you look at the Eclipse console after a successful edit, you can see that there is an <code class="inlineCode">update</code> SQL statement that updates<a id="_idIndexMarker724"/> the database:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_17.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.17: Update car statement</p>
    <p class="normal">Now, we have implemented all the CRUD functionalities.</p>
    <h1 id="_idParaDest-176" class="heading-1">Exporting the data to CSV</h1>
    <p class="normal">One feature that we<a id="_idIndexMarker725"/> will also implement is a <strong class="keyWord">comma-separated values </strong>(<strong class="keyWord">CSV</strong>) export of the data. We don’t need any extra libraries for the export<a id="_idIndexMarker726"/> because the MUI data grid provides this feature. We will activate the data grid toolbar, which contains a lot of nice features:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Add the following import to the <code class="inlineCode">Carlist.tsx</code> file. The <code class="inlineCode">GridToolbar</code> component is a toolbar for the MUI data grid that contains nice functionalities, such as export:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> { 
  <span class="hljs-title">DataGrid</span>, 
  <span class="hljs-title">GridColDef</span>, 
  <span class="hljs-title">GridCellParams</span>,
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-title-slc">GridToolbar</strong></span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@mui/x-data-grid'</span>;
</code></pre>
      </li>
      <li class="numberedList">We need to enable our toolbar, which contains the <strong class="screenText">Export </strong>button and other buttons. To enable the toolbar in the MUI data grid, you have to use the <code class="inlineCode">slots</code> prop and set the value to <code class="inlineCode">toolbar: GridToolbar</code>. The <code class="inlineCode">slots</code> prop can be used to override the data grid’s internal components:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">return</span>(
  <span class="hljs-tag">&lt;&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">AddCar</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">DataGrid</span>
<span class="hljs-tag">      </span><span class="hljs-attr">rows</span><span class="hljs-tag">=</span><span class="hljs-string">{cars}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">columns</span><span class="hljs-tag">=</span><span class="hljs-string">{columns}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">disableRowSelectionOnClick</span><span class="hljs-tag">=</span><span class="hljs-string">{true}</span>
<span class="hljs-tag">      </span><span class="hljs-attr">getRowId</span><span class="hljs-tag">=</span><span class="hljs-string">{row</span><span class="hljs-tag"> =&gt;</span> row._links.self.href}
<span class="hljs-tag">      </span><span class="code-highlight"><strong class="hljs-attr-slc">slots</strong><strong class="hljs-slc">={{ toolbar: GridToolbar }}</strong></span>
    /&gt;
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Snackbar</span>
<span class="hljs-tag">       </span><span class="hljs-attr">open</span><span class="hljs-tag">=</span><span class="hljs-string">{open}</span>
<span class="hljs-tag">       </span><span class="hljs-attr">autoHideDuration</span><span class="hljs-tag">=</span><span class="hljs-string">{2000}</span>
<span class="hljs-tag">       </span><span class="hljs-attr">onClose</span><span class="hljs-tag">=</span><span class="hljs-string">{()</span><span class="hljs-tag"> =&gt;</span> setOpen(false)}
       message=<span class="hljs-string">"Car deleted"</span>
    /&gt;
  <span class="hljs-tag">&lt;/&gt;</span>
);
</code></pre>
      </li>
      <li class="numberedList">Now, you will see the <strong class="screenText">EXPORT</strong> button<a id="_idIndexMarker727"/> in the grid. If you press<a id="_idIndexMarker728"/> the button and select <strong class="screenText">Download as CSV</strong>, the grid data is exported to a CSV file. You can <strong class="screenText">Print</strong> your grid using the <strong class="screenText">EXPORT</strong> button, and you will get a printer-friendly version of your page (you can also hide and filter columns and set row density using the toolbar):</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B19818_13_18.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 13.18: Export CSV</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">You can change the page title and icon by editing the <code class="inlineCode">index.html</code> page, as shown in the following code. The icon can be found in your project’s <code class="inlineCode">public</code> folder, and you can use your own icon instead of Vite’s default one:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span><span class="hljs-meta">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">html</span><span class="hljs-tag"> </span><span class="hljs-attr">lang</span><span class="hljs-tag">=</span><span class="hljs-string">"en"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">head</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span><span class="hljs-tag"> </span><span class="hljs-attr">charset</span><span class="hljs-tag">=</span><span class="hljs-string">"UTF-8"</span><span class="hljs-tag"> /&gt;</span>
    <span class="code-highlight"><strong class="hljs-slc">&lt;</strong><strong class="hljs-name-slc">link</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">rel</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"icon"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">type</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"image/svg+xml"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">href</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">/vite.svg"</strong><strong class="hljs-tag-slc"> /&gt;</strong></span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"viewport"</span><span class="hljs-tag"> </span><span class="hljs-attr">content</span><span class="hljs-tag">=</span><span class="hljs-string">"width=device-width, initial-</span>
<span class="hljs-string">                                   scale=1.0"</span><span class="hljs-tag"> /&gt;</span>
    <span class="code-highlight"><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">title</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Car Shop</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">title</strong><strong class="hljs-tag-slc">&gt;</strong></span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">body</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"root"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"module"</span><span class="hljs-tag"> </span><span class="hljs-attr">src</span><span class="hljs-tag">=</span><span class="hljs-string">"/src/main.tsx"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">script</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span><span class="hljs-tag">&gt;</span>
</code></pre>
      </li>
    </ol>
    <p class="normal">Now, all the functionalities<a id="_idIndexMarker729"/> have been<a id="_idIndexMarker730"/> implemented. In <em class="chapterRef">Chapter 14</em>, <em class="italic">Styling the Frontend with React MUI</em>, we will focus on styling the frontend.</p>
    <h1 id="_idParaDest-177" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we implemented all the functionalities for our app. We started with fetching the cars from the backend and showing these in the MUI <code class="inlineCode">DataGrid</code>, which provides paging, sorting, and filtering features. Then, we implemented the delete functionality and used the <code class="inlineCode">SnackBar</code> component to give feedback to the user.</p>
    <p class="normal">The add and edit functionalities were implemented using the MUI modal <code class="inlineCode">dialog</code> component. Finally, we implemented the ability to export data to a CSV file.</p>
    <p class="normal">In the next chapter, we are going to style the rest of our frontend using the React Material UI component library.</p>
    <h1 id="_idParaDest-178" class="heading-1">Questions</h1>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">How do you fetch and present data using the REST API with React?</li>
      <li class="numberedList">How do you delete data using the REST API with React?</li>
      <li class="numberedList">How do you show toast messages with React and MUI?</li>
      <li class="numberedList">How do you add data using the REST API with React?</li>
      <li class="numberedList">How do you update data using the REST API with React?</li>
      <li class="numberedList">How do you export data to a CSV file with React?</li>
    </ol>
    <h1 id="_idParaDest-179" class="heading-1">Further reading</h1>
    <p class="normal">There are other good resources available for learning about React and React Query. For example:</p>
    <ul>
      <li class="bulletList"><em class="italic">Practical React Query – TkDoDo’s blog</em>, by Dominik Dorfmeister (<a href="https://tkdodo.eu/blog/practical-react-query"><span class="url">https://tkdodo.eu/blog/practical-react-query</span></a>)</li>
      <li class="bulletList"><em class="italic">Material Design Blog</em>, by Google (<a href="https://material.io/blog/"><span class="url">https://material.io/blog/</span></a>)</li>
    </ul>
    <h1 class="heading-1">Learn more on Discord</h1>
    <p class="normal">To join the Discord community for this book – where you can share feedback, ask the author questions, and learn about new releases – follow the QR code below:</p>
    <p class="normal"><a href="https://packt.link/FullStackSpringBootReact4e"><span class="url">https://packt.link/FullStackSpringBootReact4e</span></a></p>
    <p class="normal"><img src="../Images/QR_Code10796108009382640.png" alt="" role="presentation"/></p>
  </div>
</body></html>