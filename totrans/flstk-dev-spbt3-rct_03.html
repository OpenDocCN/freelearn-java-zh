<html><head></head><body>
  <div id="_idContainer040" class="Basic-Text-Frame">
    <h1 class="chapterNumber">2</h1>
    <h1 id="_idParaDest-31" class="chapterTitle">Understanding Dependency Injection</h1>
    <p class="normal">In this chapter, we will learn what <strong class="keyWord">dependency injection</strong> (<strong class="keyWord">DI</strong>) is and how we can use it with the Spring Boot framework. The Spring Boot framework provides DI; therefore, it is good to understand the basics. DI allows for loose coupling between components, making your code more flexible, maintainable, and testable.</p>
    <p class="normal">In this chapter, we will look into the following:</p>
    <ul>
      <li class="bulletList">Introducing dependency injection</li>
      <li class="bulletList">Using dependency injection in Spring Boot</li>
    </ul>
    <h1 id="_idParaDest-32" class="heading-1">Technical requirements</h1>
    <p class="normal">All of the code for this chapter can be found at the following GitHub link: <a href="https://github.com/PacktPublishing/Full-Stack-Development-with-Spring-Boot-3-and-React-Fourth-Edition/tree/main/Chapter02"><span class="url">https://github.com/PacktPublishing/Full-Stack-Development-with-Spring-Boot-3-and-React-Fourth-Edition/tree/main/Chapter02</span></a>.</p>
    <h1 id="_idParaDest-33" class="heading-1">Introducing dependency injection</h1>
    <p class="normal">Dependency injection<a id="_idIndexMarker049"/> is a software development technique whereby we can create objects that depend on other objects. DI helps with interaction between classes, but at the same time keeps the classes independent.</p>
    <p class="normal">There are three types of classes in DI:</p>
    <ul>
      <li class="bulletList">A <strong class="keyWord">service</strong> is a class that<a id="_idIndexMarker050"/> can be<a id="_idIndexMarker051"/> used (this is the dependency).</li>
      <li class="bulletList">The <strong class="keyWord">client</strong> is a class<a id="_idIndexMarker052"/> that uses<a id="_idIndexMarker053"/> the dependency.</li>
      <li class="bulletList">The <strong class="keyWord">injector</strong> passes the dependency (the service) to the<a id="_idIndexMarker054"/> dependent<a id="_idIndexMarker055"/> class (the client).</li>
    </ul>
    <p class="normal">The three types of classes in DI are shown in the following diagram:</p>
    <figure class="mediaobject"><img src="../Images/B19818_02_01.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 2.1: DI classes</p>
    <p class="normal">DI makes classes<a id="_idIndexMarker056"/> loosely coupled. This means that the creation of client dependencies is separated from the client’s behavior, which makes unit testing easier.</p>
    <p class="normal">Let’s take a look at a simplified example of DI using Java code. In the following code, we don’t have DI, because the <code class="inlineCode">Car</code> client class is creating an object of the service class:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> {
    <span class="hljs-keyword">private</span> Owner owner;
  
    <span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">()</span> {
        owner = <span class="hljs-keyword">new</span> <span class="hljs-title">Owner</span>();
    }
}
</code></pre>
    <p class="normal">In the following code, the service object is not directly created in the client class. It is passed as a parameter in the class constructor:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> {
    <span class="hljs-keyword">private</span> Owner owner;
  
    <span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(Owner owner)</span> {
        <span class="hljs-built_in">this</span>.owner = owner;
    }
}
</code></pre>
    <p class="normal">The service class<a id="_idIndexMarker057"/> can also be an abstract class; we can then use any implementation of that in our client class and use mocks when testing.</p>
    <p class="normal">There are different types of dependency injection; let’s take a look at two of them here:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Constructor injection</strong>: Dependencies are passed<a id="_idIndexMarker058"/> to a client class<a id="_idIndexMarker059"/> constructor. An example of constructor injection was already shown in the preceding <code class="inlineCode">Car</code> code. Constructor injection is recommended to use for mandatory dependencies. All dependencies are provided using the class constructor and an object cannot be created without its required dependencies.</li>
      <li class="bulletList"><strong class="keyWord">Setter injection</strong>: Dependencies are provided through<a id="_idIndexMarker060"/> setters. The following<a id="_idIndexMarker061"/> code shows an example of setter injection:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> {
    <span class="hljs-keyword">private</span> Owner owner;
  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setOwner</span><span class="hljs-params">(Owner owner)</span> {
        <span class="hljs-built_in">this</span>.owner = owner;
    }
}
</code></pre>
      </li>
    </ul>
    <p class="normal">Here, the dependency is now passed in the setter as an argument. Setter injection is more flexible because objects can be created without all their dependencies. This approach allows for optional dependencies.</p>
    <p class="normal">The DI reduces dependencies in your code and makes your code more reusable. It also improves the testability of your code. We have now learned the basics of DI. Next, we will look at how DI is used in Spring Boot.</p>
    <h1 id="_idParaDest-34" class="heading-1">Using dependency injection in Spring Boot</h1>
    <p class="normal">In the Spring Framework, dependency<a id="_idIndexMarker062"/> injection is achieved<a id="_idIndexMarker063"/> through the Spring <code class="inlineCode">ApplicationContext</code>. <code class="inlineCode">ApplicationContext</code> is responsible for creating<a id="_idIndexMarker064"/> and managing objects – <strong class="keyWord">beans</strong> – and their dependencies.</p>
    <p class="normal">Spring Boot scans your application classes and registers classes with certain annotations (<code class="inlineCode">@Service</code>, <code class="inlineCode">@Repository</code>, <code class="inlineCode">@Controller</code>, and so on) as Spring beans. These beans can then be injected using dependency injection.</p>
    <p class="normal">Spring Boot supports several dependency injection mechanisms, and the most common ones are:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Constructor injection</strong>: Dependencies are injected<a id="_idIndexMarker065"/> through a constructor. This is the most recommended way because it ensures that all required dependencies are available when the object is created. A fairly common situation is when we need database access for some operations. In Spring Boot, we use repository classes for that. In this situation, we can inject the repository class using constructor injection and start using its methods, as shown in the code example below:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Constructor injection</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CarRepository carRepository;
    <span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(CarRepository carRepository)</span> {
        <span class="hljs-built_in">this</span>.carRepository = carRepository;
    }
  
    <span class="hljs-comment">// Fetch all cars from db </span>
    carRepository.findAll();
}
</code></pre>
    <p class="normal">If you have multiple constructors in your class, you have to use the <code class="inlineCode">@Autowired</code> annotation to define which constructor is used for dependency injection:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Constructor to used for dependency injection</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(CarRepository carRepository)</span> {
    <span class="hljs-built_in">this</span>.carRepository = carRepository;
}
</code></pre>
      </li>
    </ul>
    <ul>
      <li class="bulletList"><strong class="keyWord">Setter injection</strong>: Dependencies are injected through setter methods. Setter injection<a id="_idIndexMarker066"/> is useful if you have optional dependencies or if you want to modify dependencies at runtime. Below is an example of setter injection:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Setter injection</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AppUserService</span> {
    <span class="hljs-keyword">private</span> AppUserRepository userRepository;
<span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAppUserRepository</span><span class="hljs-params">(</span>
<span class="hljs-params">        AppUserRepository userRepository)</span> {
            <span class="hljs-built_in">this</span>.userRepository = userRepository;
        }
    <span class="hljs-comment">// Other methods that use userRepository</span>
}
</code></pre>
      </li>
      <li class="bulletList"><strong class="keyWord">Field injection</strong>: Dependencies are injected directly<a id="_idIndexMarker067"/> into fields. The benefit of field injection is its simplicity, but it has some drawbacks. It can cause runtime errors if the dependency is not available. It is also harder to test your class because you can’t mock the dependencies for testing. Here is an example:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Field injection</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CarDatabaseService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CarService</span> {
<span class="hljs-comment">// Car database services</span>
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CarController</span> {
    <span class="code-highlight"><strong class="hljs-slc">@Autowired</strong></span>
    <span class="hljs-keyword">private</span> CarDatabaseService carDatabaseService;
<span class="hljs-comment">//...</span>
}
</code></pre>
      </li>
    </ul>
    <div class="note">
      <p class="normal">You can read more about Spring Boot injection<a id="_idIndexMarker068"/> in the Spring documentation: <span class="url">https://spring.io/guides</span>.</p>
    </div>
    <h1 id="_idParaDest-35" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we learned what dependency injection is and how to use it in the Spring Boot framework, which we are using in our backend.</p>
    <p class="normal">In the next chapter, we will look at how we can use the <strong class="keyWord">Java Persistent API</strong> (<strong class="keyWord">JPA</strong>) with Spring Boot and how to set up a MariaDB database. We will also learn about the creation of CRUD repositories and the one-to-many connection between database tables.</p>
    <h1 id="_idParaDest-36" class="heading-1">Questions</h1>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">What is dependency injection?</li>
      <li class="numberedList">How does the <code class="inlineCode">@Autowired</code> annotation work in Spring Boot?</li>
      <li class="numberedList">How do you inject resources in Spring Boot?</li>
    </ol>
    <h1 id="_idParaDest-37" class="heading-1">Further reading</h1>
    <p class="normal">Packt has some video resources for learning about Spring Boot:</p>
    <ul>
      <li class="bulletList"><em class="italic">Learn Spring Core Framework the Easy Way</em>, by Karthikeya T. (<a href="https://www.packtpub.com/product/learn-spring-core-framework-the-easy-way-video/9781801071680"><span class="url">https://www.packtpub.com/product/learn-spring-core-framework-the-easy-way-video/9781801071680</span></a>)</li>
      <li class="bulletList"><em class="italic">Mastering Spring Framework Fundamentals</em>, by Matthew Speake (<a href="https://www.packtpub.com/product/mastering-spring-framework-fundamentals-video/9781801079525"><span class="url">https://www.packtpub.com/product/mastering-spring-framework-fundamentals-video/9781801079525</span></a>)</li>
    </ul>
    <h1 class="heading-1">Learn more on Discord</h1>
    <p class="normal">To join the Discord community for this book – where you can share feedback, ask the author questions, and learn about new releases – follow the QR code below:</p>
    <p class="normal"><a href="https://packt.link/FullStackSpringBootReact4e"><span class="url">https://packt.link/FullStackSpringBootReact4e</span></a></p>
    <p class="normal"><img src="../Images/QR_Code10796108009382640.png" alt="" role="presentation"/></p>
  </div>
</body></html>