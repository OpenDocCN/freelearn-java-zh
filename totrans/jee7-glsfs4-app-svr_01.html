<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Getting Started with GlassFish"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started with GlassFish</h1></div></div></div><p>In this chapter, we will discuss how to get started with GlassFish. The following are some of the topics discussed in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An overview of Java EE and GlassFish</li><li class="listitem" style="list-style-type: disc">Obtaining GlassFish</li><li class="listitem" style="list-style-type: disc">Installing and starting GlassFish</li><li class="listitem" style="list-style-type: disc">Explaining the concept of GlassFish domains</li><li class="listitem" style="list-style-type: disc">Deploying Java EE applications</li><li class="listitem" style="list-style-type: disc">Setting up Database Connectivity</li></ul></div><div class="section" title="An Overview of Java EE and GlassFish"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>An Overview of Java EE and GlassFish</h1></div></div></div><p>
<span class="strong"><strong>Java Enterprise Edition</strong></span> (<span class="strong"><strong>Java EE</strong></span>,<a id="id0" class="indexterm"/> formerly called <span class="strong"><strong>J2EE</strong></span> or <span class="strong"><strong>Java 2 Enterprise Edition</strong></span>) is a standard set of technologies for server-side Java development. Java EE technologies include <span class="strong"><strong>JavaServer Faces</strong></span> (<span class="strong"><strong>JSF</strong></span>), <span class="strong"><strong>Enterprise JavaBeans</strong></span> (<span class="strong"><strong>EJBs</strong></span>), the <span class="strong"><strong>Java Messaging Service</strong></span> (<span class="strong"><strong>JMS</strong></span>), the <span class="strong"><strong>Java Persistence API</strong></span> (<span class="strong"><strong>JPA</strong></span>), the Java API for WebSocket, <span class="strong"><strong>Contexts and Dependency Injection</strong></span> (<span class="strong"><strong>CDI</strong></span>), the <span class="strong"><strong>Java API for XML Web Services</strong></span> (<span class="strong"><strong>JAX-WS</strong></span>), the <span class="strong"><strong>Java API for RESTful Web Services</strong></span> (<span class="strong"><strong>JAX-RS</strong></span>), and the <span class="strong"><strong>Java API for JSON Processing</strong></span> (<span class="strong"><strong>JSON-P</strong></span>), among others.</p><p>Several commercial and open source application servers exist. Java EE application servers allow developers to develop and deploy Java EE-compliant applications, GlassFish being one of them. Other open source Java EE application servers include Red Hat's WildFly (formerly JBoss), the Apache Software Foundation's Geronimo, and ObjectWeb's JOnAS. Commercial application servers include Oracle's WebLogic, IBM's WebSphere, and the Oracle Application Server.</p><p>GlassFish<a id="id1" class="indexterm"/> is the Java EE 7 reference implementation; as such, it implements the latest Java EE APIs before any other application server in the market. GlassFish is open source and freely available, and is licensed under the<a id="id2" class="indexterm"/> <span class="strong"><strong>Common Development and Distribution License</strong></span> (<span class="strong"><strong>CDDL</strong></span>).</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>You can find out more about the CDDL license at <a class="ulink" href="http://opensource.org/licenses/CDDL-1.0">http://opensource.org/licenses/CDDL-1.0</a>.</p></div></div><p>Like all Java EE-compliant application servers, GlassFish provides the necessary libraries to allow us to develop and deploy Java applications compliant with Java EE specifications.</p><div class="section" title="What's new in Java EE 7?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>What's new in Java EE 7?</h2></div></div></div><p>Java EE 7, the latest version of the Java EE specification, includes several improvements and additions to the specification. The following sections list the major improvements to the specifications that are of interest to enterprise application developers:</p><div class="section" title="JavaServer Faces (JSF) 2.2"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec01"/>JavaServer Faces (JSF) 2.2</h3></div></div></div><p>Java EE 7 includes a new version of the <span class="strong"><strong>JavaServer Faces</strong></span> (<span class="strong"><strong>JSF</strong></span>) <a id="id3" class="indexterm"/>specification. JSF 2.2 includes the following notable new<a id="id4" class="indexterm"/> features:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">JSF 2.2 features the HTML5 friendly markup, that is, web pages can be written using the standard HTML 5 markup and using JSF-specific attributes on the HTML tags.</li><li class="listitem" style="list-style-type: disc">JSF 2.2 also includes Faces Flows, which provides a way to encapsulate related pages with defined entry and exit points.</li><li class="listitem" style="list-style-type: disc">Resource library contracts are the third major JSF feature introduced in JSF 2.2. Resource library contracts allow us to easily develop web applications that can have a different look and feel for different users using JSF.</li></ul></div></div><div class="section" title="Java Persistence API (JPA) 2.1"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec02"/>Java Persistence API (JPA) 2.1</h3></div></div></div><p>JPA was introduced as a standard part of Java EE in version 5<a id="id5" class="indexterm"/> of the specification. JPA replaced entity beans as the standard object relational mapping framework for Java EE. JPA adopted ideas from third-party object relational frameworks such as Hibernate and JDO, and made them a part of the standard.</p><p>JPA 2.1<a id="id6" class="indexterm"/> introduces the<a id="id7" class="indexterm"/> following new features:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">JPA 2.1 introduces the concept of <span class="strong"><strong>Converters</strong></span>,<a id="id8" class="indexterm"/> which allows custom code conversions between values stored in the database and values stored in Java objects. For instance, a common problem when working with database data is that the desired value in Java code differs from the value stored in the database. For example,<a id="id9" class="indexterm"/> the values <code class="literal">1</code> and <code class="literal">0</code> are commonly stored in the database to denote <code class="literal">true</code> and <code class="literal">false</code> respectively. Java has a perfectly good boolean type, so <code class="literal">true</code> and <code class="literal">false</code> can be used directly.</li><li class="listitem" style="list-style-type: disc">The JPA Criteria API can now perform bulk updates and deletes.</li><li class="listitem" style="list-style-type: disc">JPA 2.1 now supports stored procedures.</li><li class="listitem" style="list-style-type: disc">JPA 2.1 introduces<a id="id10" class="indexterm"/> the <code class="literal">@ConstructorResult</code> annotation, which allows returning standard Java classes (but not the JPA entities) from native SQL queries.</li></ul></div></div><div class="section" title="Java API for RESTful Web Services (JAX-RS) 2.0"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec03"/>Java API for RESTful Web Services (JAX-RS) 2.0</h3></div></div></div><p>JAX-RS is a Java API for developing RESTful web services. RESTful web services use the <span class="strong"><strong>Representational State Transfer</strong></span> (<span class="strong"><strong>REST</strong></span>) architecture<a id="id11" class="indexterm"/>. <a id="id12" class="indexterm"/>Java EE 6 adopted JAX-RS as an official part of the Java EE specification.</p><p>JAX-RS 2.0<a id="id13" class="indexterm"/> includes<a id="id14" class="indexterm"/> the following new features:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">JAX-RS 2.0 introduces a new client-side API. While previous versions of JAX-RS made it easy to develop RESTful web services, each implementation defined its own proprietary client-side API.</li><li class="listitem" style="list-style-type: disc">Extension points, method filters, and entity interceptors are also introduced in JAX-RS 2.0. These features allow <span class="strong"><strong>Aspect Oriented Programming</strong></span> (<span class="strong"><strong>AOP</strong></span>)<a id="id15" class="indexterm"/> when developing RESTful web services.</li><li class="listitem" style="list-style-type: disc">JAX-RS 2.0 also introduces asynchronous processing both on the server side and as part of the client API.</li></ul></div></div><div class="section" title="Java Message Service (JMS) 2.0"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec04"/>Java Message Service (JMS) 2.0</h3></div></div></div><p>The <span class="strong"><strong>Java Message Service</strong></span> (<span class="strong"><strong>JMS</strong></span>) API has been completely <a id="id16" class="indexterm"/>revamped in Java EE 7. Previous versions of JMS required lots<a id="id17" class="indexterm"/> of boilerplate code; with the new revamped JMS 2.0 API, this is no longer the case.</p></div><div class="section" title="Java API for JSON Processing (JSON-P) 1.0"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec05"/>Java API for JSON Processing (JSON-P) 1.0</h3></div></div></div><p>JSON-P is a brand new API introduced in Java EE 7. JSON-P<a id="id18" class="indexterm"/> allows<a id="id19" class="indexterm"/> us to parse and generate <span class="strong"><strong>JSON</strong></span> (<span class="strong"><strong>JavaScript Object Notation</strong></span>)<a id="id20" class="indexterm"/> strings.</p></div><div class="section" title="Java API for WebSocket 1.0"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec06"/>Java API for WebSocket 1.0</h3></div></div></div><p>Traditional web applications use a request-response model, that is, a client (typically a web browser)<a id="id21" class="indexterm"/> requests resources <a id="id22" class="indexterm"/>and the server provides a response. In this model, communication is always initiated by the client.</p><p>WebSockets were introduced as part of the HTML5 specification; they provide full-duplex communication between the client and the server.</p></div></div><div class="section" title="GlassFish advantages"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>GlassFish advantages</h2></div></div></div><p>With so many options in Java EE application servers, <a id="id23" class="indexterm"/>why choose GlassFish? Besides the obvious advantage of GlassFish being available free of charge, it offers the following benefits:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Java EE reference implementation</strong></span>: GlassFish is the Java EE reference implementation. What this means is that other application servers may use GlassFish to make sure their product complies with the specification. GlassFish could theoretically be used to debug other application servers. If an application deployed under another application server is not behaving properly, but it does behave properly when deployed under GlassFish, then more than likely the improper behavior is due to a bug in the other application server.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Supports the latest versions of the Java EE specification</strong></span>: Since GlassFish is the reference Java EE specification, it tends to implement the latest specifications before any other application server in the market. As a matter of fact, at the time of writing, GlassFish is the only Java EE application server in the market that supports the complete Java EE 7 specification.</li></ul></div></div></div></div>
<div class="section" title="Obtaining GlassFish"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Obtaining GlassFish</h1></div></div></div><p>GlassFish can be downloaded<a id="id24" class="indexterm"/> at <a class="ulink" href="https://glassfish.java.net">https://glassfish.java.net</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>GlassFish 4.0 is also bundled with the NetBeans IDE version 7.4 or newer.</p></div></div><p>Once there, you will<a id="id25" class="indexterm"/> see a window as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_01.jpg" alt="Obtaining GlassFish"/></div><p>Clicking on the <span class="strong"><strong>Download</strong></span> link takes <a id="id26" class="indexterm"/>us to a wizard page that provides several options to download GlassFish as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_02.jpg" alt="Obtaining GlassFish"/></div><p>The download page has several options; we can get the full Java EE platform or the web profile. We can also download GlassFish as a compressed ZIP file or as a native installer for the operating system of our choice.</p><p>To be able to follow all of the<a id="id27" class="indexterm"/> examples in this book, we need to download the full Java EE platform version of GlassFish. We will download the compressed ZIP file version since the instructions to install it are very similar across any operating system; feel free to download a platform-specific installer if you prefer.</p></div>
<div class="section" title="Installing GlassFish"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Installing GlassFish</h1></div></div></div><p>We will use the ZIP installer<a id="id28" class="indexterm"/> to illustrate the installation process. This installation process works under all major operating systems.</p><p>Installing GlassFish is an easy process; however, GlassFish assumes that some dependencies are present in your system.</p><div class="section" title="GlassFish dependencies"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>GlassFish dependencies</h2></div></div></div><p>In order to install GlassFish 4, a recent version of the <span class="strong"><strong>Java Development Kit</strong></span> (<span class="strong"><strong>JDK</strong></span>)<a id="id29" class="indexterm"/> must be installed on your workstation (JDK 1.7 or newer required), and the<a id="id30" class="indexterm"/> Java executable file must be in your system PATH. The latest JDK can be downloaded at <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>. Please refer to the<a id="id31" class="indexterm"/> JDK installation instructions for your particular platform at <a class="ulink" href="http://docs.oracle.com/javase/7/docs/webnotes/install/index.html">http://docs.oracle.com/javase/7/docs/webnotes/install/index.html</a>.</p></div><div class="section" title="Performing the installation"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Performing the installation</h2></div></div></div><p>Once JDK has been <a id="id32" class="indexterm"/>installed, the GlassFish installation can begin by simply extracting the download compressed file as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_03.jpg" alt="Performing the installation"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>All modern operating systems including Linux, Windows, and Mac OS X include out-of-the-box support to extract compressed ZIP files; consult your operating system<a id="id33" class="indexterm"/> documentation for details. </p></div></div><p>After extracting the ZIP file, a new directory named <code class="literal">glassfish4</code> will be created. This new directory contains our GlassFish installation.</p></div></div>
<div class="section" title="Starting GlassFish"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Starting GlassFish</h1></div></div></div><p>To start GlassFish from<a id="id34" class="indexterm"/> the command line, change your directory to <code class="literal">[glassfish installation directory]/glassfish4/bin</code> and execute the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./asadmin start-domain domain1</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>The preceding command, and most commands shown in this chapter, assume a Unix or Unix-like operating system such as Linux or Mac OS. For Windows systems, the initial <code class="literal">./</code> is not necessary.</p></div></div><p>A few short seconds after executing the preceding command, we should see a message similar to the following at the<a id="id35" class="indexterm"/> bottom of the terminal:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ~/GlassFish/glassfish4/bin $ ./asadmin start-domain</strong></span>
<span class="strong"><strong>Waiting for domain1 to start ........</strong></span>
<span class="strong"><strong>Successfully started the domain : domain1</strong></span>
<span class="strong"><strong>domain  Location: /home/heffel/GlassFish/glassfish4/glassfish/domains/domain1</strong></span>
<span class="strong"><strong>Log File: /home/heffel/GlassFish/glassfish4/glassfish/domains/domain1/logs/server.log</strong></span>
<span class="strong"><strong>Admin Port: 4848</strong></span>
<span class="strong"><strong>Command start-domain executed successfully.</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the sample code files for all the Packt books that you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div><p>We can then open a browser window and type the following URL in the browser's location text field:</p><p>
<code class="literal">http://localhost:8080</code>
</p><p>If everything goes well, we should see a page indicating that your GlassFish server is now running as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_04.jpg" alt="Starting GlassFish"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>
<span class="strong"><strong>Getting Help</strong></span>
</p><p>If any of the preceding <a id="id36" class="indexterm"/>steps fail or for help with GlassFish in general, a great resource is the GlassFish forum at <a class="ulink" href="https://www.java.net/forums/glassfish/glassfish">https://www.java.net/forums/glassfish/glassfish</a>.</p></div></div><div class="section" title="Deploying our first Java EE application"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Deploying our first Java EE application</h2></div></div></div><p>To further confirm that our<a id="id37" class="indexterm"/> GlassFish installation is<a id="id38" class="indexterm"/> running properly, we will deploy a <span class="strong"><strong>WAR</strong></span> (<span class="strong"><strong>Web ARchive</strong></span>) file<a id="id39" class="indexterm"/> and make sure the file deploys and executes properly. Before moving on, please download the file <code class="literal">simpleapp.war</code> from this book's web site at <a class="ulink" href="http://www.packtpub.com">www.packtpub.com</a>.</p><div class="section" title="Deploying an application through the Web Console"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec07"/>Deploying an application through the Web Console</h3></div></div></div><p>To deploy <code class="literal">simpleapp.war</code>, open <a id="id40" class="indexterm"/>a browser and navigate to <code class="literal">http://localhost:4848</code>. You should be greeted with the default GlassFish server administration page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_05.jpg" alt="Deploying an application through the Web Console"/></div><p>By default, GlassFish is installed<a id="id41" class="indexterm"/> in development mode. In this mode, it is not necessary to enter a username and password to access the GlassFish web console. In production environments, it is highly advisable to configure the web console so that it is password protected.</p><p>At this point, we should click on the <span class="strong"><strong>Deploy an Application</strong></span> item under the <span class="strong"><strong>Deployment</strong></span> section on the main <a id="id42" class="indexterm"/>screen.</p><p>To deploy our application, we should<a id="id43" class="indexterm"/> select the <span class="strong"><strong>Local Packaged File or Directory That is Accessible from GlassFish Server</strong></span> radio button and either type the path to our WAR file or select it by clicking on the <span class="strong"><strong>Browse Files...</strong></span> button. Once this is done, you will see a window as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_06.jpg" alt="Deploying an application through the Web Console"/></div><p>After we have selected our <a id="id44" class="indexterm"/>WAR file, a number of input fields that allow us to specify several options are shown. For<a id="id45" class="indexterm"/> our purposes, all defaults are fine. We can simply click on the <span class="strong"><strong>OK</strong></span> button at the top right of the page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_07.jpg" alt="Deploying an application through the Web Console"/></div><p>Once we deploy our application, the GlassFish web console displays the <span class="strong"><strong>Applications</strong></span> window<a id="id46" class="indexterm"/>, with our application listed as one of the deployed applications as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_08.jpg" alt="Deploying an application through the Web Console"/></div><p>To execute the <code class="literal">simpleapp</code> application,<a id="id47" class="indexterm"/> type the following<a id="id48" class="indexterm"/> URL in the browser's location text field:</p><p>
<code class="literal">http://localhost:8080/simpleapp/simpleservlet</code>
</p><p>The resulting page should look like the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_09.jpg" alt="Deploying an application through the Web Console"/></div><p>That's it! We have successfully deployed our first Java EE application.</p></div><div class="section" title="Undeploying an application through the GlassFish Admin Console"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec08"/>Undeploying an application through the GlassFish Admin Console</h3></div></div></div><p>To undeploy the application we just <a id="id49" class="indexterm"/>deployed, log in to the GlassFish Admin Console by typing the following URL in the browser:</p><p>
<code class="literal">http://localhost:4848</code>
</p><p>Then, either click on the <span class="strong"><strong>Applications</strong></span> menu item in the navigation pane on the left, or click on the <span class="strong"><strong>List Deployed Applications</strong></span> item on the administration console's home page.</p><p>Either way should take us to the<a id="id50" class="indexterm"/> application management page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_10.jpg" alt="Undeploying an application through the GlassFish Admin Console"/></div><p>The application can be undeployed simply by selecting the checkbox next to the <code class="literal">simpleapp</code> name from the list of deployed applications and clicking on the <span class="strong"><strong>Undeploy</strong></span> button<a id="id51" class="indexterm"/> above the list of deployed applications.</p><p>Once our application has been undeployed, it is no longer shown on the application management page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_11.jpg" alt="Undeploying an application through the GlassFish Admin Console"/></div></div><div class="section" title="Deploying an application through the command line"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec09"/>Deploying an application through the command line</h3></div></div></div><p>There are two ways in which an <a id="id52" class="indexterm"/>application can be deployed through the command line—it can be done either by copying the artifact we want to deploy to an <code class="literal">autodeploy</code> directory, or by using GlassFish's <code class="literal">asadmin</code> command-line utility.</p><div class="section" title="The autodeploy directory"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl4sec01"/>The autodeploy directory</h4></div></div></div><p>Now that we have <a id="id53" class="indexterm"/>undeployed the <code class="literal">simpleapp</code> WAR file, we are ready to deploy<a id="id54" class="indexterm"/> it using the command line. To deploy the application in this manner, simply copy <code class="literal">simpleapp.war</code> to <code class="literal">[glassfish installation directory]/glassfish4/glassfish/domains/domain1/autodeploy</code>. The application will automatically be deployed just by copying it to this directory.</p><p>We can verify that the application<a id="id55" class="indexterm"/> has successfully been deployed by looking at the server log. The server log can be found by typing <code class="literal">[glassfish installation directory]/glassfish4/glassfish/domains/domain1/logs/server.log</code>. The last few lines on this file should look something like the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[2013-08-02T10:57:45.387-0400] [glassfish 4.0] [INFO] [NCLS-DEPLOYMENT-00027] [javax.enterprise.system.tools.deployment.autodeploy] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455465387] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  Selecting file /home/heffel/GlassFish/glassfish4/glassfish/domains/domain1/autodeploy/simpleapp.war for autodeployment]]</strong></span>

<span class="strong"><strong>[2013-08-02T10:57:45.490-0400] [glassfish 4.0] [INFO] [] [javax.enterprise.system.tools.deployment.common] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455465490] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  visiting unvisited references]]</strong></span>

<span class="strong"><strong>[2013-08-02T10:57:45.628-0400] [glassfish 4.0] [INFO] [AS-WEB-GLUE-00172] [javax.enterprise.web] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455465628] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  Loading application [simpleapp] at [/simpleapp]]]</strong></span>

<span class="strong"><strong>[2013-08-02T10:57:45.714-0400] [glassfish 4.0] [INFO] [] [javax.enterprise.system.core] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455465714] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  simpleapp was successfully deployed in 302 milliseconds.]]</strong></span>

<span class="strong"><strong>[2013-08-02T10:57:45.723-0400] [glassfish 4.0] [INFO] [NCLS-DEPLOYMENT-00035] [javax.enterprise.system.tools.deployment.autodeploy] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455465723] [levelValue: 800] [[</strong></span>


<span class="strong"><strong>  [AutoDeploy] Successfully autodeployed : /home/heffel/GlassFish/glassfish4/glassfish/domains/domain1/autodeploy/simpleapp.war.]]</strong></span>
</pre></div><p>We can, of course, also verify<a id="id56" class="indexterm"/> the deployment by navigating to the same URL for the application, which we used when deploying through the web console: <code class="literal">http://localhost:8080/simpleapp/simpleservlet</code>.</p><p>Once here, the<a id="id57" class="indexterm"/> application should execute properly.</p><p>An application deployed this way can be undeployed by simply deleting the artifact (WAR file, in our case) from<a id="id58" class="indexterm"/> the <code class="literal">autodeploy</code> directory. After deleting the file, we should see a message similar to the following in the server log:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[2013-08-02T11:01:57.410-0400] [glassfish 4.0] [INFO] [NCLS-DEPLOYMENT-00026] [javax.enterprise.system.tools.deployment.autodeploy] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455717410] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  Autoundeploying application:  simpleapp]]</strong></span>


<span class="strong"><strong>[2013-08-02T11:01:57.475-0400] [glassfish 4.0] [INFO] [NCLS-DEPLOYMENT-00035] [javax.enterprise.system.tools.deployment.autodeploy] [tid: _ThreadID=91 _ThreadName=AutoDeployer] [timeMillis: 1375455717475] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  [AutoDeploy] Successfully autoundeployed : /home/heffel/GlassFish/glassfish4/glassfish/domains/domain1/autodeploy/simpleapp.war.]]</strong></span>
</pre></div></div><div class="section" title="The asadmin command-line utility"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl4sec02"/>The asadmin command-line utility</h4></div></div></div><p>An alternate way of deploying <a id="id59" class="indexterm"/>an application through the command<a id="id60" class="indexterm"/> line is to use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin deploy [path to file]/simpleapp.war</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>The preceding command must be executed from the <code class="literal">[glassfish installation directory]/glassfish4/bin</code> path.</p></div></div><p>We should see the following confirmation on the command line terminal letting us know that the file was deployed successfully:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Application deployed with name simpleapp.</strong></span>

<span class="strong"><strong>Command deploy executed successfully.</strong></span>
</pre></div><p>The server logfile should show a message similar to the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[2013-08-02T11:05:34.583-0400] [glassfish 4.0] [INFO] [AS-WEB-GLUE-00172] [javax.enterprise.web] [tid: _ThreadID=37 _ThreadName=admin-listener(5)] [timeMillis: 1375455934583] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  Loading application [simpleapp] at [/simpleapp]]]</strong></span>

<span class="strong"><strong>[2013-08-02T11:05:34.608-0400] [glassfish 4.0] [INFO] [] [javax.enterprise.system.core] [tid: _ThreadID=37 _ThreadName=admin-listener(5)] [timeMillis: 1375455934608] [levelValue: 800] [[</strong></span>

<span class="strong"><strong>  simpleapp was successfully deployed in 202 milliseconds.]]</strong></span>
</pre></div><p>The <code class="literal">asadmin</code> executable can be used to undeploy an application as well by issuing a command like the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin undeploy simpleapp</strong></span>
</pre></div><p>The following message should be shown at the bottom of the terminal window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Command undeploy executed successfully.</strong></span>
</pre></div><p>Please note that the file<a id="id61" class="indexterm"/> extension is not used to undeploy the application, the argument to <code class="literal">asadmin undeplo</code>y should be the application name, <a id="id62" class="indexterm"/>which is, by default, the<a id="id63" class="indexterm"/> WAR file name (minus the extension).</p></div></div></div></div>
<div class="section" title="GlassFish domains"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>GlassFish domains</h1></div></div></div><p>Alert readers might have noticed that the <code class="literal">autodeploy</code> directory is under a <code class="literal">domains/domain1</code> subdirectory. <a id="id64" class="indexterm"/>GlassFish has a concept of domains. Domains allow a collection of related applications to be deployed together. Several domains can be started concurrently. GlassFish domains behave like individual GlassFish instances; a default domain called <code class="literal">domain1</code> is created when installing GlassFish.</p><div class="section" title="Creating Domains"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Creating Domains</h2></div></div></div><p>Additional domains can<a id="id65" class="indexterm"/> be created from the command line by issuing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin create-domain domainname</strong></span>
</pre></div><p>The preceding command takes several parameters to specify ports where the domain will listen to for several services (HTTP, Admin, JMS, IIOP, Secure HTTP, and so on). Type the following command in the command line to see these parameters:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin create-domain --help</strong></span>
</pre></div><p>If we want several domains to execute concurrently on the same server, these ports must be chosen carefully since specifying the same ports for different services (or even the same service across domains) will prevent one of the domains from working properly.</p><p>The default ports for the default <code class="literal">domain1</code> domain are listed in the following table:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Service</p>
</th><th style="text-align: left" valign="bottom">
<p>Port</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Admin</p>
</td><td style="text-align: left" valign="top">
<p>4848</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>HTTP</p>
</td><td style="text-align: left" valign="top">
<p>8080</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Java Messaging System (JMS)</p>
</td><td style="text-align: left" valign="top">
<p>7676</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Internet Inter-ORB Protocol (IIOP)</p>
</td><td style="text-align: left" valign="top">
<p>3700</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Secure HTTP (HTTPS)</p>
</td><td style="text-align: left" valign="top">
<p>8181</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Secure IIOP</p>
</td><td style="text-align: left" valign="top">
<p>3820</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Mutual Authorization IIOP</p>
</td><td style="text-align: left" valign="top">
<p>3920</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Java Management Extensions (JMX) administration</p>
</td><td style="text-align: left" valign="top">
<p>8686</p>
</td></tr></tbody></table></div><p>Please note that when creating a domain, the only port that needs to be specified is the admin port. If the other ports <a id="id66" class="indexterm"/>are not specified, the default ports listed in the preceding table will be used. Care must be taken when creating a domain, since, as explained above, two domains cannot run concurrently in the same server if any of their services listen for connections on the same port.</p><p>An alternate method of creating a domain, without having to specify ports for every service, is to issue the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin create-domain --portbase [port number] domainname</strong></span>
</pre></div><p>The value of the <code class="literal">--portbase</code> parameter<a id="id67" class="indexterm"/> dictates the base port for the domain; ports for the different services will be offsets of the given port number. The following table lists the ports assigned to all the different services:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Service</p>
</th><th style="text-align: left" valign="bottom">
<p>Port</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Admin</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 48</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>HTTP</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 80</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Java Messaging System (JMS)</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 76</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Internet Inter-ORB Protocol (IIOP)</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 37</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Secure HTTP (HTTPS)</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 81</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Secure IIOP</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 38</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Mutual Authorization IIOP</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 39</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Java Management Extensions (JMX) administration</p>
</td><td style="text-align: left" valign="top">
<p>portbase + 86</p>
</td></tr></tbody></table></div><p>Of course, care must be taken when choosing the value for <code class="literal">--portbase</code>, making sure that none of the assigned ports collide with any other domain.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>As a rule of thumb, creating domains using a portbase number greater than 8000 and divisible by 1000 should create domains that don't conflict with each other. For example, it should be <a id="id68" class="indexterm"/>safe to create a domain using a portbase of 9000, another one using a portbase of 10000, so on and so forth.</p></div></div></div><div class="section" title="Deleting domains"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Deleting domains</h2></div></div></div><p>Deleting a domain is very simple.<a id="id69" class="indexterm"/> It can be accomplished by issuing the following command in the command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin delete-domain domainname</strong></span>
</pre></div><p>We should see the following message on the terminal window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Command delete-domain executed successfully.</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>Please use the preceding command with care. Once a domain is deleted, it cannot be easily recreated (all deployed applications as well as any connection pools, data sources, and so on will be gone).</p></div></div></div><div class="section" title="Stopping a domain"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Stopping a domain</h2></div></div></div><p>A domain that is running<a id="id70" class="indexterm"/> can be stopped by issuing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin stop-domain domainname</strong></span>
</pre></div><p>The preceding command will stop the domain named <code class="literal">domainname</code>.</p><p>If only one domain is running, the <code class="literal">domainname</code> argument is optional, that is, we can simply stop the running domain by issuing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>asadmin stop-domain</strong></span>
</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>This book will assume that the reader is working with the default domain called <code class="literal">domain1</code> and the default ports. If this is not the case, instructions given need to be modified to match the appropriate domain and port.</p></div></div></div></div>
<div class="section" title="Setting up Database Connectivity"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Setting up Database Connectivity</h1></div></div></div><p>Any nontrivial Java EE application<a id="id71" class="indexterm"/> will connect to a <span class="strong"><strong>Relational Database Management System</strong></span> (<span class="strong"><strong>RDBMS</strong></span>)<a id="id72" class="indexterm"/>. Supported RDBMS systems include Java DB, Oracle, Derby, Sybase, DB2, PointBase, MySQL, PostgreSQL, Informix, Cloudscape, and SQL Server. In this section, we will demonstrate how to set up GlassFish to communicate with a MySQL <a id="id73" class="indexterm"/>database. The procedure is similar for other RDBMS systems.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>GlassFish comes bundled with an RDBMS called JavaDB. This RDBMS is based on Apache Derby. To limit the download and configuration needed to follow this book's code, all examples needing an RDBMS will use the bundled JavaDB RDBMS. The instructions in this section are to illustrate how to connect GlassFish to a third-party RDBMS.</p></div></div><div class="section" title="Setting up connection pools"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>Setting up connection pools</h2></div></div></div><p>Opening and closing the database connections<a id="id74" class="indexterm"/> is a relatively slow operation. For performance reasons, GlassFish and other Java EE application servers keep a pool of open database connections; when a deployed application requires<a id="id75" class="indexterm"/> a database connection, one is provided from the pool; when the application no longer needs the database connection, the said connection is returned to the pool.</p><p>The first step to follow when setting up a connection pool is to copy the JAR file containing the JDBC driver for our RDBMS in the <code class="literal">lib</code> directory of the domain (consult your RDBMS documentation for information on where to obtain this JAR file). If the GlassFish domain where we want to add the connection pool is running when copying the JDBC driver, it must be restarted for the change to take effect. The domain can be restarted by executing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong> asadmin restart-domain domainname</strong></span>
</pre></div><p>Once the JDBC driver has been copied to the appropriate location and the application server has been restarted, log in to the admin console by pointing the browser to <code class="literal">http://localhost:4848</code>.</p><p>Then, navigate to <span class="strong"><strong>Resources</strong></span> | <span class="strong"><strong>JDBC</strong></span> | <span class="strong"><strong>JDBC Connection Pools</strong></span>. The browser should now look something like what is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_12.jpg" alt="Setting up connection pools"/></div><p>Click on the <span class="strong"><strong>New...</strong></span> button. After entering<a id="id76" class="indexterm"/> the appropriate<a id="id77" class="indexterm"/> values for our RDBMS, the main area of the page should look something like the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_13.jpg" alt="Setting up connection pools"/></div><p>After clicking on the <span class="strong"><strong>Next</strong></span> button, we should see a page similar to the one shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_14.jpg" alt="Setting up connection pools"/></div><p>Most of the default values on the top portion <a id="id78" class="indexterm"/>of the page shown in the preceding screenshot are sensible. Scroll all the way down and enter the appropriate property values for our RDBMS (at a minimum, username, password, and URL).<a id="id79" class="indexterm"/> Then, click on the <span class="strong"><strong>Finish</strong></span> button at the top right of the screen.</p><p>Property names vary depending on the RDBMS we are using, but usually there is a URL property where we should enter the JDBC URL for our database, plus username and password properties where we should enter authentication credentials for our database.</p><p>Our newly created connection pool should now be visible in the list of connection pools as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_15.jpg" alt="Setting up connection pools"/></div><p>In some cases, the GlassFish domain may<a id="id80" class="indexterm"/> need to be restarted <a id="id81" class="indexterm"/>after setting up a new connection pool.</p><p>We can verify that our connection pool was successfully set up by clicking on its pool name and then enabling the <span class="strong"><strong>Ping</strong></span> button on the resulting page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_16.jpg" alt="Setting up connection pools"/></div><p>Our connection pool is now ready to be<a id="id82" class="indexterm"/> used by<a id="id83" class="indexterm"/> our applications.</p></div><div class="section" title="Setting up the data sources"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>Setting up the data sources</h2></div></div></div><p>Java EE applications don't access <a id="id84" class="indexterm"/>connection pools directly; they access a data source instead, which points to a connection pool. To set up a new <a id="id85" class="indexterm"/>data source, click on the <span class="strong"><strong>JDBC</strong></span> icon under the <span class="strong"><strong>Resources</strong></span> menu item on the left-hand side of the web console, then click on the <span class="strong"><strong>JDBC Connection Pools</strong></span> tab, and then click on the <span class="strong"><strong>New...</strong></span> button. After filling out the appropriate information for our new data source, the main area of the web console should look something like what is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_17.jpg" alt="Setting up the data sources"/></div><p>After clicking on the <span class="strong"><strong>OK</strong></span> button, we can see <a id="id86" class="indexterm"/>our newly created data <a id="id87" class="indexterm"/>source as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6886EN_01_18.jpg" alt="Setting up the data sources"/></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Summary</h1></div></div></div><p>In this chapter, we discussed how to download and install GlassFish. We also discussed several methods of deploying the Java EE application through the GlassFish web console, through the <code class="literal">asadmin</code> command, and by copying the file to the <code class="literal">autodeploy</code> directory. We also discussed basic GlassFish administration tasks like setting up domains and setting up Database Connectivity by adding connection pools and data sources. In the next chapter, we will cover how to develop web applications using JSF.</p></div></body></html>