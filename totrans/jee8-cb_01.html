<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">New Features and Improvements</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Java EE 8 is a big release, desired and anticipated by the global community for about four years. More than ever before, the whole platform is now even more robust, mature, and stable.</p>
<p class="mce-root">This chapter will cover the main APIs that we can highlight for Java EE 8. Not that they are the only topics covered by this release—far from it—but they have a big role in the enterprise context and are worthy of a careful look inside.</p>
<p class="mce-root">In this chapter, we will cover the following recipes:</p>
<ul class="calibre13">
<li class="calibre14">Running your first Bean Validation 2.0 code </li>
<li class="calibre14">Running your first CDI 2.0 code </li>
<li class="calibre14">Running your first JAX-RS 2.1 code </li>
<li class="calibre14">Running your first JSF 2.3 code </li>
<li class="calibre14">Running your first JSON-P 1.1 code </li>
<li class="calibre14">Running your first JSON-B 1.0 </li>
<li class="calibre14">Running your first Servlet 4.0 code </li>
<li class="calibre14">Running your first Security API 1.0 </li>
<li class="calibre14">Running your first MVC 1.0 code </li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first Bean Validation 2.0 code</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Bean Validation is a Java specification that basically helps you to protect your data. Through its API, you can validate fields and parameters, express constraints using annotations, and extend your customs' validation rules.</p>
<p class="mce-root">It can be used both with Java SE and Java EE.</p>
<p class="mce-root">In this recipe, you will have a glimpse of Bean Validation 2.0. It doesn't matter whether you are new to it or already using version 1.1; this content will help you get familiar with some of its new features.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">First, you need to add the right Bean Validation dependency to your project, as follows:</p>
<pre class="calibre22">&lt;dependencies&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;junit&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;junit&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;4.12&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;test&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.hamcrest&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;hamcrest-core&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;1.3&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;test&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;6.0.8.Final&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.glassfish&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javax.el&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;3.0.1-b10&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>&lt;/dependencies&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">First, we need to create an object with some fields to be validated:</li>
</ol>
<pre class="mce-root2">public class User {<br class="calibre2"/><br class="calibre2"/>    @NotBlank<br class="calibre2"/>    private String name;<br class="calibre2"/>    <br class="calibre2"/>    @Email<br class="calibre2"/>    private String email;<br class="calibre2"/>    <br class="calibre2"/>    @NotEmpty<br class="calibre2"/>    private List&lt;@PositiveOrZero Integer&gt; profileId;<br class="calibre2"/>    <br class="calibre2"/>    public User(String name, String email, List&lt;Integer&gt; profileId) {<br class="calibre2"/>        this.name = name;<br class="calibre2"/>        this.email = email;<br class="calibre2"/>        this.profileId = profileId;<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Then we create a <kbd class="calibre16">test</kbd> class to validate those constraints:</li>
</ol>
<pre class="mce-root2">public class UserTest {<br class="calibre2"/> <br class="calibre2"/>    private static Validator validator;<br class="calibre2"/> <br class="calibre2"/>    @BeforeClass<br class="calibre2"/>    public static void setUpClass() {<br class="calibre2"/>        validator = Validation.buildDefaultValidatorFactory()<br class="calibre2"/>        .getValidator();<br class="calibre2"/>    }<br class="calibre2"/> <br class="calibre2"/>    @Test<br class="calibre2"/>    public void validUser() {<br class="calibre2"/>        User user = new User(<br class="calibre2"/>            "elder", <br class="calibre2"/>            "elder@eldermoraes.com", <br class="calibre2"/>            asList(1,2));<br class="calibre2"/> <br class="calibre2"/>            Set&lt;ConstraintViolation&lt;User&gt;&gt; cv = validator<br class="calibre2"/>            .validate(user);<br class="calibre2"/>            assertTrue(cv.isEmpty());<br class="calibre2"/>    }<br class="calibre2"/> <br class="calibre2"/>    @Test<br class="calibre2"/>    public void invalidName() {<br class="calibre2"/>        User user = new User(<br class="calibre2"/>            "", <br class="calibre2"/>            "elder@eldermoraes.com", <br class="calibre2"/>            asList(1,2));<br class="calibre2"/> <br class="calibre2"/>            Set&lt;ConstraintViolation&lt;User&gt;&gt; cv = validator<br class="calibre2"/>            .validate(user);<br class="calibre2"/>            assertEquals(1, cv.size());<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @Test<br class="calibre2"/>    public void invalidEmail() {<br class="calibre2"/>        User user = new User(<br class="calibre2"/>        "elder", <br class="calibre2"/>        "elder-eldermoraes_com", <br class="calibre2"/>        asList(1,2));<br class="calibre2"/> <br class="calibre2"/>        Set&lt;ConstraintViolation&lt;User&gt;&gt; cv = validator<br class="calibre2"/>        .validate(user);<br class="calibre2"/>        assertEquals(1, cv.size());<br class="calibre2"/>    } <br class="calibre2"/> <br class="calibre2"/>    @Test<br class="calibre2"/>    public void invalidId() {<br class="calibre2"/>        User user = new User(<br class="calibre2"/>            "elder", <br class="calibre2"/>            "elder@eldermoraes.com", <br class="calibre2"/>            asList(-1,-2,1,2));<br class="calibre2"/> <br class="calibre2"/>            Set&lt;ConstraintViolation&lt;User&gt;&gt; cv = validator<br class="calibre2"/>            .validate(user);<br class="calibre2"/>            assertEquals(2, cv.size());<br class="calibre2"/>    } <br class="calibre2"/>}</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Our <kbd class="calibre16">User</kbd> <span class="calibre8">class</span><span class="calibre8"> </span><span class="calibre8">uses three of the new constraints introduced by Bean Validation 2.0:</span></p>
<ul class="calibre13">
<li class="calibre14"><kbd class="calibre16">@NotBlank</kbd>: Assures that the value is not null, empty, or an empty string (it trims the value before evaluation, to make sure there aren't spaces).</li>
<li class="calibre14"><kbd class="calibre16">@Email</kbd>: Allows only a valid email format. Forget those crazy JavaScript functions!</li>
<li class="calibre14"><kbd class="calibre16">@NotEmpty</kbd>: Ensures that a list has at least one item.</li>
<li class="calibre14"><kbd class="calibre16">@PositiveOrZero</kbd>: Guarantees that a number is equal or greater than zero.</li>
</ul>
<p class="mce-root">Then we create a <kbd class="calibre16">test</kbd> class (using JUnit) to test our validations. It first instantiates <kbd class="calibre16">Validator</kbd>:</p>
<pre class="calibre21">@BeforeClass<br class="calibre2"/>public static void setUpClass() {<br class="calibre2"/>    validator = Validation.buildDefaultValidatorFactory().getValidator();<br class="calibre2"/>}</pre>
<p class="mce-root"><kbd class="calibre16">Validator</kbd> is an API that validates beans according to the constraints defined for them.</p>
<p class="mce-root">Our first <kbd class="calibre16">test</kbd> method tests a valid user, which is a <kbd class="calibre16">User</kbd> object that has:</p>
<ul class="calibre13">
<li class="calibre14">Name not empty</li>
<li class="calibre14">Valid email</li>
<li class="calibre14"><kbd class="calibre16">profileId</kbd> list only with integers greater than zero:</li>
</ul>
<pre class="calibre21">User user = new User(<br class="calibre2"/>   "elder", <br class="calibre2"/>   "elder@eldermoraes.com", <br class="calibre2"/>   asList(1,2));</pre>
<p class="mce-root">And finally, the validation:</p>
<pre class="calibre21">Set&lt;ConstraintViolation&lt;User&gt;&gt; cv = validator.validate(user);</pre>
<p class="mce-root">The <kbd class="calibre16">validate()</kbd> method from <kbd class="calibre16">Validator</kbd> returns a set of constraint violations found, if any, or an empty set if there are no violations at all.</p>
<p class="mce-root">So, for a valid user it should return an empty set:</p>
<pre class="calibre21">assertTrue(cv.isEmpty());</pre>
<p class="mce-root">And the other methods work with variations around this model:</p>
<ul class="calibre13">
<li class="calibre14"><kbd class="calibre16">invalidName()</kbd>: Uses an empty name</li>
<li class="calibre14"><kbd class="calibre16">invalidEmail()</kbd>: Uses a malformed email</li>
<li class="calibre14"><kbd class="calibre16">invalidId()</kbd>: Adds some negative numbers to the list</li>
</ul>
<p class="mce-root">Note that the <kbd class="calibre16">invalidId()</kbd> method adds two negative numbers to the list:</p>
<pre class="calibre21">asList(-1,-2,1,2));</pre>
<p class="mce-root">So, we expect two constraint violations:</p>
<pre class="calibre21">assertEquals(2, cv.size());</pre>
<p class="mce-root">In other words, <kbd class="calibre16">Validator</kbd> checks not only the constraints violated, but how many times they are violated.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<div class="title-page-name">
<ul class="calibre13">
<li class="calibre14">You can check the Bean Validation 2.0 specification at <a href="http://beanvalidation.org/2.0/spec/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">http://beanvalidation.org/2.0/spec/</a></li>
<li class="calibre14">The full source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-beanvalidation/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-beanvalidation/</a></li>
</ul>
</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first CDI 2.0 code</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre7">Context and Dependency Injection</strong> (<strong class="calibre7">CDI</strong>) is certainly one of the most important APIs for the Java EE platform. In version 2.0, it also works with Java SE.</p>
<p class="mce-root">Nowadays, CDI has an impact on many other APIs in the Java EE platform. As said in <span class="calibre8">an interview for <em class="calibre17">Java EE 8 – The Next Frontier</em> project:</span></p>
<div class="mce-root1">"If there was CDI by the time we created JSF, it would be made completely different."<br class="calibre2"/>
                                                                                                     – Ed Burns, JSF Spec Lead</div>
<p class="mce-root">There is a lot of new features in CDI 2.0. This recipe will cover Observer Ordering to give you a quick start.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">First, you need to add the right CDI 2.0 dependency to your project. To make things easier at this point, we are going to use CDI SE, the dependency that allows you to use CDI without a Java EE server:</p>
<pre class="calibre21">&lt;dependency&gt;<br class="calibre2"/>    &lt;groupId&gt;org.jboss.weld.se&lt;/groupId&gt;<br class="calibre2"/>    &lt;artifactId&gt;weld-se-shaded&lt;/artifactId&gt;<br class="calibre2"/>    &lt;version&gt;3.0.0.Final&lt;/version&gt;<br class="calibre2"/>&lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">This recipe will show you one of the main features introduced by CDI 2.0: Ordered Observers. Now, you can turn the observers job into something predictable:</p>
<ol class="calibre19">
<li class="chapter">First, let's make an event to be observed:</li>
</ol>
<pre class="mce-root2">public class MyEvent {<br class="calibre2"/>    <br class="calibre2"/>    private final String value;<br class="calibre2"/>    <br class="calibre2"/>    public MyEvent(String value){<br class="calibre2"/>        this.value = value;<br class="calibre2"/>    }<br class="calibre2"/>    <br class="calibre2"/>    public String getValue(){<br class="calibre2"/>        return value;<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Now, we build our observers and the server that will fire them:</li>
</ol>
<pre class="mce-root2">public class OrderedObserver {<br class="calibre2"/><br class="calibre2"/>    public static void main(String[] args){<br class="calibre2"/>        try(SeContainer container =    <br class="calibre2"/>        SeContainerInitializer.newInstance().initialize()){<br class="calibre2"/>            container<br class="calibre2"/>                .getBeanManager()<br class="calibre2"/>                .fireEvent(new MyEvent("event: " + <br class="calibre2"/>                System.currentTimeMillis()));<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/> <br class="calibre2"/>    public void thisEventBefore(<br class="calibre2"/>            @Observes @Priority(Interceptor.Priority<br class="calibre2"/>            .APPLICATION - 200) <br class="calibre2"/>            MyEvent event){<br class="calibre2"/>        <br class="calibre2"/>        System.out.println("thisEventBefore: " + event.getValue());<br class="calibre2"/>    }<br class="calibre2"/> <br class="calibre2"/>    public void thisEventAfter(<br class="calibre2"/>            @Observes @Priority(Interceptor.Priority<br class="calibre2"/>           .APPLICATION + 200) <br class="calibre2"/>            MyEvent event){<br class="calibre2"/>        <br class="calibre2"/>        System.out.println("thisEventAfter: " + event.getValue());<br class="calibre2"/>    }  <br class="calibre2"/>}</pre>
<p class="calibre23">Also, don't forget to add the <kbd class="calibre16">beans.xml</kbd> file into the <kbd class="calibre16">META-INF</kbd> folder:</p>
<pre class="mce-root2">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br class="calibre2"/>&lt;beans <br class="calibre2"/>       <br class="calibre2"/>       xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee <br class="calibre2"/>       http://xmlns.jcp.org/xml/ns/javaee/beans_1_1.xsd"<br class="calibre2"/>       bean-discovery-mode="all"&gt;<br class="calibre2"/>&lt;/beans&gt;</pre>
<ol start="3" class="calibre19">
<li class="chapter">Once you run it, you should see a result like this:</li>
</ol>
<pre class="mce-root2"><strong class="calibre3">INFO: WELD-ENV-002003: Weld SE container <br class="calibre2"/>353db40d-e670-431d-b7be-4275b1813782 initialized</strong><br class="calibre2"/><strong class="calibre3"> thisEventBefore: event -&gt; 1501818268764</strong><br class="calibre2"/><strong class="calibre3"> thisEventAfter: event -&gt; 1501818268764</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">First, we are building a server to manage our event and observers:</p>
<pre class="calibre21">public static void main(String[] args){<br class="calibre2"/>    try(SeContainer container =  <br class="calibre2"/>    SeContainerInitializer.newInstance().initialize()){<br class="calibre2"/>        container<br class="calibre2"/>            .getBeanManager()<br class="calibre2"/>            .fireEvent(new ExampleEvent("event: " <br class="calibre2"/>            + System.currentTimeMillis()));<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<p class="mce-root">This will give us all the resources needed to run the recipe as if it was a Java EE server.</p>
<p class="mce-root">Then we build an observer:</p>
<pre class="calibre21">public void thisEventBefore(<br class="calibre2"/>        @Observes @Priority(Interceptor.Priority.APPLICATION - 200) <br class="calibre2"/>        MyEvent event){<br class="calibre2"/>  <br class="calibre2"/>    System.out.println("thisEventBefore: " + event.getValue());<br class="calibre2"/>}</pre>
<p class="mce-root">So, we have three important topics:</p>
<ul class="calibre13">
<li class="calibre14"><kbd class="calibre16">@Observes</kbd>: This annotation is used to tell the server that it needs to watch the events fired with <kbd class="calibre16">MyEvent</kbd></li>
<li class="calibre14"><kbd class="calibre16">@Priority</kbd>: This annotation informs in which priority order this observer needs to run; it receives an <kbd class="calibre16">int</kbd> parameter, and the execution order is ascendant</li>
<li class="calibre14"><kbd class="calibre16">MyEvent event</kbd>: The event being observed</li>
</ul>
<p class="mce-root">On the <kbd class="calibre16">thisEventBefore</kbd> method and <kbd class="calibre16">thisEventAfter</kbd>, we only changed the <kbd class="calibre16">@Priority</kbd> value and the server took care of running it in the right order.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The behavior would be exactly the same in a Java EE 8 server. You just wouldn't need <kbd class="calibre16">SeContainerInitializer</kbd> and would need to change the dependencies to the following:</p>
<pre class="calibre21">&lt;dependency&gt;<br class="calibre2"/>    &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>    &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>    &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>    &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>&lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to the CDI Specification at <a href="http://www.cdi-spec.org/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">http://www.cdi-spec.org/</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-cdi" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-cdi</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first JAX-RS 2.1 code</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">JAX-RS is an API designed to give a portable and standard way for building RESTful web services in Java. This is one of the most used technologies for data transporting between different applications that uses some network (internet included) for communication.</p>
<p class="mce-root">One of the coolest features introduced by the 2.1 release is <strong class="calibre7">Server-Sent Events</strong> (<strong class="calibre7">SSE</strong>), which will be covered in this recipe. SSE is a specification created by HTML5 where it has established a channel between server and client, one way only from server to client. It is a protocol that transports a message containing some data.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Let's start by adding the right dependency to our project:</p>
<pre class="calibre21">    &lt;dependencies&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;jersey-container-grizzly2-http&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;2.26-b09&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;2.26-b09&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;2.26-b09&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>    &lt;/dependencies&gt;</pre>
<p class="mce-root">You surely noticed that we are using Jersey here. Why? Because Jersey is the reference implementation for JAX-RS, which means that all JAX-RS specifications are first implemented through Jersey.</p>
<p class="mce-root">Moreover, with Jersey we can use Grizzly to start a small local server, which will be useful for this recipe, as we need just a few server features to show the SSE behavior.</p>
<p class="mce-root">Further on in this book, we will use a full GlassFish to build more JAX-RS recipes.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">First, we create a class that will be our server:</li>
</ol>
<pre class="mce-root2">public class ServerMock {<br class="calibre2"/><br class="calibre2"/>    public static final URI CONTEXT = <br class="calibre2"/>    URI.create("http://localhost:8080/");<br class="calibre2"/>    public static final String BASE_PATH = "ssevents";<br class="calibre2"/><br class="calibre2"/>    public static void main(String[] args) {<br class="calibre2"/>        try {<br class="calibre2"/>            final ResourceConfig resourceConfig = new <br class="calibre2"/>            ResourceConfig(SseResource.class);<br class="calibre2"/><br class="calibre2"/>            final HttpServer server = <br class="calibre2"/>            GrizzlyHttpServerFactory.createHttpServer(CONTEXT, <br class="calibre2"/>            resourceConfig, false);<br class="calibre2"/>            server.start();<br class="calibre2"/><br class="calibre2"/>            System.out.println(String.format("Mock Server started<br class="calibre2"/>            at %s%s", CONTEXT, BASE_PATH));<br class="calibre2"/><br class="calibre2"/>            Thread.currentThread().join();<br class="calibre2"/>        } catch (IOException | InterruptedException ex) {<br class="calibre2"/>            System.out.println(ex.getMessage());<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Then, we create a JAX-RS endpoint to send the events to the clients:</li>
</ol>
<pre class="mce-root2">@Path(ServerMock.BASE_PATH)<br class="calibre2"/>public class SseResource {<br class="calibre2"/><br class="calibre2"/>    private static volatile SseEventSink SINK = null;<br class="calibre2"/> <br class="calibre2"/>    @GET<br class="calibre2"/>    @Produces(MediaType.SERVER_SENT_EVENTS)<br class="calibre2"/>    public void getMessageQueue(@Context SseEventSink sink) {<br class="calibre2"/>        SseResource.SINK = sink;<br class="calibre2"/>    }<br class="calibre2"/> <br class="calibre2"/>    @POST<br class="calibre2"/>    public void addMessage(final String message, @Context Sse sse) <br class="calibre2"/>    throws IOException {<br class="calibre2"/>        if (SINK != null) {<br class="calibre2"/>            SINK.send(sse.newEventBuilder()<br class="calibre2"/>                .name("sse-message")<br class="calibre2"/>                .id(String.valueOf(System.currentTimeMillis()))<br class="calibre2"/>                .data(String.class, message)<br class="calibre2"/>                .comment("")<br class="calibre2"/>                .build());<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="3" class="calibre19">
<li class="chapter">Then, we create a client class to consume the events generated from the server:</li>
</ol>
<pre class="mce-root2">public class ClientConsumer {<br class="calibre2"/><br class="calibre2"/>    public static final Client CLIENT = ClientBuilder.newClient();<br class="calibre2"/>    public static final WebTarget WEB_TARGET = <br class="calibre2"/>    CLIENT.target(ServerMock.CONTEXT<br class="calibre2"/>    + BASE_PATH);<br class="calibre2"/>    <br class="calibre2"/>    public static void main(String[] args) {<br class="calibre2"/>        consume();<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    private static void consume() {<br class="calibre2"/><br class="calibre2"/>        try (final SseEventSource sseSource =<br class="calibre2"/>                     SseEventSource<br class="calibre2"/>                             .target(WEB_TARGET)<br class="calibre2"/>                             .build()) {<br class="calibre2"/><br class="calibre2"/>            sseSource.register(System.out::println);<br class="calibre2"/>            sseSource.open();<br class="calibre2"/><br class="calibre2"/>            for (int counter=0; counter &lt; 5; counter++) {<br class="calibre2"/>                System.out.println(" ");<br class="calibre2"/>                for (int innerCounter=0; innerCounter &lt; 5; <br class="calibre2"/>                innerCounter++) {<br class="calibre2"/>                    WEB_TARGET.request().post(Entity.json("event "<br class="calibre2"/>                    + innerCounter));<br class="calibre2"/>                }<br class="calibre2"/>                Thread.sleep(1000);<br class="calibre2"/>            }<br class="calibre2"/>            <br class="calibre2"/>            CLIENT.close();<br class="calibre2"/>            System.out.println("\n All messages consumed");<br class="calibre2"/>        } catch (InterruptedException e) {<br class="calibre2"/>            System.out.println(e.getMessage());<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<p class="mce-root">To try it out, you have to first run the <kbd class="calibre16">ServerMock</kbd> class and then the <kbd class="calibre16">ClientConsumer</kbd> class. If everything worked well, you should see something like this:</p>
<pre class="calibre21"><strong class="calibre3">InboundEvent{name='sse-message', id='1502228257736', comment='',    data=event 0}</strong><br class="calibre2"/><strong class="calibre3"> InboundEvent{name='sse-message', id='1502228257753', comment='',   data=event 1}</strong><br class="calibre2"/><strong class="calibre3"> InboundEvent{name='sse-message', id='1502228257758', comment='',   data=event 2}</strong><br class="calibre2"/><strong class="calibre3"> InboundEvent{name='sse-message', id='1502228257763', comment='',   data=event 3}</strong><br class="calibre2"/><strong class="calibre3"> InboundEvent{name='sse-message', id='1502228257768', comment='',   data=event 4}</strong></pre>
<p class="mce-root">These are the messages sent from the server to the client.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">This recipe is made up of three parts:</p>
<ul class="calibre13">
<li class="calibre14">The server, represented by the <kbd class="calibre16">ServerMock</kbd> class</li>
<li class="calibre14">The SSE engine, represented by the <kbd class="calibre16">SseResource</kbd> class</li>
<li class="calibre14">The client, represented by the <kbd class="calibre16">ClientConsumer</kbd> class</li>
</ul>
<p class="mce-root">So once <kbd class="calibre16">ServerMock</kbd> is instantiated, it registers the <kbd class="calibre16">SseResource</kbd> class:</p>
<pre class="calibre21">final ResourceConfig resourceConfig = new ResourceConfig(SseResource.class);<br class="calibre2"/>final HttpServer server = GrizzlyHttpServerFactory.createHttpServer(CONTEXT, resourceConfig, false);<br class="calibre2"/>server.start();</pre>
<p class="mce-root">Then two key methods from <kbd class="calibre16">SseResource</kbd> take place. The first one adds messages to the server queue:</p>
<pre class="calibre21">addMessage(final String message, @Context Sse sse)</pre>
<p class="mce-root">The second one consumes this queue and sends the messages to the clients:</p>
<pre class="calibre21">@GET<br class="calibre2"/>@Produces(MediaType.SERVER_SENT_EVENTS)<br class="calibre2"/>public void getMessageQueue(@Context SseEventSink sink)</pre>
<p class="mce-root">Note that this one has a media type <kbd class="calibre16">SERVER_SENT_EVENTS</kbd>, introduced in this version for this very purpose. And finally, we have our client. In this recipe, it is both posting and consuming messages. </p>
<p class="mce-root">It consumes here:</p>
<pre class="calibre21">sseSource.register(System.out::println);<br class="calibre2"/>sseSource.open();</pre>
<p class="mce-root">It posts here:</p>
<pre class="calibre21">ServerMock.WEB_TARGET.request().post(Entity.json("event " + innerCounter));</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to JAX-RS at <a href="https://github.com/jax-rs" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/jax-rs</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jaxrs" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jaxrs</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first JSF 2.3 code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre7">JavaServer Faces</strong> (<strong class="calibre7">JSF</strong>) is the Java technology made to simplify the process of building a UIs, despite how it's made for the frontend and the UI is built in the backend.</p>
<p class="mce-root">With JSF, you can build components and use (or reuse) them in the UI in an extensible way. You can also use other powerful APIs, such as CDI and Bean Validation, to improve your application and its architecture.</p>
<p class="mce-root">In this recipe, we will use the <kbd class="calibre16">Validator</kbd> and <kbd class="calibre16">Converter</kbd> interfaces with the new feature introduced by version 2.3, which is the possibility of using them with generic parameters.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">First, we need to add the dependencies needed:</p>
<pre class="calibre21">        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">Let's create a <kbd class="calibre16">User</kbd> class as the main object of our recipe:</li>
</ol>
<pre class="mce-root2">public class User implements Serializable {<br class="calibre2"/><br class="calibre2"/>    private String name;<br class="calibre2"/>    private String email;<br class="calibre2"/><br class="calibre2"/>    public User(String name, String email) {<br class="calibre2"/>        this.name = name;<br class="calibre2"/>        this.email = email; <br class="calibre2"/>    }<br class="calibre2"/>   <br class="calibre2"/>    //DON'T FORGET THE GETTERS AND SETTERS<br class="calibre2"/>    //THIS RECIPE WON'T WORK WITHOUT THEM<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Now, we create a <kbd class="calibre16">UserBean</kbd> class to manage our UI:</li>
</ol>
<pre class="mce-root2">@Named<br class="calibre2"/>@ViewScoped<br class="calibre2"/>public class UserBean implements Serializable {<br class="calibre2"/><br class="calibre2"/>    private User user;<br class="calibre2"/>    <br class="calibre2"/>    public UserBean(){<br class="calibre2"/>        user = new User("Elder Moraes", "elder@eldermoraes.com");<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    public void userAction(){<br class="calibre2"/>        FacesContext.getCurrentInstance().addMessage(null, <br class="calibre2"/>                new FacesMessage("Name|Password welformed"));<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    //DON'T FORGET THE GETTERS AND SETTERS<br class="calibre2"/>    //THIS RECIPE WON'T WORK WITHOUT THEM<br class="calibre2"/>}</pre>
<ol start="3" class="calibre19">
<li class="chapter">Now, we implement the <kbd class="calibre16">Converter</kbd> interface with a <kbd class="calibre16">User</kbd> parameter:</li>
</ol>
<pre class="mce-root2">@FacesConverter("userConverter")<br class="calibre2"/>public class UserConverter implements Converter&lt;User&gt; {<br class="calibre2"/><br class="calibre2"/>    @Override<br class="calibre2"/>    public String getAsString(FacesContext fc, UIComponent uic, <br class="calibre2"/>    User user) {<br class="calibre2"/>        return user.getName() + "|" + user.getEmail();<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @Override<br class="calibre2"/>    public User getAsObject(FacesContext fc, UIComponent uic, <br class="calibre2"/>    String string) {<br class="calibre2"/>        return new User(string.substring(0, string.indexOf("|")), <br class="calibre2"/>        string.substring(string.indexOf("|") + 1));<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>}</pre>
<ol start="4" class="calibre19">
<li class="chapter">Now, we implement the <kbd class="calibre16">Validator</kbd> interface with a <kbd class="calibre16">User</kbd> parameter:</li>
</ol>
<pre class="mce-root2">@FacesValidator("userValidator")<br class="calibre2"/>public class UserValidator implements Validator&lt;User&gt; {<br class="calibre2"/><br class="calibre2"/>    @Override<br class="calibre2"/>    public void validate(FacesContext fc, UIComponent uic, <br class="calibre2"/>    User user) <br class="calibre2"/>    throws ValidatorException {<br class="calibre2"/>        if(!user.getEmail().contains("@")){<br class="calibre2"/>            throw new ValidatorException(new FacesMessage(null, <br class="calibre2"/>                                         "Malformed e-mail"));<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="5" class="calibre19">
<li class="chapter">And then we create our UI using all of them:</li>
</ol>
<pre class="mce-root2">&lt;h:body&gt;<br class="calibre2"/>    &lt;h:form&gt;<br class="calibre2"/>        &lt;h:panelGrid columns="3"&gt;<br class="calibre2"/>            &lt;h:outputLabel value="Name|E-mail:" <br class="calibre2"/>            for="userNameEmail"/&gt;<br class="calibre2"/>            &lt;h:inputText id="userNameEmail" <br class="calibre2"/>            value="#{userBean.user}" <br class="calibre2"/>            converter="userConverter" validator="userValidator"/&gt; <br class="calibre2"/>            &lt;h:message for="userNameEmail"/&gt;<br class="calibre2"/>        &lt;/h:panelGrid&gt;<br class="calibre2"/>        &lt;h:commandButton value="Validate" <br class="calibre2"/>        action="#{userBean.userAction()}"/&gt;<br class="calibre2"/>    &lt;/h:form&gt; <br class="calibre2"/>&lt;/h:body&gt;</pre>
<p class="mce-root">Don't forget to run it in a Java EE 8 server.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The <kbd class="calibre16">UserBean</kbd> class manages the communication between the UI and the server. Once you instantiate the <kbd class="calibre16">user</kbd> object, it is available for both of them.</p>
<p class="mce-root">That's why when you run it, the <kbd class="calibre16">Name | E-mail</kbd> is already filled (the <kbd class="calibre16">user</kbd> object is instantiated when the <kbd class="calibre16">UserBean</kbd> class is created by the server).</p>
<p class="mce-root">We associated the <kbd class="calibre16">userAction()</kbd> method from the <kbd class="calibre16">UserBean</kbd> class to the <kbd class="calibre16">Validate</kbd> button of the UI:</p>
<pre class="calibre21">&lt;h:commandButton value="Validate" action="#{userBean.userAction()}"/&gt;</pre>
<p class="mce-root">You can create other methods in <kbd class="calibre16">UserBean</kbd> and do the same to empower your application.</p>
<p class="mce-root">The whole core of our recipe is represented by just a single line in the UI:</p>
<pre class="calibre21">&lt;h:inputText id="userNameEmail" value="#{userBean.user}" converter="userConverter" validator="userValidator"/&gt;</pre>
<p class="mce-root">So, our two implemented interfaces used here are <kbd class="calibre16">userConverter</kbd> and <kbd class="calibre16">userValidator</kbd>.</p>
<p class="mce-root">Basically, the <kbd class="calibre16">UserConverter</kbd> class (with <kbd class="calibre16">getAsString</kbd> and <kbd class="calibre16">getAsObject</kbd> methods) converts an object to/from a string and vice versa, according to the logic defined by you.</p>
<p class="mce-root">We have just mentioned it in the preceding code snippet:</p>
<pre class="calibre21">value="#{userBean.user}"</pre>
<p class="mce-root">The server uses the <kbd class="calibre16">userConverter</kbd> object, calls the <kbd class="calibre16">getAsString</kbd> method, and prints the result using the preceding expression language.</p>
<p class="mce-root">Finally, the <kbd class="calibre16">UserValidator</kbd> class is automatically called when you submit the form, by calling its <kbd class="calibre16">validate</kbd> method, and applying the rules defined by you.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">You could increase the validators by adding a Bean Validation on it and, for example, defining the <kbd class="calibre16">email</kbd> property from <kbd class="calibre16">User</kbd> with an <kbd class="calibre16">@Email</kbd> constraint.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to JSF at <a href="https://javaserverfaces.github.io/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://javaserverfaces.github.io/</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsf" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsf</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first JSON-P 1.1 code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">JSON-Pointer is the Java API for JSON processing. By processing,  we mean generating, transforming, parsing, and querying JSON strings and/or objects.</p>
<p class="mce-root">In this recipe, you will learn how to use JSON Pointer to get a specific value from a JSON message in a very easy way.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Let's get our <kbd class="calibre16">dependency</kbd>:</p>
<pre class="calibre21">&lt;dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>&lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">First, we define a JSON message to represent a <kbd class="calibre16">User</kbd> object:</li>
</ol>
<pre class="mce-root2">{<br class="calibre2"/>  "user": {<br class="calibre2"/>    "email": "elder@eldermoraes.com",<br class="calibre2"/>    "name": "Elder",<br class="calibre2"/>    "profile": [<br class="calibre2"/>      {<br class="calibre2"/>        "id": 1<br class="calibre2"/>      },<br class="calibre2"/>      {<br class="calibre2"/>        "id": 2<br class="calibre2"/>      },<br class="calibre2"/>      {<br class="calibre2"/>        "id": 3<br class="calibre2"/>      }<br class="calibre2"/>    ]<br class="calibre2"/>  }<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Now, we create a method to read it and print the values we want:</li>
</ol>
<pre class="mce-root2">public class JPointer {<br class="calibre2"/><br class="calibre2"/>    public static void main(String[] args) throws IOException{<br class="calibre2"/>        try (InputStream is = <br class="calibre2"/>        JPointer.class.getClassLoader().getResourceAsStream("user.json");<br class="calibre2"/>                JsonReader jr = Json.createReader(is)) {<br class="calibre2"/><br class="calibre2"/>            JsonStructure js = jr.read();<br class="calibre2"/>            JsonPointer jp = Json.createPointer("/user/profile");<br class="calibre2"/>            JsonValue jv = jp.getValue(js);<br class="calibre2"/>            System.out.println("profile: " + jv);<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<p class="mce-root">The execution of this code prints the following:</p>
<pre class="calibre21"><strong class="calibre3">profile: [{"id":1},{"id":2},{"id":3}]</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The JSON Pointer is a standard defined by the <strong class="calibre7">Internet Engineering Task Force</strong> (<strong class="calibre7">IETF</strong>) under <strong class="calibre7"><span class="calibre8">Request for Comments</span></strong> (<strong class="calibre7">RFC</strong>) 6901. The standard basically says that a JSON Pointer is a string that identifies a specific value in a JSON document.</p>
<p class="mce-root">Without a JSON Pointer, you would need to parse the whole message and iterate through it until you find the desired value; probably lots of ifs, elses, and things like that.</p>
<p class="mce-root">So, JSON Pointer helps you to decrease the written code <span class="calibre8">dramatically by</span> doing this kind of operation in a very elegant way.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to JSON-P at <a href="https://javaee.github.io/jsonp/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://javaee.github.io/jsonp/</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsonp" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsonp</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first JSON-B code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">JSON-B is an API for converting Java objects to/from JSON messages in a standardized way. It defines a default mapping algorithm to convert Java classes to JSON and still lets you customize your own algorithms.</p>
<p class="mce-root">With JSON-B, Java EE now has a complete set of tools to work with JSON, such as JSON API, and JSON-P. No third-party frameworks are needed anymore (although you are still free to use them).</p>
<p class="mce-root">This quick recipe will show you how to use JSON-B to convert a Java object to and from a JSON message.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Let's add our dependencies to the project:</p>
<pre class="calibre21">    &lt;dependencies&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.eclipse&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;yasson&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;1.0&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt; <br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.glassfish&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javax.json&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;1.1&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt; <br class="calibre2"/>    &lt;/dependencies&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">Let's create a <kbd class="calibre16">User</kbd> class as a model for our JSON message:</li>
</ol>
<pre class="mce-root2">public class User {<br class="calibre2"/><br class="calibre2"/>    private String name;<br class="calibre2"/>    private String email;<br class="calibre2"/><br class="calibre2"/>    public User(){        <br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    public User(String name, String email) {<br class="calibre2"/>        this.name = name;<br class="calibre2"/>        this.email = email;<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @Override<br class="calibre2"/>    public String toString() {<br class="calibre2"/>        return "User{" + "name=" + name + ", email=" + email + '}';<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    //DON'T FORGET THE GETTERS AND SETTERS<br class="calibre2"/>    //THIS RECIPE WON'T WORK WITHOUT THEM<br class="calibre2"/><br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Then, let's create a class to use JSON-B to transform an object:</li>
</ol>
<pre class="mce-root2">public class JsonBUser {<br class="calibre2"/>    <br class="calibre2"/>    public static void main(String[] args) throws Exception {<br class="calibre2"/>        User user = new User("Elder", "elder@eldermoraes.com");<br class="calibre2"/>        <br class="calibre2"/>        Jsonb jb = JsonbBuilder.create();<br class="calibre2"/>        String jsonUser = jb.toJson(user);<br class="calibre2"/>        User u = jb.fromJson(jsonUser, User.class);<br class="calibre2"/>        <br class="calibre2"/>        jb.close();<br class="calibre2"/>        System.out.println("json: " + jsonUser);<br class="calibre2"/>        System.out.println("user: " + u);<br class="calibre2"/>        <br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<p class="mce-root">The result printed is:</p>
<pre class="calibre21"><strong class="calibre3">json: {"email":"elder@eldermoraes.com","name":"Elder"}</strong><br class="calibre2"/><strong class="calibre3"> user: User{name=Elder, email=elder@eldermoraes.com}</strong></pre>
<p class="mce-root">The first line is the object transformed into a JSON string. The second is the same string converted into an object.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">It uses the getters and setters defined in the <kbd class="calibre16">User</kbd> class to transform both ways and that's why they are so important.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to JSON-B at <a href="http://json-b.net/" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">http://json-b.net/</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsonb" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-jsonb</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first Servlet 4.0 code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Servlet 4.0 is one the of biggest APIs of Java EE 8. Since the very beginning of the Java EE platform (the old J2EE), the Servlet specification has always played a key role.</p>
<p class="mce-root">The coolest additions of this version are surely HTTP/2.0 and Server Push. Both of them bring performance improvements to your application.</p>
<p class="mce-root">This recipe will use Server Push to do one of the most basic tasks in a web page—loading an image.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Let's add the dependencies that we need:</p>
<pre class="calibre21">&lt;dependency&gt;<br class="calibre2"/>    &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>    &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>    &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>    &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>&lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">We will create a servlet:</li>
</ol>
<pre class="mce-root2">@WebServlet(name = "ServerPush", urlPatterns = {"/ServerPush"})<br class="calibre2"/>public class ServerPush extends HttpServlet {<br class="calibre2"/><br class="calibre2"/>    @Override<br class="calibre2"/>    protected void doGet(HttpServletRequest request, <br class="calibre2"/>    HttpServletResponse <br class="calibre2"/>    response) throws ServletException, IOException {<br class="calibre2"/><br class="calibre2"/>        PushBuilder pb = request.newPushBuilder();<br class="calibre2"/>        if (pb != null) {<br class="calibre2"/>            pb.path("images/javaee-logo.png")<br class="calibre2"/>              .addHeader("content-type", "image/png")<br class="calibre2"/>              .push();<br class="calibre2"/>        }<br class="calibre2"/><br class="calibre2"/>        try (PrintWriter writer = response.getWriter();) {<br class="calibre2"/>            StringBuilder html = new StringBuilder();<br class="calibre2"/>            html.append("&lt;html&gt;");<br class="calibre2"/>            html.append("&lt;center&gt;");<br class="calibre2"/>            html.append("&lt;img src='images/javaee-logo.png'&gt;&lt;br&gt;");<br class="calibre2"/>            html.append("&lt;h2&gt;Image pushed by ServerPush&lt;/h2&gt;");<br class="calibre2"/>            html.append("&lt;/center&gt;");<br class="calibre2"/>            html.append("&lt;/html&gt;");<br class="calibre2"/>            writer.write(html.toString());<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">To try it, run the project in a Java EE 8 server and open this URL:</li>
</ol>
<pre class="mce-root2">https://localhost:8080/ch01-servlet/ServerPush</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We use the <kbd class="calibre16">PushBuilder</kbd> object to send an image to the client before it is requested by the <kbd class="calibre16">img src</kbd> tag. In other words, the browser doesn't need to do another request (what it usually does with <kbd class="calibre16">img src</kbd>) to have an image available for rendering.</p>
<p class="mce-root">It might seem as if it doesn't make too much difference for a single image, but it would with dozens, hundreds, or thousands of images. Less traffic for your client and from your server. Better performance for all!</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">If you are using JSF, you can get the benefits from Server Push for free! You don't even need to rewrite a single line of your code, as JSF relies on the Server Push specification.</p>
<p class="mce-root">Just make sure that you run it under the HTTPS protocol, as HTTP/2.0 only works under it.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to the Servlet specification at <a href="https://github.com/javaee/servlet-spec" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/javaee/servlet-spec</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-servlet" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-servlet</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first Security API code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Security is one of the top concerns when you build an enterprise application. Luckily, the Java EE platform now has this API that handles many of the enterprise requirements in a standardized way.</p>
<p class="mce-root">In this recipe, you will learn how to define roles and give them the right authorization based on rules defined in the methods that manage sensitive data.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We start by adding our dependencies to the project:</p>
<pre class="calibre21">        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;junit&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;junit&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;4.12&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;test&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;org.apache.tomee&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;openejb-core&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;7.0.4&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">We first create a <kbd class="calibre16">User</kbd> entity:</li>
</ol>
<pre class="mce-root2">@Entity <br class="calibre2"/>public class User implements Serializable{<br class="calibre2"/><br class="calibre2"/>    @Id<br class="calibre2"/>    private Long id;<br class="calibre2"/>    private String name;<br class="calibre2"/>    private String email;<br class="calibre2"/><br class="calibre2"/>    public User(){        <br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    public User(Long id, String name, String email) {<br class="calibre2"/>        this.id = id;<br class="calibre2"/>        this.name = name;<br class="calibre2"/>        this.email = email;<br class="calibre2"/>    }<br class="calibre2"/>    <br class="calibre2"/>    //DON'T FORGET THE GETTERS AND SETTERS<br class="calibre2"/>    //THIS RECIPE WON'T WORK WITHOUT THEM<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Here, we create a class to store our security roles:</li>
</ol>
<pre class="mce-root2">public class Roles {<br class="calibre2"/>    public static final String ADMIN = "ADMIN";<br class="calibre2"/>    public static final String OPERATOR = "OPERATOR";<br class="calibre2"/>}</pre>
<ol start="3" class="calibre19">
<li class="chapter">Then, we create a stateful bean to manage our user operations:</li>
</ol>
<pre class="mce-root2">@Stateful<br class="calibre2"/>public class UserBean {<br class="calibre2"/><br class="calibre2"/>    @PersistenceContext(unitName = "ch01-security-pu", <br class="calibre2"/>    type = PersistenceContextType.EXTENDED)<br class="calibre2"/>    private EntityManager em;<br class="calibre2"/><br class="calibre2"/>    @RolesAllowed({Roles.ADMIN, Roles.OPERATOR})<br class="calibre2"/>    public void add(User user){<br class="calibre2"/>        em.persist(user);<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @RolesAllowed({Roles.ADMIN})<br class="calibre2"/>    public void remove(User user){<br class="calibre2"/>        em.remove(user);<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @RolesAllowed({Roles.ADMIN})<br class="calibre2"/>    public void update(User user){<br class="calibre2"/>        em.merge(user);<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @PermitAll<br class="calibre2"/>    public List&lt;User&gt; get(){<br class="calibre2"/>        Query q = em.createQuery("SELECT u FROM User as u ");<br class="calibre2"/>        return q.getResultList();<br class="calibre2"/>    }</pre>
<ol start="4" class="calibre19">
<li class="chapter">Now, we need to create an executor for each role:</li>
</ol>
<pre class="mce-root2">public class RoleExecutor {<br class="calibre2"/><br class="calibre2"/>    public interface Executable {<br class="calibre2"/>        void execute() throws Exception;<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @Stateless<br class="calibre2"/>    @RunAs(Roles.ADMIN)<br class="calibre2"/>    public static class AdminExecutor {<br class="calibre2"/>        public void run(Executable executable) throws Exception {<br class="calibre2"/>            executable.execute();<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    @Stateless<br class="calibre2"/>    @RunAs(Roles.OPERATOR)<br class="calibre2"/>    public static class OperatorExecutor {<br class="calibre2"/>        public void run(Executable executable) throws Exception {<br class="calibre2"/>            executable.execute();<br class="calibre2"/>        }<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="5" class="calibre19">
<li class="chapter">And finally, we create a test class to try our security rules.</li>
</ol>
<p class="mce-root"> Our code uses three test methods: <kbd class="calibre16">asAdmin()</kbd>, <kbd class="calibre16">asOperator()</kbd>, and <kbd class="calibre16">asAnonymous()</kbd>.</p>
<ol class="calibre19">
<li class="chapter">First, it tests <kbd class="calibre16">asAdmin()</kbd>:</li>
</ol>
<pre class="calibre21">    //Lot of setup code before this point<br class="calibre2"/><br class="calibre2"/>    @Test<br class="calibre2"/>    public void asAdmin() throws Exception {<br class="calibre2"/>        adminExecutor.run(() -&gt; {<br class="calibre2"/>            userBean.add(new User(1L, "user1", "user1@user.com"));<br class="calibre2"/>            userBean.add(new User(2L, "user2", "user2@user.com"));<br class="calibre2"/>            userBean.add(new User(3L, "user3", "user3@user.com"));<br class="calibre2"/>            userBean.add(new User(4L, "user4", "user4@user.com"));<br class="calibre2"/><br class="calibre2"/>            List&lt;User&gt; list = userBean.get();<br class="calibre2"/><br class="calibre2"/>            list.forEach((user) -&gt; {<br class="calibre2"/>                userBean.remove(user);<br class="calibre2"/>            });<br class="calibre2"/><br class="calibre2"/>            Assert.assertEquals("userBean.get()", 0, <br class="calibre2"/>            userBean.get().size());<br class="calibre2"/>        });<br class="calibre2"/>    }</pre>
<ol start="2" class="calibre19">
<li class="chapter">Then it tests <kbd class="calibre16">asOperator()</kbd>:</li>
</ol>
<pre class="calibre21">    @Test<br class="calibre2"/>    public void asOperator() throws Exception {<br class="calibre2"/><br class="calibre2"/>        operatorExecutor.run(() -&gt; {<br class="calibre2"/>            userBean.add(new User(1L, "user1", "user1@user.com"));<br class="calibre2"/>            userBean.add(new User(2L, "user2", "user2@user.com"));<br class="calibre2"/>            userBean.add(new User(3L, "user3", "user3@user.com"));<br class="calibre2"/>            userBean.add(new User(4L, "user4", "user4@user.com"));<br class="calibre2"/><br class="calibre2"/>            List&lt;User&gt; list = userBean.get();<br class="calibre2"/><br class="calibre2"/>            list.forEach((user) -&gt; {<br class="calibre2"/>                try {<br class="calibre2"/>                    userBean.remove(user);<br class="calibre2"/>                    Assert.fail("Operator was able to remove user " + <br class="calibre2"/>                    user.getName());<br class="calibre2"/>                } catch (EJBAccessException e) {<br class="calibre2"/>                }<br class="calibre2"/>            });<br class="calibre2"/>            Assert.assertEquals("userBean.get()", 4, <br class="calibre2"/>            userBean.get().size());<br class="calibre2"/>        });<br class="calibre2"/>    }</pre>
<ol start="4" class="calibre19">
<li class="chapter">And, finally it tests <kbd class="calibre16">asAnonymous()</kbd>:</li>
</ol>
<pre class="calibre21">    @Test<br class="calibre2"/>    public void asAnonymous() {<br class="calibre2"/><br class="calibre2"/>        try {<br class="calibre2"/>            userBean.add(new User(1L, "elder", <br class="calibre2"/>            "elder@eldermoraes.com"));<br class="calibre2"/>            Assert.fail("Anonymous user should not add users");<br class="calibre2"/>        } catch (EJBAccessException e) {<br class="calibre2"/>        }<br class="calibre2"/><br class="calibre2"/>        try {<br class="calibre2"/>            userBean.remove(new User(1L, "elder", <br class="calibre2"/>            "elder@eldermoraes.com"));<br class="calibre2"/>            Assert.fail("Anonymous user should not remove users");<br class="calibre2"/>        } catch (EJBAccessException e) {<br class="calibre2"/>        }<br class="calibre2"/><br class="calibre2"/>        try {<br class="calibre2"/>            userBean.get();<br class="calibre2"/>        } catch (EJBAccessException e) {<br class="calibre2"/>            Assert.fail("Everyone can list users");<br class="calibre2"/>        }<br class="calibre2"/>    }</pre>
<div class="packt_infobox"><span class="calibre5">This class is huge! For the full source code, check the link at the end of the recipe.</span></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The whole point in this recipe is to do with the <kbd class="calibre16">@RolesAllowed</kbd>, <kbd class="calibre16">@RunsAs</kbd>, and <kbd class="calibre16">@PermitAll</kbd> annotations. They define what operations each role can do and what happens when a user tries an operation using the wrong role.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">What we did here is called <strong class="calibre7">programmatic security;</strong> that is, we defined the security rules and roles through our code (the program). There's another approach called <strong class="calibre7">declarative security</strong>, where you declare the rules and roles through application and server configurations.</p>
<p class="mce-root">One good step up for this recipe is if you evolve the roles management to a source outside the application, such as a database or a service.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to Security API at <a href="https://github.com/javaee-security-spec" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/javaee-security-spec</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-security" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-security</a></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Running your first MVC 1.0 code </h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">If you are following the news about Java EE 8, you may now be wondering: <em class="calibre17">why is MVC 1.0 here if it was dropped from the Java EE 8 umbrella?</em></p>
<p class="mce-root">Yes, it is true. MVC 1.0 doesn't belong (anymore) to the Java EE 8 release. But it didn't reduce the importance of this great API and I'm sure it will change the way some other APIs work in future releases (for example, JSF).</p>
<p class="mce-root">So why not cover it here? You will use it anyway.</p>
<p class="mce-root">This recipe will show you how to use a Controller (the C) to inject a Model (the M) into the View (the V). It also brings some CDI and JAX-RS to the party.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Add the proper dependencies to your project:</p>
<pre class="calibre21">        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;8.0&lt;/version&gt;<br class="calibre2"/>            &lt;scope&gt;provided&lt;/scope&gt;<br class="calibre2"/>        &lt;/dependency&gt;<br class="calibre2"/>        &lt;dependency&gt;<br class="calibre2"/>            &lt;groupId&gt;javax.mvc&lt;/groupId&gt;<br class="calibre2"/>            &lt;artifactId&gt;javax.mvc-api&lt;/artifactId&gt;<br class="calibre2"/>            &lt;version&gt;1.0-pr&lt;/version&gt;<br class="calibre2"/>        &lt;/dependency&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article class="calibre2">
                
<ol class="calibre19">
<li class="chapter">Start by creating a root for your JAX-RS endpoints:</li>
</ol>
<pre class="mce-root2">@ApplicationPath("webresources")<br class="calibre2"/>public class AppConfig extends Application{<br class="calibre2"/>}</pre>
<ol start="2" class="calibre19">
<li class="chapter">Create a <kbd class="calibre16">User</kbd> class (this will be your MODEL):</li>
</ol>
<pre class="mce-root2">public class User {<br class="calibre2"/><br class="calibre2"/>    private String name;<br class="calibre2"/>    private String email;<br class="calibre2"/><br class="calibre2"/>    public User(String name, String email) {<br class="calibre2"/>        this.name = name;<br class="calibre2"/>        this.email = email;<br class="calibre2"/>    }<br class="calibre2"/><br class="calibre2"/>    //DON'T FORGET THE GETTERS AND SETTERS<br class="calibre2"/>    //THIS RECIPE WON'T WORK WITHOUT THEM<br class="calibre2"/>}</pre>
<ol start="3" class="calibre19">
<li class="chapter">Now, create a Session Bean, which will be injected later in your Controller:</li>
</ol>
<pre class="mce-root2">@Stateless<br class="calibre2"/>public class UserBean {<br class="calibre2"/>    <br class="calibre2"/>    public User getUser(){<br class="calibre2"/>        return new User("Elder", "elder@eldermoraes.com");<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="4" class="calibre19">
<li class="chapter">Then, create the Controller:</li>
</ol>
<pre class="mce-root2">@Controller<br class="calibre2"/>@Path("userController")<br class="calibre2"/>public class UserController {<br class="calibre2"/>    <br class="calibre2"/>    @Inject<br class="calibre2"/>    Models models;<br class="calibre2"/>    <br class="calibre2"/>    @Inject<br class="calibre2"/>    UserBean userBean;<br class="calibre2"/>    <br class="calibre2"/>    @GET<br class="calibre2"/>    public String user(){<br class="calibre2"/>        models.put("user", userBean.getUser());<br class="calibre2"/>        return "/user.jsp";<br class="calibre2"/>    }<br class="calibre2"/>}</pre>
<ol start="5" class="calibre19">
<li class="chapter">And finally, the web page (the View):</li>
</ol>
<pre class="mce-root2">&lt;head&gt;<br class="calibre2"/>    &lt;meta http-equiv="Content-Type" content="text/html; <br class="calibre2"/>    charset=UTF-8"&gt;<br class="calibre2"/>    &lt;title&gt;User MVC&lt;/title&gt;<br class="calibre2"/>&lt;/head&gt;<br class="calibre2"/>&lt;body&gt;<br class="calibre2"/>    &lt;h1&gt;${user.name}/${user.email}&lt;/h1&gt;<br class="calibre2"/>&lt;/body&gt;</pre>
<p class="mce-root">Run it on a Java EE 8 server and access this URL:</p>
<p class="mce-root"><kbd class="calibre16">http://localhost:8080/ch01-mvc/webresources/userController</kbd></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">The main actor in this whole scenario is the <kbd class="calibre16">Models</kbd> class injected into the Controller:</p>
<pre class="calibre21">@Inject<br class="calibre2"/>Models models;</pre>
<p class="mce-root">It's a class from MVC 1.0 API that owns the responsibility, in this recipe, of letting the <kbd class="calibre16">User</kbd> object be available for the View layer. It's injected (using CDI) and uses another injected bean, <kbd class="calibre16">userBean</kbd>, to do it:</p>
<pre class="calibre21">models.put("user", userBean.getUser());</pre>
<p class="mce-root">So, the View can easily access the values from the <kbd class="calibre16">User</kbd> object using expression language:</p>
<pre class="calibre21">&lt;h1&gt;${user.name}/${user.email}&lt;/h1&gt;</pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article class="calibre2">
                
<ul class="calibre13">
<li class="calibre14">You can stay tuned with everything related to MVC specification at <a href="https://github.com/mvc-spec" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/mvc-spec</a></li>
<li class="calibre14">The source code of this recipe is at <a href="https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-mvc" target="_blank" class="pcalibre pcalibre3 pcalibre1 calibre12 pcalibre2">https://github.com/eldermoraes/javaee8-cookbook/tree/master/chapter01/ch01-mvc</a></li>
</ul>


            </article>

            
        </section>
    </div>



  </body></html>