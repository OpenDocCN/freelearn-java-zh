<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;4.&#xA0;Building and Running a Project"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04" class="calibre1"/>Chapter 4. Building and Running a Project</h1></div></div></div><p class="calibre7">Congratulations! You are halfway through the book. As discussed in earlier chapters, Maven follows convention over configuration; this implies there is a default build mechanism in place. The build mechanism, often termed as <a id="id214" class="calibre1"/>the <span class="strong"><strong class="calibre8">build lifecycle</strong></span>, forms a sequence of steps grouped together in phases (also known as <a id="id215" class="calibre1"/>
<span class="strong"><strong class="calibre8">stages)</strong></span>. Each <span class="strong"><strong class="calibre8">phase</strong></span><a id="id216" class="calibre1"/> is accompanied with a set of goals that define the unit of task. In this chapter, we will look at three standard lifecycles—clean, default, and site—and get acquainted with other common lifecycles. You will also get to know about building and running the <code class="email">hello-project</code>, which was created in <a class="calibre1" title="Chapter 3. Creating and Importing Projects" href="part0024_split_000.html#page">Chapter 3</a>, <span class="strong"><em class="calibre9">Creating and Importing Projects</em></span>. This chapter covers the following sections:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Build lifecycle<div class="book"><ul class="itemizedlist1"><li class="listitem">Default lifecycle</li><li class="listitem">Clean lifecycle</li><li class="listitem">Site lifecycle</li></ul></div></li><li class="listitem">Package-specific lifecycle</li><li class="listitem">The Maven console</li><li class="listitem">Building and packaging projects</li><li class="listitem">Running hello-project</li></ul></div></div>

<div class="book" title="Chapter&#xA0;4.&#xA0;Building and Running a Project">
<div class="book" title="The build lifecycle"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch04lvl1sec26" class="calibre1"/>The build lifecycle</h1></div></div></div><p class="calibre7">Building a Maven <a id="id217" class="calibre1"/>project results in the execution of set goals grouped in phases. Though there is a default build cycle of Maven, it can be customized to suit our needs; that's the beauty Maven inherits. To ascertain, it is essential to have knowledge of the build's lifecycle. Essentially, the following are the three standard lifecycles in Maven:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Default</li><li class="listitem">Clean</li><li class="listitem">Site</li></ul></div></div></div>

<div class="book" title="Chapter&#xA0;4.&#xA0;Building and Running a Project">
<div class="book" title="The build lifecycle">
<div class="book" title="The default lifecycle"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec24" class="calibre1"/>The default lifecycle</h2></div></div></div><p class="calibre7">The<a id="id218" class="calibre1"/> default lifecycle <a id="id219" class="calibre1"/>handles the build of the project and its deployment. It is the primary lifecycle of Maven and is also known as the build lifecycle. In general, it provides the build process model for Java applications. There are 23 phases for the default lifecycle that starts with validation and ends with deploy. For details on all <a id="id220" class="calibre1"/>23 phases, please refer to <a class="calibre1" href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference">http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference</a>.</p><p class="calibre7">However, here we will see some of the phases and the default associated goals that need attention for common application development, which are as follows:</p><div class="informalexample"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/><col class="calibre19"/></colgroup><thead class="calibre20"><tr class="calibre21"><th valign="bottom" class="calibre22">
<p class="calibre23">Lifecycle phases</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">Description</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">Plugin:goals</p>
</th></tr></thead><tbody class="calibre24"><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">validate</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id221" class="indexterm"/>validates that the <a id="id222" class="indexterm"/>project is <a id="id223" class="indexterm"/>correct and contains all the necessary information to perform the build operation</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">-</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">compile</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id224" class="indexterm"/>compiles the <a id="id225" class="indexterm"/>source code</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">compiler:compile</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">test-compile</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id226" class="indexterm"/>compiles<a id="id227" class="indexterm"/> the test source code in the test destination directory</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">compiler:testCompile</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">test </p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id228" class="indexterm"/>runs the test using <a id="id229" class="indexterm"/>suitable unit testing framework as configured in the <code class="literal">pom</code> file</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">surefire:test</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">package</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id230" class="indexterm"/>packages the compiled source code in the corresponding<a id="id231" class="indexterm"/> distributable format such as JAR, WAR, EAR, and so on</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">jar:jar</code> (for JAR packaging)</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">install</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id232" class="indexterm"/>installs<a id="id233" class="indexterm"/> the package in the local repository, which can act as a dependency for other projects</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">install:install</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">deploy</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This<a id="id234" class="indexterm"/> copies the<a id="id235" class="indexterm"/> final package to a<a id="id236" class="indexterm"/> remote repository to share with other <a id="id237" class="indexterm"/>developers and projects</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">deploy:deploy</code>
</p>
</td></tr></tbody></table></div></div></div></div>

<div class="book" title="Chapter&#xA0;4.&#xA0;Building and Running a Project">
<div class="book" title="The build lifecycle">
<div class="book" title="The clean lifecycle"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch04lvl2sec25" class="calibre1"/>The clean lifecycle</h2></div></div></div><p class="calibre7">The clean lifecycle is the simplest lifecycle in <a id="id238" class="calibre1"/>Maven, and it consists of the<a id="id239" class="calibre1"/> following phases:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre8">pre-clean</strong></span>: This <a id="id240" class="calibre1"/>phase <a id="id241" class="calibre1"/>executes the process <a id="id242" class="calibre1"/>needed before a project's clean up</li><li class="listitem"><span class="strong"><strong class="calibre8">clean</strong></span>: This phase<a id="id243" class="calibre1"/> removes all files built by an <a id="id244" class="calibre1"/>earlier <code class="email">build</code> (the <code class="email">target</code> directory)</li><li class="listitem"><span class="strong"><strong class="calibre8">post-clean</strong></span>: This phase<a id="id245" class="calibre1"/> executes the process required after a <a id="id246" class="calibre1"/>project's cleanup</li></ul></div><p class="calibre7">Out of these phases, the one that gathers our interest is the <span class="strong"><strong class="calibre8">clean</strong></span> phase. The Maven "<code class="email">clean:clean</code>" goal is bound to the clean phase. It cleans the project's <code class="email">build</code> (usually <code class="email">target</code>) directory. Executing any one phase result in execution of all phases up to it and the phase itself, for example, a call of a clean phase would execute the first pre-clean phase and then the clean phase; similarly, a call of post-clean results in the calling of pre-clean, clean, and post-clean phases. The following diagram illustrates the execution of the clean lifecycle phases (reference: the Apache Maven site):</p><div class="mediaobject"><img src="../images/00040.jpeg" alt="The clean lifecycle" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">We can bind <a id="id247" class="calibre1"/>other goals to the phases of the clean lifecycle. Suppose<a id="id248" class="calibre1"/> we want to echo some message on the pre-clean phase; we can achieve this by binding the <code class="email">maven-antrun-plugin:run</code> goal to this phase, which can be done as follows:</p><div class="informalexample"><pre class="programlisting">&lt;/project&gt;
  ...........
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;precleanid&lt;/id&gt;
          &lt;phase&gt;pre-clean&lt;/phase&gt;
          &lt;goals&gt;
            &lt;goal&gt;run&lt;/goal&gt;
          &lt;/goals&gt;
          &lt;configuration&gt;
            &lt;tasks&gt;
              &lt;echo&gt;Hello am in pre-clean phase&lt;/echo&gt;
                &lt;/tasks&gt;
          &lt;/configuration&gt;
        &lt;/execution&gt;</pre></div></div></div></div>

<div class="book" title="Chapter&#xA0;4.&#xA0;Building and Running a Project">
<div class="book" title="The build lifecycle">
<div class="book" title="The site lifecycle"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch04lvl2sec26" class="calibre1"/>The site lifecycle</h2></div></div></div><p class="calibre7">The <a id="id249" class="calibre1"/>site lifecycle <a id="id250" class="calibre1"/>handles the creation of the project site documentation. The phases of a site lifecycle are shown in the following diagram:</p><div class="mediaobject"><img src="../images/00041.jpeg" alt="The site lifecycle" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">The following table describes the site lifecycle phases in the order of execution. (reference: Apache Maven website)</p><div class="informalexample"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/></colgroup><thead class="calibre20"><tr class="calibre21"><th valign="bottom" class="calibre22">
<p class="calibre23">Phases</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">Description</p>
</th></tr></thead><tbody class="calibre24"><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">pre-site</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id251" class="indexterm"/>phase<a id="id252" class="indexterm"/> executes processes<a id="id253" class="indexterm"/> needed before the generation of a project site.</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">site</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This<a id="id254" class="indexterm"/> phase generates <a id="id255" class="indexterm"/>documentation of a project site </p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">post-site</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id256" class="indexterm"/>phase <a id="id257" class="indexterm"/>executes a process required after a site's generation and to prepare for site deployment</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">site-deploy</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">This <a id="id258" class="indexterm"/>phase <a id="id259" class="indexterm"/>deploys the generated site <a id="id260" class="indexterm"/>documentation to the specified web server</p>
</td></tr></tbody></table></div><p class="calibre7">Executing any<a id="id261" class="calibre1"/> one phase results in the execution of all phases up to it and the phase itself. For example, calling post-site results in the execution of pre-site, site, and post-site phases. Similar to the clean lifecycle, we can bind other goals to the site's lifecycle.</p></div></div></div>
<div class="book" title="The package-specific lifecycle"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec27" class="calibre1"/>The package-specific lifecycle</h1></div></div></div><p class="calibre7">Each type of<a id="id262" class="calibre1"/> packaging has its own set of default goals. The default goals for JAR packaging is different from WAR packaging. Maven provides a lifecycle for the following built-in packaging types:</p><div class="book"><ul class="itemizedlist"><li class="listitem">JAR</li><li class="listitem">WAR</li><li class="listitem">EAR</li><li class="listitem">POM</li><li class="listitem">EJB</li><li class="listitem">Maven plugins</li></ul></div><p class="calibre7">The lifecycle and goal binding for WAR packaging is described here. For other packaging lifecycle<a id="id263" class="calibre1"/> and <a id="id264" class="calibre1"/>goal binding, please refer to <a class="calibre1" href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Built-in_Lifecycle_Bindings">http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Built-in_Lifecycle_Bindings</a>.</p><div class="informalexample"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/></colgroup><thead class="calibre20"><tr class="calibre21"><th valign="bottom" class="calibre22">
<p class="calibre23">Phases</p>
</th><th valign="bottom" class="calibre22">
<p class="calibre23">plugin:goals</p>
</th></tr></thead><tbody class="calibre24"><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">process-resources<a id="id265" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">resources:resources</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">compile<a id="id266" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">compiler:compile</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">process-test-resources<a id="id267" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">resources:testResources</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">test-compile<a id="id268" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">compiler:testCompile</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">test<a id="id269" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">surefire:test</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">package<a id="id270" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">war:war</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">install<a id="id271" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">install:install</code>
</p>
</td></tr><tr class="calibre21"><td valign="top" class="calibre25">
<p class="calibre23">deploy<a id="id272" class="indexterm"/>
</p>
</td><td valign="top" class="calibre25">
<p class="calibre23">
<code class="literal">deploy:deploy</code>
</p>
</td></tr></tbody></table></div></div>
<div class="book" title="The Maven console"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec28" class="calibre1"/>The Maven console</h1></div></div></div><p class="calibre7">Before<a id="id273" class="calibre1"/> we <a id="id274" class="calibre1"/>get <a id="id275" class="calibre1"/>our <a id="id276" class="calibre1"/>hands<a id="id277" class="calibre1"/> dirty<a id="id278" class="calibre1"/> with<a id="id279" class="calibre1"/> building<a id="id280" class="calibre1"/> and executing <a id="id281" class="calibre1"/>Maven projects, we need to <a id="id282" class="calibre1"/>enable the Maven console. The Maven console can be enabled with the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1"> Navigate to <span class="strong"><strong class="calibre8">Window</strong></span> | <span class="strong"><strong class="calibre8">Show View</strong></span> | <span class="strong"><strong class="calibre8">Console</strong></span>. This <a id="id283" class="calibre1"/>shows the console view.</li><li class="listitem" value="2"> Next, click on the little arrow of <span class="strong"><strong class="calibre8">Open Console</strong></span> as shown in the following screen and click on <span class="strong"><strong class="calibre8">Maven Console</strong></span>:<div class="mediaobject"><img src="../images/00042.jpeg" alt="The Maven console" class="calibre10"/></div><p class="calibre14"> </p></li></ol><div class="calibre15"/></div><p class="calibre7">The Maven console shows all the output of the Maven build process. It shows all the details that Maven processes and is really helpful in getting to know what is happening underneath and you can also see the debug messages.</p></div>
<div class="book" title="Building and packaging projects"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec29" class="calibre1"/>Building and packaging projects</h1></div></div></div><p class="calibre7">Building and packaging Maven projects<a id="id284" class="calibre1"/> needs execution of required phases, which we<a id="id285" class="calibre1"/> discussed in the preceding sections. Let's build and package <code class="email">hello-project</code> from <a class="calibre1" title="Chapter 3. Creating and Importing Projects" href="part0024_split_000.html#page">Chapter 3</a>, <span class="strong"><em class="calibre9">Creating and Importing Projects</em></span>, which we generated using archetypes. In the <span class="strong"><em class="calibre9">Default Lifecycle</em></span> section, the phase package executes the following phases in order: compile, test, and package phases. Now, we will see how to invoke the package phase from m2eclipse. The following steps will ascertain this:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Right-click on <code class="email">hello-project</code> and select <span class="strong"><strong class="calibre8">Run As</strong></span>. Click on <span class="strong"><strong class="calibre8">Run Configurations</strong></span> and the <span class="strong"><strong class="calibre8">Run Configurations</strong></span> window will appear.</li><li class="listitem" value="2">Right-click on <span class="strong"><strong class="calibre8">Maven Build</strong></span> and choose <span class="strong"><strong class="calibre8">New</strong></span> as shown in the following screenshot:<div class="mediaobject"><img src="../images/00043.jpeg" alt="Building and packaging projects" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="3">Once the<a id="id286" class="calibre1"/> launch configurations window appears, fill in the details<a id="id287" class="calibre1"/> as shown in the following screenshot. For <span class="strong"><strong class="calibre8">Base Directory</strong></span>, click on <span class="strong"><strong class="calibre8">Browse Workspace...</strong></span> and choose <code class="email">hello-project</code> from the pop-up list:<div class="mediaobject"><img src="../images/00044.jpeg" alt="Building and packaging projects" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="4">Next, click <a id="id288" class="calibre1"/>on <span class="strong"><strong class="calibre8">Apply</strong></span> and close it using the <span class="strong"><strong class="calibre8">Close</strong></span> button.</li><li class="listitem" value="5">Again right-click <a id="id289" class="calibre1"/>on the project and select <span class="strong"><strong class="calibre8">Run As</strong></span>, and click on <span class="strong"><strong class="calibre8">Maven build</strong></span> as shown in the following screenshot:<div class="mediaobject"><img src="../images/00045.jpeg" alt="Building and packaging projects" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="6">A window, as<a id="id290" class="calibre1"/> shown in the following screenshot, will<a id="id291" class="calibre1"/> appear with all the run configurations available:<div class="mediaobject"><img src="../images/00046.jpeg" alt="Building and packaging projects" class="calibre10"/></div><p class="calibre14"> </p></li><li class="listitem" value="7">Choose the <span class="strong"><strong class="calibre8">hello-package</strong></span> launch configuration and click on <span class="strong"><strong class="calibre8">OK</strong></span>. It should compile, run tests, generate site documentation, and package in the <code class="email">target</code> directory, as shown in following screenshot:<div class="mediaobject"><img src="../images/00047.jpeg" alt="Building and packaging projects" class="calibre10"/></div><p class="calibre14"> </p></li></ol><div class="calibre15"/></div></div>
<div class="book" title="Running hello-project"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec30" class="calibre1"/>Running hello-project</h1></div></div></div><p class="calibre7">Since <code class="email">hello-project</code> from<a id="id292" class="calibre1"/> the previous chapter is a Java application, running it is similar to any other Java application. Right-click on the project, select <span class="strong"><strong class="calibre8">Run As</strong></span>, and click on <span class="strong"><strong class="calibre8">Java Application</strong></span>, select the main JAVA class, and click on <span class="strong"><strong class="calibre8">OK</strong></span>. It will print <code class="email">Hello World!</code> in the console.</p><p class="calibre7">Running a web application requires some extra steps, which we will discuss in <a class="calibre1" title="Chapter 5. Spicing Up a Maven Project" href="part0037_split_000.html#page">Chapter 5</a>, <span class="strong"><em class="calibre9">Spicing Up a Maven Project</em></span>.</p></div>
<div class="book" title="Summary"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec31" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, you learned about the clean, site, and default build lifecycles of the Maven project, and later used this knowledge to get the application to package and run.</p><p class="calibre7">In the next chapter, we will build a web application and you will learn to customize the <code class="email">pom</code> file to suit our needs.</p></div></body></html>