<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Overview of Spring 5 and Spring Security 5</h1>
                </header>
            
            <article>
                
<p>This book expects readers to be conversant with Spring Framework (any version) and Spring Security (any version). This is an ice-breaker chapter that introduces the reader to some of the most important concepts; we will expand on them in subsequent chapters.</p>
<p>The chapter will introduce you to new application requirements and then to reactive programming concepts. It touches on application security and how Spring Security addresses security concerns in an application.</p>
<p>We'll continue with Spring Security and then close the chapter by explaining how the examples in this chapter are structured. This is quite important as I expect readers to be comfortable whenever a new concept is introduced in code.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>New-generation application requirements</li>
<li>Reactive programming</li>
<li>Reactive applications</li>
<li>Spring Framework</li>
<li>Reactive landscape in Java</li>
<li>Spring Framework and reactive applications</li>
<li>Application security</li>
<li>Spring Security</li>
<li>Spring Security's core features</li>
<li>Spring Security 5's new features</li>
<li>The working of Spring Security</li>
<li>Core Spring Security modules</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How examples are structured</h1>
                </header>
            
            <article>
                
<p>It's important that you understand how we will be using examples in this book. Since the book tries to give lots of detail on Spring Security 5 and its reactive aspects, we will not have a single use case throughout the book. Instead, we will keep creating small projects to help you understand each of the core concepts covered. Here are some of the important aspects of the code base within this book:</p>
<ul>
<li style="font-weight: 400">Most concepts will be covered using a standalone Spring Boot project.</li>
<li style="font-weight: 400">At times, we will use the famous Spring Initializr (<a href="https://start.spring.io/">https://start.spring.io/</a>) to bootstrap our sample Spring Boot application. In other cases, we will start with a base project that we already have and introduce more concepts through code.</li>
<li style="font-weight: 400">Generally, we will be using Java configuration. At times, we might use XML-based configurations.</li>
<li style="font-weight: 400">We will keep our examples as simple as possible so that we don't lose focus on the core concept being introduced.</li>
<li style="font-weight: 400">Even though this book is focused on reactive applications, we will not be covering this each time it is introduced. At times, we will just be doing plain, old imperative programming as it is more important to know reactive programming and use it when required. It's not that we have to use reactive code everywhere possible, just use it where you see fit.</li>
<li style="font-weight: 400">We will be using VS Code for all the projects, and we'll be using the extensions available in VS Code to the fullest. We will also be using the Spring Initializr extension rather than using online Spring Initializr.</li>
<li style="font-weight: 400">We will be using Maven most of the time in this book. There might be a case where we try<span> </span>Gradle.</li>
<li style="font-weight: 400">Sometimes, we might use IntelliJ IDE and you'll see some screenshots showing this.</li>
<li style="font-weight: 400">We'll be using the latest Spring Boot release version, namely <strong>2.0.0. RELEASE</strong>. This is the latest release version of Spring Boot at the time of writing this book.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">New-generation application requirements</h1>
                </header>
            
            <article>
                
<p>Here are some of the core new application requirements:</p>
<ul>
<li><strong>Highly scalable</strong>: The social platform has grown exponentially over the last decade and people are more tech-savvy than ever.</li>
<li><strong>Resilient, fault-tolerant, and highly available</strong><span>: downtime in your application is something which enterprises are not ready to take in modern times; downtime of even seconds is now creating huge losses for many big businesses.</span></li>
<li><strong>High performance</strong>: If your site is slow, people have a tendency to leave and search for alternatives. People have a short attention span and will not stay or come back if your website performs poorly.</li>
<li><strong>Hyper-personalization</strong>: Users need personalized websites rather than generic websites, and this puts huge pressure on servers to do many intensive analyses in real time.</li>
</ul>
<p>With technology in everyone's hands (in some form or another, most people use technology), users are quite well-versed in privacy policies and application security. They are aware of most of the security requirements, and companies take time to educate users about the importance of security and the ways they should look for security flaws in applications. You might already know that if a site runs on HTTP as opposed to HTTPS (SSL) and Chrome tags, these sites quite clearly show the users as <span class="packt_screen">Not Secure</span> in the address bar. With more people becoming knowledgeable about technology, these aspects are well-known among the majority of users and security has become one of the most talked about subjects in the IT landscape.</p>
<p>Another important aspect is data privacy. Some users are not concerned about sharing their data but some are quite reticent. Many governments recognize this fear and have started making many rules and regulations in this space. One such data privacy rule is the well-known <strong>General Data Protection Regulation</strong> (<strong>GDPR</strong>), which has been enforced since May 25th, 2018.</p>
<p class="mce-root"><span>The <strong>European Union</strong> (<strong>EU</strong>) GDPR replaces the Data Protection Directive 95/46/EC and was designed to harmonize data privacy laws across Europe, to protect and empower all EU citizen's data privacy and to reshape the way organizations across the region approach data privacy. For more information, you can check this link:</span><span><span> <a href="https://gdpr-info.eu/art-99-gdpr/">https://gdpr-info.eu/art-99-gdpr/</a>.</span></span></p>
<p class="mce-root">Modern browsers have also given us enough tools to look at many aspects of a web application in a more detailed manner with regards to security. In addition, browsers have been enhanced with more and more features (for example, a cookie was once one of the options for storing data, but now we have other options, such as <strong>localStorage</strong> and i<strong>ndexedDB</strong>), making it more vulnerable to security breaches and attacks from an ever-open hacker sitting on the sidelines.</p>
<p class="mce-root"/>
<p><span>To achieve these various application requirements, organizations go to public cloud providers instead of their own on-premise datacenters</span>. This puts applications in a more vulnerable state and security aspects come to the forefront. The various components that constitute the application need to be highly secured and nonhackable.</p>
<p>The technological landscape is constantly growing, with new technologies popping up and getting adopted by the developer community. Because of this and the various technology improvements it brings in, many organizations have to adopt these technologies to be compete within the market. This again puts huge pressure on security, as these shiny new technologies may not have concentrated enough effort on making security a major requirement.</p>
<p>All in, having rigid security in an application is a no-brainer requirement and organizations, and end users, are well aware of this fact.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive programming</h1>
                </header>
            
            <article>
                
<p><span> Over the last few years, </span>JavaScript has become one of the most used languages, and you have already heard of the term <strong>reactive</strong> in the world of JavaScript, both in a backend and a frontend context.</p>
<p>So, <em>What exactly is reactive programming?</em>—It's a programming paradigm that has asynchronous data streams at its core. The data flows through various parts of the program in the form of a message. The message is produced by a <kbd>Producer</kbd><span> </span>and works in a fire-and-forget manner in which the program produces a message and forgets it. The <kbd>Subscriber</kbd> who has subscribed (shown interest) to such messages, gets the message, processes it, and passes on the output as a message for other parts of the program to consume.</p>
<p>In the world of databases, NoSQL presented a huge shift from relational databases. Similarly, this programming paradigm is a huge shift from the conventional programming paradigm (imperative programming). The good thing is that without much knowledge, you have already been coding a bit of reactive code in your day-to-day coding life. Wherever you see the word <strong>stream</strong>, you are indirectly using a piece of reactive code. Such programming has a name of its own and this aspect has become more mainstream in the industry. Many languages understand the advantages this brings and they have started to natively support this paradigm of programming.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive applications</h1>
                </header>
            
            <article>
                
<p>In the earlier section of this chapter, we covered how application requirements have drastically changed over the last decade. To cater to this, there is a concept of application development named reactive applications.</p>
<p>It is important to understand the difference between reactive programming and reactive applications. Employing reactive programming doesn't produce reactive applications, but concepts of reactive programming can definitely aid in building reactive applications.</p>
<p>Knowing the Reactive Manifesto will help you understand reactive applications/systems because the manifesto clearly dictates each and every aspect of reactive applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Manifesto</h1>
                </header>
            
            <article>
                
<p class="def-content"><span><span class="oneClick-link">A <strong>manifesto</strong> is a</span> <span class="oneClick-link oneClick-available">public</span> <span class="oneClick-link oneClick-available">declaration</span> <span class="oneClick-link">of</span> <span class="oneClick-link">intentions,</span> <span class="oneClick-link">opinions,</span> <span class="oneClick-link">objectives,</span> <span class="oneClick-link">or</span> <span class="oneClick-link">motives,</span> <span class="oneClick-link">as</span> <span class="oneClick-link">one</span> <span class="oneClick-link">issued</span> <span class="oneClick-link">by</span> <span class="oneClick-link">a</span> <span class="oneClick-link oneClick-available">government,</span> <span class="oneClick-link oneClick-available">sovereign,</span> <span class="oneClick-link">or</span> <span class="oneClick-link oneClick-available">organization</span></span><span> (</span><a href="http://www.dictionary.com/browse/manifesto">http://www.dictionary.com/browse/manifesto</a>).</p>
<p>The <strong>Reactive Manifesto</strong> clearly articulates the views of the issuer, following which an application can be developed to be reactive.</p>
<p>According to the Reactive Manifesto (<a href="https://www.reactivemanifesto.org/">https://www.reactivemanifesto.org/</a>), a reactive system should be responsive, resilient, elastic, and message-driven.</p>
<p>Let's get into each of these terms in a bit more detail. Most of the text in this section is from the online Reactive Manifesto and then slightly modified to convey the concepts in more easily digestible terms for the readers.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Responsive</h1>
                </header>
            
            <article>
                
<p>In case of problems, responsive systems can quickly detect them and effectively deal with them. These systems also give consistent response times and also establish upper bounds, guaranteeing a minimum <strong>Quality of Service</strong> (<strong>QoS</strong>). Because of such characteristics, these systems build end user confidence, simplify error handling, and encourage more interaction from end users.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Resilient</h1>
                </header>
            
            <article>
                
<p>In the case of failure, resilient systems stay responsive and interactable. <strong>Resilience</strong> in an application can be achieved by:</p>
<ul>
<li><strong>Replication</strong>: Running the same component in more than one place, so that if one fails, another could handle it and the application can function in a normal fashion.</li>
<li><strong>Containment/isolation</strong>: Issues of a particular component are contained and isolated within that component and don't interfere with other components or other similar components spun up as part of replication.</li>
<li><strong>Delegation</strong>: In the case of an issue in a component, without much deliberation, the control is transferred to another similar component that is running in a completely different context.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Elastic</h1>
                </header>
            
            <article>
                
<p>Elastic systems can easily autoscale (increase or decrease resources) as the input rate increases or decreases. Such systems don't have any contention points and can replicate components at will, distributing the increase in load. The way these systems are designed makes sure that when scaling is required, it can be done in a very cost-effective manner by adding on more commodity hardware and software platforms as opposed to expensive hardware and licensed software platforms.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Message-driven</h1>
                </header>
            
            <article>
                
<p>In reactive applications, one of the main aspects is the usage of asynchronous messages to pass data from one component to another. This brings loose coupling between components and aids in achieving location transparency (as long as the component is reachable/discoverable, it can reside in a single node or a cluster of nodes anywhere). Create a message, publish, and forget. Registered subscribers receive the message, process it, and broadcast the message for the other subscribes to do their jobs. This is one of the core aspects of reactive programming and it is one of the fundamental aspects needed for a reactive system. This fire-and-forget concept brings in a non-blocking way of communication, resulting in highly scalable applications.</p>
<p>The following diagram (<em>Figure 1</em>) clearly shows the Reactive Manifesto in a pictorial fashion. It also clearly shows the relationship between the main concepts on the Reactive Manifesto:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0c837321-50ac-422f-993a-c12aece10ded.png" style="width:29.25em;height:18.17em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 1: Reactive Manifesto</div>
<p>Since reactive applications are responsive, resilient, elastic, and message-driven, these applications are inherently highly flexible, highly scalable, loosely coupled, and fault-tolerant.</p>
<p>Mateusz Gajewski, in one of his presentations shared on <kbd>www.slideshare.net</kbd>, sums up the Reactive Manifesto in a very nice way:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f2dc861f-ce23-40b4-9240-691ca42cee51.png" style="width:29.58em;height:15.67em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 2: Reactive Manifesto as conceived by Mateusz Gajewski</div>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Framework</h1>
                </header>
            
            <article>
                
<p><strong>Spring Framework</strong> is the de facto standard for building Java applications. Over the last decade, it has matured with every major release. Spring Framework 5 became generally available as 5.0.0. in September 2017; this is an important release (major) for the framework since its previous version, which was released in 2013.</p>
<p>One of the major additions to Spring 5 is the introduction of a functional web framework, Spring<span> </span>WebFlux,<span> </span>built on the core reactive foundation. Reactive programming is slowly creeping into the framework and many core modules within the framework are inherently supporting reactive programming in a big way. Since the framework has started supporting reactive programming natively, core aspects of this programming are fully implemented and followed by many of the modules. Also, many reactive concepts have become common language within the framework.</p>
<p>It's important to note that Spring's reactive concepts have been taken as is from Java 8's <strong>Reactor Core library</strong>, which implements the reactive programming paradigm. Reactor Core is built on top of <em>Reactive Streams Specification</em>, which is the industry standard for building reactive applications in the Java world.</p>
<p>Another important feature is the inclusion of new way by which such applications can be tested. We have a dedicated chapter for Spring WebFlux in (<a href="df488f9c-24a7-4d0f-ac82-1d126a391fcc.xhtml">Chapter 5</a>, <em>Integrating with Spring WebFlux</em>) where these aspects will be covered in more detail.</p>
<p>Being a major release, it has loads of stuff either added or enhanced. But we are not going to list all of its features. The full list can be found at this link: <a href="https://github.com/spring-projects/spring-framework/wiki/What%27s-New-in-Spring-Framework-5.x">https://github.com/spring-projects/spring-framework/wiki/What%27s-New-in-Spring-Framework-5.x</a><em>.</em></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Landscape in Java</h1>
                </header>
            
            <article>
                
<p>It's hard to wrap your head around reactive concepts when you're coming from a traditional programming model. Some of the subsequent sections are aimed at introducing you to reactive concepts and how they evolved into their present state.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Streams and Reactive Streams Specifications</h1>
                </header>
            
            <article>
                
<p>The official document for Reactive Streams (<a href="http://www.reactive-streams.org/">http://www.reactive-streams.org/</a>) says that—<em>Reactive Streams is an initiative to provide a standard for asynchronous stream processing with non-blocking back pressure. This encompasses efforts aimed at runtime environments (JVM and JavaScript) as well as network protocols.</em></p>
<p>It started as an initiative between a group of companies in 2013. In April 2015, 1.0 of the specification was released and there were a number of implementations (such as Akka Streams and Vert.x) available at the same time. The specification was initiated with a target to get it included in the official Java standard library and in 2017, with the release of JDK9, it made it's way into it officially. As with any specification, the ultimate aim is to have a number of implementations conforming to the specification, and over time, the specification evolves. The specification consists of some core interfaces, some rules around these, and a <strong><span>Technology Compatibility Kit</span></strong> (<strong><span>TCK</span></strong>).</p>
<p>TCK is a suite of tests that will be executed to check the correctness/compliance of a <span><strong>Java Specification Request</strong></span> (<strong><span>JSR</span></strong>) implementation. In <strong><span>Java Community Process</span></strong> (<strong><span>JCP</span></strong>), TCK is one of the three required components for ratifying a JSR. The other two are JSR specification and JSR reference implementation. The TCK for the Java platform is called <strong>Java Compatibility Kit</strong> (<strong>JCK</strong>).</p>
<p>Being a specification, it enables any implementation respecting the specification to cooperate and interoperate with each other. For example, an implementation written in Akka can talk to the Vert.x implementation over the Reactive Streams protocol without any trouble. Adoption is growing and, as we speak, more implementations that conform to the specifications written in different languages are being released:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/889be598-8a2a-46ac-b42d-e926af183090.png" style="width:29.92em;height:14.67em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 3: Reactive Streams Specification/API</div>
<p>The preceding figure clearly shows the <strong>Reactive Streams Specification</strong>. Some of the important specification rules are as follows:</p>
<ul>
<li style="font-weight: 400">The calls from <kbd>Publisher</kbd> to <kbd>Subscriber</kbd> and <kbd>Subscriber</kbd> to <kbd>Publisher</kbd> shouldn't be concurrent in nature.</li>
<li style="font-weight: 400">The <kbd>Subscriber</kbd> can perform its job synchronously or asynchronously but always has to be non-blocking in nature.</li>
<li style="font-weight: 400">From <kbd>Publisher</kbd> to <kbd>Subscriber</kbd> there should be an upper bound defined. After that defined bound, buffer overflows occur and could result in errors.</li>
<li style="font-weight: 400">Apart from <strong>NullPointerException</strong> (<strong><span>NPE</span></strong>), no other exception can be raised. In the case of NPE, <kbd>Publisher</kbd> calls the <kbd>onError</kbd> method and <kbd>Subscriber</kbd> cancels the <kbd>Subscription</kbd>.</li>
</ul>
<p>In the preceding definition of Reactive Streams, there are some very important terms, namely <strong>non-blocking</strong> and <strong>backpressure</strong>, which we'll explore a bit more to understand the core concepts of Reactive Streams.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Non-blocking</h1>
                </header>
            
            <article>
                
<p><strong>Non-blocking</strong> means threads never block. If the thread needs to block, the code is written in such a way that the thread gets notified at the right time and the process continues. Reactive programming lets you implement a non-blocking, declarative, and event-driven architecture.</p>
<p>One of the approaches to writing non-blocking applications is by using messages as the means of sending data. A thread sends the request and soon after that, the thread is being used for something else. When the response is ready, it is delivered back using another thread and the requesting party is notified so that further processing can continue:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1323eef4-40e3-40e8-895a-fe526156fa6e.png" style="width:26.00em;height:12.58em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 4: Non-blocking</div>
<p class="mce-root"/>
<p>The non-blocking concept is already implemented by well-known frameworks, such as Node.js and Akka. The approach that Node.js uses is a single thread that sends data in a multiplexing aspect.</p>
<p><span>In telecommunications and computer networks, multiplexing (sometimes contracted to muxing) is a method by which multiple analog or digital signals are combined into one signal over a shared medium. The aim is to share an expensive resource. For more information about multiplexing, you can visit the following link: <a href="http://www.icym.edu.my/v13/about-us/our-news/general/722-multiplexing.html">http://www.icym.edu.my/v13/about-us/our-news/general/722-multiplexing.html</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Backpressure</h1>
                </header>
            
            <article>
                
<p>In an ideal scenario, every message produced by the <kbd>Producer</kbd> is passed to the <kbd>Subscriber</kbd> as and when the message is produced without any delay. There is a chance that the <kbd>Subscriber</kbd> is unable to handle the messages at the same rate as they are produced and this can cramp its resources.</p>
<p><strong>Backpressure</strong> is a method by which the <kbd>Subscriber</kbd> can tell the <kbd>Producer</kbd> to send messages at a slower rate to give the <kbd>Subscriber</kbd> time to handle these messages properly without putting too much pressure on its resources.</p>
<p>Since this is the first chapter, we are just introducing you to these important reactive concepts. Code examples will be covered in subsequent chapters.</p>
<p>Now that we have a brief idea of Reactive Streams and Reactive Streams Specification, we will go into next important reactive concept in Java, namely Reactive Extensions.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Extensions</h1>
                </header>
            
            <article>
                
<p><strong>Reactive Extensions</strong> (<strong>Rx or <span>ReactiveX</span></strong>) (<a href="https://msdn.microsoft.com">https://msdn.microsoft.com</a>) is a library for composing asynchronous and event-based programs using observable sequences and LINQ-style query operators. Data sequences can take many forms, such as a stream of data from a file or web service, web services requests, system notifications, or a series of events such as user inputs.</p>
<p>As stated in the preceding definition, these are APIs that allow stream composition using the Observer pattern. It's my duty to introduce you to the Observer pattern before going any further. The following is the definition of this pattern and it's quite intuitive:</p>
<p class="mce-root"/>
<p><span>The Observer pattern defines a </span>provider<span> (also known as a </span>subject<span> or an </span>observable<span>) and zero, one, or more </span>observers (<kbd>Subscriber</kbd>)<span>. Observers register with the provider, and whenever a predefined condition, event, or state change occurs, the provider automatically notifies all observers by calling one of their methods. For more information about the Observer pattern, you can refer to this link:</span> <a href="https://docs.microsoft.com/en-us/dotnet/standard/events/observer-design-pattern">https://docs.microsoft.com/en-us/dotnet/standard/events/observer-design-pattern</a>.</p>
<p>Data can flow in a number of forms, such as streams or events. Reactive Extensions lets you convert this dataflow into observables and aids you in programming reactive code.</p>
<p>Rx is implemented in a variety of languages, including Java (RxJava). A full list of implemented languages and more detail on Rx can be found at <a href="http://reactivex.io/">http://reactivex.io/</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">RxJava</h1>
                </header>
            
            <article>
                
<p><strong>RxJava</strong> is a Java VM implementation of ReactiveX—a library for composing asynchronous and event-based programs by using observable sequences.</p>
<p>RxJava was ported from .NET to the world of Java by Netflix. After almost two years of development, a stable release of the API was made available in 2014. This stable release targets Java (Version 6 and above), Scala, JRuby, Kotlin, and Clojure.</p>
<p>RxJava is a single-JAR, lightweight library and focuses on Observable abstraction. It facilitates integration with a variety of external libraries, making the library align with reactive principles. Some examples are <kbd>rxjava-jdbc</kbd> (database calls using JDBC with RxJava Observables) and Camel RX (Camel support for Reactive Extensions using RxJava).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Streams and RxJava</h1>
                </header>
            
            <article>
                
<p>RxJava 2.x is a complete rewrite from its predecessor, RxJava 1.x.</p>
<p>RxJava 1.x was created before Reactive Streams Specification, and because of this it doesn't implement it. RxJava 2.x, on the other hand, is written on top of Reactive Streams Specification and fully implements it, and also targets Java 8+. RxJava types in RxJava 1.x have been fully tweaked to comply with the specification and suffered heavy changes when the rewrite took place. It's good to note that there exists a bridge library (<a href="https://github.com/ReactiveX/RxJavaReactiveStreams">https://github.com/ReactiveX/RxJavaReactiveStreams</a>) that bridges between RxJava 1.x types and Reactive Streams, allowing RxJava 1.x to pass the Reactive Streams TCK-compliance tests.</p>
<p>In RxJava 2.x, many concepts remain intact but names have been changed to comply with the spec.</p>
<p>We will not be going deep into RxJava as it is a big topic and there are plenty of books available that dive deep into RxJava.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">JDK 9 additions</h1>
                </header>
            
            <article>
                
<p>As part of concurrency updates to JDK 9 (JEP 266), Reactive Streams was added to the Java standard library. Reactive Streams was initiated in 2013 by some of the well-known organizations that wanted to standardize the approach by which asynchronous data can be exchanged between software components. Soon, the concept became adopted by the industry and there evolved a number of implementations that all had similar core concepts but lacked standard nomenclature and terminologies, especially as regards interfaces and package naming. To avoid multiple nomenclatures and to enable interoperability between implementations, JDK 9 included basic interfaces as part of the <strong>Flow Concurrency</strong> library. This made applications want to implement Reactive Streams to depend on this library but not include specific implementations into the code base. Thus it is very easy to swap between implementations without any trouble.</p>
<p>These interfaces are coded as static interfaces within the <kbd>java.util.concurrent.Flow</kbd> class.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Important interfaces</h1>
                </header>
            
            <article>
                
<p>Reactive Streams specifications in Java 9 revolve around just four interfaces—<kbd>Publisher</kbd>, <kbd>Subscriber</kbd>, <kbd>Subscription</kbd>, and <kbd>Processor</kbd>. The library also includes a <kbd>Publisher</kbd> implementation—<kbd>SubmissionPublisher</kbd>. All of these are included within the <kbd>java.util.concurrent</kbd> package in the Java standard library. We will touch upon these interfaces in the following subsections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Publisher Interface</h1>
                </header>
            
            <article>
                
<p>The definition of this interface is as follows:</p>
<pre>public interface Publisher&lt;T&gt; {<br/>  public void subscribe(Subscriber&lt;? super T&gt; s);<br/>}</pre>
<p>As you can see, <kbd>Publisher</kbd> allows the <kbd>Subscriber</kbd> interface to subscribe to it so as to receive the message when <kbd>Publisher</kbd> produces it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Subscriber Interface</h1>
                </header>
            
            <article>
                
<p>The definition of this interface is as follows:</p>
<pre>public interface Subscriber&lt;T&gt; {<br/>  public void onSubscribe(Subscription s);<br/>  public void onNext(T t);<br/>  public void onError(Throwable t);<br/>  public void onComplete();<br/>}</pre>
<p>As you can see, the <kbd>Subscriber</kbd> interface's <kbd>onSubscribe</kbd> method allows <kbd>Subscriber</kbd> to be notified when <kbd>Publisher</kbd> accepts the <kbd>Subscription</kbd>. The <kbd>onNext</kbd> method is invoked when new items get published. As the name suggests, the <kbd>onError</kbd> method is invoked when there's an error and the <kbd>onComplete</kbd> method gets invoked when <kbd>Publisher</kbd> has completed its function.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Subscription interface</h1>
                </header>
            
            <article>
                
<p>The definition of this interface is as follows:</p>
<pre>public interface Subscription {<br/>  public void request(long n);<br/>  public void cancel();<br/>}</pre>
<p>The method request is for accepting requests for items and method cancel is for when <kbd>Subscription</kbd> is cancelled.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Processor interface</h1>
                </header>
            
            <article>
                
<p>The definition of this interface is as follows:</p>
<pre>public interface Processor&lt;T, R&gt; extends Subscriber&lt;T&gt;, Publisher&lt;R&gt; {<br/>}</pre>
<p>It inherits from both the <kbd>Publisher</kbd> and <kbd>Subscriber</kbd> interfaces and therefore inherits all the methods of these interfaces. The main aspect is that the <kbd>Publisher</kbd> can produce an item but the <kbd>Subscriber</kbd> can consume a different item than that produced by the <kbd>Publisher</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Framework and reactive applications</h1>
                </header>
            
            <article>
                
<p>Spring Framework adopted reactive in 2013 (the same time reactive was born and became more mainstream) with the release of Version 1.0 of Reactor. This was the time when Spring Framework Version 4.0 was released and Spring got itself engaged with <strong>Pivotal</strong>. In 2016, Spring's 4.3 Version was released with Reactor's Version 3.0. Around this period, the work on Spring's Version 5.0 (major version) was actively under construction.</p>
<p>With new-generation application requirements, many conventional coding practices were challenged. One of the main aspects was to get rid of blocking IO and to find an alternative to conventional imperative programming.</p>
<p>Web applications backed by a Servlet container are inherently blocking, and Spring 5 did a great deal in web application development by introducing a fresh web application framework based on reactive programming: Spring WebFlux.</p>
<p>Spring also has embraced Rx and has used it in many ways within Spring 5. With Spring 5, reactive features are baked into it in many aspects, helping developers to embrace reactive programming easily in a slow-paced manner.</p>
<p>Pivotal is heavily invested in Reactor but has exposed APIs, allowing developers to choose the library of their choice between Reactor and RxJava.</p>
<p>The following diagram depicts Spring 5's reactive programming support:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d655fc0b-14d0-4f74-a358-9d23692d570a.png" style="width:31.42em;height:20.42em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 5: Spring Framework + Reactor + Rx</div>
<p>Reactor is Pivotal's (<strong>SpringSource</strong>) answer to implementing Reactive Streams Specification. As mentioned earlier, Spring is heavily invested in Reactor and this section aims to delve a bit deeper into Reactor.</p>
<p>Reactor is a fourth-generation reactive library for building non-blocking applications on the JVM based on the Reactive Streams Specification.</p>
<p>An overview of the history of <strong>Project Reactor</strong> can be pictorially represented in the following figure:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/dac8af45-ddb4-4573-bf79-0c71571f4115.png" style="width:32.92em;height:7.92em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 6: Project Reactor history</div>
<p>The figure above shows the major releases of Project Reactor. The project kick started in the year 2013 (1.x version) and the major release of 3.x was released in the year 2016. As of writing this book, the core module of the framework is at version 3.1.8.RELEASE.</p>
<p>Now that we have a brief understanding of Spring Framework and its connection with reactive programming, lets dive a bit deep into Project Reactor.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Modules in Reactor</h1>
                </header>
            
            <article>
                
<p>With the latest release of Reactor 3.0 the project has been structured with modularity in mind. Reactor 3.0 consists of four major components namely Core, IO, Addons, and Reactive Streams Commons.</p>
<ul>
<li style="font-weight: 400"><strong>Reactor Core</strong> (<a href="https://github.com/reactor/reactor-core">https://github.com/reactor/reactor-core</a>): The main library within Reactor. It provides foundational, non-blocking JVM-compliant Reactive Streams Specification implementations. It also contains code for Reactor types, such as <kbd>Flux</kbd> and <kbd>Mono</kbd>. </li>
<li style="font-weight: 400"><strong>Reactor IO</strong> (<a href="https://github.com/reactor/reactor-ipc">https://github.com/reactor/reactor-ipc</a>): It contains backpressure-ready components that can be used to encode, decode, send (unicast, multicast, or request/response), and then serve connections. It also contains support for <strong>Kafka</strong> (<a href="https://kafka.apache.org/">https://kafka.apache.org/</a>), <strong>Netty</strong> (<a href="http://netty.io/">http://netty.io/</a>), and <strong>Aeron</strong> (<a href="https://github.com/real-logic/aeron">https://github.com/real-logic/aeron</a>).</li>
<li style="font-weight: 400"><strong>Addons</strong> (<a href="https://github.com/reactor/reactor-addons">https://github.com/reactor/reactor-addons</a>): As the name suggests, these are add-ons that consist of three components:
<ul>
<li style="font-weight: 400"><kbd>reactor-adapter</kbd>: Contains a bridge to RxJava 1 or 2 types, such as Observable, Completable, Single, Maybe, and Mono/Flux back and forth.</li>
<li style="font-weight: 400"><kbd>reactor-logback</kbd>: Supports logback over asynchronous reactor-core processors.</li>
<li style="font-weight: 400"><kbd>reactor-extra</kbd>: Contains more operations for <kbd>Flux</kbd>, which include mathematical operations such as sum and average.</li>
</ul>
</li>
<li style="font-weight: 400"><strong>Reactive Streams Commons </strong>(<a href="https://github.com/reactor/reactive-streams-commons">https://github.com/reactor/reactive-streams-commons</a>): A collaboration experiment project between Spring's Reactor and RxJava. It also contains Reactor-Streams-compliant operators that both projects implement. Issues fixed on one project are also fixed on the other.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive types in Reactor Core</h1>
                </header>
            
            <article>
                
<p>Reactor provided two reactive types, <kbd>Flux</kbd> and <kbd>Mono</kbd>, that implement Rx extensively. They can be represented as a timeline in which elements are sequenced according to how they arrived. It is important that you get the hang of these two types. Let's do that in the following subsections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Flux reative type</h1>
                </header>
            
            <article>
                
<p>A Reactive Streams publisher with Rx operators that emits <em>0</em> to <em>N</em> elements, and then completes (successfully or with an error). For more information, you can check the following link: <a href="https://projectreactor.io">https://projectreactor.io</a></p>
<p><kbd>Flux&lt;T&gt;</kbd> is a <kbd>Publisher&lt;T&gt;</kbd> with basic flow operations and supports <em>0.</em>.<em>n</em> elements.</p>
<p>The definition of <kbd>Flux</kbd> is as follows:</p>
<pre>public abstract class Flux&lt;T&gt;<br/> extends Object<br/> implements Publisher&lt;T&gt;</pre>
<p class="mce-root"/>
<p>The following figure, as depicted in the <kbd>Flux</kbd> documentation, explains the working of <kbd>Flux</kbd> in more detail:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5e2ee3fa-4291-4813-9457-d4404fec9a26.png" style="width:53.25em;height:25.25em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 7: Working of Flux</div>
<p>Flux support is in Spring 5 and a variety of other important modules, including Spring Security. Operators acting on <kbd>Flux</kbd> would create new publishers.</p>
<p><span>Please refer to the Reactor Flux documentation for more information</span>: <a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html">https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html</a>.</p>
<p class="mce-root">Now, let's have a look at some code examples where usage of <kbd>Flux</kbd> is shown:</p>
<ul>
<li style="font-weight: 400">Creating empty <kbd>Flux</kbd>:</li>
</ul>
<pre style="padding-left: 60px">Flux&lt;String&gt; emptyFlux = Flux.empty();</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Flux</kbd> with items in it:</li>
</ul>
<pre style="padding-left: 60px">Flux&lt;String&gt; itemFlux = Flux.just("Spring”, "Security”, "Reactive”);</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Flux</kbd> from an existing list:</li>
</ul>
<pre style="padding-left: 60px">List&lt;String&gt; existingList = Arrays.asList("Spring”, "Security”, "Reactive”);<br/>Flux&lt;String&gt; listFlux = Flux.fromIterable(existingList);</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Flux</kbd> that emits every <kbd>x</kbd> milliseconds in an infinite manner:</li>
</ul>
<pre style="padding-left: 60px">Flux&lt;Long&gt; timer = Flux.interval(Duration.ofMillis(x));</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Flux</kbd> that emits an exception:</li>
</ul>
<pre style="padding-left: 60px">Flux.error(new CreatedException());</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Mono reactive type</h1>
                </header>
            
            <article>
                
<p> </p>
<div class="packt_quote">A Reactive Streams Publisher with basic Rx operators that completes successfully by emitting an element, or with an error.</div>
<div class="packt_quote CDPAlignRight CDPAlign"><span>– Mono JavaDoc</span></div>
<p><kbd>Mono&lt;T&gt;</kbd> is a <kbd>Publisher&lt;T&gt;</kbd> that supports <em>0</em>..<em>1</em> elements.</p>
<p>The definition of <kbd>Mono</kbd> is as follows:</p>
<pre>public abstract class Mono&lt;T&gt;<br/>    extends Object<br/>    implements Publisher&lt;T&gt;</pre>
<p>As detailed in the documentation, the following figure shows the workings of <kbd>Mono</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/fcab5a6e-6e9e-40b6-a689-b0d0abe4ed0a.png" style="width:44.75em;height:22.08em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 08: Working of Mono</div>
<p class="mce-root"/>
<p><kbd>Mono&lt;Void&gt;</kbd> should be used for a <kbd>Publisher</kbd> that completes with no value. The documentation explains each method and how it works using a marble diagram, which is self-explanatory. Again, this type is also supported by Spring 5 and Spring Security.</p>
<p>JavaDoc for <kbd>Mono</kbd> contains more information: <a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html">https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html</a>.</p>
<p class="mce-root">Let's have a look at some examples:</p>
<ul>
<li style="font-weight: 400">Creating empty <kbd>Mono:</kbd></li>
</ul>
<pre style="padding-left: 60px">Mono&lt;String&gt; emptyMono = Mono.empty();</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Mono</kbd> with a value in it:</li>
</ul>
<pre style="padding-left: 60px">Mono&lt;String&gt; itemMono = Mono.just("Spring Security Reactive”);</pre>
<ul>
<li style="font-weight: 400">Creating <kbd>Mono</kbd> that emits an exception:</li>
</ul>
<pre style="padding-left: 60px">Mono.error(new CreatedException());</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data stream types</h1>
                </header>
            
            <article>
                
<p>Broadly, data streams can be categorized into two types:</p>
<ul>
<li style="font-weight: 400"><strong>Cold data streams</strong>: There are a number of names by which this is known, such as <strong>Cold Source</strong>, <strong>Cold Observable</strong>, and <strong>Cold Publisher</strong>. These emit data only when one subscribes to it and because of this, all messages produced from start are delivered to the subscriber. If a new <kbd>Subscriber</kbd> connects to it, the messages are replayed in ascending order and this is same for any new <kbd>Subscriber</kbd>. The <kbd>Subscriber</kbd> also has a provision to dictate the rate at which the <kbd>Publisher</kbd> should emit messages. These data streams are good candidates for applying reactive backpressure (<kbd>request(n)</kbd>), for example, a database cursor or file stream (reading a file).</li>
<li style="font-weight: 400"><strong>Hot data streams</strong>: Again, this has a number of different names, such as <strong>Hot Source</strong>, <strong>Hot Observable</strong>, and <strong>Hot Publisher</strong>. These emit data irrespective of any subscribers connected. When a new <kbd>Subscriber</kbd> connects, it just emits the messages from that point in time and cannot replay messages from the start. These cannot pause message emissions, so an alternate mechanism is required to control flow, such as a buffer. Examples of this stream include mouse events and stock prices.</li>
</ul>
<p class="mce-root"/>
<p>It's important to note that operators on a stream can change their property, going from cold to hot and vice versa. Also, there are times when a merge between hot and cold can happen and their properties change.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactor and RxJava</h1>
                </header>
            
            <article>
                
<p>One of the main aspects between the two is RxJava 2.x which is Java 6+ compatible, but Reactor is Java 8+ compatible. If you are going with Spring 5, I urge you to use a Reactor. If you are comfortable with RxJava 2.x, there is no need to migrate to Reactor. Reactor is an implementation of the Reactive Streams Specification, so you can remain agnostic of what the underlying implementation is.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Web Application</h1>
                </header>
            
            <article>
                
<p>Spring 5 has brought reactive concepts into the world of web application development with the inclusion of a number of important components. Let's cover them here.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring WebFlux</h1>
                </header>
            
            <article>
                
<p>Spring 5 has a reactive stack baked into it, using which, web applications can be built on top of Reactive Streams capable of running on new non-blocking servers, such as Netty, Undertow, and Servlet containers, running on Servlet specifications greater than 3.1.</p>
<p>Existing web application frameworks, such as Spring MVC, are built for Servlet containers from the outset, but Spring 5 brings with it a new web application framework, Spring WebFlux, created with reactive in mind. We have a dedicated chapter in this book covering Spring WebFlux (<a href="df488f9c-24a7-4d0f-ac82-1d126a391fcc.xhtml">Chapter 5</a>, <em>Integrating with Spring WebFlux</em>), so I won't be delving deep into this here. It's good to know that Spring 5 has serious thoughts on reactive and that it is reflected clearly in all these new additions.</p>
<p>Spring WebFlux requires Reactor to be included as one of its core dependencies. But, as always, it does allow you to switch implementations quite easily, if needs be.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reactive Spring Web</h1>
                </header>
            
            <article>
                
<p>The <strong>Spring Web Module</strong> (<a href="https://github.com/spring-projects/spring-framework/tree/master/spring-web">https://github.com/spring-projects/spring-framework/tree/master/spring-web</a>) has many foundational pieces used to build reactive web applications. It allows you to do operations pertaining to the server and the client.</p>
<p class="mce-root"/>
<p>The capabilities that it provides on the server are divided into two areas:</p>
<ul>
<li style="font-weight: 400"><strong>HTTP</strong>: Contained within the <kbd>org.springframework.http</kbd> package in <kbd>spring-web</kbd> and contains various APIs for HTTP request handling for supported servers</li>
<li style="font-weight: 400"><strong>Web</strong>: Contained within the <kbd>org.springframework.web</kbd> package in <kbd>spring-web</kbd> and contains various APIs for request processing</li>
</ul>
<p>This module also contains message codecs that work on the client and aid in encoding and decoding requests and responses. These codecs can also be used on the server.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">WebClient</h1>
                </header>
            
            <article>
                
<p>The interface <kbd>org.springframework.web.reactive.function.client.WebClient</kbd> is a reactive web client introduced in Spring 5 that can be used to perform web requests. Similarly there is <kbd>org.springframework.test.web.reactive.server.WebTestClient</kbd> interface, which is a special <kbd>WebClient</kbd>—used to write unit tests within your application. <kbd>WebClient</kbd> is the reactive version of <kbd>RestTemplate</kbd>, which works over the HTTP/1.1 protocol. They are packaged as part of the <kbd>spring-webflux</kbd> module.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">WebSockets</h1>
                </header>
            
            <article>
                
<p>The <kbd>spring-webflux</kbd> module also has reactive WebSocket implementation. <strong>WebSocket</strong> allows us to establish a two-way connection between the client and server, and usage of this is becoming more mainstream in new-generation applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Application security</h1>
                </header>
            
            <article>
                
<p><strong>Application security</strong> is composed of various processes put in place to find, fix, and prevent security vulnerabilities in an application.</p>
<p>We are living in the world of <strong><span>Development + Operations</span></strong> (<strong><span>DevOps</span></strong>) where we bring engineering and operational staff together. DevOps advocates automation and monitoring at all levels. With security becoming a very important consideration, a new term, <strong>DevSecOps</strong>, is becoming prominent—<span>this is where </span>we bring in security as a first-class citizen.</p>
<p class="mce-root"/>
<p>For an application, security comes under the nonfunctional requirements. Due to its importance in an application, most organizations have dedicated teams that test applications for potential security flaws. It's a very important aspect to be considered, as in this modern world, a security breach can seriously ruin an organization's brand.</p>
<p>Security is a very broad term and encompasses many aspects. In this book, we will look at some of the fundamental security concerns using the Spring Framework module—Spring Security. After covering some of the core security concerns, we will also look at some of the low-level security problems and how Spring Security can help deal with them.</p>
<p>Since we will be focusing on Spring, we will be delving deep into security concerns with respect to a Java web application development.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Security</h1>
                </header>
            
            <article>
                
<div class="packt_quote">Spring Security is a powerful and highly customizable authentication and access-control framework. It is the de facto standard for securing Spring-based applications.</div>
<div class="packt_quote CDPAlignRight CDPAlign">– Spring by Pivotal</div>
<p>Spring Security 5 is the new version of the framework and will be the main focus of this book. Spring Security enables you to take care of authentication and authorization of your application in all aspects. It also has top-level projects to deal specifically with a number of authentication mechanisms, such as <strong>LDAP</strong>, <strong>OAuth</strong>, and <strong>SAML</strong>. Spring Security also gives you enough mechanisms to deal with common security attacks, such as <strong>Session Fixation</strong>, <strong>Clickjacking</strong>, and<span> </span><strong>Cross-Site Request Forgery</strong>. Moreover, it has very good integration with a number of Spring Framework projects, such as Spring MVC, Spring WebFlux, Spring Data, Spring Integration, and Spring Boot.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Security terminologies</h1>
                </header>
            
            <article>
                
<p>It's important to understand some of the most important Spring Security terminologies. Let's look at some of them:</p>
<ul>
<li style="font-weight: 400"><strong>Principal</strong>: Any user, device, or system (application) that would like to interact with your application.</li>
<li style="font-weight: 400"><strong>Authentication</strong>: A process by which your application makes sure that the principal is who they claim to be.</li>
<li style="font-weight: 400"><strong>Credentials</strong>: When a principal tries to interact with your application, the authentication process kicks in and challenges the principal to pass on some values. One such example is a username/password combination and these values are called credentials. The authentication process validates the principal's passed-in credentials against a data store and replies back with the appropriate result.</li>
<li style="font-weight: 400"><strong>Authorization</strong>: After successful authentication, the principal is checked again for actions that it can perform on your application. This process of checking rights for a principal and then granting necessary permissions is called authorization.</li>
<li style="font-weight: 400"><strong>Secured item/resource</strong>: The item or resource that is marked as secured and requires the principal (user) to successfully complete both authentication and authorization.</li>
<li style="font-weight: 400"><strong>GrantedAuthority</strong>: A Spring Security object (<kbd>org.springframework.security.core.GrantedAuthority</kbd> interface<span>) that contains/holds permissions/access-right details of a principal.</span></li>
<li style="font-weight: 400"><strong>SecurityContext</strong>: A Spring Security object that holds a principal's authentication details.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Security's core features</h1>
                </header>
            
            <article>
                
<p>Spring Security provides a number of security features for your application. The two main features for which Spring Security is well-known are it's <strong>support for a variety of authentication</strong> and <strong>authorization methodologies</strong>. In this section, we will delve deeply into these core features in more detail.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Authentication</h1>
                </header>
            
            <article>
                
<p>Spring Security provides a number of approaches by which your application can authenticate. It also allows you to write a custom authentication mechanism if these provided default approaches don't fit your requirements. Because of this extensibility, you can even use the legacy application against which authentication can be done. The book has a dedicated chapters (<a href="69913c59-1186-44b2-8707-dceca721e206.xhtml">Chapter 3</a>, <em>Authentication Using SAML, LDAP, and OAuth/OIDC</em> and <a href="5bccc5ce-c067-46ee-a91c-02ee11dd9fc7.xhtml">Chapter 4</a>, <em>Authentication Using CAS and JAAS</em>) where we will cover various authentications mechanisms, such as OAuth, LDAP, and SAML, in more detail.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Authorization</h1>
                </header>
            
            <article>
                
<p>Spring Security allows you, as an application developer, many choices by which you can authorize user's access to various parts of your application. Here are some of the approaches:</p>
<ul>
<li style="font-weight: 400"><strong>Web URL</strong>: Based on a URL or URL pattern, you can control access</li>
<li style="font-weight: 400"><strong>Method invocation</strong>: Even a method in a Java Bean can be access-controlled if needs be</li>
<li style="font-weight: 400"><strong>Domain instance</strong>: One of the very cool features is to control access to specific data by having access control of certain needed domain objects within your application</li>
<li style="font-weight: 400"><strong>Web service</strong>: Allows you to secure exposed web services in your application</li>
</ul>
<p>In the next chapter, we will get into these aspects in a bit more detail with more code snippets.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Spring Security 5's new features</h1>
                </header>
            
            <article>
                
<p>Spring Security 5 provides a number of new features along with support for Spring 5. Some of the important new features introduced as part of this release are:</p>
<ul>
<li style="font-weight: 400"><strong>Support for OAuth 2.0 and OpenID Connect (OIDC) 1.0</strong>: Allows users to log in to your application using their existing OAuth provider (for example, GitHub) or OIDC provider (for example, Google). OAuth is implemented using Authorization Code Flow. We will delve deep into this in subsequent chapters.</li>
<li style="font-weight: 400"><strong>Reactive support</strong>: Spring 5 introduced a new reactive web application framework—Spring WebFlux. Spring Security made sure that this web application framework is fully supported in all aspects (authentication and authorization) using reactive concepts.</li>
<li style="font-weight: 400"><strong>Improved password encoding</strong>: The introduction of the password-encoding delegation allows usage of more than one algorithm for encoding various passwords. The way Spring identifies the algorithm is by reading the prefix of the encoded password, which contains the algorithm used to encode the password. The format is <kbd>{algorithm}encoded_password</kbd>.</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working of Spring Security</h1>
                </header>
            
            <article>
                
<p>In this section, we will look at how Spring Security works. We will first explain the core concepts and then look at various classes the request goes through to perform security.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Servlet Filter</h1>
                </header>
            
            <article>
                
<p>It's quite important to understand Servlet Filter so you can understand Spring Security internals. The following figure clearly explains a Servlet Filter in action. It comes before the request reaches the actual resource and also before the response if sent back to the consumer. It's a pluggable component that can be introduced at any time with configuration in the web configuration file (<kbd>web.xml</kbd>).</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/88799858-7e56-4fe9-92b4-039eb75ddc96.png" style="width:36.58em;height:15.58em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 9: Working of Servlet Filter</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Filter Chain</h1>
                </header>
            
            <article>
                
<p>You can embed any number of Servlet Filters before they reach the actual resource. The filters are fired according to the order in which they are declared in <kbd>web.xml</kbd>. This chaining of the Servlet Filter is called <strong>Filter Chain</strong>. Spring Security works on a number of Servlet Filters arranged as a Filter Chain, each filter performing a single responsibility, then handing it over to the next one, and so on. Most of the built-in filters are good enough for most applications. If needs be, you can write your own filters and place them wherever you want them to be executed.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Security Interceptor (DelegatingFilterProxy)</h1>
                </header>
            
            <article>
                
<p>When any request reaches an application that is secured using Spring Security, there is a gate the request goes through. This interceptor does all the magic and if things don't look good, it errors out and goes back to the caller, as shown in the following figure:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/023819ce-1ee5-40a6-9366-716cf9c6dcb9.png" style="width:41.67em;height:33.67em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 10: Working of Security Interceptor</div>
<p>The Security Interceptor makes sure that, according to various security configurations set up for your application, it delegates the work to appropriate parties and makes sure that everyone is happy before actually reaching the resource requested by the caller. To do the actual job, the Security Interceptor employs a number of managers, each entrusted to do a single job. The following figure lists some of the important managers the Security Interceptor works with to perform the function:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/be0f39f5-a970-440b-9014-9cc92ce1a762.png" style="width:35.25em;height:15.00em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 11: Security Interceptor and associated managers</div>
<p>In Spring Security, the Security Interceptor is accomplished by <kbd>DelegatingFilterProxy</kbd>. For any request that reaches the web application, this proxy makes sure to delegate the request to Spring Security, and when things go well, it makes sure that the request is taken to the right resource within the web application.</p>
<p><kbd>DelegatingFilterProxy</kbd> is a Servlet Filter that has to be configured in your <kbd>web.xml</kbd> file, which then delegates to a Spring-managed bean (<kbd>@Bean</kbd>) that implements a <kbd>ServletFilter</kbd> interface.</p>
<p>The following code snippet shows how to configure <kbd>DelegatingProxyFilter</kbd> in <kbd>web.xml</kbd>:</p>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/> &lt;web-app&gt;<br/>    &lt;filter&gt;<br/>        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;<br/>        &lt;filter-class&gt;<br/>            org.springframework.web.filter.DelegatingFilterProxy<br/>        &lt;/filter-class&gt;<br/>    &lt;/filter&gt;<br/> <br/>    &lt;filter-mapping&gt;<br/>        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;<br/>        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br/>    &lt;/filter-mapping&gt;<br/> &lt;/web-app&gt;</pre>
<p>In the preceding code, all the requests to the web application (<kbd>/* mapping</kbd>) would go through the <kbd>DelegatingProxyFilter</kbd> filter. It's important to note that the name of this filter should be <kbd>springSecurityFilterChain</kbd> as Spring Security looks for this default filter name to configure itself. The proxy filter just passes/delegates the control to a bean named <kbd>springSecuirtyFilterChain</kbd>. If you are using the default Spring Security setup, the request would then be received by <kbd>FilterChainProxy</kbd>. <kbd>FilterChainProxy</kbd> is responsible for passing the request through the various Servlet Filters configured as part of Spring Security. The <kbd>springSecuirtyFilterChain</kbd> bean need not be explicitly declared, instead, it is taken care of by the framework which is transparent to the developer.</p>
<p>Now that we've looked at all the core concepts of Spring Security, let's come back to the working of Spring Security as pictorially represented in the following diagram. It contains two important security aspects <span>–</span>Authentication and Authorization:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ad01cc0a-91da-4c35-9cf5-dd8cf2722f0a.png" style="width:40.08em;height:22.00em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 12: Working of Spring Security</div>
<p>The request from the caller reaches <kbd>DelegatingFilterProxy</kbd>, which delegates to <kbd>FilterChainProxy</kbd> (Spring Bean), which in turn passes the request through a number of filters, and after successful execution, grants access to the secured resource the caller has asked for.</p>
<p class="mce-root"/>
<p>For the complete list of Servlet Filters and their functions, I urge you to go through the Spring Security reference: <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/security-filter-chain.html">https://docs.spring.io/spring-security/site/docs/current/reference/html/security-filter-chain.html</a>.</p>
<p>With all these details, the following figure sums up how Spring Security takes care of Authentication and Authorization for your web application:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ef2f262d-a6e6-4e88-9131-9f321aa9bf14.png" style="width:54.00em;height:34.25em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 13: Authentication and Authorization in Spring Security using a database</div>
<p>When a caller sends a request to a web application protected by Spring Security, it first goes through the Security Interceptor managers, such as <strong>Authentication Manager</strong> (responsible for authentication) and <strong>Access Decision Manager</strong> (responsible for authorization), and after executing these successfully, gives the caller access to the secured resource.</p>
<p>For reactive applications, these concepts are all valid. There are equivalent reactive classes and the way we code is the only thing that changes. These are easy to understand and implement.</p>
<p class="mce-root"/>
<p>In <a href="e43a2e26-5b28-4d37-a7f8-d3c992a07bc2.xhtml"/><a href="e43a2e26-5b28-4d37-a7f8-d3c992a07bc2.xhtml"/><a href="e43a2e26-5b28-4d37-a7f8-d3c992a07bc2.xhtml">Chapter 2</a>, <em>Deep Diving into Spring Security</em>, we will cover Authentication, and in <a href="69913c59-1186-44b2-8707-dceca721e206.xhtml">Chapter 3</a>, <em>Authentication Using SAML, LDAP, and OAuth/OIDC</em>, we will cover Authorization in detail and delve a bit more deeply into its internals.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Core Spring Security modules</h1>
                </header>
            
            <article>
                
<p>In Spring Framework, Spring Security is a top-level project. Within the Spring Security project (<a href="https://github.com/spring-projects/spring-security">https://github.com/spring-projects/spring-security</a>), there are a number of sub-modules:</p>
<ul>
<li style="font-weight: 400"><strong>Core</strong> (<kbd>spring-security-core</kbd>): Spring security's core classes and interfaces on authentication and access control reside here.</li>
<li style="font-weight: 400"><strong>Remoting</strong> (<kbd>spring-security-remoting</kbd>): In case you need Spring Remoting, this is the module with the necessary classes.</li>
<li style="font-weight: 400"><strong>Aspect</strong> (<kbd>spring-security-aspects</kbd>): <span><strong>Aspect-Oriented Programming</strong> </span>(<strong><span>AOP</span></strong>) support within Spring Security.</li>
<li style="font-weight: 400"><strong>Config</strong> (<kbd>spring-security-config</kbd>): Provides XML and Java configuration support.</li>
<li style="font-weight: 400"><strong>Crypto</strong> (<kbd>spring-security-crypto</kbd>): Contains cryptography support.</li>
<li style="font-weight: 400"><strong>Data</strong> (<kbd>spring-security-data</kbd>): Integration with Spring Data.</li>
<li style="font-weight: 400"><strong>Messaging</strong> (<kbd>spring-security-messaging</kbd>)</li>
<li style="font-weight: 400"><strong>OAuth2</strong>: Support for OAuth 2.x support within Spring Security:
<ul>
<li style="font-weight: 400"><strong>Core</strong> (<kbd>spring-security-oauth2-core</kbd>)</li>
<li style="font-weight: 400"><strong>Client</strong> (<kbd>spring-security-oauth2-client</kbd>)</li>
<li style="font-weight: 400"><strong>JOSE</strong> (<kbd>spring-security-oauth2-jose</kbd>)</li>
</ul>
</li>
<li style="font-weight: 400"><strong>OpenID</strong> (<kbd>spring-security-openid</kbd>): OpenID web-authentication support.</li>
<li style="font-weight: 400"><strong>CAS</strong> (<kbd>spring-security-cas</kbd>): CAS (Central Authentication Service) client integration.</li>
<li style="font-weight: 400"><strong>TagLib</strong> (<kbd>spring-security-taglibs</kbd>): Various tag libraries regarding Spring Security.</li>
<li style="font-weight: 400"><strong>Test</strong> (<kbd>spring-security-test</kbd>): Testing support.</li>
<li style="font-weight: 400"><strong>Web</strong> (<kbd>spring-security-web</kbd>): Contains web security infrastructure code, such as various filters and other Servlet API dependencies.</li>
</ul>
<p>These are the top-level projects within Spring Framework that are strongly linked to Spring Security:</p>
<ul>
<li style="font-weight: 400"><kbd>spring-ldap</kbd>: Simplifying <strong><span>Lightweight Directory Access Protocol</span></strong> (<strong><span>LDAP</span></strong>) programming in Java.</li>
<li style="font-weight: 400"><kbd>spring-security-oauth</kbd>: Easy programming with OAuth 1.x and OAuth 2.x protocols.</li>
<li style="font-weight: 400"><kbd>spring-security-saml</kbd>: Bringing the SAML 2.0 service provider capabilities to Spring applications.</li>
<li style="font-weight: 400"><kbd>spring-security-kerberos</kbd>: Bringing easy integration of Spring application with Kerberos protocol.</li>
</ul>
<p><strong>Security Assertion Markup Language</strong> (<strong>SAML</strong>) is an XML-based framework for ensuring that transmitted communications are secure. SAML defines mechanisms to exchange authentication, authorization, and non-repudiation information, allowing single sign-on capabilities for Web services.</p>
<p>The <strong>Lightweight Directory Access Protocol</strong> (<strong>LDAP</strong>) is a directory service protocol that runs on a layer above the TCP/IP stack. Its based on a client-server model and provides a mechanism used to connect to, search, and modify Internet directories.</p>
<p><strong>Kerberos</strong> is a network authentication protocol. It is designed to provide strong authentication for client/server applications by using secret key cryptography. A free implementation of this protocol is available from MIT and it is also available in many commercial products.</p>
<div class="packt_tip">For more information about SAML, LDAP, and Kerberos, you can check the following links:<br/>
<ul>
<li><a href="https://www.webopedia.com/TERM/S/SAML.html">https://www.webopedia.com/TERM/S/SAML.html</a><a href="https://msdn.microsoft.com/en-us/library/aa367008(v=vs.85).aspx"/></li>
<li><a href="https://msdn.microsoft.com/en-us/library/aa367008(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/aa367008(v=vs.85).aspx</a><a href="https://web.mit.edu/kerberos/"/></li>
<li><a href="https://web.mit.edu/kerberos/">https://web.mit.edu/kerberos/</a></li>
</ul>
</div>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we introduced you to new application requirements and then moved to some of the core reactive concepts. We looked at the Reactive Manifesto and reactive programming. We then moved our attention to Spring 5 and Spring Security 5, and touched on some of the new features in it, especially regarding reactive programming. We then looked briefly at Spring's reactive programming efforts by introducing you to Project Reactor. After that, we explored Spring Security in a bit more detail to refresh your thoughts on this subject. Finally, we closed this chapter by giving you an idea of how examples would be structured in this book and what coding practices we will be using.</p>
<p>You should now have a good grasp on reactive programming, and on Spring Security and how it works. You should also have a clear understanding of how to go through the rest of the chapters, especially the example code.</p>


            </article>

            
        </section>
    </body></html>