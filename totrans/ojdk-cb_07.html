<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Working with WebStart and the Browser Plugin"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Working with WebStart and the Browser Plugin</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Building the IcedTea browser plugin on Linux</li><li class="listitem" style="list-style-type: disc">Using the IcedTea Java WebStart implementation on Linux</li><li class="listitem" style="list-style-type: disc">Preparing the IcedTea Java WebStart implementation for Mac OS X</li><li class="listitem" style="list-style-type: disc">Preparing the IcedTea Java WebStart implementation for Windows</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec51"/>Introduction</h1></div></div></div><p>For a long time, for end users, the Java applets technology was the face of the whole Java world. For a lot of non-developers, the word Java itself is a synonym for the Java browser plugin that allows running Java applets inside web browsers. The<a id="id245" class="indexterm"/> <span class="strong"><strong>Java WebStart</strong></span> technology is similar to the Java browser plugin but runs remotely on loaded Java applications as separate applications outside of web browsers.</p><p>The OpenJDK open source project does not contain the implementations for the browser plugin nor for the WebStart technologies. The Oracle Java distribution, otherwise matching closely to OpenJDK codebases, provided its own closed source implementation for these technologies.</p><p>The IcedTea-Web project<a id="id246" class="indexterm"/> contains free and open source implementations of the browser plugin and WebStart technologies. The IcedTea-Web browser plugin supports only GNU/Linux operating systems and the WebStart implementation is cross-platform.</p><p>While the IcedTea implementation of WebStart is well-tested and production-ready, it has numerous incompatibilities with the Oracle WebStart implementation. These differences can be seen as corner cases; some of them are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Different behavior when</strong></span><span class="strong"><strong> parsing not well-formed JNLP descriptor files</strong></span>: The Oracle implementation is generally more lenient for malformed descriptors.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Differences in JAR (re)downloading and caching behavior</strong></span>: The Oracle implementation uses caching more aggressively.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Differences in sound support</strong></span>: This is due to differences in sound support between Oracle Java and IcedTea on Linux. Linux historically has multiple different sound providers (ALSA, PulseAudio, and so on) and IcedTea has more wide support for different providers, which can lead to sound misconfiguration.</li></ul></div><p>The <a id="id247" class="indexterm"/>IcedTea-Web browser plugin (as it is built on WebStart) has these incompatibilities too. On top of them, it can have more incompatibilities in relation to browser integration. User interface forms and general browser-related operations such as access from/to JavaScript code should work fine with both implementations. But historically, the browser plugin was widely used for security-critical applications like online bank clients. Such applications usually require security facilities from browsers, such as access to certificate stores or hardware crypto-devices that can differ from browser to browser, depending on the OS (for example, supports only Windows), browser version, Java version, and so on. Because of that, many real-world applications can have problems running the IcedTea-Web browser plugin on Linux.</p><p>Both WebStart and the browser plugin are built on the idea of downloading (possibly untrusted) code from remote locations, and proper privilege checking and sandboxed execution of that code is a notoriously complex task. Usually reported security issues in the Oracle browser plugin (most widely known are issues during the year 2012) are also fixed separately in IcedTea-Web.</p></div></div>
<div class="section" title="Building the IcedTea browser plugin on Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec52"/>Building the IcedTea browser plugin on Linux</h1></div></div></div><p>The<a id="id248" class="indexterm"/> IcedTea-Web project is not inherently cross-platform; it is developed on Linux and for Linux, and so it can be built quite easily on <a id="id249" class="indexterm"/>popular Linux distributions. The two main parts of it (stored in corresponding directories in the source code repository) are <code class="literal">netx</code> and <code class="literal">plugin</code>.</p><p>NetX<a id="id250" class="indexterm"/> is a pure Java implementation of the WebStart technology. We will look at it more thoroughly in the following recipes of this chapter.</p><p>Plugin is an implementation of the browser plugin using the <code class="literal">NPAPI</code> plugin architecture that is supported by multiple browsers. Plugin is written partly in Java and partly in native code (C++), and it officially supports only Linux-based operating systems. There exists an opinion about <code class="literal">NPAPI</code> that this architecture is dated, overcomplicated, and insecure, and that modern web browsers have enough built-in capabilities to not require external plugins. And browsers have gradually reduced support for <code class="literal">NPAPI</code>. Despite that, at the time of writing this book, the IcedTea-Web browser plugin worked on all major Linux browsers (Firefox and derivatives, Chromium and derivatives, and Konqueror).</p><p>We will build the IcedTea-Web browser plugin from sources using Ubuntu 12.04 LTS amd64.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec174"/>Getting ready</h2></div></div></div><p>For this recipe, we <a id="id251" class="indexterm"/>will need a clean Ubuntu 12.04 running with the Firefox web browser installed.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec175"/>How to do it...</h2></div></div></div><p>The following procedure will help you to build the IcedTea-Web browser plugin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install prepackaged binaries of OpenJDK 7:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-7-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-7</strong></span>
</pre></div></li><li class="listitem">Install the specific dependency for the browser plugin:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install firefox-dev</strong></span>
</pre></div></li><li class="listitem">Download<a id="id252" class="indexterm"/> and decompress the IcedTea-Web source code tarball:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wget http://icedtea.wildebeest.org/download/source/icedtea-web-1.4.2.tar.gz</strong></span>
<span class="strong"><strong>tar xzvf icedtea-web-1.4.2.tar.gz</strong></span>
</pre></div></li><li class="listitem">Run the <code class="literal">configure</code> script to set up the build environment:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure</strong></span>
</pre></div></li><li class="listitem">Run the build process:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Install the newly built plugin into the <code class="literal">/usr/local</code> directory:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo make install</strong></span>
</pre></div></li><li class="listitem">Configure the Firefox web browser to use the newly built plugin library:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mkdir ~/.mozilla/plugins</strong></span>
<span class="strong"><strong>cd ~/.mozilla/plugins</strong></span>
<span class="strong"><strong>ln -s /usr/local/IcedTeaPlugin.so libjavaplugin.so</strong></span>
</pre></div></li><li class="listitem">Check whether the IcedTea-Web plugin has appeared under <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Add-ons</strong></span> | <span class="strong"><strong>Plugins</strong></span>.</li><li class="listitem">Open the <a class="ulink" href="http://java.com/en/download/installed.jsp">http://java.com/en/download/installed.jsp</a> web page to verify that the browser plugin works.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec176"/>How it works...</h2></div></div></div><p>The<a id="id253" class="indexterm"/> IcedTea browser plugin requires the IcedTea Java implementation to be compiled successfully. The prepackaged OpenJDK 7 binaries in Ubuntu 12.04 are based on IcedTea, so we installed them first. The plugin uses the GNU Autconf build system that is common between free software tools. The <code class="literal">xulrunner-dev</code> package is required to access the <code class="literal">NPAPI</code> headers.</p><p>The built plugin may <a id="id254" class="indexterm"/>be installed into Firefox for the current user only without requiring administrator privileges. For that, we created a symbolic link to our plugin in the place where Firefox expects to find the <code class="literal">libjavaplugin.so</code> plugin library.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec177"/>There's more...</h2></div></div></div><p>The plugin can also be installed into other browsers with <code class="literal">NPAPI</code> support, but installation instructions can be different for different browsers and different Linux distributions.</p><p>As the <code class="literal">NPAPI</code> architecture does not depend on the operating system, in theory, a plugin can be built for non-Linux operating systems. But currently, no such ports are planned.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec178"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Using the IcedTea Java WebStart implementation on Linux</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Preparing the IcedTea Java WebStart implementation for Mac OS X</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Preparing the IcedTea Java WebStart implementation for Windows</em></span> recipe</li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch05.html" title="Chapter 5. Building IcedTea">Chapter 5</a>, <span class="emphasis"><em>Building IcedTea</em></span></li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">The IcedTea-Web project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/IcedTea-Web">http://icedtea.classpath.org/wiki/IcedTea-Web</a></li><li class="listitem" style="list-style-type: disc">The NetX project website at <a class="ulink" href="http://jnlp.sourceforge.net/netx/">http://jnlp.sourceforge.net/netx/</a></li><li class="listitem" style="list-style-type: disc">The Java WebStart developers guide at <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/">http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/</a></li><li class="listitem" style="list-style-type: disc">The NPAPI project site at <a class="ulink" href="https://wiki.mozilla.org/NPAPI">https://wiki.mozilla.org/NPAPI</a></li><li class="listitem" style="list-style-type: disc">Details on NPAPI support in different browsers at <a class="ulink" href="http://www.firebreath.org/display/documentation/Browser+Plugins+in+a+post-NPAPI+world">http://www.firebreath.org/display/documentation/Browser+Plugins+in+a+post-NPAPI+world</a></li></ul></div></div></div>
<div class="section" title="Using the IcedTea Java WebStart implementation on Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec53"/>Using the IcedTea Java WebStart implementation on Linux</h1></div></div></div><p>On the<a id="id255" class="indexterm"/> Java platform, the JVM needs to perform the class load process for each class it wants to use. This process is opaque for the JVM and <a id="id256" class="indexterm"/>actual bytecode for loaded classes may come from one of many sources. For example, this method allows the Java Applet classes to be loaded from a remote server to the Java process inside the web browser. Remote class loading also may be used to run remotely loaded Java applications in standalone mode without integration with the web browser. This technique is called Java WebStart and was developed under <span class="strong"><strong>Java Specification Request</strong></span> (<span class="strong"><strong>JSR</strong></span>)<a id="id257" class="indexterm"/> number 56.</p><p>To run the Java application remotely, WebStart requires an application descriptor file that should be written using the <a id="id258" class="indexterm"/>
<span class="strong"><strong>Java Network Launching Protocol</strong></span> (<span class="strong"><strong>JNLP</strong></span>) syntax. This file is used to define the remote server to load the application form along with some metainformation. The WebStart application may be launched from the web page by clicking on the JNLP link, or without the web browser using the JNLP file obtained beforehand. In either case, running the application is completely separate from the web browser, but uses a sandboxed security model similar to Java Applets.</p><p>The OpenJDK project does not contain the WebStart implementation; the Oracle Java distribution provides its own closed-source WebStart implementation. The open source WebStart implementation exists as part of the IcedTea-Web project. It was initially based on the <a id="id259" class="indexterm"/>
<span class="strong"><strong>NETwork eXecute</strong></span> (<span class="strong"><strong>NetX</strong></span>) project. Contrary to the Applet technology, WebStart does not require any web browser integration. This allowed developers to implement the NetX module using pure Java without native code. For integration with Linux-based operating systems, IcedTea-Web implements the <code class="literal">javaws</code> command as shell script that launches the <code class="literal">netx.jar</code> file with proper arguments.</p><p>In this recipe, we will build the<a id="id260" class="indexterm"/> NetX module from the official IcedTea-Web source tarball.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec179"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a clean Ubuntu 12.04 running with the Firefox web browser installed.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec180"/>How to do it...</h2></div></div></div><p>The following procedure will help you to build a NetX module:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install prepackaged binaries of OpenJDK 7:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install openjdk-7-jdk</strong></span>
</pre></div></li><li class="listitem">Install the GCC toolchain and build dependencies:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get build-dep openjdk-7</strong></span>
</pre></div></li><li class="listitem">Download and decompress the IcedTea-Web source code tarball:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wget http://icedtea.wildebeest.org/download/source/icedtea-web-1.4.2.tar.gz</strong></span>
<span class="strong"><strong>tar xzvf icedtea-web-1.4.2.tar.gz</strong></span>
</pre></div></li><li class="listitem">Run the <code class="literal">configure</code> script to set up a build environment excluding the browser plugin from the build:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./configure –disable-plugin</strong></span>
</pre></div></li><li class="listitem">Run the build process:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>make</strong></span>
</pre></div></li><li class="listitem">Install the <a id="id261" class="indexterm"/>newly-built plugin into the <code class="literal">/usr/local</code> directory:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo make install</strong></span>
</pre></div></li><li class="listitem">Run the WebStart application example from the Java tutorial:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>javaws http://docs.oracle.com/javase/tutorialJWS/samples/</strong></span>
<span class="strong"><strong>deployment/dynamictree_webstartJWSProject/dynamictree_webstart.jnlp</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec181"/>How it works...</h2></div></div></div><p>The <code class="literal">javaws</code> shell script<a id="id262" class="indexterm"/> is installed into the <code class="literal">/usr/local/*</code> directory. When launched with a path or a link to the JNLP file, <code class="literal">javaws</code> launches the <code class="literal">netx.jar</code> file, adding it to the boot classpath (for security reasons) and providing the JNLP link as an argument.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec182"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Preparing the IcedTea Java WebStart implementation for Mac OS X</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Preparing the IcedTea Java WebStart implementation for Windows</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building the IcedTea browser plugin on Linux</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Working with GNU Autoconf</em></span> recipe from <a class="link" href="ch04.html" title="Chapter 4. Building OpenJDK 8">Chapter 4</a>, <span class="emphasis"><em>Building OpenJDK 8</em></span></li><li class="listitem" style="list-style-type: disc">The IcedTea-Web project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/IcedTea-Web">http://icedtea.classpath.org/wiki/IcedTea-Web</a></li><li class="listitem" style="list-style-type: disc">The NetX project website at <a class="ulink" href="http://jnlp.sourceforge.net/netx/">http://jnlp.sourceforge.net/netx/</a></li><li class="listitem" style="list-style-type: disc">The Java WebStart developers guide at <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/">http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/</a></li></ul></div></div></div>
<div class="section" title="Preparing the IcedTea Java WebStart implementation for Mac OS X"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec54"/>Preparing the IcedTea Java WebStart implementation for Mac OS X</h1></div></div></div><p>The NetX WebStart <a id="id263" class="indexterm"/>implementation from the IcedTea-Web project is written in pure Java, so it can also be used on Mac OS X. IcedTea-Web provides the <code class="literal">javaws</code> launcher implementation only for Linux-based operating systems. In <a id="id264" class="indexterm"/>this recipe, we will create a simple implementation of the WebStart launcher script for Mac OS X.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec183"/>Getting ready</h2></div></div></div><p>For this recipe, we will need Mac OS X Lion with Java 7 (the prebuilt OpenJDK or Oracle one) installed. We will also need the <code class="literal">netx.jar</code> module from the IcedTea-Web project, which can be built using instructions from the previous recipe.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec184"/>How to do it...</h2></div></div></div><p>The following procedure will help you to run WebStart applications on Mac OS X:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the JNLP descriptor example from the Java tutorials at <a class="ulink" href="http://docs.oracle.com/javase/tutorialJWS/samples/deployment/dynamictree_webstartJWSProject/dynamictree_webstart.jnlp">http://docs.oracle.com/javase/tutorialJWS/samples/deployment/dynamictree_webstartJWSProject/dynamictree_webstart.jnlp</a>.</li><li class="listitem">Test that this application can be run from the terminal using <code class="literal">netx.jar</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>java -Xbootclasspath/a:netx.jar net.sourceforge.jnlp.runtime.Boot dynamictree_webstart.jnlp</strong></span>
</pre></div></li><li class="listitem">Create the <code class="literal">wslauncher.sh</code> bash script with the following contents:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>#!/bin/bash</strong></span>
<span class="strong"><strong>if [ "x$JAVA_HOME" = "x" ] ; then</strong></span>
<span class="strong"><strong>    JAVA="$( which java 2&gt;/dev/null )"</strong></span>
<span class="strong"><strong>else</strong></span>
<span class="strong"><strong>    JAVA="$JAVA_HOME"/bin/java</strong></span>
<span class="strong"><strong>fi</strong></span>
<span class="strong"><strong>if [ "x$JAVA" = "x" ] ; then</strong></span>
<span class="strong"><strong>    echo "Java executable not found"</strong></span>
<span class="strong"><strong>    exit 1</strong></span>
<span class="strong"><strong>fi</strong></span>
<span class="strong"><strong>if [ "x$1" = "x" ] ; then</strong></span>
<span class="strong"><strong>    echo "Please provide JNLP file as first argument"</strong></span>
<span class="strong"><strong>    exit 1</strong></span>
<span class="strong"><strong>fi</strong></span>
<span class="strong"><strong>$JAVA -Xbootclasspath/a:netx.jar net.sourceforge.jnlp.runtime.Boot $1</strong></span>
</pre></div></li><li class="listitem">Mark the launcher script as executable:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>chmod 755 wslauncher.sh</strong></span>
</pre></div></li><li class="listitem">Run the application using the launcher script:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./wslauncher.sh dynamictree_webstart.jnlp</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec185"/>How it works...</h2></div></div></div><p>The <a id="id265" class="indexterm"/>
<code class="literal">next.jar</code> file <a id="id266" class="indexterm"/>contains a Java application that can read JNLP files and download and run classes described in JNLP. But for security reasons, <code class="literal">next.jar</code> cannot be launched directly as an application (using the <code class="literal">java -jar netx.jar</code> syntax). Instead, <code class="literal">netx.jar</code> is added to the privileged boot<a id="id267" class="indexterm"/> classpath and is run specifying the main class directly. This allows us to download applications in sandbox mode.</p><p>The <code class="literal">wslauncher.sh</code> script<a id="id268" class="indexterm"/> tries to find the Java executable file using the <code class="literal">PATH</code> and <code class="literal">JAVA_HOME</code> environment variables and then launches specified JNLP through <code class="literal">netx.jar</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec186"/>There's more...</h2></div></div></div><p>The <code class="literal">wslauncher.sh</code> script provides a basic solution to run WebStart applications from the terminal. To integrate <code class="literal">netx.jar</code> into your operating system environment properly (to be able to launch WebStart apps using JNLP links from the web browser), a native launcher or custom platform scripting solution may be used. Such solutions lay down the scope of this book.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec187"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Using the IcedTea Java WebStart implementation on Linux</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building OpenJDK 7 on Mac OS X</em></span> recipe from <a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span></li><li class="listitem" style="list-style-type: disc">The IcedTea-Web project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/IcedTea-Web">http://icedtea.classpath.org/wiki/IcedTea-Web</a></li><li class="listitem" style="list-style-type: disc">The NetX project website at <a class="ulink" href="http://jnlp.sourceforge.net/netx/">http://jnlp.sourceforge.net/netx/</a></li><li class="listitem" style="list-style-type: disc">The Java WebStart developers guide at <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/">http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/</a></li><li class="listitem" style="list-style-type: disc">Apple Inc. support article about enabling WebStart on Apple Java at <a class="ulink" href="http://support.apple.com/kb/HT5559">http://support.apple.com/kb/HT5559</a></li></ul></div></div></div>
<div class="section" title="Preparing the IcedTea Java WebStart implementation for Windows"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec55"/>Preparing the IcedTea Java WebStart implementation for Windows</h1></div></div></div><p>The<a id="id269" class="indexterm"/> NetX WebStart implementation from the IcedTea-Web project is written in pure Java, so it can also be used on<a id="id270" class="indexterm"/> Windows; we also used it on Linux and Mac OS X in previous recipes in this chapter. In this recipe, we will create a simple implementation of the WebStart launcher script for Windows.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec188"/>Getting ready</h2></div></div></div><p>For this recipe, we will need a version of Windows running with Java 7 (the prebuilt OpenJDK or Oracle one) installed. We will also need the <code class="literal">netx.jar</code> module from the IcedTea-Web project, which can be built using instructions from the previous recipe in this chapter.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec189"/>How to do it...</h2></div></div></div><p>The following procedure will help you to run WebStart applications on Windows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the JNLP descriptor example from the Java tutorials:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>http://docs.oracle.com/javase/tutorialJWS/samples/deployment/dynamictree_webstartJWSProject/dynamictree_webstart.jnlp</strong></span>
</pre></div></li><li class="listitem">Test that this application can be run from the Command Prompt using <code class="literal">netx.jar</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>java -Xbootclasspath/a:netx.jar net.sourceforge.jnlp.runtime.Boot dynamictree_webstart.jnlp</strong></span>
</pre></div></li><li class="listitem">Create a batch file, <code class="literal">wslauncher.bat</code>, with the following contents:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>@echo off</strong></span>
<span class="strong"><strong>if "%JAVA_HOME%" == "" goto noJavaHome</strong></span>
<span class="strong"><strong>if not exist "%JAVA_HOME%\bin\javaw.exe" goto noJavaHome</strong></span>
<span class="strong"><strong>set "JAVA=%JAVA_HOME%\bin\javaw.exe"</strong></span>
<span class="strong"><strong>if "%1" == "" goto noJnlp</strong></span>
<span class="strong"><strong>start %JAVA% -Xbootclasspath/a:netx.jar net.sourceforge.jnlp.runtime.Boot %1</strong></span>
<span class="strong"><strong>exit /b 0</strong></span>
<span class="strong"><strong>:noJavaHome</strong></span>
<span class="strong"><strong>echo The JAVA_HOME environment variable is not defined correctly</strong></span>
<span class="strong"><strong>exit /b 1</strong></span>
<span class="strong"><strong>:noJnlp</strong></span>
<span class="strong"><strong>echo Please provide JNLP file as first argument</strong></span>
<span class="strong"><strong>exit /b 1</strong></span>
</pre></div></li><li class="listitem">Run the application using the launcher script:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wslauncher.bat dynamictree_webstart.jnlp</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec190"/>How it works...</h2></div></div></div><p>The <code class="literal">netx.jar</code> module <a id="id271" class="indexterm"/>must be added to the boot classpath as it cannot be run directly because of security reasons.</p><p>The <code class="literal">wslauncher.bat</code> script tries to find the Java executable using the <code class="literal">JAVA_HOME</code> environment variable and then launches specified JNLP through <code class="literal">netx.jar</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec191"/>There's more...</h2></div></div></div><p>The <code class="literal">wslauncher.bat</code> script<a id="id272" class="indexterm"/> may be registered as a default application to run the JNLP files. This will allow you to run WebStart applications from the web browser. But the current script will show the batch window for a short period of time before launching the application. It also does not support looking for Java executables in the Windows Registry. A more advanced script without those problems may be written using Visual Basic script (or any other native scripting solution) or as a native executable launcher. Such solutions lay down the scope of this book.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec192"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Preparing the IcedTea Java WebStart implementation for Mac OS X</em></span> recipe</li><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Building 64-bit OpenJDK 7 on Windows 7 x64 SP1</em></span> recipe from <a class="link" href="ch03.html" title="Chapter 3. Building OpenJDK 7">Chapter 3</a>, <span class="emphasis"><em>Building OpenJDK 7</em></span></li><li class="listitem" style="list-style-type: disc">The IcedTea-Web project website at <a class="ulink" href="http://icedtea.classpath.org/wiki/IcedTea-Web">http://icedtea.classpath.org/wiki/IcedTea-Web</a></li><li class="listitem" style="list-style-type: disc">The NetX project website at <a class="ulink" href="http://jnlp.sourceforge.net/netx/">http://jnlp.sourceforge.net/netx/</a></li><li class="listitem" style="list-style-type: disc">The Java WebStart developers guide at <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/">http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/</a></li><li class="listitem" style="list-style-type: disc">Articles on ActiveX technology from Microsoft that is similar to NPAPI at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/aa751968%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/aa751968%28v=vs.85%29.aspx</a></li></ul></div></div></div></body></html>