<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">The PageObject Pattern</h1>
                </header>
            
            <article>
                
<p>So far, we have seen various APIs of WebDriver and learned how to use them to accomplish various actions on the web application we have been testing. We created a number of tests that use these APIs and are executed continuously to validate the application. However, as your test suite grows, the complexity of your tests and code will also grow. This becomes a challenge, with respect to the maintainability of your scripts and code. You will need to design a maintainable, modular, and reusable test code that will scale as you add more test coverage. In this chapter, we will explore the PageObject pattern to build a highly maintainable test suite. We will cover the following topics:</p>
<ul>
<li>What is the PageObject pattern design?</li>
<li>Good practices for designing PageObjects</li>
<li>Extensions to the PageObject pattern</li>
<li>An end-to-end example</li>
</ul>
<p>A decently written test script would work just fine, as long as the target web application doesn't change. But once one or more pages in your web application change, as a test-script developer, you shouldn't be in a position where you have to refactor your test scripts in a hundred different places. Let's understand this statement better with the help of an example. We will try to go through this chapter by working on a WordPress blog. Before we start, I would like you to create a WordPress blog (<a href="http://wordpress.com/about">http://wordpress.com/about</a>) or use one of your existing ones.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating test cases for our WordPress blog</h1>
                </header>
            
            <article>
                
<p>Here, we are using a WordPress blog: <a href="http://demo-blog.seleniumacademy.com/wp/">http://demo-blog.seleniumacademy.com/wp/</a>. Let's create three test cases for it before we start talking about the PageObject pattern.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Test case 1 – adding a new post to our WordPress blog</h1>
                </header>
            
            <article>
                
<p>The following test script will log into the <kbd>Admin</kbd> portal of our WordPress blog and add a new blog post:</p>
<pre><span>@Test<br/></span><span>public void </span><span>testAddNewPost</span>() {<br/>    WebElement email = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_login"</span>))<span>;<br/></span><span>    </span>WebElement pwd = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_pass"</span>))<span>;<br/></span><span>    </span>WebElement submit = <span>driver</span>.findElement(By.<span>id</span>(<span>"wp-submit"</span>))<span>;<br/></span><span>    </span>email.sendKeys(<span>"admin"</span>)<span>;<br/></span><span>    </span>pwd.sendKeys(<span>"$$SUU3$$N#"</span>)<span>;<br/></span><span>    </span>submit.click()<span>;<br/></span><span><br/></span><span>   </span><span> </span><span>// Go to AllPosts page<br/></span><span> </span><span>driver</span>.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span><br/></span><span> </span><span>// Add New Post<br/></span><span> </span>WebElement addNewPost = <span>driver</span>.findElement(By.<span>linkText</span>(<span>"Add New"</span>))<span>;<br/></span><span> </span>addNewPost.click()<span>;</span><span><br/></span><span><br/></span><span>    </span><span>// Add New Post's Content<br/></span><span>    </span>WebElement title = <span>driver</span>.findElement(By.<span>id</span>(<span>"title"</span>))<span>;<br/></span><span>    </span>title.click()<span>;<br/></span><span>    </span>title.sendKeys(<span>"My First Post"</span>)<span>;<br/></span><span><br/></span><span>    </span><span>driver</span>.switchTo().frame(<span>"content_ifr"</span>)<span>;<br/></span><span>    </span>WebElement postBody = <span>driver</span>.findElement(By.<span>id</span>(<span>"tinymce"</span>))<span>;<br/></span><span>    </span>postBody.sendKeys(<span>"This is description"</span>)<span>;<br/></span><span>    </span><span>driver</span>.switchTo().defaultContent()<span>;<br/></span><span><br/></span><span>    </span><span>// Publish the Post<br/></span><span>    </span>WebElement publish = <span>driver</span>.findElement(By.<span>id</span>(<span>"publish"</span>))<span>;<br/></span><span>    </span>publish.click()<span>;<br/></span>}</pre>
<p>The following is the sequence of steps that the preceding code performs:</p>
<ol>
<li>Log into the WordPress <kbd>Admin</kbd> portal.</li>
<li>Go to the <span class="packt_screen">All Posts</span> page.</li>
<li>Click on the <span class="packt_screen">Add New</span> post button.</li>
<li>Add a new post by providing the title and description.</li>
<li>Publish the post.</li>
</ol>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Test case 2 – deleting a post from our WordPress blog</h1>
                </header>
            
            <article>
                
<p>The following test script will log into our WordPress blog and delete an existing post:</p>
<pre><span>@Test<br/></span><span>public void </span><span>testDeleteAPost</span>() {<br/>    WebElement email = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_login"</span>))<span>;<br/></span><span>    </span>WebElement pwd = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_pass"</span>))<span>;<br/></span><span>    </span>WebElement submit = <span>driver</span>.findElement(By.<span>id</span>(<span>"wp-submit"</span>))<span>;<br/></span><span>    </span>email.sendKeys(<span>"admin"</span>)<span>;<br/></span><span>    </span>pwd.sendKeys(<span>"$$SUU3$$N#"</span>)<span>;<br/></span><span>    </span>submit.click()<span>;<br/></span><span><br/></span><span>    </span><span>// Go to AllPosts page<br/></span><span>    </span><span>driver</span>.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span><br/></span><span>    </span><span>// Click on the post to be deleted<br/></span><span>    </span>WebElement post = <span>driver</span>.findElement(By.<span>linkText</span>(<span>"My First Post"</span>))<span>;<br/></span><span>    </span>post.click()<span>;<br/></span><span><br/></span><span>    </span><span>// Delete Post<br/></span><span>    </span>WebElement publish = <span>driver</span>.findElement(By.<span>linkText</span>(<span>"Move to Trash"</span>))<span>;<br/></span><span>    </span>publish.click()<span>;<br/></span>}</pre>
<p>The following is the sequence of steps that the preceding test script follows to delete a post:</p>
<ol>
<li>Log into the WordPress <kbd>Admin</kbd> portal.</li>
<li>Go to the <span class="packt_screen">All Posts</span> page.</li>
<li>Click on the post to be deleted.</li>
<li>Delete the post.</li>
</ol>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Test case 3 – counting the number of posts on our WordPress blog</h1>
                </header>
            
            <article>
                
<p>The following test script will count all the posts currently available on our WordPress blog:</p>
<pre><span>@Test<br/></span><span>public void </span><span>testPostCount</span>() {<br/>    WebElement email = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_login"</span>))<span>;<br/></span><span>    </span>WebElement pwd = <span>driver</span>.findElement(By.<span>id</span>(<span>"user_pass"</span>))<span>;<br/></span><span>    </span>WebElement submit = <span>driver</span>.findElement(By.<span>id</span>(<span>"wp-submit"</span>))<span>;<br/></span><span>    </span>email.sendKeys(<span>"admin"</span>)<span>;<br/></span><span>    </span>pwd.sendKeys(<span>"$$SUU3$$N#"</span>)<span>;<br/></span><span>    </span>submit.click()<span>;<br/></span><span><br/></span><span>    </span><span>// Count the number of posts<br/></span><span>    </span><span>driver</span>.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>WebElement postsContainer = <span>driver</span>.findElement(By.<span>id</span>(<span>"the-list"</span>))<span>;<br/></span><span>    </span>List postsList = postsContainer.findElements(By.<br/>            <span>tagName</span>(<span>"tr"</span>))<span>;<br/></span><span><br/></span><span>    </span>Assert.<span>assertEquals</span>(postsList.size()<span>, </span><span>1</span>)<span>;<br/></span>}</pre>
<p>The following is the sequence of steps that the preceding test script follows to count the number of posts currently available on our blog:</p>
<ol>
<li>Log into the <kbd>Admin</kbd> portal.</li>
<li>Go to the <span class="packt_screen">All Posts</span> page.</li>
<li>Count the number of posts available.</li>
</ol>
<p>In the previous three test scripts, we log into WordPress and perform an action, such as creating a post, deleting a post, or counting the number of existing posts. Imagine that the ID of an element on the login page has changed, and we have to modify that in all three different test cases; or, if the <span class="packt_screen">All Posts</span> page has changed, that we have to edit all three test cases to reflect the new changes. If you have 50 test cases, changing each of them every time there is a change in the target application is very difficult. For this purpose, you need to design a test framework that keeps the changes that you need to make in the test cases to a minimum. The PageObject pattern is a design pattern that can be used to design your test framework.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">What is the PageObject pattern?</h1>
                </header>
            
            <article>
                
<p>Whenever we are designing an automation framework for testing web applications, we have to accept the fact that the target application and its elements are bound to change. An efficient framework is one that needs minimal refactoring to adapt to new changes in the target application. Let's try to build the preceding test scenarios into the PageObject design pattern model. Let's first start building a PageObject for the login page. This should look like the following:</p>
<pre><span>public class </span>AdminLoginPage {<br/>    <br/>    WebDriver <span>driver</span><span>;<br/></span><strong><span>    </span>WebElement <span>email</span><span>;<br/></span><span>    </span>WebElement <span>password</span><span>;<br/></span><span>    </span>WebElement <span>submit</span><span>;<br/></span></strong><span><br/></span><span>    public </span><span>AdminLoginPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin"</span>)<span>;<br/></span><span>        </span><span>email </span>= driver.findElement(By.<span>id</span>(<span>"user_login"</span>))<span>;<br/></span><span>        </span><span>password </span>= driver.findElement(By.<span>id</span>(<span>"user_pass"</span>))<span>;<br/></span><span>        </span><span>submit </span>= driver.findElement(By.<span>id</span>(<span>"wp-submit"</span>))<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>login</span>() {<br/>        <span>email</span>.sendKeys(<span>"admin"</span>)<span>;<br/></span><span>        </span><span>password</span>.sendKeys(<span>"$$SUU3$$N#"</span>)<span>;<br/></span><span>        </span><span>submit</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>So, all the elements that are part of the process of signing in are listed in the <kbd>AdminLoginPage</kbd> class and there is a method named <kbd>login()</kbd>, which manages the populating of these elements and submits the login form. Thus, this <kbd>AdminLoginPageobject</kbd> class, will represent WordPress's administration login page, constituting all the elements that are listed on the page as member variables and all the actions that can be taken on the page as methods. Now, let's see how we need to refactor the test case to use our newly created PageObject. Let's consider the following <kbd>testAddNewPost</kbd> test case:</p>
<pre><span>@Test<br/></span><span>public void </span><span>testAddNewPost</span>() {<br/>    <br/>    <strong>AdminLoginPage admLoginPage = <span>new </span>AdminLoginPage(<span>driver</span>)<span>;<br/></span><span>    </span>admLoginPage.login()</strong><span><strong>;</strong><br/></span><span>    <br/></span><span>    </span><span>// Go to New Posts page<br/></span><span>    </span><span>driver</span>.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>WebElement addNewPost = <span>driver</span>.findElement(By.<span>linkText</span>(<span>"Add New"</span>))<span>;<br/></span><span>            </span>addNewPost.click()<span>;<br/></span><span>    </span><span>// Add New Post<br/></span><span>    </span><span>driver</span>.switchTo().frame(<span>"content_ifr"</span>)<span>;<br/></span><span>    </span>WebElement postBody = <span>driver</span>.findElement(By.<span>id</span>(<span>"tinymce"</span>))<span>;<br/></span><span>    </span>postBody.sendKeys(<span>"This is description"</span>)<span>;<br/></span><span>    </span><span>driver</span>.switchTo().defaultContent()<span>;<br/></span><span>    </span>WebElement title = <span>driver</span>.findElement(By.<span>id</span>(<span>"title"</span>))<span>;<br/></span><span>    </span>title.click()<span>;<br/></span><span>    </span>title.sendKeys(<span>"My First Post"</span>)<span>;<br/></span><span>    </span>WebElement publish = <span>driver</span>.findElement(By.<span>id</span>(<span>"publish"</span>))<span>;<br/></span><span>    </span>publish.click()<span>;<br/></span>}</pre>
<p>In the preceding test case, the entire code for logging into the admin page is contained in just two lines:</p>
<pre><strong>AdminLoginPage admLoginPage = <span>new </span>AdminLoginPage(<span>driver</span>)<span>;<br/></span>admLoginPage.login()</strong><span><strong>;</strong></span></pre>
<p>Navigating to the admin login page, identifying the elements, providing values for the elements, and submitting the form —everything is taken care of by the PageObject. Thus, from now on, the test case doesn't need to be refactored for any changes to the admin page. You just have to change the PageObject, and all the test cases using this PageObject will start using the new changes without even knowing they occurred.</p>
<p>Now that you have seen what a PageObject looks like, the Selenium library provides even more convenient ways to implement your PageObjects. Let's take a look at them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the @FindBy annotation</h1>
                </header>
            
            <article>
                
<p>An element in the PageObject is marked with the <kbd>@FindBy</kbd> annotation. It is used to direct the WebDriver to locate that element on a page. It takes the locating mechanism (that is, by <kbd>Id</kbd>, <kbd>Name</kbd>, or <kbd>Class Name</kbd>) and the value of the element for that locating mechanism as input.</p>
<p>There are two ways of using the <kbd>@FindBy</kbd> annotation:</p>
<p>Usage 1 is shown as follows:</p>
<pre>@FindBy(id="user_login")<br/>WebElement userId;</pre>
<p class="mce-root"/>
<p>Usage 2 is shown as follows:</p>
<pre>@FindBy(how=How.ID, using="user_login")<br/>WebElement userId; </pre>
<p>The preceding two usages direct the WebDriver to locate the element using the locating mechanism ID with the <kbd>user_login</kbd> value and assign that element to the <kbd>userId</kbd> WebElement. In usage 2, we have used the How enumeration. This enumeration supports all the different locating mechanisms that our <kbd>By</kbd> class supports. The enumeration constants supported in the How enumeration are as follows:</p>
<ul>
<li>CLASS_NAME</li>
<li>CSS</li>
<li>ID</li>
<li>ID_OR_NAME</li>
<li>LINK_TEXT</li>
<li>NAME</li>
<li>PARTIAL_LINK_TEXT</li>
<li>TAG_NAME</li>
<li>XPATH</li>
</ul>
<p>Using the <kbd>@FindBy</kbd> annotation, we will see how our <kbd>AdminLoginPage</kbd> class changes:</p>
<pre><span>public class </span>AdminLoginPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span>    <br/></span><span>    </span><span>@FindBy</span>(<span>id</span>=<span>"user_login"</span>)<br/>    WebElement <span>email</span><span>;<br/></span><span>    <br/></span><span>    </span><span>@FindBy</span>(<span>id</span>=<span>"user_pass"</span>)<br/>    WebElement <span>password</span><span>;<br/></span><span>    <br/></span><span>    </span><span>@FindBy</span>(<span>id</span>=<span>"wp-submit"</span>)<br/>    WebElement <span>submit</span><span>;<br/></span><span>    <br/></span><span>    public </span><span>AdminLoginPage</span>(WebDriver driver){<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin"</span>)<span>;<br/></span><span>    </span>}<br/>    <span>public void </span><span>login</span>(){<br/>        <span>email</span>.sendKeys(<span>"pageobjectpattern@gmail.com"</span>)<span>;<br/></span><span>        </span><span>password</span>.sendKeys(<span>"webdriver123"</span>)<span>;<br/></span><span>        </span><span>submit</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>When the test case instantiates the preceding class in the constructor, we navigate to the WordPress login page using the following code specified in the constructor:</p>
<pre>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin"</span>)<span>;</span></pre>
<p>Once the driver state is set to this page, all the <kbd>FindBy</kbd> declared elements, that is, <kbd>email</kbd>, <kbd>password</kbd>, and <kbd>submit</kbd>, are initialized by the WebDriver using the locating mechanisms specified in the <kbd>FindBy</kbd> annotation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding PageFactory</h1>
                </header>
            
            <article>
                
<p>Another important class that the WebDriver library provides to support the PageObject pattern is the <kbd>PageFactory</kbd> class. Once the <kbd>PageObject</kbd> class declares elements using the <kbd>FindBy</kbd> annotation, you can instantiate that <kbd>PageObject</kbd> class and its elements using the <kbd>PageFactory</kbd> class. This class supports a static method named <kbd>initElements</kbd>. The API syntax for this method is as follows:</p>
<pre>initElements(WebDriver driver, java.lang.Class PageObjectClass)</pre>
<p>Now, let's see how this can be used in our test case to create AdminLoginPage:</p>
<pre>public class TestAddNewPostUsingPageObjects { public static void main(String... args){<br/>AdminLoginPage loginPage= PageFactory<br/>.<span>initElements</span>(<span>driver</span><span>, </span>AdminLoginPage.<span>class</span>)<span>;<br/></span>loginPage.login()<span>;</span></pre>
<p>The <kbd>PageFactory</kbd> class instantiates the <kbd>AdminLoginPage</kbd> class and gives it the driver instance. The <kbd>AdminLoginPage</kbd> PageObject navigates the driver instance to a URL (<a href="http://demo-blog.seleniumacademy.com/wp/wp-admin">http://demo-blog.seleniumacademy.com/wp/wp-admin</a>, in this case) and then populates all its elements annotated with the <kbd>FindBy</kbd> annotation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Good practices for the PageObjects design</h1>
                </header>
            
            <article>
                
<p>So, now that you have seen what a simple implementation of PageObject looks like, it's time to consider some good practices in designing PageObjects for your test framework.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Think of a web page as a services provider</h1>
                </header>
            
            <article>
                
<p>At a high level, when you look at a page in a web application, you will find it is an aggregation of various User Services. For example, if you take a look at the <span class="packt_screen">All Posts</span> page in our WordPress Admin console, there are many sections in it:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ae4559d2-2c7e-4ec8-aafb-0d1d9e0e9b31.png"/></p>
<p>In the preceding screenshot, in the <kbd>All Posts</kbd> page, a user can perform the following five activities:</p>
<ul>
<li>Add a new post.</li>
<li>Edit a selected post.</li>
<li>Delete a selected post.</li>
<li>Filter the posts by category.</li>
<li>Search for text in all the posts.</li>
</ul>
<p class="mce-root"/>
<p>The preceding activities are the services that the <span class="packt_screen">All Posts</span> page provides to its users. So, your PageObject should also provide these services for the test case, which is the user of this PageObject. The code for the <span class="packt_screen">All Posts</span> PageObject should look as follows:</p>
<pre><span>public class </span>AllPostsPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"the-list"</span>)<br/>    WebElement <span>postsContainer</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"post-search-input"</span>)<br/>    WebElement <span>searchPosts</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"cat"</span>)<br/>    WebElement <span>viewByCategories</span><span>;<br/></span><span><br/></span><span>    public </span><span>AllPostsPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>createANewPost</span>(String title<span>, </span>String description) {<br/>    }<br/><br/>    <span>public void </span><span>editAPost</span>(String title) {<br/>    }<br/><br/>    <span>public void </span><span>deleteAPost</span>(String postTitle) {<br/>    }<br/><br/>    <span>public void </span><span>filterPostsByCategory</span>(String category) {<br/>    }<br/><br/>    <span>public void </span><span>searchInPosts</span>(String searchText) {<br/>    }<br/>}</pre>
<p>Now, we have mapped the identified services on the page to the methods in our PageObject. When a test case wants to execute a service, it will get assistance from the PageObject to accomplish that.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Always look for implied services</h1>
                </header>
            
            <article>
                
<p>Some of a page's services can be identified very clearly on it. And there are some services that are not visible on the page but that are implied. For example, in the <span class="packt_screen">All Posts</span> page, we have identified five services just by looking at the page. But let's say your test case wants to know the count of existing posts; this information is available on the <span class="packt_screen">All Posts</span> page, and we have to make sure that your PageObject provides that as an implied service. Now you extend your PageObject for the <span class="packt_screen">All Posts</span> page with this implied service, which looks as follows:</p>
<pre><span>public class </span>AllPostsPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span>    <br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"the-list"</span>)<br/>    WebElement <span>postsContainer</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"post-search-input"</span>)<br/>    WebElement <span>searchPosts</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"cat"</span>)<br/>    WebElement <span>viewByCategories</span><span>;<br/></span><span><br/></span><span>    public </span><span>AllPostsPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>createANewPost</span>(String title<span>, </span>String description) {<br/>    }<br/><br/>    <span>public void </span><span>editAPost</span>(String title) {<br/>    }<br/><br/>    <span>public void </span><span>deleteAPost</span>(String postTitle) {<br/>    }<br/><br/>    <span>public void </span><span>filterPostsByCategory</span>(String category) {<br/>    }<br/><br/>    <span>public void </span><span>searchInPosts</span>(String searchText) {<br/>    }<br/><br/><strong>    <span>public int </span><span>getAllPostsCount</span>(){</strong><br/><strong>    }</strong><br/>}</pre>
<p class="mce-root"/>
<p>Now your test cases can employ the same PageObject to use the implied services relevant to the <span class="packt_screen">All Posts</span> page.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using PageObjects within a PageObject</h1>
                </header>
            
            <article>
                
<p>There will be many situations where you need to use PageObjects within a PageObject. Let's analyze that using a scenario on the <span class="packt_screen">All Posts</span> page. When you click on <span class="packt_screen">Add New</span> to add a new post, the browser actually navigates to a different page. So, you have to create two PageObjects, one for the <span class="packt_screen">All Posts</span> page and another for the <span class="packt_screen">Add New</span> page. Designing your PageObjects to simulate the exact behavior of our target application will keep things very clear and independent of each other. You may be able to navigate to the <span class="packt_screen">Add New</span> page in several different ways. Creating a PageObject of its own for the <span class="packt_screen">Add New</span> page and using it wherever needed will make your test framework adhere to good object-oriented fundamentals, and make the maintenance of your test framework easy. Let us see what using PageObjects within a PageObject will look like.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The AddNewPost PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>AddNewPost</kbd> PageObject adds new posts, as shown in the following code:</p>
<pre><span>public class </span>AddNewPostPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"content_ifr"</span>)<br/>    WebElement <span>newPostContentFrame</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"tinymce"</span>)<br/>    WebElement <span>newPostContentBody</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"title"</span>)<br/>    WebElement <span>newPostTitle</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"publish"</span>)<br/>    WebElement <span>newPostPublish</span><span>;<br/></span><span><br/></span><span>    public </span><span>AddNewPostPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>addNewPost</span>(String title<span>, </span>String descContent) {<br/>        <span>newPostTitle</span>.click()<span>;<br/></span><span>        </span><span>newPostTitle</span>.sendKeys(title)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().frame(<span>newPostContentFrame</span>)<span>;<br/></span><span>        </span><span>newPostContentBody</span>.sendKeys(descContent)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().defaultContent()<span>;<br/></span><span>        </span><span>newPostPublish</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The AllPostsPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>AllPostsPage</kbd> PageObject deals with the <kbd>All posts page</kbd>, as shown in the following code:</p>
<pre><span>public class </span>AllPostsPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"the-list"</span>)<br/>    WebElement <span>postsContainer</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"post-search-input"</span>)<br/>    WebElement <span>searchPosts</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"cat"</span>)<br/>    WebElement <span>viewByCategories</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>linkText </span>= <span>"Add New"</span>)<br/>    WebElement <span>addNewPost</span><span>;<br/></span><span><br/></span><span>    public </span><span>AllPostsPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>createANewPost</span>(String title<span>, </span>String description) {<br/>        <strong><span>addNewPost</span>.click()<span>;<br/></span><span>        </span>AddNewPostPage newPost = PageFactory.<span>initElements</span>(<span>driver</span><span>,<br/></span><span>                </span>AddNewPostPage.<span>class</span>)<span>;<br/></span><span>        </span>newPost.addNewPost(title<span>, </span>description)</strong><span><strong>;</strong><br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>editAPost</span>(String title) {<br/><span>    </span>}<br/><br/>    <span>public void </span><span>deleteAPost</span>(String title) {<br/><span>    </span>}<br/><br/>    <span>public void </span><span>filterPostsByCategory</span>(String category) {<br/>    }<br/><br/>    <span>public void </span><span>searchInPosts</span>(String searchText) {<br/>    }<br/><br/>    <span>public int </span><span>getAllPostsCount</span>() {<br/><span>    </span>}  <br/>}</pre>
<p>Now, as you can see in the <kbd>AllPostsPage</kbd> PageObject, we have instantiated the <kbd>AddNewPage</kbd> PageObject in the <kbd>createNewPost()</kbd> method. Thus, we are using one PageObject with another and keeping the behavior as close as possible to the target application.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Think of methods in PageObjects as services and not as user actions</h1>
                </header>
            
            <article>
                
<p>There might sometimes be confusion surrounding what methods make a PageObject. We saw earlier that each PageObject should contain <span class="packt_screen">User Services</span> as their methods. But quite often, we see some implementations of PageObjects in several test frameworks that constitute <kbd>User Actions</kbd> as their methods. So what is the difference between a <kbd>User Service</kbd> and a <kbd>User Action</kbd>? As we have already seen, some of the examples of User Services on the WordPress Admin console are as follows:</p>
<ul>
<li>Create a new post</li>
<li>Delete a post</li>
<li>Edit a post</li>
<li>Search in posts</li>
<li>Filter posts</li>
<li>Count all existing posts</li>
</ul>
<p>All the preceding services talk about the various functionalities of the target application. Now, let's see some examples of <kbd>User Actions</kbd>:</p>
<ul>
<li>Mouse-click</li>
<li>Typing text in a textbox</li>
<li>Navigating to a page</li>
<li>Clicking on a checkbox</li>
<li>Select an option from a dropdown</li>
</ul>
<p class="mce-root"/>
<p>The previous list showed some examples of <kbd>User Actions</kbd> on a page. They are common across many applications. Your PageObject is not meant to provide your test case with <kbd>User Actions</kbd>, but with User Services. So, each method in your PageObject should map to a service that the target page provides to the user. To accomplish a User Service, PageObject methods should contain many <kbd>User Actions</kbd>.</p>
<div class="packt_tip">Several User Actions come together to accomplish a User Service.</div>
<p>Here is an example of what your PageObject will look like if it provisions its methods with User Actions instead of User Services is as follows; let's see what the <kbd>AddNewPage</kbd> PageObject will look like:</p>
<pre><span>public class </span>AddNewPost {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"content_ifr"</span>)<br/>    WebElement <span>newPostContentFrame</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"tinymce"</span>)<br/>    WebElement <span>newPostContentBody</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"title"</span>)<br/>    WebElement <span>newPostTitle</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"publish"</span>)<br/>    WebElement <span>newPostPublish</span><span>;<br/></span><span><br/></span><span>    public </span><span>AddNewPost</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>System.<span>out</span>.println(driver.getCurrentUrl())<span>;<br/></span><span>    </span>}<br/>    <br/>    <span>public void </span><span>typeTextinTitle</span>(String title) {<br/>        <span>newPostTitle</span>.sendKeys(title)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>clickPublishButton</span>() {<br/>        <span>newPostPublish</span>.click()<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>typeTextinContent</span>(String descContent) {<br/>        <span>driver</span>.switchTo().frame(<span>newPostContentFrame</span>)<span>;<br/></span><span>        </span><span>newPostContentBody</span>.sendKeys(descContent)<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>So, in the code of the <kbd>AddNewPage</kbd> PageObject, we have three different methods to accomplish three different User Actions. The caller object, instead of just invoking the <kbd>addNewPage(String title, String description)</kbd> method, should now invoke the following:</p>
<pre>typeTextinTitle(String title)<br/>typeTextinContent(String description)<br/>clickPublishButton()</pre>
<p>The preceding User Actions are three different User Actions to accomplish adding a new post User Service. The caller of these methods should also keep in mind the order in which these User Actions need to be called; that is, the <kbd>clickPublishButton()</kbd> method should always come last. This introduces unnecessary complexity to your test cases and other PageObjects that try to add new posts to the system. Thus, User Services will hide most of the implementation details from the users of the PageObjects and reduce the cost of maintaining your test cases.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Identifying some WebElements on the fly</h1>
                </header>
            
            <article>
                
<p>In all the PageObjects, we have initialized the elements that we are going to use during object instantiation, using the <kbd>@FindBy</kbd> annotation. It is always good to identify all the elements of a page that are required to accomplish a User Service and assign them to the member variables in your PageObject. However, it is not always possible to do that. For example, if you want to edit a particular post in the <span class="packt_screen">All Posts</span> page, it is not mandatory, during PageObject initialization, to map each post on the page to a member variable in your PageObject. When you have a large number of posts, your PageObject initialization will be spending unnecessary time mapping the posts to your member variables, even though we don't use them. Besides, we don't even know how many member variables we need to map all the posts in the <span class="packt_screen">All Posts</span> page. The HTML for the <span class="packt_screen">All Posts</span> page looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8d717941-9160-46e4-9d37-09751687ee22.png"/></p>
<p class="mce-root"/>
<p>There is a root element identified by <kbd>the-list</kbd>, which contains all the posts in the WordPress blog. Within this element, we can see that there's Post1, Post2, and Post3. So having your PageObject initialized for all three posts is not an optimal solution. You can initialize your PageObject with a member variable mapped to the root element and the target post will be retrieved from it whenever required.</p>
<p>Let's take a look at the <kbd>AllPostsPage</kbd> PageObject that implements its <kbd>editPost()</kbd> method in the following way:</p>
<pre><span>public void </span><span>editAPost</span>(String presentTitle<span>,<br/></span><span>                      </span>String newTitle<span>, </span>String description){<br/>    List&lt;WebElement&gt; allPosts<br/>            = <span>postsContainer</span>.findElements(By.<span>className</span>(<span>"rowtitle"</span>))<span>;<br/></span><span>    for</span>(WebElement ele : allPosts){<br/>        <span>if</span>(ele.getText().equals(presentTitle)){<br/>            Actions builder = <span>new </span>Actions(<span>driver</span>)<span>;<br/></span><span>            </span>builder.moveToElement(ele)<span>;<br/></span><span>            </span>builder.click(<span>driver</span>.findElement(<br/>                    By.<span>cssSelector</span>(<span>".edit&gt;a"</span>)))<span>;<br/></span><span>            </span><span>// Generate the composite action.<br/></span><span>            </span>Action compositeAction = builder.build()<span>;<br/></span><span>            </span><span>// Perform the composite action.<br/></span><span>            </span>compositeAction.perform()<span>;<br/></span><span>            break;<br/></span><span>        </span>}<br/>    }<br/>    EditPost editPost<br/>            = PageFactory.initElements(<span>driver</span><span>, </span>EditPost.<span>class</span>)<span>;<br/></span><span>    </span>editPost.editPost(newTitle<span>, </span>description)<span>;<br/></span>}</pre>
<p>Notice that in the previous code that only the root element is identified by <kbd>the-list</kbd>; the element that contains all the posts in the All Posts page is mapped to a member variable, named <kbd>pageContainer</kbd> in the <kbd>AllPostsPage</kbd> PageObject. The target post is extracted only when it is needed in the <kbd>editAPost()</kbd> method. This way, your PageObject initialization doesn't take much time and has all the necessary elements mapped.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Keeping the page-specific details off the test script</h1>
                </header>
            
            <article>
                
<p>The ultimate aim of the PageObject pattern design is to maintain the page-specific details, such as the IDs of the elements on the page and the way we reach a particular page in the application, away from the test script. Building your test framework using the PageObject pattern should allow you to keep your test scripts very generic and not need a modification each time the page implementation details change. Finally, whenever there is a change done to a web page, such as a login page, the number of changes that need to be done for 50 test scripts that use this page should ideally be 0. Just changing the PageObject should handle adapting all the tests to the new changes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding loadable components</h1>
                </header>
            
            <article>
                
<p>The loadable component is an extension of the PageObject pattern. The <kbd>LoadableComponent</kbd> class in the WebDriver library will help test-case developers make sure that the page or a component of the page is loaded successfully. It tremendously reduces the efforts to debug your test cases. The PageObject should extend this LoadableComponent abstract class and, as a result, it is bound to provide an implementation for the following two methods:</p>
<pre>protected abstract void load()<br/>protected abstract void isLoaded() throws java.lang.Error</pre>
<p>The page or component that has to be loaded in the <kbd>load()</kbd> and <kbd>isLoaded()</kbd> methods determines whether the page or component is fully loaded. If it is not fully loaded, it throws an error.</p>
<p>Let's now modify the <kbd>AdminLoginPage</kbd> PageObject to extend the LoadableComponent class and see how it looks, using the following code:</p>
<pre><span>public class </span>AdminLoginPageUsingLoadableComponent <span>extends </span>LoadableComponent&lt;AdminLoginPageUsingLoadableComponent&gt; {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"user_login"</span>)<br/>    WebElement <span>email</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"user_pass"</span>)<br/>    WebElement <span>password</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"wp-submit"</span>)<br/>    WebElement <span>submit</span><span>;<br/></span><span><br/></span><span>    public </span><span>AdminLoginPageUsingLoadableComponent</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>PageFactory.<span>initElements</span>(driver<span>, this</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public </span>AllPostsPage <span>login</span>(String username<span>, </span>String pwd) {<br/>        <span>email</span>.sendKeys(username)<span>;<br/></span><span>        </span><span>password</span>.sendKeys(pwd)<span>;<br/></span><span>        </span><span>submit</span>.click()<span>;<br/></span><span>        return </span>PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>AllPostsPage.<span>class</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>@Override<br/></span><span>    </span><span>protected void </span><span>load</span>() {<br/>        <span>driver</span>.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>@Override<br/></span><span>    </span><span>protected void </span><span>isLoaded</span>() <span>throws </span>Error {<br/>        Assert.<span>assertTrue</span>(<span>driver</span>.getCurrentUrl().contains(<span>"wp-admin"</span>))<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>The URL that has to be loaded is specified in the <kbd>load()</kbd> method and the <kbd>isLoaded()</kbd> method validates whether or not the correct page is loaded. Now, the changes that are to be done in your test case are as follows:</p>
<pre>AdminLoginPageUsingLoadableComponent loginPage = new AdminLoginPageUsingLoadableComponent(driver).get();</pre>
<p>The <kbd>get()</kbd> method from the <kbd>LoadableComponent</kbd> class will make sure the component is loaded by invoking the <kbd>isLoaded()</kbd> method.                                                </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working on an end-to-end example of WordPress</h1>
                </header>
            
            <article>
                
<p>Now that we know what PageObjects are, it's time to take a look at an end-to-end example that interacts and tests the WordPress Admin console. First, we will see all the PageObjects and then the test cases that use them.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Looking at all the PageObjects</h1>
                </header>
            
            <article>
                
<p>Let's first see all the PageObjects that are involved in testing the WordPress Admin console.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The AdminLoginPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>AdminLoginPage</kbd> PageObject deals with the login page. This object has to be refactored if any changes have been made to the page in the target application, using the following code:</p>
<pre><span>package com.packt.webdriver.chapter9.pageObjects; <br/>import org.openqa.selenium.WebDriver;<br/>public class </span>AdminLoginPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"user_login"</span>)<br/>    WebElement <span>email</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"user_pass"</span>)<br/>    WebElement <span>password</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"wp-submit"</span>)<br/>    WebElement <span>submit</span><span>;<br/></span><span><br/></span><span>    public </span><span>AdminLoginPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public </span>AllPostsPage <span>login</span>(String username<span>, </span>String pwd) {<br/>        <span>email</span>.sendKeys(username)<span>;<br/></span><span>        </span><span>password</span>.sendKeys(pwd)<span>;<br/></span><span>        </span><span>submit</span>.click()<span>;<br/></span><span>        return </span>PageFactory.<span>initElements</span>(<span>driver</span><span>,<br/></span><span>                </span>AllPostsPage.<span>class</span>)<span>;<br/></span><span>    </span>}<br/>}</pre>
<p class="mce-root"/>
<p>The constructor of the <kbd>AdminLoginPage</kbd> PageObject accepts the WebDriver instance. This will let the test framework use the same driver instance throughout the execution across test scripts as well as PageObjects; thus, the state of the browser and web application is preserved. You will see similar constructors for all the PageObjects. Apart from the constructor, the <kbd>AdminLoginPage</kbd> PageObject provides the <kbd>login(String username, String pwd)</kbd> service. This service lets the test scripts log into the WordPress blog and, in return, gets the <kbd>AllPostsPage</kbd> PageObject. Before returning the instance of the <kbd>AllPostsPage</kbd> PageObject, the PageFactory PageObject will initialize all the WebElements of the <kbd>AllPostsPage</kbd> PageObject. Thus, all of the implementation details of the login service are hidden from the test script, and it can work with the <kbd>AllPostsPage</kbd> PageObject.                                                                             </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The AllPostsPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>AllPostsPage</kbd> PageObject deals with the <span class="packt_screen">All Posts</span> page, using the following code:</p>
<pre><span>public class </span>AllPostsPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"the-list"</span>)<br/>    WebElement <span>postsContainer</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"post-search-input"</span>)<br/>    WebElement <span>searchPosts</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"cat"</span>)<br/>    WebElement <span>viewByCategories</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>linkText </span>= <span>"Add New"</span>)<br/>    WebElement <span>addNewPost</span><span>;<br/></span><span><br/></span><span>    public </span><span>AllPostsPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>driver.get(<span>"http://demo-blog.seleniumacademy.com/wp/wp-admin/edit.php"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>createANewPost</span>(String title<span>, </span>String description) {<br/>        <span>addNewPost</span>.click()<span>;<br/></span><span>        </span>AddNewPostPage newPost = PageFactory.<span>initElements</span>(<span>driver</span><span>,<br/></span><span>                </span>AddNewPostPage.<span>class</span>)<span>;<br/></span><span>        </span>newPost.addNewPost(title<span>, </span>description)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>editAPost</span>(String presentTitle<span>, </span>String newTitle<span>,<br/></span><span>                          </span>String description) {<br/>        goToParticularPostPage(presentTitle)<span>;<br/></span><span>        </span>EditPostPage editPost = PageFactory.<span>initElements</span>(<span>driver</span><span>,<br/></span><span>                </span>EditPostPage.<span>class</span>)<span>;<br/></span><span>        </span>editPost.editPost(newTitle<span>, </span>description)<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>deleteAPost</span>(String title) {<br/>        goToParticularPostPage(title)<span>;<br/></span><span>        </span>DeletePostPage deletePost =<br/>                PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>DeletePostPage.<span>class</span>)<span>;<br/></span><span>        </span>deletePost.delete()<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>filterPostsByCategory</span>(String category) {<br/>    }<br/><br/>    <span>public void </span><span>searchInPosts</span>(String searchText) {<br/>    }<br/><br/>    <span>public int </span><span>getAllPostsCount</span>() {<br/>        List&lt;WebElement&gt; postsList = <span>postsContainer</span>.findElements(By.<span>tagName</span>(<span>"tr"</span>))<span>;<br/></span><span>        return </span>postsList.size()<span>;<br/></span><span>    </span>}<br/><br/>    <span>private void </span><span>goToParticularPostPage</span>(String title) {<br/>        List&lt;WebElement&gt; allPosts<br/>                = <span>postsContainer</span>.findElements(By.<span>className</span>(<span>"title"</span>))<span>;<br/></span><span>        for </span>(WebElement ele : allPosts) {<br/>            <span>if </span>(ele.getText().equals(title)) {<br/>                Actions builder = <span>new </span>Actions(<span>driver</span>)<span>;<br/></span><span>                </span>builder.moveToElement(ele)<span>;<br/></span><span>                </span>builder.click(<span>driver</span>.findElement(<br/>                        By.<span>cssSelector</span>(<span>".edit&gt;a"</span>)))<span>;<br/></span><span>                </span><span>// Generate the composite action.<br/></span><span>                </span>Action compositeAction = builder.build()<span>;<br/></span><span>                </span><span>// Perform the composite action.<br/></span><span>                </span>compositeAction.perform()<span>;<br/></span><span>                break;<br/></span><span>            </span>}<br/>        }<br/>    }<br/>}</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The <kbd>AllPostsPage</kbd> PageObject provides six services:</p>
<ul>
<li>Create a post</li>
<li>Edit a post</li>
<li>Delete a post</li>
<li>Filter posts by category</li>
<li>Search for text in posts</li>
<li>Count the number of posts available</li>
</ul>
<p>Once the test scripts obtains an instance of this PageObject via the login service of the <kbd>AdminLoginPage</kbd> PageObject, it can use any of the six services of this PageObject and test it. If any of the implementation details change, such as the navigation to a particular post or the ID of a WebElement on this page, the test script doesn't really have to worry about it. Modifying this PageObject will apply the changes to the WordPress blog.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The AddNewPostPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>AddNewPostPage</kbd> PageObject deals with adding a new post to the blog, using the following code:</p>
<pre><span>package </span>com.example<span>;<br/></span><span><br/></span><span>import </span>org.openqa.selenium.WebDriver<span>;<br/></span><span>import </span>org.openqa.selenium.WebElement<span>;<br/></span><span>import </span>org.openqa.selenium.support.<span>FindBy</span><span>;<br/></span><span><br/></span><span>public class </span>AddNewPostPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"content_ifr"</span>)<br/>    WebElement <span>newPostContentFrame</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"tinymce"</span>)<br/>    WebElement <span>newPostContentBody</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"title"</span>)<br/>    WebElement <span>newPostTitle</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"publish"</span>)<br/>    WebElement <span>newPostPublish</span><span>;<br/></span><span><br/></span><span>    public </span><span>AddNewPostPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>addNewPost</span>(String title<span>, </span>String descContent) {<br/>        <span>newPostTitle</span>.click()<span>;<br/></span><span>        </span><span>newPostTitle</span>.sendKeys(title)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().frame(<span>newPostContentFrame</span>)<span>;<br/></span><span>        </span><span>newPostContentBody</span>.sendKeys(descContent)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().defaultContent()<span>;<br/></span><span>        </span><span>newPostPublish</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>The <kbd>AddNewPostPage</kbd> PageObject is instantiated in the <kbd>createANewPost</kbd> service of the <kbd>AllPostsPage</kbd> PageObject. This PageObject provides a service named <kbd>addNewPost</kbd> that takes input for <kbd>title</kbd> and <kbd>description</kbd> for the post and publishes a new post in the blog with them.                                                                           </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The EditPostPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>EditPostPage</kbd> PageObject deals with editing an existing post, using the following code:</p>
<pre><span>package </span>com.example<span>;<br/></span><span><br/></span><span>import </span>org.openqa.selenium.WebDriver<span>;<br/></span><span>import </span>org.openqa.selenium.WebElement<span>;<br/></span><span>import </span>org.openqa.selenium.support.<span>FindBy</span><span>;<br/></span><span><br/></span><span>public class </span>EditPostPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"content_ifr"</span>)<br/>    WebElement <span>newPostContentFrame</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"tinymce"</span>)<br/>    WebElement <span>newPostContentBody</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"title"</span>)<br/>    WebElement <span>newPostTitle</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>id </span>= <span>"publish"</span>)<br/>    WebElement <span>newPostPublish</span><span>;<br/></span><span><br/></span><span>    public </span><span>EditPostPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>System.<span>out</span>.println(driver.getCurrentUrl())<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>editPost</span>(String title<span>, </span>String descContent) {<br/>        <span>newPostTitle</span>.click()<span>;<br/></span><span>        </span><span>newPostTitle</span>.clear()<span>;<br/></span><span>        </span><span>newPostTitle</span>.sendKeys(title)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().frame(<span>newPostContentFrame</span>)<span>;<br/></span><span>        </span><span>newPostContentBody</span>.clear()<span>;<br/></span><span>        </span><span>newPostContentBody</span>.sendKeys(descContent)<span>;<br/></span><span>        </span><span>driver</span>.switchTo().defaultContent()<span>;<br/></span><span>        </span><span>newPostPublish</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>The <kbd>EditPostPage</kbd> PageObject is similar to the <kbd>AddNewPostPage</kbd> PageObject and is instantiated at the <kbd>editAPost</kbd> service of the <kbd>AllPostsPage</kbd> PageObject. This provides a service named <kbd>editPost</kbd> to edit an existing post. The new <kbd>title</kbd> and <kbd>description</kbd> are passed as input parameters to this service.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The DeletePostPage PageObject</h1>
                </header>
            
            <article>
                
<p>The <kbd>DeletePostPage</kbd> PageObject deals with deleting an existing post, using the following code:</p>
<pre><span>package </span>com.example<span>;<br/></span><span><br/></span><span>import </span>org.openqa.selenium.WebDriver<span>;<br/></span><span>import </span>org.openqa.selenium.WebElement<span>;<br/></span><span>import </span>org.openqa.selenium.support.<span>FindBy</span><span>;<br/></span><span><br/></span><span>public class </span>DeletePostPage {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span><br/></span><span>    </span><span>@FindBy</span>(<span>linkText </span>= <span>"Move to Trash"</span>)<br/>    WebElement <span>moveToTrash</span><span>;<br/></span><span><br/></span><span>    public </span><span>DeletePostPage</span>(WebDriver driver) {<br/>        <span>this</span>.<span>driver </span>= driver<span>;<br/></span><span>        </span>System.<span>out</span>.println(driver.getCurrentUrl())<span>;<br/></span><span>    </span>}<br/><br/>    <span>public void </span><span>delete</span>() {<br/>        <span>moveToTrash</span>.click()<span>;<br/></span><span>    </span>}<br/>}</pre>
<p>The <kbd>DeletePostPage</kbd> PageObject is similar to the <kbd>AddNewPostPage</kbd> and <kbd>EditPostPage</kbd> PageObjects and is instantiated at the <kbd>deleteAPost</kbd> service of the <kbd>AllPostsPage</kbd> PageObject. This provides a service, named <kbd>delete</kbd>, to delete an existing post. As you can see, the <kbd>AddNewPostPage</kbd>, <kbd>EditPostPage</kbd>, and <kbd>DeletePostPage</kbd> PageObjects take you to the same page. So, it makes sense to merge these three PageObjects into one that provides services for adding, editing, and deleting posts.                                                                              </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Looking at the test cases</h1>
                </header>
            
            <article>
                
<p>Now it's time to see the test cases that use the PageObjects to interact with the WordPress Admin console.                                                                                    </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a new post</h1>
                </header>
            
            <article>
                
<p>This test case deals with adding a new post to the blog, using the following code:</p>
<pre><span>package </span>com.example<span>;<br/></span><span><br/></span><span>import </span>org.openqa.selenium.WebDriver<span>;<br/></span><span>import </span>org.openqa.selenium.chrome.ChromeDriver<span>;<br/></span><span>import </span>org.openqa.selenium.support.PageFactory<span>;<br/></span><span><br/></span><span>import </span>org.testng.annotations.<span>AfterMethod</span><span>;<br/></span><span>import </span>org.testng.annotations.<span>BeforeMethod</span><span>;<br/></span><span>import </span>org.testng.annotations.<span>Test</span><span>;<br/></span><span><br/></span><span>public class </span>WordPressBlogTestsWithPageObject {<br/><br/>    WebDriver <span>driver</span><span>;<br/></span><span>    </span>String <span>username </span>= <span>"admin"</span><span>;<br/></span><span>    </span>String <span>password </span>= <span>"$$SUU3$$N#"</span><span>;<br/></span><span><br/></span><span>    </span><span>@BeforeMethod<br/></span><span>    </span><span>public void </span><span>setup</span>() {<br/><br/>        System.<span>setProperty</span>(<span>"webdriver.chrome.driver"</span><span>,<br/></span><span>                </span><span>"./src/test/resources/drivers/chromedriver"</span>)<span>;<br/></span><span>        </span><span>driver </span>= <span>new </span>ChromeDriver()<span>;<br/></span><span>    </span>}<br/><br/>    <span>@Test<br/></span><span>    </span><span>public void </span><span>testAddNewPost</span>() {<br/>        AdminLoginPage loginPage =<br/>                PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>AdminLoginPage.<span>class</span>)<span>;<br/></span><span>        </span>AllPostsPage allPostsPage = loginPage.login(<span>username</span><span>, </span><span>password</span>)<span>;<br/></span><span>        </span>allPostsPage.createANewPost(<span>"Creating New Post using PageObjects"</span><span>,<br/></span><span>                </span><span>"Its good to use PageObjects"</span>)<span>;<br/></span><span>    </span>}<br/><br/>    <span>@AfterMethod<br/></span><span>    </span><span>public void </span><span>tearDown</span>() {<br/>        <span>driver</span>.quit()<span>;<br/></span><span>    </span>}<br/><br/>}</pre>
<p>The following is the sequence of steps executed in the preceding test script to test how to add a new post to the WordPress blog:</p>
<ol>
<li>The test script creates a ChromeDriver instance, because it intends to test the scenario of adding a new post to the blog on the Chrome browser.</li>
<li>It creates an instance of the <kbd>AdminLoginPage</kbd> PageObject that uses the same driver instance created in the previous step.</li>
<li>Once it gets the instance of the <kbd>AdminLoginPage</kbd> PageObject, it uses the <kbd>login</kbd> service to log into the WordPress admin console. The <kbd>login</kbd> service, in return, gives out an instance of the <kbd>AllPostsPage</kbd> PageObject instance to the test script.</li>
<li>The test script uses the instance of the <kbd>AllPostsPage</kbd> PageObject obtained in the previous step to use one of the many services provided by the <kbd>All Posts page</kbd>. In this case, it uses the <kbd>createANewPost</kbd> service.                                                                                                 </li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Editing a post</h1>
                </header>
            
            <article>
                
<p>This test case deals with the testing and editing of a post in the blog using the following code:</p>
<pre><span>@Test<br/></span><span>public void </span><span>testEditPost</span>() {<br/>    AdminLoginPage loginPage =<br/>            PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>AdminLoginPage.<span>class</span>)<span>;<br/></span><span>    </span>AllPostsPage allPostsPage = loginPage.login(<span>username</span><span>, </span><span>password</span>)<span>;<br/></span><span>    </span>allPostsPage.editAPost(<span>"Creating New Post using PageObjects"</span><span>,<br/></span><span>            </span><span>"Editing Post using PageObjects"</span><span>, </span><span>"Test framework low maintenance"</span>)<span>;<br/></span>}</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The following is the sequence of steps executed in the preceding test script to test how to add a new post to the WordPress blog:</p>
<ol>
<li>It creates an instance of the <kbd>AdminLoginPage</kbd> PageObject that uses the same driver instance created in the previous step.</li>
<li>Once it gets the instance of the <kbd>AdminLoginPage</kbd> PageObject, it uses the <kbd>login</kbd> service to log into the WordPress admin console. The <kbd>login</kbd> service, in return, gives out an instance of the <kbd>AllPostsPage</kbd> PageObject instance to the test script.</li>
<li>The test script uses the instance of the <kbd>AllPostsPage</kbd> PageObject obtained in the previous step to use one of the many services provided by the <span class="packt_screen">All Posts</span> page. In this case, it uses the <kbd>createANewPost</kbd> service.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Deleting a post</h1>
                </header>
            
            <article>
                
<p>This test case deals with deleting a post, using the following code:</p>
<pre><span>@Test </span>(<span>dependsOnMethods </span>= <span>"testEditPost"</span>)<br/><span>public void </span><span>testDeletePost</span>() {<br/>    AdminLoginPage loginPage =<br/>            PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>AdminLoginPage.<span>class</span>)<span>;<br/></span><span>    </span>AllPostsPage allPostsPage = loginPage.login(<span>username</span><span>, </span><span>password</span>)<span>;<br/></span><span>    </span>allPostsPage.deleteAPost(<span>"Editing Post using PageObjects"</span>)<span>;<br/></span>}</pre>
<p>The following is the sequence of steps executed in the preceding test script to test the deleting of a post in the WordPress blog:</p>
<ol>
<li>It creates an instance of the <kbd>AdminLoginPage</kbd> PageObject that uses the same driver instance created in the previous step.</li>
<li>Once it gets the instance of the <kbd>AdminLoginPage</kbd> PageObject, it uses the <kbd>login</kbd> service to log into the WordPress Admin console. The <kbd>login</kbd> service, in return, gives out an instance of the <kbd>AllPostsPage</kbd> PageObject instance to the test script.</li>
<li>The test script uses the instance of the <kbd>AllPostsPage</kbd> PageObject obtained in the previous step to use one of the many services provided by the <span class="packt_screen">All Posts</span> page. In this case, it uses the <kbd>deleteAPost</kbd> service.                                                                                                     </li>
</ol>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Counting posts</h1>
                </header>
            
            <article>
                
<p>This test case deals with counting of the number of posts currently available in the blog, using the following code: </p>
<pre><span>@Test <br/></span><span>public void </span><span>testCountPost</span>() {<br/>    AdminLoginPage loginPage =<br/>            PageFactory.<span>initElements</span>(<span>driver</span><span>, </span>AdminLoginPage.<span>class</span>)<span>;<br/></span><span>    </span>AllPostsPage allPostsPage = loginPage.login(<span>username</span><span>, </span><span>password</span>)<span>;<br/></span><span>    </span>Assert.<span>assertEquals</span>(allPostsPage.getAllPostsCount()<span>, </span><span>1</span>)<span>;<br/></span>}</pre>
<p>The following is the sequence of steps executed in the preceding test script to test counting the number of posts in the WordPress blog:</p>
<ol>
<li>It creates an instance of the <kbd>AdminLoginPage</kbd> PageObject that uses the driver instance created in the previous step.</li>
<li>Once it gets the instance of the <kbd>AdminLoginPage</kbd> PageObject, it uses the <kbd>login</kbd> service to log into the WordPress Admin console. The <kbd>login</kbd> service, in return, gives out an instance of the <kbd>AllPostsPage</kbd> PageObject instance to the test script.</li>
<li>The test script uses the instance of the <kbd>AllPostsPage</kbd> PageObject obtained in the previous step to use one of the many services provided by the <span class="packt_screen">All Posts</span> page. In this case, it uses the <kbd>getAllPostsCount</kbd> service.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we learned about the PageObject pattern and how we can implement a test framework using PageObjects. It has numerous advantages. The PageObject pattern and the <kbd>LoadableComponents</kbd> class provide a test framework that adapts easily to changes made to the target application, without changing any test cases. We should always remember that a well-designed test framework is always flexible to changes made to the target application. In the next <a href="edb0d52b-7d7a-4e34-9d34-67962dfd87aa.xhtml"/>chapter, we will look at testing iOS and Android mobile applications using, <kbd>Appium</kbd>.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>How do you initialize a PageObject implemented with PageFactory?</li>
<li>Using which class can we implement methods to validate whether the page is loaded ?</li>
<li>Which <kbd>By class</kbd> methods are supported by @FindBy?</li>
<li>When using PageFactory, if you give the WebElement variable the name same ID or name attribute, then you don't need to use the @FindBy annotation— True or False?</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further information</h1>
                </header>
            
            <article>
                
<p><span>You can check out the following links for more information about the topics covered in this chapter:</span></p>
<ul>
<li>Test Design Considerations: <a href="https://www.seleniumhq.org/docs/06_test_design_considerations.jsp">https://www.seleniumhq.org/docs/06_test_design_considerations.jsp</a></li>
<li class="post_title-text">Automation in Selenium: PageObjectModel and PageFactory: <a href="https://www.toptal.com/selenium/test-automation-in-selenium-using-page-object-model-and-page-factory">https://www.toptal.com/selenium/test-automation-in-selenium-using-page-object-model-and-page-factory</a></li>
</ul>


            </article>

            
        </section>
    </body></html>