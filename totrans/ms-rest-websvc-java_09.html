<html><head></head><body>
  <div id="_idContainer066">
   <h1 class="chapterNumber">
    <a id="_idTextAnchor176">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     7
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-164">
    <a id="_idTextAnchor177">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Securing Your RESTful API
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.3.1">
     Welcome to the part of the book that talks about software security, within the larger field of cybersecurity, which is what you, as a software engineer, are most responsible for.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     This may seem a little different from what you have read so far because it’s not always seen as a core responsibility of a software engineer.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     That is a sad misconception.
    </span>
    <span class="koboSpan" id="kobo.3.4">
     With the digitization of our society, software security is no longer just the domain of cybersecurity experts; it’s an integral part of software development and should be a major concern at all levels of development.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.4.1">
     Understanding security can be complex, so let’s start with a mental image.
    </span>
    <span class="koboSpan" id="kobo.4.2">
     Metaphors help simplify abstract concepts, and one of the most common metaphors in cybersecurity is the onion.
    </span>
    <span class="koboSpan" id="kobo.4.3">
     If you’ve read about security before, you’ve likely encountered this idea: security is built in layers, just like an onion, with each layer adding a protective barrier.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.5.1">
     While useful, this metaphor has its flaws.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     It suggests that every layer is uniform when, in reality, cybersecurity defenses vary significantly.
    </span>
    <span class="koboSpan" id="kobo.5.3">
     A more accurate comparison is a fortress under siege, where different layers of defense respond to different threats.
    </span>
    <span class="koboSpan" id="kobo.5.4">
     Long-range artillery targets distant attackers, walls hold back intruders, and hand-to-hand combat is the last line of defense.
    </span>
    <span class="koboSpan" id="kobo.5.5">
     Likewise, in security, each layer serves a distinct purpose, using different tools and techniques to protect against specific risks.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.6.1">
     But what does this mean for you, the software engineer?
    </span>
    <span class="koboSpan" id="kobo.6.2">
     Security isn’t just about protecting systems—it’s about safeguarding user data, ensuring reliability, and preventing costly breaches that can damage both a company’s reputation and its bottom line.
    </span>
    <span class="koboSpan" id="kobo.6.3">
     Vulnerabilities in your code can be exploited to steal sensitive information, disrupt services, or even compromise entire networks.
    </span>
    <span class="koboSpan" id="kobo.6.4">
     As software engineers, we are the first line of defense.
    </span>
    <span class="koboSpan" id="kobo.6.5">
     Writing secure code, enforcing proper access controls, and understanding common attack vectors are not optional skills—they are essential responsibilities.
    </span>
    <span class="koboSpan" id="kobo.6.6">
     In this chapter, we’ll explore the layers of security you are responsible for and how to integrate security into your development process effectively.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.7.1">
     The following topics will be covered in this chapter:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.8.1">
      Anatomy of an HTTP API call
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.9.1">
      Authentication
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.10.1">
      OWASP API Security Top 10 overview
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.11.1">
      Understanding Common Vulnerabilities and Exposures
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.12.1">
      Strategies to manage CVEs
     </span>
    </li>
   </ul>
   <h1 class="heading-1" id="_idParaDest-165">
    <a id="_idTextAnchor178">
    </a>
    <span class="koboSpan" id="kobo.13.1">
     Anatomy of an HTTP API call
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.14.1">
     Almost all API calls today are made over HTTP.
    </span>
    <span class="koboSpan" id="kobo.14.2">
     So, let’s take a look at what happens during such a call
    </span>
    <a id="_idIndexMarker470">
    </a>
    <span class="koboSpan" id="kobo.15.1">
     and many of the components that participate in it.
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.16.1">
     <img alt="Figure 7.1 – A typical secure API call over HTTP" src="../Images/B21843_07_1.jpg"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.17.1">
     Figure 7.1 – A typical secure API call over HTTP
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-166">
    <a id="_idTextAnchor179">
    </a>
    <span class="koboSpan" id="kobo.18.1">
     Encrypting the communication
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.19.1">
     Although the protocol is called HTTP and we usually say it is an HTTP call or an HTTP connection, the fact
    </span>
    <a id="_idIndexMarker471">
    </a>
    <span class="koboSpan" id="kobo.20.1">
     is that all modern API calls are made over HTTPS.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.21.1">
     The “
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.22.1">
      S
     </span>
    </em>
    <span class="koboSpan" id="kobo.23.1">
     ” at the
    </span>
    <a id="_idIndexMarker472">
    </a>
    <span class="koboSpan" id="kobo.24.1">
     end stands for “
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.25.1">
      secure
     </span>
    </em>
    <span class="koboSpan" id="kobo.26.1">
     ,” indicating that the HTTP communication is encrypted using
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.27.1">
      Transport Layer Security
     </span>
    </strong>
    <span class="koboSpan" id="kobo.28.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.29.1">
      TLS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.30.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.30.2">
     TLS operates at the transport layer (Layer 4 in the OSI model), encrypting data between the client and server to prevent eavesdropping and tampering.
    </span>
    <span class="koboSpan" id="kobo.30.3">
     Using TLS in an HTTP call ensures that only the intended receiver can read the message correctly, practically eliminating man-in-the-middle attacks because even if a message is intercepted, it cannot be decrypted and read.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.31.1">
     An HTTPS call will therefore enforce the following:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.32.1">
       Data confidentiality
      </span>
     </strong>
     <span class="koboSpan" id="kobo.33.1">
      : All data transmitted over the network is encrypted and meaningless without the correct set of keys
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.34.1">
       Data integrity
      </span>
     </strong>
     <span class="koboSpan" id="kobo.35.1">
      : Ensures the data hasn’t been altered during transition
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.36.1">
       Server authentication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.37.1">
      : Validates the server’s identity to the client
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.38.1">
     All three features of HTTPS (HTTP over TLS) communication are implemented using cryptographic algorithms to perform encryption and create digital signatures and secure digests (hashes) of the transferred data.
    </span>
    <span class="koboSpan" id="kobo.38.2">
     How the cryptographic algorithms are used and how their inputs and outputs are transferred over the network are specified by the particular TLS protocol version used.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.39.1">
     Some of the
    </span>
    <a id="_idIndexMarker473">
    </a>
    <span class="koboSpan" id="kobo.40.1">
     algorithms and protocols used in the past are considered vulnerable given the current scientific knowledge and computing power available.
    </span>
    <span class="koboSpan" id="kobo.40.2">
     The set of algorithms that are considered safe keeps evolving.
    </span>
    <span class="koboSpan" id="kobo.40.3">
     There are already algorithms available today that are expected to stay safe when we reach the quantum computing era.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.41.1">
     Always use strong cryptographic algorithms and protocols when implementing HTTPS for your APIs.
    </span>
    <span class="koboSpan" id="kobo.41.2">
     Avoid deprecated protocols such as SSL and old versions of TLS.
    </span>
    <span class="koboSpan" id="kobo.41.3">
     Encryption algorithms are constantly evolving, and old ones have become obsolete due to the ease with which they are broken.
    </span>
    <span class="koboSpan" id="kobo.41.4">
     Create and enforce a policy to review your encryption selections frequently and update your TLS certificates.
    </span>
    <span class="koboSpan" id="kobo.41.5">
     We will discuss this later.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.42.1">
     In modern organizations (mid-size and up), it is unlikely that a software engineer will be responsible for any TLS implementations, but it is important to have a general idea of how HTTPS works and its implications.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.43.1">
     An essential element used in HTTPS communication is the use of public key cryptography.
    </span>
    <span class="koboSpan" id="kobo.43.2">
     The public part of the public-private key pair is part of a TLS certificate.
    </span>
    <span class="koboSpan" id="kobo.43.3">
     TLS certificates have a life cycle from issue to expiry or invalidation.
    </span>
    <span class="koboSpan" id="kobo.43.4">
     Hence, we need to manage these certificates.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-167">
    <a id="_idTextAnchor180">
    </a>
    <span class="koboSpan" id="kobo.44.1">
     Managing your HTTPS certificates
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.45.1">
     One of the consequences of using HTTPS/TLS encryption is the need for certificate management.
    </span>
    <span class="koboSpan" id="kobo.45.2">
     Managing security certificates is a complex and crucial part of any API-based application.
    </span>
    <span class="koboSpan" id="kobo.45.3">
     Effective certificate management involves handling renewals and expirations, and ensuring
    </span>
    <a id="_idIndexMarker474">
    </a>
    <span class="koboSpan" id="kobo.46.1">
     certificates are correctly configured to prevent service interruptions.
    </span>
    <span class="koboSpan" id="kobo.46.2">
     Additionally, automated tools for certificate life cycle management can help streamline compliance, especially in environments with frequent communication between APIs
    </span>
    <a id="_idIndexMarker475">
    </a>
    <span class="koboSpan" id="kobo.47.1">
     or external services.
    </span>
    <span class="koboSpan" id="kobo.47.2">
     This is such a significant problem that many groups have tried to create mechanisms to mitigate it.
    </span>
    <span class="koboSpan" id="kobo.47.3">
     Let’s Encrypt (
    </span>
    <a href="https://letsencrypt.org/">
     <span class="url">
      <span class="koboSpan" id="kobo.48.1">
       https://letsencrypt.org/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.49.1">
     ) has achieved great success, having been used even in some large corporations.
    </span>
    <span class="koboSpan" id="kobo.49.2">
     Most cloud providers also have some form of automatic certificate management, such
    </span>
    <a id="_idIndexMarker476">
    </a>
    <span class="koboSpan" id="kobo.50.1">
     as AWS Certificate Manager (
    </span>
    <a href="https://aws.amazon.com/certificate-manager/">
     <span class="url">
      <span class="koboSpan" id="kobo.51.1">
       https://aws.amazon.com/certificate-manager/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.52.1">
     ).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-168">
    <a id="_idTextAnchor181">
    </a>
    <span class="koboSpan" id="kobo.53.1">
     The first line of defense – Web Application Firewall (WAF)
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.54.1">
     A WAF acts as a barrier between the client and your server, filtering out malicious traffic and offering a
    </span>
    <a id="_idIndexMarker477">
    </a>
    <span class="koboSpan" id="kobo.55.1">
     first layer of protection against common web exploits such
    </span>
    <a id="_idIndexMarker478">
    </a>
    <span class="koboSpan" id="kobo.56.1">
     as SQL injection and
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.57.1">
      Cross-Site Scripting
     </span>
    </strong>
    <span class="koboSpan" id="kobo.58.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.59.1">
      XSS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.60.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.60.2">
     This is not usually controlled by software engineers, but it is important to know about it as the WAF can cause some interference on HTTP traffic.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.61.1">
     These are
    </span>
    <a id="_idIndexMarker479">
    </a>
    <span class="koboSpan" id="kobo.62.1">
     the functions of a WAF:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.63.1">
       Traffic monitoring
      </span>
     </strong>
     <span class="koboSpan" id="kobo.64.1">
      : Inspects incoming requests for suspicious patterns
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.65.1">
       Rule-based filtering
      </span>
     </strong>
     <span class="koboSpan" id="kobo.66.1">
      : Blocks traffic based on predefined security rules
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.67.1">
       Anomaly detection
      </span>
     </strong>
     <span class="koboSpan" id="kobo.68.1">
      : Identifies unusual behavior that may indicate an attack
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-169">
    <a id="_idTextAnchor182">
    </a>
    <span class="koboSpan" id="kobo.69.1">
     Best practices
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.70.1">
     Regularly updating WAF rules is essential to ensure that it can adapt to new and emerging threats.
    </span>
    <span class="koboSpan" id="kobo.70.2">
     Additionally, it’s important to customize these rules to align with the specific needs and architecture
    </span>
    <a id="_idIndexMarker480">
    </a>
    <span class="koboSpan" id="kobo.71.1">
     of your application, ensuring optimal protection.
    </span>
    <span class="koboSpan" id="kobo.71.2">
     Monitoring WAF logs consistently provides valuable security insights, helping to identify patterns, anomalies, or potential attacks, thereby enabling proactive defenses.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-170">
    <a id="_idTextAnchor183">
    </a>
    <span class="koboSpan" id="kobo.72.1">
     API gateways
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.73.1">
     An API gateway is
    </span>
    <a id="_idIndexMarker481">
    </a>
    <span class="koboSpan" id="kobo.74.1">
     usually the entry point for all client requests, handling tasks such
    </span>
    <a id="_idIndexMarker482">
    </a>
    <span class="koboSpan" id="kobo.75.1">
     as request routing, composition, and protocol translation.
    </span>
    <span class="koboSpan" id="kobo.75.2">
     In terms
    </span>
    <a id="_idIndexMarker483">
    </a>
    <span class="koboSpan" id="kobo.76.1">
     of security, an API gateway frequently performs many important tasks:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.77.1">
       TLS termination
      </span>
     </strong>
     <span class="koboSpan" id="kobo.78.1">
      : Decrypts incoming HTTPS traffic
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.79.1">
       Authentication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.80.1">
      : Validates credentials and permissions
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.81.1">
       Rate limiting and throttling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.82.1">
      : Controls the number of requests to prevent abuse
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-171">
    <a id="_idTextAnchor184">
    </a>
    <span class="koboSpan" id="kobo.83.1">
     Benefits
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.84.1">
     An API gateway
    </span>
    <a id="_idIndexMarker484">
    </a>
    <span class="koboSpan" id="kobo.85.1">
     centralizes security policies, allowing consistent enforcement across all services.
    </span>
    <span class="koboSpan" id="kobo.85.2">
     It simplifies client interactions with APIs by providing a single entry point that manages tasks such as routing and authentication.
    </span>
    <span class="koboSpan" id="kobo.85.3">
     Additionally, it enhances performance by enabling caching and load balancing, ensuring efficient resource utilization and improved response times.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-172">
    <a id="_idTextAnchor185">
    </a>
    <span class="koboSpan" id="kobo.86.1">
     Load balancers
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.87.1">
     Load balancers
    </span>
    <a id="_idIndexMarker485">
    </a>
    <span class="koboSpan" id="kobo.88.1">
     distribute incoming network traffic across multiple servers to ensure availability and reliability.
    </span>
    <span class="koboSpan" id="kobo.88.2">
     While not directly involved in security logic, they contribute to overall security in the following ways:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.89.1">
       Health monitoring
      </span>
     </strong>
     <span class="koboSpan" id="kobo.90.1">
      : Removing unhealthy servers from the pool.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.91.1">
       TLS termination
      </span>
     </strong>
     <span class="koboSpan" id="kobo.92.1">
      : Also handling TLS encryption to reduce server load and system complexity if an API gateway is not present.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.93.1">
       Mitigating Denial of Service (DoS)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.94.1">
      : Distributing the load helps to mitigate DoS attacks.
     </span>
     <span class="koboSpan" id="kobo.94.2">
      This is often the last resort in a DoS attack.
     </span>
     <span class="koboSpan" id="kobo.94.3">
      It would be expected that the WAF and the API gateway would have minimized the impact of an attack at this point.
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-173">
    <a id="_idTextAnchor186">
    </a>
    <span class="koboSpan" id="kobo.95.1">
     When to decrypt the call – TLS termination
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.96.1">
     If a secure call is encrypted, it needs to be decrypted at some point so that its content can be interpreted and processed.
    </span>
    <span class="koboSpan" id="kobo.96.2">
     That
    </span>
    <a id="_idIndexMarker486">
    </a>
    <span class="koboSpan" id="kobo.97.1">
     is called
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.98.1">
      TLS termination
     </span>
    </strong>
    <span class="koboSpan" id="kobo.99.1">
     .
    </span>
    <span class="koboSpan" id="kobo.99.2">
     It refers to the process of decrypting an HTTPS connection and converting it back to a clear-text HTTP communication.
    </span>
    <span class="koboSpan" id="kobo.99.3">
     This typically occurs at the network’s edge, such as within an API gateway, a load balancer, or a reverse proxy server.
    </span>
    <span class="koboSpan" id="kobo.99.4">
     By terminating the TLS encryption at a single point, organizations can offload the computational overhead associated with encryption and decryption from backend servers.
    </span>
    <span class="koboSpan" id="kobo.99.5">
     This process usually happens only once during the life cycle of an API call, ensuring that data remains encrypted while traversing insecure networks but can be processed more efficiently within trusted internal networks.
    </span>
    <span class="koboSpan" id="kobo.99.6">
     TLS termination enhances performance and simplifies certificate management without compromising the security of data in transit over public channels.
    </span>
    <span class="koboSpan" id="kobo.99.7">
     It is important to be aware of when the TLS termination happens, especially when troubleshooting some problems with an API.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.100.1">
     All the security elements that we have briefly discussed so far are undeniably very important, but in modern mid-size and larger organizations, they are usually not the direct responsibility of the software engineer.
    </span>
    <span class="koboSpan" id="kobo.100.2">
     Other professionals oversee them, and therefore they are not the focus of this chapter.
    </span>
    <span class="koboSpan" id="kobo.100.3">
     In contrast, the following security elements are very much the responsibility of the software engineer and we all should have a clear understanding of them.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.101.1">
     As we have discussed, securing API communications is a multi-layered process involving various tools and technologies, each playing a distinct role in protecting data in transit.
    </span>
    <span class="koboSpan" id="kobo.101.2">
     From the encryption provided by HTTPS and TLS to the filtering and monitoring capabilities of WAFs, every layer contributes to a robust defense against cyber threats.
    </span>
    <span class="koboSpan" id="kobo.101.3">
     TLS termination and certificate management further underscore the importance of maintaining both performance and security in modern API ecosystems.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.102.1">
     While these responsibilities are often overseen by dedicated teams in large organizations, it is essential for software engineers to understand how these components work and their implications.
    </span>
    <span class="koboSpan" id="kobo.102.2">
     Having this foundational knowledge allows better collaboration with security teams and DevOps
    </span>
    <a id="_idIndexMarker487">
    </a>
    <span class="koboSpan" id="kobo.103.1">
     engineers to troubleshoot issues effectively when they arise and to make better decisions during design and development.
    </span>
    <span class="koboSpan" id="kobo.103.2">
     With security threats constantly evolving, maintaining an awareness of these practices ensures APIs remain resilient and reliable, forming a secure backbone for any application.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-174">
    <a id="_idTextAnchor187">
    </a>
    <span class="koboSpan" id="kobo.104.1">
     Authentication
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.105.1">
     Authentication is the foundational process of verifying the identity of a user, device, or other entity attempting
    </span>
    <a id="_idIndexMarker488">
    </a>
    <span class="koboSpan" id="kobo.106.1">
     to access your API.
    </span>
    <span class="koboSpan" id="kobo.106.2">
     Authentication is a crucial element in security because it ensures that only legitimate and recognized parties can interact with your services.
    </span>
    <span class="koboSpan" id="kobo.106.3">
     Without proper authentication mechanisms, APIs become vulnerable to unauthorized access, data breaches, and malicious activities that can compromise system integrity and user data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.107.1">
     The primary goal of authentication is to establish the identity of the client requesting access.
    </span>
    <span class="koboSpan" id="kobo.107.2">
     By confirming it, the API can enforce access controls, apply rate limiting, and provide personalized experiences where appropriate.
    </span>
    <span class="koboSpan" id="kobo.107.3">
     Moreover, robust authentication mechanisms are essential for compliance with legal and regulatory requirements, such as the GDPR, HIPAA, LGPD, and other data protection laws.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.108.1">
     Different authentication methods can be employed depending on the level of security required, the nature of the application, and user experience considerations.
    </span>
    <span class="koboSpan" id="kobo.108.2">
     Next, we will break down some of the most common methods.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-175">
    <a id="_idTextAnchor188">
    </a>
    <span class="koboSpan" id="kobo.109.1">
     Password-based authentication
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.110.1">
     Password-based authentication is the most traditional and is still one of the most widely used methods
    </span>
    <a id="_idIndexMarker489">
    </a>
    <span class="koboSpan" id="kobo.111.1">
     of authentication.
    </span>
    <span class="koboSpan" id="kobo.111.2">
     Users provide a username
    </span>
    <a id="_idIndexMarker490">
    </a>
    <span class="koboSpan" id="kobo.112.1">
     and password, which are then verified against credentials stored on the server.
    </span>
    <span class="koboSpan" id="kobo.112.2">
     By its nature, this method is mostly used when a person is authenticating with a system.
    </span>
    <span class="koboSpan" id="kobo.112.3">
     It is hardly ever used in any form of machine-to-machine interaction.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-176">
    <a id="_idTextAnchor189">
    </a>
    <span class="koboSpan" id="kobo.113.1">
     How it works
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.114.1">
     When the user
    </span>
    <a id="_idIndexMarker491">
    </a>
    <span class="koboSpan" id="kobo.115.1">
     attempts to log in, they send their credentials, typically a username and password, to a security service API.
    </span>
    <span class="koboSpan" id="kobo.115.2">
     Upon receiving the credentials, the server hashes the password and compares it with the stored hash in its database.
    </span>
    <span class="koboSpan" id="kobo.115.3">
     If the credentials match, the user is successfully authenticated, and the server generates an
    </span>
    <a id="_idIndexMarker492">
    </a>
    <span class="koboSpan" id="kobo.116.1">
     authentication token, such as a session cookie or a
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.117.1">
      JSON Web Token
     </span>
    </strong>
    <span class="koboSpan" id="kobo.118.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.119.1">
      JWT
     </span>
    </strong>
    <span class="koboSpan" id="kobo.120.1">
     ), to facilitate future requests without the need for repeated credential submission.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-177">
    <a id="_idTextAnchor190">
    </a>
    <span class="koboSpan" id="kobo.121.1">
     Security considerations
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.122.1">
     Passwords should never be stored in plaintext; instead, they must always be hashed using a secure algorithm.
    </span>
    <span class="koboSpan" id="kobo.122.2">
     The hashing process is only as good as the algorithm used.
    </span>
    <span class="koboSpan" id="kobo.122.3">
     Two modern and widely used
    </span>
    <a id="_idIndexMarker493">
    </a>
    <span class="koboSpan" id="kobo.123.1">
     ones are
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.124.1">
      Bcrypt
     </span>
    </em>
    <span class="koboSpan" id="kobo.125.1">
     and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.126.1">
      Argon2
     </span>
    </em>
    <span class="koboSpan" id="kobo.127.1">
     .
    </span>
    <span class="koboSpan" id="kobo.127.2">
     A deeper discussion on hashing algorithms is not in the scope of this chapter, but it is highly recommended to look at how they work.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.128.1">
     Another consideration is brute-force attacks.
    </span>
    <span class="koboSpan" id="kobo.128.2">
     It’s important to implement account lockout mechanisms after a certain number of failed login attempts.
    </span>
    <span class="koboSpan" id="kobo.128.3">
     Additionally, users should be required to create strong passwords by enforcing password policies that include minimum length requirements, the use of special characters, and the avoidance of common or easily guessable words.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.129.1">
     Here are the
    </span>
    <a id="_idIndexMarker494">
    </a>
    <span class="koboSpan" id="kobo.130.1">
     advantages of password-based authentication:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.131.1">
      Simple to implement
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.132.1">
      Easy for users to understand
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.133.1">
     And here
    </span>
    <a id="_idIndexMarker495">
    </a>
    <span class="koboSpan" id="kobo.134.1">
     are the disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.135.1">
      Passwords can be easily stolen or guessed, especially if they are weak
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.136.1">
      It requires robust security measures such as rate limiting and password resets
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.137.1">
      Password reuse across different services makes accounts more vulnerable
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-178">
    <a id="_idTextAnchor191">
    </a>
    <span class="koboSpan" id="kobo.138.1">
     Token-based authentication
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.139.1">
     Token-based authentication relies on the use of tokens—small pieces of data passed between the client
    </span>
    <a id="_idIndexMarker496">
    </a>
    <span class="koboSpan" id="kobo.140.1">
     and server to verify identity.
    </span>
    <span class="koboSpan" id="kobo.140.2">
     A widely adopted token format is JWT, and this is the format we will discuss.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.141.1">
     It is important to understand how a JWT works, specifically the lifespan of a token.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-179">
    <a id="_idTextAnchor192">
    </a>
    <span class="koboSpan" id="kobo.142.1">
     JWT life cycle and utilization
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.143.1">
     The user
    </span>
    <a id="_idIndexMarker497">
    </a>
    <span class="koboSpan" id="kobo.144.1">
     logs in with their credentials, and the
    </span>
    <a id="_idIndexMarker498">
    </a>
    <span class="koboSpan" id="kobo.145.1">
     server generates a token (often a JWT) containing encoded information about the user.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.146.1">
     The server will create and sign the JWT, ensuring its integrity, and send it back to the client.
    </span>
    <span class="koboSpan" id="kobo.146.2">
     The internal mechanism of signing and creating a JWT is beyond the scope of this book.
    </span>
    <span class="koboSpan" id="kobo.146.3">
     See this article for a more complete discussion:
    </span>
    <a href="https://www.freecodecamp.org/news/how-to-sign-and-validate-json-web-tokens/">
     <span class="url">
      <span class="koboSpan" id="kobo.147.1">
       https://www.freecodecamp.org/news/how-to-sign-and-validate-json-web-tokens/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.148.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.149.1">
     From that moment on, the client will include the JWT in the header of all future API requests, typically in a pre-defined header defined by the API development team.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.150.1">
     The server validates the token on each request without needing to check the user credentials again.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.151.1">
     One important
    </span>
    <a id="_idIndexMarker499">
    </a>
    <span class="koboSpan" id="kobo.152.1">
     point to understand
    </span>
    <a id="_idIndexMarker500">
    </a>
    <span class="koboSpan" id="kobo.153.1">
     is that all tokens (JWT or not) must be temporary.
    </span>
    <span class="koboSpan" id="kobo.153.2">
     They must expire at clear and well-defined intervals.
    </span>
    <span class="koboSpan" id="kobo.153.3">
     As a software engineer working on the API layer, you usually don’t have to do anything special to handle this, but frontend applications will have to define a token renewal strategy, and you may have to collaborate and support such tasks.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-180">
    <a id="_idTextAnchor193">
    </a>
    <span class="koboSpan" id="kobo.154.1">
     Structure of a JWT
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.155.1">
     A JWT is
    </span>
    <a id="_idIndexMarker501">
    </a>
    <span class="koboSpan" id="kobo.156.1">
     an encrypted record that follows a well-defined structure.
    </span>
    <span class="koboSpan" id="kobo.156.2">
     So, let’s look inside a JWT and discuss its structure.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.157.1">
     A good tool for viewing and manipulating JWTs can be found at
    </span>
    <a href="https://jwt.io/#debugger-io">
     <span class="url">
      <span class="koboSpan" id="kobo.158.1">
       https://jwt.io/#debugger-io
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.159.1">
     .
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.160.1">
     <img alt="Figure 7.2 – Example JWT" src="../Images/B21843_07_2.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.161.1">
     Figure 7.2 – Example JWT
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.162.1">
     A JWT consists of three distinct parts separated by a dot: the header, payload, and signature.
    </span>
    <span class="koboSpan" id="kobo.162.2">
     As an API
    </span>
    <a id="_idIndexMarker502">
    </a>
    <span class="koboSpan" id="kobo.163.1">
     developer, your focus will be on the payload, as it contains claims (fields) about the user (e.g., user ID, permissions).
    </span>
    <span class="koboSpan" id="kobo.163.2">
     The signature ensures the token hasn’t been tampered with.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.164.1">
     Once decrypted, the data inside a JWT looks like this:
    </span>
   </p>
   <table class="table-container" id="table001">
    <thead>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.165.1">
          Part
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.166.1">
          Field
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.167.1">
          Description
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.168.1">
          Example Value
         </span>
        </strong>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.169.1">
         Header
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.170.1">
          alg
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.171.1">
         Algorithm used to sign or encrypt the token
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.172.1">
          "HS256"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.173.1">
         Header
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.174.1">
          typ
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.175.1">
         Type of token
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.176.1">
          "JWT"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.177.1">
         Header
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.178.1">
          cty
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.179.1">
         Content type of the JWT payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.180.1">
          "JWT"
         </span>
        </code>
        <span class="koboSpan" id="kobo.181.1">
         or
        </span>
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.182.1">
          "application/json"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.183.1">
         Header
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.184.1">
          kid
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.185.1">
         Key ID used to identify the key used in signature
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.186.1">
          "abc123"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.187.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.188.1">
          iss
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.189.1">
         Issuer of the token
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.190.1">
          "auth.example.com"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.191.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.192.1">
          sub
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.193.1">
         Subject
        </span>
        <a id="_idIndexMarker503">
        </a>
        <span class="koboSpan" id="kobo.194.1">
         of the token (usually a user ID)
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.195.1">
          "1234567890"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.196.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.197.1">
          aud
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.198.1">
         Audience for which the token is intended
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.199.1">
          "example.com"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.200.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.201.1">
          exp
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.202.1">
         Expiration time (in Unix time)
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.203.1">
          1516239022
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.204.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.205.1">
          nbf
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.206.1">
         Not valid before this time (in Unix time)
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.207.1">
          1516239022
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.208.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.209.1">
          iat
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.210.1">
         Issued at time (in Unix time)
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.211.1">
          1516239022
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.212.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.213.1">
          jti
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.214.1">
         JWT ID; a unique identifier for the token
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.215.1">
          "unique-token-id-123"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.216.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.217.1">
          name
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.218.1">
         User’s full name
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.219.1">
          "John Doe"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.220.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.221.1">
          email
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.222.1">
         User’s email address
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.223.1">
          "john.doe@example.com"
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.224.1">
         Payload
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.225.1">
          role
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.226.1">
         Roles or permissions assigned to the user
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.227.1">
          "admin"
         </span>
        </code>
        <span class="koboSpan" id="kobo.228.1">
         or
        </span>
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.229.1">
          ["admin", "user"]
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.230.1">
         Signature
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.231.1">
         N/A
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.232.1">
         Digital signature for verifying the token’s integrity
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.233.1">
         (Result of cryptographic operation)
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.234.1">
     Table 7.1 – An example JWT
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.235.1">
     The header can be customized to adjust to the needs of each organization.
    </span>
    <span class="koboSpan" id="kobo.235.2">
     But at a minimum, you should see
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.236.1">
      "alg"
     </span>
    </code>
    <span class="koboSpan" id="kobo.237.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.238.1">
      "typ"
     </span>
    </code>
    <span class="koboSpan" id="kobo.239.1">
     entries present.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.240.1">
     The payload is also mostly defined by the organization.
    </span>
    <span class="koboSpan" id="kobo.240.2">
     Each entry in the payload is called a
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.241.1">
      claim
     </span>
    </strong>
    <span class="koboSpan" id="kobo.242.1">
     and is used to identify the users, their roles, unique information, and any other data element that can be used by the APIs to best control access to the data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.243.1">
     Special attention
    </span>
    <a id="_idIndexMarker504">
    </a>
    <span class="koboSpan" id="kobo.244.1">
     should be given to the three time-based claims –
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.245.1">
      exp
     </span>
    </code>
    <span class="koboSpan" id="kobo.246.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.247.1">
      nbf
     </span>
    </code>
    <span class="koboSpan" id="kobo.248.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.249.1">
      iat
     </span>
    </code>
    <span class="koboSpan" id="kobo.250.1">
     .
    </span>
    <span class="koboSpan" id="kobo.250.2">
     They are crucial to verify whether the JWT is valid at the time of execution of the API.
    </span>
    <span class="koboSpan" id="kobo.250.3">
     Ideally, they should not be omitted, although
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.251.1">
      "nbf"
     </span>
    </code>
    <span class="koboSpan" id="kobo.252.1">
     is sometimes not defined.
    </span>
    <span class="koboSpan" id="kobo.252.2">
     In that case, it is assumed that the JWT is valid from the moment it is created (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.253.1">
      "iat"
     </span>
    </code>
    <span class="koboSpan" id="kobo.254.1">
     ).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.255.1">
     In general, there are three classifications for claims:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.256.1">
       Registered claims
      </span>
     </strong>
     <span class="koboSpan" id="kobo.257.1">
      : Predefined claims widely used in the industry, such as
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.258.1">
       iss
      </span>
     </code>
     <span class="koboSpan" id="kobo.259.1">
      ,
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.260.1">
       exp
      </span>
     </code>
     <span class="koboSpan" id="kobo.261.1">
      , and
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.262.1">
       sub
      </span>
     </code>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.263.1">
       Public claims
      </span>
     </strong>
     <span class="koboSpan" id="kobo.264.1">
      : Custom claims agreed upon by parties using the JWT
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.265.1">
       Private claims
      </span>
     </strong>
     <span class="koboSpan" id="kobo.266.1">
      : Custom claims used in contexts specific to your application
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-181">
    <a id="_idTextAnchor194">
    </a>
    <span class="koboSpan" id="kobo.267.1">
     Statelessness
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.268.1">
     One of the key benefits of token-based authentication is that the server doesn’t need to store session state
    </span>
    <a id="_idIndexMarker505">
    </a>
    <span class="koboSpan" id="kobo.269.1">
     validation information.
    </span>
    <span class="koboSpan" id="kobo.269.2">
     All necessary information is contained in the token itself and is sent over in each call.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.270.1">
     Frequently, it is necessary to store session state on the server side, but no credentials or user identification should be stored, only references to the tokens used.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-182">
    <a id="_idTextAnchor195">
    </a>
    <span class="koboSpan" id="kobo.271.1">
     Security considerations
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.272.1">
     JWTs are part of a general security strategy, and as such should be treated as data to be secured in
    </span>
    <a id="_idIndexMarker506">
    </a>
    <span class="koboSpan" id="kobo.273.1">
     themselves.
    </span>
    <span class="koboSpan" id="kobo.273.2">
     Therefore, here are some specific security concerns about the JWTs:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.274.1">
      Always use HTTPS to transmit tokens, as tokens are susceptible to interception in plaintext
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.275.1">
      Set token expiration times to limit the window of vulnerability
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.276.1">
      Use short-lived tokens with refresh tokens to minimize the risk of token theft
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.277.1">
      Securely store tokens on the client side, avoiding local storage if possible
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.278.1">
     These are the
    </span>
    <a id="_idIndexMarker507">
    </a>
    <span class="koboSpan" id="kobo.279.1">
     advantages of a JWT strategy:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.280.1">
      Stateless authentication scales well in distributed systems
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.281.1">
      There’s no need to store session information on the server
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.282.1">
      It allows granular control over access rights using token claims
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.283.1">
     And these
    </span>
    <a id="_idIndexMarker508">
    </a>
    <span class="koboSpan" id="kobo.284.1">
     are some disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.285.1">
      Tokens, if stolen, can be used to impersonate the user
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.286.1">
      Managing token expiration and secure refresh cycles will add complexity to the application, both the frontend and the backend
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-183">
    <a id="_idTextAnchor196">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     Caveats
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.288.1">
     One problem that sometimes happens is JWT inflation, where the organization keeps adding more claims or long lists of values to claims to the point that the JWT grows beyond the limits defined on
    </span>
    <a id="_idIndexMarker509">
    </a>
    <span class="koboSpan" id="kobo.289.1">
     the server.
    </span>
    <span class="koboSpan" id="kobo.289.2">
     Even if the JWT specs do not define an upper limit, remember that the token will be sent over as part of the HTTP header, and there is always a limit for them.
    </span>
    <span class="koboSpan" id="kobo.289.3">
     If you start receiving
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.290.1">
      HTTP 413 Content Too Large
     </span>
    </strong>
    <span class="koboSpan" id="kobo.291.1">
     errors, one possible culprit could be the size of your JWT.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.292.1">
     In summary, using JWTs to manage authentication and authorization is a well-established strategy that has good industry support and relies upon solid technologies.
    </span>
    <span class="koboSpan" id="kobo.292.2">
     However, a large portion of its effectiveness is due to how it is used by the application.
    </span>
    <span class="koboSpan" id="kobo.292.3">
     It is your responsibility as the software engineer to make sure good and well-managed policies are put in place.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-184">
    <a id="_idTextAnchor197">
    </a>
    <span class="koboSpan" id="kobo.293.1">
     Multi-factor authentication
    </span>
   </h2>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.294.1">
      Multi-factor authentication
     </span>
    </strong>
    <span class="koboSpan" id="kobo.295.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.296.1">
      MFA
     </span>
    </strong>
    <span class="koboSpan" id="kobo.297.1">
     ) adds an additional layer of security by requiring the user to provide
    </span>
    <a id="_idIndexMarker510">
    </a>
    <span class="koboSpan" id="kobo.298.1">
     more than one form of identification.
    </span>
    <span class="koboSpan" id="kobo.298.2">
     This typically includes something they know (e.g., password), something they have (e.g., mobile phone or security token), or something they are (e.g., fingerprint or face recognition).
    </span>
    <span class="koboSpan" id="kobo.298.3">
     This is mostly a client-side strategy and has little effect on API development, but it is important for backend engineers to understand its general concepts.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.299.1">
     MFA is part
    </span>
    <a id="_idIndexMarker511">
    </a>
    <span class="koboSpan" id="kobo.300.1">
     of the authentication dialog, so, after a user has successfully entered their password, they are prompted to provide a second factor, such as a code generated by a mobile app (e.g., Google Authenticator) or sent via SMS.
    </span>
    <span class="koboSpan" id="kobo.300.2">
     The server then verifies the second factor before granting access, usually by generating a JWT to be used by the client when accessing the APIs.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-185">
    <a id="_idTextAnchor198">
    </a>
    <span class="koboSpan" id="kobo.301.1">
     What can be used in MFA?
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.302.1">
     Generally
    </span>
    <a id="_idIndexMarker512">
    </a>
    <span class="koboSpan" id="kobo.303.1">
     speaking, there are three types of MFA:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.304.1">
       Something you know
      </span>
     </strong>
     <span class="koboSpan" id="kobo.305.1">
      : A password, PIN, or answer to a security question
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.306.1">
       Something you have
      </span>
     </strong>
     <span class="koboSpan" id="kobo.307.1">
      : A physical device such as a phone or hardware token that generates a temporary passcode
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.308.1">
       Something you are
      </span>
     </strong>
     <span class="koboSpan" id="kobo.309.1">
      : Biometric data such as a fingerprint, facial recognition, or iris scan
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-186">
    <a id="_idTextAnchor199">
    </a>
    <span class="koboSpan" id="kobo.310.1">
     Security considerations
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.311.1">
     Let’s see
    </span>
    <a id="_idIndexMarker513">
    </a>
    <span class="koboSpan" id="kobo.312.1">
     what we should consider with regard to security when using MFA:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.313.1">
      MFA drastically reduces the likelihood of account compromise, even if a password is stolen.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.314.1">
       Time-based one-time passwords
      </span>
     </strong>
     <span class="koboSpan" id="kobo.315.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.316.1">
       TOTPs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.317.1">
      ) are commonly used for MFA.
     </span>
     <span class="koboSpan" id="kobo.317.2">
      Ensure that
     </span>
     <a id="_idIndexMarker514">
     </a>
     <span class="koboSpan" id="kobo.318.1">
      those tokens are properly time-synchronized and expire after a short period.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.319.1">
      SMS-based MFA is vulnerable to SIM swapping and should be avoided where possible.
     </span>
     <span class="koboSpan" id="kobo.319.2">
      Use app-based authenticators or hardware tokens instead.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.320.1">
     Let’s
    </span>
    <a id="_idIndexMarker515">
    </a>
    <span class="koboSpan" id="kobo.321.1">
     look at the advantages of MFA:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.322.1">
      It significantly enhances security by requiring multiple forms of verification
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.323.1">
      It protects against common attacks such as password phishing and brute-force attacks
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.324.1">
     And let’s
    </span>
    <a id="_idIndexMarker516">
    </a>
    <span class="koboSpan" id="kobo.325.1">
     see some of the disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.326.1">
      It can be cumbersome for users, especially in environments with frequent logins
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.327.1">
      It requires infrastructure to support the second factor, such as maintaining SMS gateways or integrating with an authenticator app
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-187">
    <a id="_idTextAnchor200">
    </a>
    <span class="koboSpan" id="kobo.328.1">
     Biometric authentication
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.329.1">
     Biometric authentication uses physical characteristics like fingerprints, facial recognition, or voice to verify
    </span>
    <a id="_idIndexMarker517">
    </a>
    <span class="koboSpan" id="kobo.330.1">
     a user’s identity.
    </span>
    <span class="koboSpan" id="kobo.330.2">
     With the increasing availability of
    </span>
    <a id="_idIndexMarker518">
    </a>
    <span class="koboSpan" id="kobo.331.1">
     biometric sensors on mobile devices and laptops, it’s becoming a more common method of authentication.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.332.1">
     Let’s
    </span>
    <a id="_idIndexMarker519">
    </a>
    <span class="koboSpan" id="kobo.333.1">
     see how it works:
    </span>
   </p>
   <ol>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.334.1">
      The user’s biometric data (fingerprint, face scan, etc.) is captured and stored securely on the device.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.335.1">
      When the user attempts to authenticate, the API compares the captured data with the stored biometric template to verify their identity.
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.336.1">
     Here are
    </span>
    <a id="_idIndexMarker520">
    </a>
    <span class="koboSpan" id="kobo.337.1">
     some common biometric authentication methods:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.338.1">
       Fingerprint scanning
      </span>
     </strong>
     <span class="koboSpan" id="kobo.339.1">
      : Used extensively on mobile devices
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.340.1">
       Facial recognition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.341.1">
      : Built into many smartphones and laptops
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.342.1">
       Voice recognition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.343.1">
      : Sometimes used for telephonic authentication
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.344.1">
     Let’s see
    </span>
    <a id="_idIndexMarker521">
    </a>
    <span class="koboSpan" id="kobo.345.1">
     some of the security considerations:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.346.1">
      Biometric data is unique to each user, making it difficult to forge
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.347.1">
      Store biometric data locally, not on the server, to prevent mass breaches
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.348.1">
      Ensure biometric systems have fallback options (such as passwords) for cases where biometrics fail (e.g., injury or hardware malfunction)
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.349.1">
     These are
    </span>
    <a id="_idIndexMarker522">
    </a>
    <span class="koboSpan" id="kobo.350.1">
     some advantages of biometric authentication:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.351.1">
      It provides a high level of security
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.352.1">
      It is convenient for users—there’s no need to remember passwords
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.353.1">
     Here are
    </span>
    <a id="_idIndexMarker523">
    </a>
    <span class="koboSpan" id="kobo.354.1">
     some of the disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.355.1">
      Biometric data is irreversible—once compromised, it cannot be changed
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.356.1">
      There are potential privacy concerns around the collection and storage of biometric data
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.357.1">
      It is less reliable in certain conditions (e.g., wet fingerprints or poor lighting for facial recognition)
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.358.1">
     Choosing the
    </span>
    <a id="_idIndexMarker524">
    </a>
    <span class="koboSpan" id="kobo.359.1">
     right authentication method depends on the application’s requirements and the sensitivity of the data it handles.
    </span>
    <span class="koboSpan" id="kobo.359.2">
     While password-based authentication
    </span>
    <a id="_idIndexMarker525">
    </a>
    <span class="koboSpan" id="kobo.360.1">
     remains prevalent, more secure methods, such as token-based authentication, MFA, and biometric authentication, are rapidly gaining ground.
    </span>
    <span class="koboSpan" id="kobo.360.2">
     Combining these methods, such as using MFA in conjunction with JWTs, can provide a robust and flexible authentication mechanism for APIs, ensuring the security of both users and data.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-188">
    <a id="_idTextAnchor201">
    </a>
    <span class="koboSpan" id="kobo.361.1">
     Authorization
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.362.1">
     Once you have
    </span>
    <a id="_idIndexMarker526">
    </a>
    <span class="koboSpan" id="kobo.363.1">
     your API guarded against unknown users by authentication, the next step is to apply authorization mechanisms.
    </span>
    <span class="koboSpan" id="kobo.363.2">
     This is where the system determines whether an authenticated entity (user, device, or service) has permission to access a specific resource or perform a particular action.
    </span>
    <span class="koboSpan" id="kobo.363.3">
     While authentication verifies identity, authorization governs access, ensuring that the authenticated entity only has access to the resources and operations for which they have been granted permission.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.364.1">
     In API security, proper authorization is essential for enforcing business rules, safeguarding sensitive data, and ensuring
    </span>
    <a id="_idIndexMarker527">
    </a>
    <span class="koboSpan" id="kobo.365.1">
     that each user or service only performs the actions and accesses the information they are allowed to.
    </span>
    <span class="koboSpan" id="kobo.365.2">
     So, let’s look at the different techniques we can use to implement authorization.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-189">
    <a id="_idTextAnchor202">
    </a>
    <span class="koboSpan" id="kobo.366.1">
     Role-based access control
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.367.1">
     One of the most common authorization mechanisms is
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.368.1">
      role-based access control
     </span>
    </strong>
    <span class="koboSpan" id="kobo.369.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.370.1">
      RBAC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.371.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.371.2">
     RBAC works
    </span>
    <a id="_idIndexMarker528">
    </a>
    <span class="koboSpan" id="kobo.372.1">
     by assigning predefined roles to
    </span>
    <a id="_idIndexMarker529">
    </a>
    <span class="koboSpan" id="kobo.373.1">
     users or entities and associating permissions with those roles.
    </span>
    <span class="koboSpan" id="kobo.373.2">
     Each role is granted access to specific API endpoints or functionalities, depending on the application’s security requirements.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.374.1">
     Let’s see
    </span>
    <a id="_idIndexMarker530">
    </a>
    <span class="koboSpan" id="kobo.375.1">
     how RBAC works:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.376.1">
      Users are assigned one or more roles, such as admin, user, or editor.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.377.1">
      API endpoints or resources are protected by role checks.
     </span>
     <span class="koboSpan" id="kobo.377.2">
      For example, only users with the admin role might have access to the /admin endpoints.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.378.1">
      When an API request is made, the server checks the user’s assigned roles against the roles required for the requested resource.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.379.1">
     These are
    </span>
    <a id="_idIndexMarker531">
    </a>
    <span class="koboSpan" id="kobo.380.1">
     some of the advantages of RBAC:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.381.1">
      It simplifies permission management by grouping permissions into roles
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.382.1">
      It is easy to implement and scale, particularly in enterprise applications where roles can be defined centrally
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.383.1">
      It is fully supported by many solutions, such as the claims in JWT
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.384.1">
     Here are
    </span>
    <a id="_idIndexMarker532">
    </a>
    <span class="koboSpan" id="kobo.385.1">
     some of the disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.386.1">
      It can be inflexible in complex systems where fine-grained access control is required, leading to role explosion or data leaks
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.387.1">
      It can cause unexpected exposure in complex systems, as roles may be inconsistent or incompatible with each other
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-190">
    <a id="_idTextAnchor203">
    </a>
    <span class="koboSpan" id="kobo.388.1">
     Attribute-based access control
    </span>
   </h3>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.389.1">
      Attribute-based access control
     </span>
    </strong>
    <span class="koboSpan" id="kobo.390.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.391.1">
      ABAC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.392.1">
     ) provides
    </span>
    <a id="_idIndexMarker533">
    </a>
    <span class="koboSpan" id="kobo.393.1">
     more granular
    </span>
    <a id="_idIndexMarker534">
    </a>
    <span class="koboSpan" id="kobo.394.1">
     control than RBAC by using attributes (user attributes, environment attributes, resource attributes, etc.) to determine access rights.
    </span>
    <span class="koboSpan" id="kobo.394.2">
     Attributes are metadata that describe entities or actions and are evaluated against policies to decide whether access is allowed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.395.1">
     Let’s see
    </span>
    <a id="_idIndexMarker535">
    </a>
    <span class="koboSpan" id="kobo.396.1">
     how ABAC works:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.397.1">
      Policies are written to define the conditions under which access is granted.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.398.1">
      Attributes such as user role, time of request, resource type, or location are considered.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.399.1">
      Access decisions are made dynamically, based on real-time evaluation of attributes and policies.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.400.1">
     These are
    </span>
    <a id="_idIndexMarker536">
    </a>
    <span class="koboSpan" id="kobo.401.1">
     some of the advantages of using ABAC:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.402.1">
      It provides flexibility by allowing fine-grained control based on dynamic conditions
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.403.1">
      It is scalable for complex systems in which RBAC would become difficult to manage
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.404.1">
     And here
    </span>
    <a id="_idIndexMarker537">
    </a>
    <span class="koboSpan" id="kobo.405.1">
     are some disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.406.1">
      It is more complex to implement and manage than RBAC.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.407.1">
      It can result in performance overhead due to real-time policy evaluations.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.408.1">
      It can cause unexpected security issues due to mismanaged attributes.
     </span>
     <span class="koboSpan" id="kobo.408.2">
      For example, an employee changes positions in the company but the system still allows them to see data from the previous job.
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-191">
    <a id="_idTextAnchor204">
    </a>
    <span class="koboSpan" id="kobo.409.1">
     OAuth 2.0
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.410.1">
     OAuth 2.0 is one
    </span>
    <a id="_idIndexMarker538">
    </a>
    <span class="koboSpan" id="kobo.411.1">
     of the most widely used authorization frameworks for APIs.
    </span>
    <span class="koboSpan" id="kobo.411.2">
     It allows a
    </span>
    <a id="_idIndexMarker539">
    </a>
    <span class="koboSpan" id="kobo.412.1">
     user to grant a third-party application limited access to their resources without exposing their credentials.
    </span>
    <span class="koboSpan" id="kobo.412.2">
     OAuth 2.0 is commonly used for delegating access to APIs and provides a standardized method for authorization across web, mobile, and cloud applications.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.413.1">
     Let’s see
    </span>
    <a id="_idIndexMarker540">
    </a>
    <span class="koboSpan" id="kobo.414.1">
     how OAuth 2.0 works:
    </span>
   </p>
   <ol>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.415.1">
      The user authenticates with an identity provider (e.g., Google, Facebook) and grants permission to a third-party application.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.416.1">
      The third-party application receives an access token, which it uses to make authorized API requests on behalf of the user.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.417.1">
      The access token contains scopes, which define the level of access the third-party application has (e.g., read-only, write).
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.418.1">
     Let’s see some security considerations:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.419.1">
      Always use HTTPS to transmit OAuth tokens
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.420.1">
      Use short-lived
     </span>
     <a id="_idIndexMarker541">
     </a>
     <span class="koboSpan" id="kobo.421.1">
      access tokens and refresh tokens to minimize risk in case of token theft
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.422.1">
      Implement token revocation mechanisms to invalidate tokens if necessary
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.423.1">
     Here are
    </span>
    <a id="_idIndexMarker542">
    </a>
    <span class="koboSpan" id="kobo.424.1">
     the advantages of using Oauth2.0:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.425.1">
      It allows delegated access without sharing user credentials
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.426.1">
      It has been widely adopted, providing standardization across many services
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.427.1">
     And here
    </span>
    <a id="_idIndexMarker543">
    </a>
    <span class="koboSpan" id="kobo.428.1">
     are some disadvantages:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.429.1">
      It requires the implementation of secure token storage and transmission mechanisms
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.430.1">
      It can add complexity, especially when managing refresh tokens and token expiration
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-192">
    <a id="_idTextAnchor205">
    </a>
    <span class="koboSpan" id="kobo.431.1">
     JWT for authorization
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.432.1">
     JWTs, which
    </span>
    <a id="_idIndexMarker544">
    </a>
    <span class="koboSpan" id="kobo.433.1">
     were discussed in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.434.1">
      Authentication
     </span>
    </em>
    <span class="koboSpan" id="kobo.435.1">
     section, also play a key role in authorization.
    </span>
    <span class="koboSpan" id="kobo.435.2">
     After authentication, a JWT can be issued
    </span>
    <a id="_idIndexMarker545">
    </a>
    <span class="koboSpan" id="kobo.436.1">
     containing claims that specify the user’s roles or permissions.
    </span>
    <span class="koboSpan" id="kobo.436.2">
     These claims can then be used by the API to enforce access controls.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.437.1">
     Let’s see
    </span>
    <a id="_idIndexMarker546">
    </a>
    <span class="koboSpan" id="kobo.438.1">
     how JWT authorization works:
    </span>
   </p>
   <ol>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.439.1">
      The user is authenticated, and a JWT is issued containing claims such as user roles or permissions.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.440.1">
      The client includes the JWT in the authorization header in future API requests.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.441.1">
      The server decodes the JWT and checks the claims to determine whether the user is authorized to access the requested resource.
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.442.1">
     JWTs allow stateless authorization, meaning the server doesn’t need to maintain session state because the necessary authorization information is embedded in the token itself.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.443.1">
     Let’s see some
    </span>
    <a id="_idIndexMarker547">
    </a>
    <span class="koboSpan" id="kobo.444.1">
     of the advantages of using JWT authorization:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.445.1">
      It scales well in distributed systems by eliminating the need for server-side session storage
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.446.1">
      It enables fine-grained control using claims inside the JWT
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.447.1">
     As for disadvantages, it requires
    </span>
    <a id="_idIndexMarker548">
    </a>
    <span class="koboSpan" id="kobo.448.1">
     careful management of token expiration and revocation to prevent unauthorized access.
    </span>
    <span class="koboSpan" id="kobo.448.2">
     This is the biggest drawback of JWT and any other attribute-based authorization.
    </span>
    <span class="koboSpan" id="kobo.448.3">
     It is important to ensure the claims in the JWT reflect the actual roles of this user.
    </span>
    <span class="koboSpan" id="kobo.448.4">
     Once again, the case of an employee changing positions in the company comes to mind, potentially causing data access violations.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-193">
    <a id="_idTextAnchor206">
    </a>
    <span class="koboSpan" id="kobo.449.1">
     Fine-grained access control
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.450.1">
     In some systems, the level of access control required goes beyond the basic capabilities of RBAC or even ABAC.
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.451.1">
      Fine-grained access control
     </span>
    </strong>
    <span class="koboSpan" id="kobo.452.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.453.1">
      FGAC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.454.1">
     ) allows more nuanced control over access to
    </span>
    <a id="_idIndexMarker549">
    </a>
    <span class="koboSpan" id="kobo.455.1">
     resources, based on attributes such as user identity, resource ownership, and contextual data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.456.1">
     These levels
    </span>
    <a id="_idIndexMarker550">
    </a>
    <span class="koboSpan" id="kobo.457.1">
     of FGAC are usually found in complex business domains; healthcare and finance are two very common cases.
    </span>
    <span class="koboSpan" id="kobo.457.2">
     Healthcare, being a highly regulated industry, has many different rules that need to be applied to any data access.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.458.1">
     Here are
    </span>
    <a id="_idIndexMarker551">
    </a>
    <span class="koboSpan" id="kobo.459.1">
     some examples of FGAC:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.460.1">
      A user can access only their own profile data, not other users’ data
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.461.1">
      A service can only modify resources that it has created
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.462.1">
      Access to sensitive resources might be restricted based on location, time of day, or other contextual information
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.463.1">
      A customer on a healthcare insurance system can see all payments made to their account but can only see claims payments for their claims and other dependents that they are legally allowed to
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.464.1">
     Let’s take a closer
    </span>
    <a id="_idIndexMarker552">
    </a>
    <span class="koboSpan" id="kobo.465.1">
     look at that last example, as it illustrates the challenges of FGAC.
    </span>
   </p>
   <p class="normal">
    <em class="italic">
     <span class="koboSpan" id="kobo.466.1">
      Case
     </span>
    </em>
    <span class="koboSpan" id="kobo.467.1">
     : A client is required to keep their ex-spouse on their healthcare policy for a specified time.
    </span>
    <span class="koboSpan" id="kobo.467.2">
     During this time, the main client cannot see any of the spouse’s medical information, but can see the costs associated with their treatment.
    </span>
    <span class="koboSpan" id="kobo.467.3">
     There are several challenges in this case.
    </span>
    <span class="koboSpan" id="kobo.467.4">
     Where do we look for the mandatory amount of time to keep the spouse on the policy?
    </span>
    <span class="koboSpan" id="kobo.467.5">
     How do we isolate the spouse’s data in a family request?
    </span>
    <span class="koboSpan" id="kobo.467.6">
     How do we allow some financial data to be exposed but not medical information?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.468.1">
     Those are not simple questions to answer and may make that piece of the system more complex than it would be otherwise.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.469.1">
     This case requires careful design and policy enforcement.
    </span>
    <span class="koboSpan" id="kobo.469.2">
     It could increase the complexity of the application, particularly in large systems.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-194">
    <a id="_idTextAnchor207">
    </a>
    <span class="koboSpan" id="kobo.470.1">
     Best practices for API authorization
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.471.1">
     In summary, here
    </span>
    <a id="_idIndexMarker553">
    </a>
    <span class="koboSpan" id="kobo.472.1">
     are some guidelines to make sure your API
    </span>
    <a id="_idIndexMarker554">
    </a>
    <span class="koboSpan" id="kobo.473.1">
     is as secure as you can make it:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.474.1">
       Use the principle of least privilege
      </span>
     </strong>
     <span class="koboSpan" id="kobo.475.1">
      : Only grant users and services the minimal permissions necessary to perform their tasks
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.476.1">
       Implement layered authorization mechanisms
      </span>
     </strong>
     <span class="koboSpan" id="kobo.477.1">
      : Combine RBAC with ABAC or OAuth for more flexible and secure access control
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.478.1">
       Regularly audit permissions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.479.1">
      : Periodically review and update roles, permissions, and access policies to ensure they align with current business needs
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.480.1">
       Secure tokens
      </span>
     </strong>
     <span class="koboSpan" id="kobo.481.1">
      : Always use secure storage and transmission methods for tokens (e.g., OAuth tokens, JWTs) to prevent unauthorized access
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.482.1">
     Authorization, when designed and implemented effectively, ensures that your API remains secure, responsive, and compliant with regulatory requirements.
    </span>
    <span class="koboSpan" id="kobo.482.2">
     By choosing the right authorization strategy—whether RBAC, ABAC, OAuth, or JWT-based—you can tailor access control to your system’s specific needs while protecting data and ensuring users can only perform the actions they are entitled to.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-195">
    <a id="_idTextAnchor208">
    </a>
    <span class="koboSpan" id="kobo.483.1">
     OWASP API Security Top 10 overview
    </span>
   </h1>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.484.1">
      OWASP
     </span>
    </strong>
    <span class="koboSpan" id="kobo.485.1">
     stands for
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.486.1">
      Open Web Application Security Project
     </span>
    </strong>
    <span class="koboSpan" id="kobo.487.1">
     , a non-profit organization that focuses
    </span>
    <a id="_idIndexMarker555">
    </a>
    <span class="koboSpan" id="kobo.488.1">
     on web application security.
    </span>
    <span class="koboSpan" id="kobo.488.2">
     They do a phenomenal job at documenting known security issues and helping developers and organizations to
    </span>
    <a id="_idIndexMarker556">
    </a>
    <span class="koboSpan" id="kobo.489.1">
     secure web applications.
    </span>
    <span class="koboSpan" id="kobo.489.2">
     One of the main contributions is the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.490.1">
      OWASP API Security Top 10
     </span>
    </strong>
    <span class="koboSpan" id="kobo.491.1">
     , which identifies the most critical security risks for APIs.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.492.1">
     OWASP is a crucial resource for all software engineers, and you should periodically look at the published lists of concerns and new security white papers.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.493.1">
     The most recent list was published in 2023 and can be found here:
    </span>
    <a href="https://owasp.org/API-Security/editions/2023/en/0x11-t10/">
     <span class="url">
      <span class="koboSpan" id="kobo.494.1">
       https://owasp.org/API-Security/editions/2023/en/0x11-t10/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.495.1">
     .
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.496.1">
      API1:2023 - Broken Object Level Authorization
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.497.1">
      API2:2023 - Broken Authentication
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.498.1">
      API3:2023 - Broken Object Property Level Authorization
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.499.1">
      API4:2023 - Unrestricted Resource Consumption
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.500.1">
      API5:2023 - Broken Function Level Authorization
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.501.1">
      API6:2023 - Unrestricted Access to Sensitive Business Flows
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.502.1">
      API7:2023 - Server Side Request Forgery
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.503.1">
      API8:2023 - Security Misconfiguration
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.504.1">
      API9:2023 - Improper Inventory Management
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.505.1">
      API10:2023 - Unsafe Consumption of APIs
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.506.1">
     As you can see, all the top OWASP concerns are the topics we have been discussing in this chapter so far.
    </span>
    <span class="koboSpan" id="kobo.506.2">
     It is important to be well acquainted with the OWASP list as it evolves, so visit frequently the OWASP Top Ten API Security Risks at the link provided previously.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-196">
    <a id="_idTextAnchor209">
    </a>
    <span class="koboSpan" id="kobo.507.1">
     Understanding Common Vulnerabilities and Exposures
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.508.1">
     The phrase “our society runs on software” is not new and describes most modern societies, and consequently, software security has emerged as a core concern for governments and organizations worldwide.
    </span>
    <span class="koboSpan" id="kobo.508.2">
     Cyber threats are evolving at an unprecedented pace, and vulnerabilities
    </span>
    <a id="_idIndexMarker557">
    </a>
    <span class="koboSpan" id="kobo.509.1">
     in software can lead to significant financial losses, reputational damage, and legal repercussions.
    </span>
    <span class="koboSpan" id="kobo.509.2">
     In the same week as this chapter was written, the largest DDoS attack in history targeted Cloudflare (you can find a detailed discussion here:
    </span>
    <a href="https://www.linkedin.com/pulse/cloudflare-mitigates-historic-world-record-56-tbps-hoccc/">
     <span class="url">
      <span class="koboSpan" id="kobo.510.1">
       https://www.linkedin.com/pulse/cloudflare-mitigates-historic-world-record-56-tbps-hoccc/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.511.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.511.2">
     It is suspected that the scale of this attack was achieved by exploiting vulnerabilities in many IoT devices, but the details are still being discovered.
    </span>
    <span class="koboSpan" id="kobo.511.3">
     Therefore, for Java software engineers, understanding and managing these vulnerabilities is fundamental for developing secure and robust applications.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.512.1">
     One of the fundamental aspects of software security is the identification and mitigation of known vulnerabilities, commonly referred to as
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.513.1">
      Common Vulnerabilities and Exposures
     </span>
    </strong>
    <span class="koboSpan" id="kobo.514.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.515.1">
      CVEs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.516.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.516.2">
     This chapter aims to provide an in-depth exploration of CVEs from the perspective of a professional Java software engineer.
    </span>
    <span class="koboSpan" id="kobo.516.3">
     We will delve into the definition of CVEs, the mechanisms used to discover and document them, and their structural composition.
    </span>
    <span class="koboSpan" id="kobo.516.4">
     Additionally, we will highlight the best resources for tracking CVEs and discuss software scanners that help identify these vulnerabilities.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.517.1">
     Furthermore, we will examine effective strategies for managing CVEs, including continuous dependency upgrades, dependency management practices, proactive dependency updates, and reactive upgrades based on scan reports.
    </span>
    <span class="koboSpan" id="kobo.517.2">
     By understanding and implementing these strategies, software engineers can enhance the security posture of their applications and contribute to a safer digital ecosystem.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-197">
    <a id="_idTextAnchor210">
    </a>
    <span class="koboSpan" id="kobo.518.1">
     What are CVEs?
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.519.1">
     The CVE
    </span>
    <a id="_idIndexMarker558">
    </a>
    <span class="koboSpan" id="kobo.520.1">
     system is a standardized method for identifying and cataloging security vulnerabilities and exposures in software and firmware.
    </span>
    <span class="koboSpan" id="kobo.520.2">
     Managed by the MITRE Corporation, CVE provides a unique identifier for each disclosed vulnerability, allowing consistent references across various security tools, databases, and communications.
    </span>
    <span class="koboSpan" id="kobo.520.3">
     A CVE entry typically includes an identification number, a brief description of the vulnerability, and references to related advisories, reports, and patches.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.521.1">
     For Java
    </span>
    <a id="_idIndexMarker559">
    </a>
    <span class="koboSpan" id="kobo.522.1">
     software engineers, CVEs are particularly significant due to the widespread use of Java libraries and frameworks, which can introduce vulnerabilities into applications if not properly managed.
    </span>
    <span class="koboSpan" id="kobo.522.2">
     Understanding CVEs enables developers to do the following:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.523.1">
       Identify vulnerabilities
      </span>
     </strong>
     <span class="koboSpan" id="kobo.524.1">
      : Recognize known security issues in the libraries and components they use
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.525.1">
       Assess impact
      </span>
     </strong>
     <span class="koboSpan" id="kobo.526.1">
      : Evaluate the potential impact of a vulnerability on their applications
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.527.1">
       Implement mitigations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.528.1">
      : Apply patches or updates to address vulnerabilities promptly
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.529.1">
       Maintain compliance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.530.1">
      : Adhere to security policies and regulatory requirements by managing known vulnerabilities
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-198">
    <a id="_idTextAnchor211">
    </a>
    <span class="koboSpan" id="kobo.531.1">
     How are CVEs found and documented?
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.532.1">
     The discovery of vulnerabilities is a collaborative effort involving security researchers, developers, and
    </span>
    <a id="_idIndexMarker560">
    </a>
    <span class="koboSpan" id="kobo.533.1">
     automated tools.
    </span>
    <span class="koboSpan" id="kobo.533.2">
     The following are common mechanisms for finding vulnerabilities:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.534.1">
       Security research
      </span>
     </strong>
     <span class="koboSpan" id="kobo.535.1">
      : Security professionals and researchers actively analyze software to identify potential vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.535.2">
      This process may involve the following:
     </span>
     <ul>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.536.1">
         Code auditing
        </span>
       </strong>
       <span class="koboSpan" id="kobo.537.1">
        : Manually reviewing source code for insecure coding practices
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.538.1">
         Penetration testing
        </span>
       </strong>
       <span class="koboSpan" id="kobo.539.1">
        : Simulating attacks to find weaknesses in running applications
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.540.1">
         Fuzz testing
        </span>
       </strong>
       <span class="koboSpan" id="kobo.541.1">
        : Providing invalid or random data to programs to trigger unexpected behavior
       </span>
      </li>
     </ul>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.542.1">
       Bug bounty programs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.543.1">
      : Many organizations offer bug bounty programs, incentivizing independent researchers to find and report vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.543.2">
      These programs help uncover issues that might be missed by internal teams.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.544.1">
       Automated scanning tools
      </span>
     </strong>
     <span class="koboSpan" id="kobo.545.1">
      : Tools
     </span>
     <a id="_idIndexMarker561">
     </a>
     <span class="koboSpan" id="kobo.546.1">
      such as static code analyzers and
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.547.1">
       dynamic application security testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.548.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.549.1">
       DAST
      </span>
     </strong>
     <span class="koboSpan" id="kobo.550.1">
      ) tools automatically scan code bases and running
     </span>
     <a id="_idIndexMarker562">
     </a>
     <span class="koboSpan" id="kobo.551.1">
      applications for known vulnerability patterns.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.552.1">
       User and developer reports
      </span>
     </strong>
     <span class="koboSpan" id="kobo.553.1">
      : End-users and developers may encounter security issues during regular use or development activities and report them to the maintainers or security teams.
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-199">
    <a id="_idTextAnchor212">
    </a>
    <span class="koboSpan" id="kobo.554.1">
     Documentation process
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.555.1">
     Once a
    </span>
    <a id="_idIndexMarker563">
    </a>
    <span class="koboSpan" id="kobo.556.1">
     vulnerability is discovered, documenting it involves several steps:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.557.1">
       Vulnerability disclosure
      </span>
     </strong>
     <span class="koboSpan" id="kobo.558.1">
      : The finder reports the vulnerability to the software vendor or maintainers, following responsible disclosure practices to allow time for a fix before public disclosure.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.559.1">
       CVE assignment
      </span>
     </strong>
     <span class="koboSpan" id="kobo.560.1">
      : An
     </span>
     <a id="_idIndexMarker564">
     </a>
     <span class="koboSpan" id="kobo.561.1">
      authorized
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.562.1">
       CVE Numbering Authority
      </span>
     </strong>
     <span class="koboSpan" id="kobo.563.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.564.1">
       CNA
      </span>
     </strong>
     <span class="koboSpan" id="kobo.565.1">
      ) assigns a unique CVE identifier to the vulnerability.
     </span>
     <span class="koboSpan" id="kobo.565.2">
      This identifier allows consistent tracking and reference.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.566.1">
       Description and analysis
      </span>
     </strong>
     <span class="koboSpan" id="kobo.567.1">
      : A detailed description of the vulnerability is created, including the following:
     </span>
     <ul>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.568.1">
         Summary
        </span>
       </strong>
       <span class="koboSpan" id="kobo.569.1">
        : A brief overview of the issue
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.570.1">
         Technical details
        </span>
       </strong>
       <span class="koboSpan" id="kobo.571.1">
        : In-depth information about the vulnerability, including affected versions and components
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.572.1">
         Impact assessment
        </span>
       </strong>
       <span class="koboSpan" id="kobo.573.1">
        : The potential risks and consequences if the vulnerability is exploited
       </span>
      </li>
     </ul>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.574.1">
       Publishing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.575.1">
      : The CVE entry is published in the CVE database and shared with various security
     </span>
     <a id="_idIndexMarker565">
     </a>
     <span class="koboSpan" id="kobo.576.1">
      databases such as the
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.577.1">
       National Vulnerability Database
      </span>
     </strong>
     <span class="koboSpan" id="kobo.578.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.579.1">
       NVD
      </span>
     </strong>
     <span class="koboSpan" id="kobo.580.1">
      ).
     </span>
     <span class="koboSpan" id="kobo.580.2">
      Vendors may also release security advisories and patches.
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-200">
    <a id="_idTextAnchor213">
    </a>
    <span class="koboSpan" id="kobo.581.1">
     Structure of a CVE
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.582.1">
     A CVE
    </span>
    <a id="_idIndexMarker566">
    </a>
    <span class="koboSpan" id="kobo.583.1">
     entry consists of several key components that provide essential information about the vulnerability:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.584.1">
       CVE identifier
      </span>
     </strong>
     <span class="koboSpan" id="kobo.585.1">
      : A unique identifier in the format CVE-YYYY-NNNN, where YYYY is the year the CVE ID was assigned or made public and NNNN is a sequential number, for example, CVE-2023-12345.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.586.1">
       Description
      </span>
     </strong>
     <span class="koboSpan" id="kobo.587.1">
      : A concise summary of the vulnerability, including the following:
     </span>
     <ul>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.588.1">
         Type of vulnerability
        </span>
       </strong>
       <span class="koboSpan" id="kobo.589.1">
        : Such as buffer overflow or injection flaw
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.590.1">
         Affected products
        </span>
       </strong>
       <span class="koboSpan" id="kobo.591.1">
        : Specific software, versions, and components impacted
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.592.1">
         Impact
        </span>
       </strong>
       <span class="koboSpan" id="kobo.593.1">
        : The potential effects of exploitation, such as unauthorized access or denial of service
       </span>
      </li>
     </ul>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.594.1">
       References
      </span>
     </strong>
     <span class="koboSpan" id="kobo.595.1">
      : Links to additional information, including the following:
     </span>
     <ul>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.596.1">
         Vendor advisories
        </span>
       </strong>
       <span class="koboSpan" id="kobo.597.1">
        : Official statements or patches from the software vendor
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.598.1">
         Security Bulletins
        </span>
       </strong>
       <span class="koboSpan" id="kobo.599.1">
        : Reports from security organizations
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.600.1">
         Technical Analysis
        </span>
       </strong>
       <span class="koboSpan" id="kobo.601.1">
        : In-depth articles or reports analyzing the vulnerability
       </span>
      </li>
     </ul>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.602.1">
      Finally, when
     </span>
     <a id="_idIndexMarker567">
     </a>
     <span class="koboSpan" id="kobo.603.1">
      imported into the NVD, additional metadata is added (if available):
     </span>
     <ul>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.604.1">
         CVSS scores
        </span>
       </strong>
       <span class="koboSpan" id="kobo.605.1">
        : The
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.606.1">
         Common Vulnerability Scoring System
        </span>
       </strong>
       <span class="koboSpan" id="kobo.607.1">
        (
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.608.1">
         CVSS
        </span>
       </strong>
       <span class="koboSpan" id="kobo.609.1">
        ) provides a
       </span>
       <a id="_idIndexMarker568">
       </a>
       <span class="koboSpan" id="kobo.610.1">
        quantitative measure of the severity of the vulnerability.
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.611.1">
         Impact metrics
        </span>
       </strong>
       <span class="koboSpan" id="kobo.612.1">
        : Details about confidentiality, integrity, and availability impacts.
       </span>
      </li>
      <li class="bulletList">
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.613.1">
         Affected configurations
        </span>
       </strong>
       <span class="koboSpan" id="kobo.614.1">
        : Specific environments or configurations that are vulnerable.
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.615.1">
     You need to understand that documenting a CVE is a process, and a CVE that affects your code may have been identified, but no current solution is yet available.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-201">
    <a id="_idTextAnchor214">
    </a>
    <span class="koboSpan" id="kobo.616.1">
     Best resources to track CVEs
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.617.1">
     Staying
    </span>
    <a id="_idIndexMarker569">
    </a>
    <span class="koboSpan" id="kobo.618.1">
     informed about the latest vulnerabilities is essential for proactive security management.
    </span>
    <span class="koboSpan" id="kobo.618.2">
     The following are some of the best resources for tracking CVEs.
    </span>
    <span class="koboSpan" id="kobo.618.3">
     You should bookmark each of them and become familiar with their structure and searching capabilities:
    </span>
   </p>
   <p class="H4---Subheading">
    <span class="koboSpan" id="kobo.619.1">
     NVD
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.620.1">
     Managed
    </span>
    <a id="_idIndexMarker570">
    </a>
    <span class="koboSpan" id="kobo.621.1">
     by the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.622.1">
      National Institute of Standards and Technology
     </span>
    </strong>
    <span class="koboSpan" id="kobo.623.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.624.1">
      NIST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.625.1">
     ), the NVD provides comprehensive information about CVEs, including
    </span>
    <a id="_idIndexMarker571">
    </a>
    <span class="koboSpan" id="kobo.626.1">
     detailed analyses, CVSS scores, and impact metrics.
    </span>
    <span class="koboSpan" id="kobo.626.2">
     It is the main resource for CVEs:
    </span>
   </p>
   <p class="normal">
    <a href="https://nvd.nist.gov/ ">
     <span class="url">
      <span class="koboSpan" id="kobo.627.1">
       https://nvd.nist.gov/
      </span>
     </span>
    </a>
   </p>
   <p class="H4---Subheading">
    <span class="koboSpan" id="kobo.628.1">
     MITRE CVE list
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.629.1">
     The official
    </span>
    <a id="_idIndexMarker572">
    </a>
    <span class="koboSpan" id="kobo.630.1">
     CVE list is maintained by MITRE.
    </span>
    <span class="koboSpan" id="kobo.630.2">
     It provides basic information about each CVE, including descriptions and references.
    </span>
    <span class="koboSpan" id="kobo.630.3">
     Frequently, the information here is easier to navigate than the NVD:
    </span>
   </p>
   <p class="normal">
    <a href="https://cve.mitre.org/ ">
     <span class="url">
      <span class="koboSpan" id="kobo.631.1">
       https://cve.mitre.org/
      </span>
     </span>
    </a>
   </p>
   <p class="H4---Subheading">
    <span class="koboSpan" id="kobo.632.1">
     Security advisories from vendors
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.633.1">
     Software vendors often publish their own security advisories and patches.
    </span>
    <span class="koboSpan" id="kobo.633.2">
     Monitoring these sources
    </span>
    <a id="_idIndexMarker573">
    </a>
    <span class="koboSpan" id="kobo.634.1">
     ensures you receive vendor-specific information promptly.
    </span>
    <span class="koboSpan" id="kobo.634.2">
     There are many such resources, but for a Java software engineer, Oracle and Apache are two of the most important:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.635.1">
       Oracle Java SE Critical Patch Updates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.636.1">
      :
     </span>
     <a href="https://www.oracle.com/security-alerts/ ">
      <span class="url">
       <span class="koboSpan" id="kobo.637.1">
        https://www.oracle.com/security-alerts/
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.638.1">
       Apache Security
      </span>
     </strong>
     <span class="koboSpan" id="kobo.639.1">
      :
     </span>
     <a href="https://apache.org/security/ ">
      <span class="url">
       <span class="koboSpan" id="kobo.640.1">
        https://apache.org/security/
       </span>
      </span>
     </a>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.641.1">
       VulDB
      </span>
     </strong>
     <span class="koboSpan" id="kobo.642.1">
      :
     </span>
     <a href="https://vuldb.com/ ">
      <span class="url">
       <span class="koboSpan" id="kobo.643.1">
        https://vuldb.com/
       </span>
      </span>
     </a>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.644.1">
     These databases aggregate vulnerability information from various sources and often provide additional context and analysis.
    </span>
    <span class="koboSpan" id="kobo.644.2">
     Not all current vulnerabilities may be available there yet.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-202">
    <a id="_idTextAnchor215">
    </a>
    <span class="koboSpan" id="kobo.645.1">
     Software scanners that help to identify CVEs
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.646.1">
     Software scanners are tools that have been designed to automatically detect vulnerabilities within
    </span>
    <a id="_idIndexMarker574">
    </a>
    <span class="koboSpan" id="kobo.647.1">
     code bases, applications, or systems.
    </span>
    <span class="koboSpan" id="kobo.647.2">
     For Java developers, these tools are invaluable in identifying CVEs associated with dependencies and code.
    </span>
    <span class="koboSpan" id="kobo.647.3">
     They work in a few different forms and, depending on the project, you may have to use more than one to cover your code.
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.648.1">
       Static Application Security Testing (SAST) tools
      </span>
     </strong>
     <span class="koboSpan" id="kobo.649.1">
      : These tools analyze source code for
     </span>
     <a id="_idIndexMarker575">
     </a>
     <span class="koboSpan" id="kobo.650.1">
      security vulnerabilities without executing the code.
     </span>
     <span class="koboSpan" id="kobo.650.2">
      Examples are SonarQube and Checkmarx
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.651.1">
       Software Composition Analysis (SCA)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.652.1">
      : These tools identify open source components
     </span>
     <a id="_idIndexMarker576">
     </a>
     <span class="koboSpan" id="kobo.653.1">
      and dependencies in your application and check for known vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.653.2">
      Examples include OWASP Dependency-Check, Snyk, Black Duck, and WhiteSource.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.654.1">
       Dynamic Application Security Testing (DAST)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.655.1">
      : These tools analyze running applications
     </span>
     <a id="_idIndexMarker577">
     </a>
     <span class="koboSpan" id="kobo.656.1">
      to detect vulnerabilities by simulating attacks.
     </span>
     <span class="koboSpan" id="kobo.656.2">
      Examples include OWASP ZAP and Burp Suite.
     </span>
    </li>
   </ul>
   <p class="H4---Subheading">
    <span class="koboSpan" id="kobo.657.1">
     How these tools work
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.658.1">
     As CVEs are security problems with external dependencies, how can the scanners look at your code and find the issues?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.659.1">
     First, the scanner
    </span>
    <a id="_idIndexMarker578">
    </a>
    <span class="koboSpan" id="kobo.660.1">
     analyzes project files, such as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.661.1">
      pom.xml
     </span>
    </code>
    <span class="koboSpan" id="kobo.662.1">
     for Maven and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.663.1">
      build.gradle
     </span>
    </code>
    <span class="koboSpan" id="kobo.664.1">
     for Gradle, to identify all direct and transitive dependencies.
    </span>
    <span class="koboSpan" id="kobo.664.2">
     It then extracts the version numbers of each dependency and compares them against a vulnerability database containing CVE information.
    </span>
    <span class="koboSpan" id="kobo.664.3">
     Based on this comparison, the scanner generates a detailed report highlighting any vulnerable dependencies, classifying them by severity levels according to CVSS scores.
    </span>
    <span class="koboSpan" id="kobo.664.4">
     Additionally, it provides upgrade recommendations, suggesting versions that resolve the identified vulnerabilities.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.665.1">
     The next step
    </span>
    <a id="_idIndexMarker579">
    </a>
    <span class="koboSpan" id="kobo.666.1">
     is to integrate the dependency scanners into the development workflow.
    </span>
    <span class="koboSpan" id="kobo.666.2">
     Some scanners provide plugins for
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.667.1">
      Integrated Development Environments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.668.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.669.1">
      IDEs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.670.1">
     ) such as Eclipse and IntelliJ IDEA, allowing developers to detect vulnerabilities directly within their coding environment.
    </span>
    <span class="koboSpan" id="kobo.670.2">
     Additionally, scanners
    </span>
    <a id="_idIndexMarker580">
    </a>
    <span class="koboSpan" id="kobo.671.1">
     can be incorporated into
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.672.1">
      Continuous Integration/Continuous Deployment
     </span>
    </strong>
    <span class="koboSpan" id="kobo.673.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.674.1">
      CI/CD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.675.1">
     ) pipelines, automating vulnerability detection during the build process.
    </span>
    <span class="koboSpan" id="kobo.675.2">
     To enhance security monitoring, they can also be configured to send automated alerts whenever new vulnerabilities are identified.
    </span>
    <span class="koboSpan" id="kobo.675.3">
     By identifying and addressing security issues early in the development cycle, these integrations enhance
    </span>
    <a id="_idIndexMarker581">
    </a>
    <span class="koboSpan" id="kobo.676.1">
     agility and help shorten the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.677.1">
      Software Development Life Cycle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.678.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.679.1">
      SDLC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.680.1">
     ), reducing delays caused by late-stage security fixes.
    </span>
   </p>
   <p class="H4---Subheading">
    <span class="koboSpan" id="kobo.681.1">
     Popular scanners for Java
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.682.1">
     It is always a little dangerous to publish lists of software tools in a printed format as some projects may
    </span>
    <a id="_idIndexMarker582">
    </a>
    <span class="koboSpan" id="kobo.683.1">
     disappear or become obsolete over time, but as of April 2025, these are the most widely used tools for identifying vulnerabilities in Java projects:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.684.1">
       OWASP Dependency-Check
      </span>
     </strong>
     <span class="koboSpan" id="kobo.685.1">
      : This
     </span>
     <a id="_idIndexMarker583">
     </a>
     <span class="koboSpan" id="kobo.686.1">
      open-source tool identifies a project’s dependencies and checks whether there are any known, publicly disclosed vulnerabilities (CVEs) associated with the scanned dependencies.
     </span>
     <span class="koboSpan" id="kobo.686.2">
      It supports projects that use Maven, Gradle, and Ant and can be integrated into most build tools and CI/CD solutions.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.687.1">
       Snyk
      </span>
     </strong>
     <span class="koboSpan" id="kobo.688.1">
      : This is a
     </span>
     <a id="_idIndexMarker584">
     </a>
     <span class="koboSpan" id="kobo.689.1">
      commercial tool that provides vulnerability scanning and remediation for open source dependencies.
     </span>
     <span class="koboSpan" id="kobo.689.2">
      It provides real-time scanning, allowing the continuous monitoring of dependencies.
     </span>
     <span class="koboSpan" id="kobo.689.3">
      It also proposes code fixes automatically with suggestions directly in pull requests.
     </span>
     <span class="koboSpan" id="kobo.689.4">
      Plugins are available for most popular IDEs (such as IntelliJ and VS Code).
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.690.1">
       Black Duck
      </span>
     </strong>
     <span class="koboSpan" id="kobo.691.1">
      : This is a
     </span>
     <a id="_idIndexMarker585">
     </a>
     <span class="koboSpan" id="kobo.692.1">
      comprehensive SCA tool that scans for open source vulnerabilities and license compliance.
     </span>
     <span class="koboSpan" id="kobo.692.2">
      It enforces policies regarding the use of open source components in the system and generates in-depth analysis of vulnerabilities and risks.
     </span>
    </li>
   </ul>
   <h1 class="heading-1" id="_idParaDest-203">
    <a id="_idTextAnchor216">
    </a>
    <span class="koboSpan" id="kobo.693.1">
     Strategies to manage CVEs
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.694.1">
     All these tools are very important and are a crucial part of managing the CVEs in your project.
    </span>
    <span class="koboSpan" id="kobo.694.2">
     But how can we manage this workload, and what considerations are needed?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.695.1">
     The effective
    </span>
    <a id="_idIndexMarker586">
    </a>
    <span class="koboSpan" id="kobo.696.1">
     management of CVEs involves not just detection but also strategic planning and processes to mitigate risks.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.697.1">
     One important point to understand is that writing secure software is expensive, and managing CVEs in particular has become a hard and expensive part of software security.
    </span>
    <span class="koboSpan" id="kobo.697.2">
     It is not uncommon for teams to allocate 15% to 20% of their capacity to security.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.698.1">
     With that in mind, let’s look at a couple of strategies that help Java developers maintain secure applications.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-204">
    <a id="_idTextAnchor217">
    </a>
    <span class="koboSpan" id="kobo.699.1">
     Continuous upgrade dependencies
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.700.1">
     Regularly updating dependencies to their latest versions ensures that applications benefit from security
    </span>
    <a id="_idIndexMarker587">
    </a>
    <span class="koboSpan" id="kobo.701.1">
     patches and improvements made by library maintainers.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.702.1">
     This is a proactive approach to CVEs.
    </span>
    <span class="koboSpan" id="kobo.702.2">
     By always keeping your dependencies up to date, you guarantee that any security update will be implemented and used in your code as soon as it is available.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.703.1">
     There are various ways to implement continuous upgrades:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.704.1">
       Automated updates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.705.1">
      : Use tools such as Dependabot to automatically create pull requests for dependency updates
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.706.1">
       Regular maintenance schedule
      </span>
     </strong>
     <span class="koboSpan" id="kobo.707.1">
      : Establish a routine (e.g., weekly or monthly) to review and update dependencies
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.708.1">
       Testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.709.1">
      : Implement comprehensive automated tests to ensure that updates do not introduce regressions
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.710.1">
       Monitoring release notes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.711.1">
      : Keep track of dependency release notes for any security-related updates
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.712.1">
     These are the benefits of continuous upgrades:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.713.1">
       Security
      </span>
     </strong>
     <span class="koboSpan" id="kobo.714.1">
      : It reduces the window of exposure to known vulnerabilities
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.715.1">
       Feature enhancements
      </span>
     </strong>
     <span class="koboSpan" id="kobo.716.1">
      : It provides access to new features and performance improvements
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.717.1">
       Community support
      </span>
     </strong>
     <span class="koboSpan" id="kobo.718.1">
      : It aligns with the active versions supported by the community
     </span>
    </li>
   </ul>
   <h3 class="heading-3" id="_idParaDest-205">
    <a id="_idTextAnchor218">
    </a>
    <span class="koboSpan" id="kobo.719.1">
     Costs and requirements
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.720.1">
     The main cost with this approach is the time that must be invested in keeping the code base current.
    </span>
    <span class="koboSpan" id="kobo.720.2">
     Remember, you will be changing dependencies in your code, and the API you are calling may
    </span>
    <a id="_idIndexMarker588">
    </a>
    <span class="koboSpan" id="kobo.721.1">
     have changed, sometimes in ways that are not immediately obvious, forcing you and your team to refactor portions of your code that would not need any change otherwise.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.722.1">
     To be able to make so many potential breaking changes so frequently, it is necessary to have a comprehensive set of automated tests that can give the developer team the confidence to make those changes in the first place.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.723.1">
     The time to add the tools and integrate them with the specific ticketing system used in your organization is another cost that needs to be considered.
    </span>
    <span class="koboSpan" id="kobo.723.2">
     The initial investment can be quite large for legacy code bases with not enough test coverage and automated build pipelines.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-206">
    <a id="_idTextAnchor219">
    </a>
    <span class="koboSpan" id="kobo.724.1">
     Dependency management
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.725.1">
     Now that we know that CVEs are caused by the dependencies we as software engineers add to the code base, what can we do to limit our exposure to them?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.726.1">
     Clearly, a proper
    </span>
    <a id="_idIndexMarker589">
    </a>
    <span class="koboSpan" id="kobo.727.1">
     policy for the management of dependencies is crucial to control the quality, security, and performance of your application.
    </span>
    <span class="koboSpan" id="kobo.727.2">
     The goal here is to prevent exposure to CVEs as much as possible.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.728.1">
     Sometimes, software engineers add dependencies to projects without analyzing the consequences.
    </span>
    <span class="koboSpan" id="kobo.728.2">
     To be honest, this happens more often than we’d like to admit!
    </span>
    <span class="koboSpan" id="kobo.728.3">
     Having a policy in place that will require validation of the need for this new dependency and a discussion about more secure and better-maintained alternatives can significantly help with security vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.728.4">
     To avoid introducing unnecessary risks, it is important to follow these best practices when adding and managing dependencies:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.729.1">
       Minimal dependencies
      </span>
     </strong>
     <span class="koboSpan" id="kobo.730.1">
      : Include only necessary dependencies to reduce the attack surface.
     </span>
     <span class="koboSpan" id="kobo.730.2">
      The
     </span>
     <a id="_idIndexMarker590">
     </a>
     <span class="koboSpan" id="kobo.731.1">
      introduction of new dependencies must be discussed with the team and its implications must be identified.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.732.1">
       Version pinning
      </span>
     </strong>
     <span class="koboSpan" id="kobo.733.1">
      : Specify exact versions of dependencies to ensure consistent builds.
     </span>
     <span class="koboSpan" id="kobo.733.2">
      Avoid having dependencies on the “latest” version.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.734.1">
       Use trusted sources
      </span>
     </strong>
     <span class="koboSpan" id="kobo.735.1">
      : Retrieve dependencies from reputable repositories (e.g., Maven Central).
     </span>
     <span class="koboSpan" id="kobo.735.2">
      Choose packages and libraries that are actively maintained and have a good history of security updates.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.736.1">
       Transitive dependency control
      </span>
     </strong>
     <span class="koboSpan" id="kobo.737.1">
      : Monitor and manage transitive dependencies brought in by direct dependencies.
     </span>
    </li>
   </ul>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.738.1">
      License compliance
     </span>
    </strong>
    <span class="koboSpan" id="kobo.739.1">
     : Ensure that the licenses of dependencies are compatible with your project.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-207">
    <a id="_idTextAnchor220">
    </a>
    <span class="koboSpan" id="kobo.740.1">
     Proactive dependency upgrade
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.741.1">
     As much as we may want to avoid dependencies, it is nearly impossible to build a modern API system
    </span>
    <a id="_idIndexMarker591">
    </a>
    <span class="koboSpan" id="kobo.742.1">
     without them.
    </span>
    <span class="koboSpan" id="kobo.742.2">
     So, proactively upgrading dependencies before vulnerabilities are disclosed or before they become outdated is a good way to keep your system CVE-free.
    </span>
    <span class="koboSpan" id="kobo.742.3">
     To achieve this, it is necessary to do the following:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.743.1">
       Stay informed
      </span>
     </strong>
     <span class="koboSpan" id="kobo.744.1">
      : Subscribe to mailing lists and monitor updates from dependency maintainers
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.745.1">
       Run beta tests
      </span>
     </strong>
     <span class="koboSpan" id="kobo.746.1">
      : Test new versions in a controlled environment before full integration
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.747.1">
       Contribute to dependencies
      </span>
     </strong>
     <span class="koboSpan" id="kobo.748.1">
      : Engage with open source projects you use the most to understand upcoming changes
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.749.1">
       Automate the scanning
      </span>
     </strong>
     <span class="koboSpan" id="kobo.750.1">
      : Use tools that notify you about new releases of dependencies
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.751.1">
     By doing all of this, you will stay ahead of most CVEs, which reduces the likelihood of being affected by new vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.751.2">
     As secondary gains, these policies eliminate large jumps in dependency versions that may require significant refactoring of your own code and all the performance improvements and optimizations of newer versions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.752.1">
     The drawback is the cost.
    </span>
    <span class="koboSpan" id="kobo.752.2">
     Implementing these proactive policies can cause frequent disruptions that can be hard to justify to business owners and investors because there are no new features being created by all the work.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-208">
    <a id="_idTextAnchor221">
    </a>
    <span class="koboSpan" id="kobo.753.1">
     Reactive upgrade based on scan results
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.754.1">
     This is the process of upgrading dependencies in response to vulnerability reports from scanners
    </span>
    <a id="_idIndexMarker592">
    </a>
    <span class="koboSpan" id="kobo.755.1">
     or security advisories.
    </span>
    <span class="koboSpan" id="kobo.755.2">
     This is probably the most common process used by development teams.
    </span>
    <span class="koboSpan" id="kobo.755.3">
     To effectively manage upgrades based on scan results, the teams should follow the following steps:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.756.1">
       Scan regularly
      </span>
     </strong>
     <span class="koboSpan" id="kobo.757.1">
      : Use automated scanners to detect vulnerabilities in dependencies
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.758.1">
       Assess severity
      </span>
     </strong>
     <span class="koboSpan" id="kobo.759.1">
      : Prioritize vulnerabilities based on severity and impact
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.760.1">
       Plan remediation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.761.1">
      : Schedule upgrades or apply patches for affected dependencies
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.762.1">
       Validation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.763.1">
      : Test the application after upgrades to ensure functionality is intact
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.764.1">
       Documentation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.765.1">
      : Keep records of vulnerabilities found and actions taken
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.766.1">
       Risk management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.767.1">
      : Balance the urgency of upgrades with the potential impact on the application
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.768.1">
       Communication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.769.1">
      : Coordinate with stakeholders to schedule necessary updates
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.770.1">
       Fallback plans
      </span>
     </strong>
     <span class="koboSpan" id="kobo.771.1">
      : Have strategies in place in case an upgrade introduces issues
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.772.1">
     There is nothing inherently negative about this process, but there are risks that need to be understood.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.773.1">
     It is easy to have too many CVEs to mitigate at the same time.
    </span>
    <span class="koboSpan" id="kobo.773.2">
     When the team decides to delay the security tasks, they can accumulate just before a release.
    </span>
    <span class="koboSpan" id="kobo.773.3">
     This is a very common case and can cause important delays to a release.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-209">
    <a id="_idTextAnchor222">
    </a>
    <span class="koboSpan" id="kobo.774.1">
     Summary
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.775.1">
     The ever-evolving landscape of cybersecurity necessitates that Java software engineers remain vigilant and proactive in managing vulnerabilities within their applications.
    </span>
    <span class="koboSpan" id="kobo.775.2">
     CVEs play a critical role in identifying and communicating known security issues, and understanding how to find, document, and remediate them is essential.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.776.1">
     By leveraging tools such as vulnerability scanners and implementing strategies such as continuous dependency upgrades, proactive updates, and reactive measures based on scan reports, developers can significantly enhance the security posture of their applications.
    </span>
    <span class="koboSpan" id="kobo.776.2">
     Effective dependency management further reduces risks by controlling the components integrated into the software.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.777.1">
     Staying informed through reputable sources such as the NVD and vendor advisories ensures that developers are aware of the latest threats and can act promptly.
    </span>
    <span class="koboSpan" id="kobo.777.2">
     Integrating security practices into the development life cycle transforms security from a reactive afterthought into a proactive cornerstone of software development.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.778.1">
     In summary, managing
    </span>
    <a id="_idIndexMarker593">
    </a>
    <span class="koboSpan" id="kobo.779.1">
     CVEs is a multifaceted process that requires diligence, strategic planning, and the right tools.
    </span>
    <span class="koboSpan" id="kobo.779.2">
     By embracing these practices, Java software engineers can contribute to creating more secure applications, protecting both their organizations and the end-users who rely on their software.
    </span>
    <span class="koboSpan" id="kobo.779.3">
     In the next chapter, we will look at how generative AI can revolutionize the way we write tests for APIs, providing insights and techniques
    </span>
   </p>
  </div>
 </body></html>