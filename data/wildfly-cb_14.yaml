- en: Chapter 14. WildFly into the Cloud with OpenShift
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第14章：使用OpenShift将WildFly迁移到云端
- en: 'In this chapter, you will learn the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将学习以下食谱：
- en: Registering to OpenShift Online
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册OpenShift Online
- en: Installing the WildFly cartridge for our first deployment
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为我们的第一次部署安装WildFly卡式盒
- en: Taking control of your WildFly server via SSH
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过SSH控制你的WildFly服务器
- en: Deploying your code to OpenShift Online
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将你的代码部署到OpenShift Online
- en: Introduction
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: In this chapter, you will learn what OpenShift is, and how you can take advantage
    of it by deploying your application directly to the Internet on the cloud.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将了解OpenShift是什么，以及如何通过将你的应用程序直接部署到云上的互联网来利用它。
- en: 'First of all, OpenShift is a **Platform as a Service**, which stands for the
    famous acronym **PaaS**. OpenShift is Red Hat''s PaaS, and you can find it in
    three different versions:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，OpenShift是一个**平台即服务**，代表著名的缩写**PaaS**。OpenShift是Red Hat的PaaS，你可以找到三个不同版本的它：
- en: '**OpenShift Origin**: This one is the free and open source version of OpenShift.
    You can find its code stream on GitHub at [https://github.com/openshift/origin](https://github.com/openshift/origin).'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OpenShift Origin**：这是一个OpenShift的免费开源版本。你可以在GitHub上找到其代码流，网址为[https://github.com/openshift/origin](https://github.com/openshift/origin)。'
- en: '**OpenShift Online**: OpenShift Online (OSO) is the version that we will use
    in this chapter. For the moment you just need to know that it''s a free PaaS,
    where you can deploy your application based on your favorite environment. We will
    discuss it later in the chapter. OpenShift Online is available for free at [https://www.openshift.com](https://www.openshift.com).'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OpenShift Online**：OpenShift Online (OSO) 是本章我们将使用的版本。目前你只需要知道它是一个免费的PaaS，你可以在其中根据你喜欢的环境部署你的应用程序。我们将在本章后面讨论它。OpenShift
    Online可在[https://www.openshift.com](https://www.openshift.com)免费使用。'
- en: '**OpenShift Enterprise**: OpenShift Enterprise (OSE) is the version for which
    Red Hat provides support at the enterprise level.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OpenShift Enterprise**：OpenShift Enterprise (OSE) 是Red Hat在企业级别提供支持的版本。'
- en: 'As mentioned in the book *Getting Started with OpenShift*, *O''Reilly*:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如同书中《OpenShift入门》所述，*O'Reilly*：
- en: '*OSE is intended for customers who want stability and a production-ready install
    out of the box. Since stability is paramount, some of the features found in Origin
    or Online may not be in Enterprise for a release or two.*'
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*OSE是为那些想要稳定性和开箱即用的生产就绪安装的客户设计的。由于稳定性至关重要，Origin或Online中的一些功能可能不会在Enterprise版本中存在一两个版本。*'
- en: 'Anyway, what is OpenShift all about? OpenShift is a lot of things, but from
    my experience, I think that the word self-provisioning is the one that fits it
    better. Developers and/or sysadmins can access the system and provision themselves
    their own environment, on the fly. Resources, runtime, network: all you need is
    there for you at one click.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，OpenShift到底是什么？OpenShift有很多东西，但根据我的经验，我认为“自助配置”这个词更适合它。开发人员和/或系统管理员可以访问系统，并即时为自己配置环境。资源、运行时、网络：所有你需要的东西都在一键之遥。
- en: Another thing OpenShift can do for you is autoscaling. If you deploy your application
    on OpenShift and flag the option for "autoscaling", whenever your site gets more
    traffic, your infrastructure scales; more "nodes" are added in order to handle
    more and more requests. Still, "automagically", whenever your application traffic
    decreases, OpenShift gets back the extra resources.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift还能为你做另一件事，那就是自动扩展。如果你在OpenShift上部署应用程序并标记“自动扩展”选项，每当你的网站流量增加时，你的基础设施就会扩展；为了处理越来越多的请求，会添加更多的“节点”。然而，“自动”地，当你的应用程序流量减少时，OpenShift会回收额外的资源。
- en: 'In OpenShift you need to understand three main concepts:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在OpenShift中，你需要了解三个主要概念：
- en: '**Gear**: Think about it as a server that provides you the resources that you
    need, such as RAM, CPU, and disk space. In OpenShift Online you can find three
    types of gear: small, medium, and large. They all have 1 GB of disk space. The
    small gear has 512 MB of RAM, medium gear has 1 GB of RAM, and the large gear
    has 2 GB of RAM.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**齿轮**：你可以将其视为一个提供你所需资源的服务器，例如RAM、CPU和磁盘空间。在OpenShift Online中，你可以找到三种类型的齿轮：小型、中型和大型。它们都有1GB的磁盘空间。小型齿轮有512MB的RAM，中型齿轮有1GB的RAM，大型齿轮有2GB的RAM。'
- en: Tip
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: OpenShift Online gives you three small gears for free. If you want more or want
    to get different types, you need to purchase them.
  id: totrans-19
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online免费提供三个小型齿轮。如果你想购买更多或想获取不同类型的齿轮，你需要购买它们。
- en: '**Cartridge**: Think of it as a plugin. A cartridge is the host of your services
    or applications. For example, if you have a Java web application, your cartridge
    might be WildFly, JBoss AS, or Tomcat. Cartridges can be of two types:'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**卡式**：把它想象成一个插件。卡式是你的服务或应用程序的主机。例如，如果你有一个Java网络应用程序，你的卡式可能是WildFly、JBoss AS或Tomcat。卡式有两种类型：'
- en: '**Standalone**: This is like WildFly, JBoss AS, and Vert.x; basically the application
    server that your application runs on'
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**独立**：这就像WildFly、JBoss AS和Vert.x；基本上是应用程序运行在上的应用服务器'
- en: '**Embedded**: This is a functionality cartridge such as a database cartridge'
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**嵌入式**：这是一个功能卡，例如数据库卡'
- en: '**Application**: Without turning around too much, it''s your application that
    runs on OpenShift. OpenShift exposes three ports for incoming traffic: SSH on
    port 22, HTTP on port 80, and HTTPS on port 443.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用**：无需过多转身，你的应用程序是在OpenShift上运行的。OpenShift为传入流量暴露了三个端口：22号端口上的SSH，80号端口上的HTTP，以及443号端口上的HTTPS。'
- en: This is essentially the basics you need to know in order to work with OpenShift
    Online. A plus would be an understanding of the basis of Git (a distributed version
    control software), but we will see it when needed.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上是你需要了解的基本知识，以便与OpenShift Online一起工作。一个加分项是对Git（一种分布式版本控制软件）的基础有所了解，但我们需要在需要时再讨论。
- en: Let's begin!
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始！
- en: Registering to OpenShift Online
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 注册OpenShift Online
- en: In this recipe, you will learn how to register for a free OpenShift Online account.
    This is a warm-up recipe, which will enable us to get acquainted with the overall
    infrastructure.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，你将学习如何注册免费的OpenShift Online账户。这是一个热身菜谱，将使我们能够熟悉整体基础设施。
- en: Getting ready
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: As we will operate just online, all you need to have is an Internet connection
    for the next 10 minutes.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们将在网上操作，你接下来10分钟只需要有互联网连接。
- en: How to do it…
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: Open a browser of your choice and point it to [http://www.openshift.com](http://www.openshift.com).
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开你选择的浏览器，将其指向[http://www.openshift.com](http://www.openshift.com)。
- en: Once there, click on the **Online** box (to the extreme left), as depicted in
    the following image:![How to do it…](img/3744_14_01.jpg)
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦到达那里，点击左边的**在线**框（如图所示）：![如何操作…](img/3744_14_01.jpg)
- en: OpenShift home page
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift主页
- en: The next step is to fill in the registration form by providing a valid, working
    e-mail ID and choosing a password, as shown in the following screenshot:![How
    to do it…](img/3744_14_02.jpg)
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是填写注册表单，提供有效的、可工作的电子邮件ID并选择一个密码，如下面的截图所示：![如何操作…](img/3744_14_02.jpg)
- en: OpenShift Online registration form
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online注册表单
- en: Once done, hit the **Sign Up** button and wait for a confirmation mail, as warned
    in the following message:![How to do it…](img/3744_14_03.jpg)
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后，点击**注册**按钮并等待确认邮件，如下面的消息所警告的：![如何操作…](img/3744_14_03.jpg)
- en: Message warning for a confirmation mail
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确认邮件的消息警告
- en: You may need to wait a few minutes and even check for it in the **Spam** folder.
    The mail should look like the following screenshot:![How to do it…](img/3744_14_04.jpg)
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可能需要等待几分钟，甚至检查一下**垃圾邮件**文件夹。邮件应该看起来像下面的截图：![如何操作…](img/3744_14_04.jpg)
- en: The e-mail sent by OpenShift Online
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online发送的电子邮件
- en: Click on the link labeled **Verify Your Account** to activate your account.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击标有**验证您的账户**的链接以激活您的账户。
- en: You will be prompted to accept the **OpenShift Service Agreement** and **Red
    Hat Portal Terms of Use**, as depicted in the following image:![How to do it…](img/3744_14_05.jpg)
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将被提示接受**OpenShift服务协议**和**Red Hat门户使用条款**，如下面的图片所示：![如何操作…](img/3744_14_05.jpg)
- en: OpenShift service agreement and Red Hat portal terms of use acceptance form
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift服务协议和Red Hat门户使用条款接受表
- en: If you want, you can also flag the **Sign me up for OpenShift email** and click
    the **I Accept** button.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你愿意，你也可以勾选**注册OpenShift电子邮件**并点击**我接受**按钮。
- en: Great, you are now ready to deploy into the cloud and provide your applications
    to the world!
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了，你现在可以部署到云端并向世界提供你的应用程序了！
- en: How it works…
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作…
- en: The process is pretty straightforward and quick. What is worth mentioning again,
    is the type of account you get.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程非常直接且快捷。再次值得提一下的是你获得的账户类型。
- en: Once you log in to your OpenShift Online account, at the upper-right corner
    of the screen, you can find your username with a down arrow. If you click on it,
    you will see a little menu; click on the first item labeled **My Account**.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你登录到OpenShift Online账户，屏幕右上角你可以找到带有向下箭头的用户名。如果你点击它，你会看到一个菜单；点击第一个标有**我的账户**的项目。
- en: 'It should provide you with a page like the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 它应该为你提供一个如下所示的页面：
- en: '![How it works…](img/3744_14_06.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![工作原理…](img/3744_14_06.jpg)'
- en: OpenShift Online "My Account" page
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift Online “我的账户”页面
- en: 'In that page there are four things that need to be noticed:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在该页面上有四件事情需要注意：
- en: On the left is your login e-mail and your account type; it's always better to
    check.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在左侧是你的登录电子邮件和账户类型；总是检查一下为好。
- en: On the upper-right side of the screen is a grayed bold label specifying the
    **Free Plan**.
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 屏幕右上角有一个灰色粗体标签，指定了**免费计划**。
- en: Towards the bottom-center is the information that at the moment you are using
    zero (**0**) gears out of three (**3**), and that they are free. Also, at the
    same location, there is a hint that you can have a maximum of **16 Gears**, not
    more! This is something you should consider when choosing between OpenShift Online
    and OpenShift Enterprise, which is totally customizable.
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在页面底部中央是信息，目前你正在使用三台（**3**）中的零台（**0**）齿轮，并且它们是免费的。同样，在同一位置，还有一个提示，你可以拥有最多 **16
    Gears**，不能再多了！这是你在选择 OpenShift Online 和 OpenShift Enterprise（这是一个完全可定制的版本）时应该考虑的事情。
- en: Last, but not least, is the **Upgrade Now** button, which provides you with
    all the information that you need to upgrade to the **Bronze** or **Silver** Plans.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，但同样重要的是，是**立即升级**按钮，它为你提供了升级到**青铜**或**银色**计划所需的所有信息。
- en: See also
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考以下内容
- en: For all the services that OpenShift Online provides and how it works, please
    refer to the documentation at [https://www.openshift.com/walkthrough/how-it-works](https://www.openshift.com/walkthrough/how-it-works)
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于 OpenShift Online 提供的所有服务和其工作原理，请参阅[https://www.openshift.com/walkthrough/how-it-works](https://www.openshift.com/walkthrough/how-it-works)上的文档。
- en: If you are looking for documentation from a developer's point of view, you can
    go to [https://developers.openshift.com](https://developers.openshift.com)
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你正在寻找从开发者的角度来看的文档，你可以访问 [https://developers.openshift.com](https://developers.openshift.com)。
- en: Installing the WildFly cartridge for our first deployment
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为我们的第一次部署安装 WildFly 卡包
- en: In this recipe, you will learn how to configure the WildFly cartridge using
    your OpenShift Online account. If you still don't have an account, please refer
    to the first recipe of this chapter.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，你将学习如何使用你的 OpenShift Online 账户配置 WildFly 卡包。如果你还没有账户，请参阅本章的第一个菜谱。
- en: Getting ready
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: As we will operate online most of the time, you need to have an Internet connection.
    On the other hand, all we need locally is a web application to deploy.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们大部分时间都会在线操作，你需要有一个互联网连接。另一方面，我们本地只需要一个要部署的 Web 应用程序。
- en: For this reason, download the entire repository named `wildfly-cookbook-oso`,
    from my GitHub account at [https://github.com/foogaro/wildfly-cookbook-oso.git](https://github.com/foogaro/wildfly-cookbook-oso.git).
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因此，请从我的 GitHub 账户下载名为 `wildfly-cookbook-oso` 的整个仓库，网址为 [https://github.com/foogaro/wildfly-cookbook-oso.git](https://github.com/foogaro/wildfly-cookbook-oso.git)。
- en: 'You can `git-clone` the project or just download it as a ZIP archive. Either
    way, place the source in our `~/WFC/github` path. There you can find a project
    called `openshift-welcome`. To compile the project, execute the following commands:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以 `git-clone` 项目或仅将其作为 ZIP 存档下载。无论哪种方式，将源放置在我们的 `~/WFC/github` 路径下。在那里你可以找到一个名为
    `openshift-welcome` 的项目。要编译项目，请执行以下命令：
- en: '[PRE0]'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In the `target` folder, generated by maven, you should find the `openshift-welcome.war`
    artifact ready to be deployed.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在由 Maven 生成的 `target` 文件夹中，你应该找到准备部署的 `openshift-welcome.war` 工件。
- en: Let's start for real now!
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们真正开始吧！
- en: How to do it…
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: First things first; log in to your OSO account at [https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console).
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，登录到你的 OSO 账户 [https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console)。
- en: Use the e-mail and password chosen at the time of registration, as depicted
    in the following image:![How to do it…](img/3744_14_07.jpg)
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用注册时选择的电子邮件和密码，如下面的图像所示：![如何操作…](img/3744_14_07.jpg)
- en: OpenShift Online login form
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online 登录表单
- en: Once there, the first thing to do is to create an application, as depicted in
    the following screenshot:![How to do it…](img/3744_14_08.jpg)
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦进入，首先要做的是创建一个应用程序，如下面的截图所示：![如何操作…](img/3744_14_08.jpg)
- en: OpenShift Online welcome page
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online 欢迎页面
- en: Follow the **Create your first application now** link. In the next page, select
    the WildFly cartridge, as shown in the following image:![How to do it…](img/3744_14_09.jpg)
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即创建第一个应用程序**链接。在下一页，选择 WildFly 卡包，如下面的图像所示：![如何操作…](img/3744_14_09.jpg)
- en: OpenShift Online list of most used cartridges
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online 最常用卡包列表
- en: Note
  id: totrans-76
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: While writing the book, the latest available stable cartridge for WildFly is
    version 8.2.0.Final. Obviously, this is the application server which we will be
    using to provide our application.
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在编写本书时，WildFly最新可用的稳定卡式版本是8.2.0.Final。显然，这是我们提供应用程序的应用服务器。
- en: Next, we need to configure our namespace, where all our applications will belong,
    and configure the application name; both of these together become the **Public
    URL**, as shown in the following image:![How to do it…](img/3744_14_10.jpg)
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要配置我们的命名空间，所有我们的应用程序都将属于该命名空间，并配置应用程序名称；这两个配置项共同构成了**公共URL**，如下图中所示：![如何操作…](img/3744_14_10.jpg)
- en: OpenShift Online—applications settings form
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online—应用程序设置表单
- en: What you need to change in the preceding form is the domain name, which is on
    the right side of the hyphen symbol (**-**); I chose `wildflycookbook`. The domain
    name must be unique within OpenShift Online at **rhcloud.com**. So choose your
    own domain name to which all your application names will belong.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在前面的表单中，您需要更改的是域名，它位于连字符符号（**-**）的右侧；我选择了`wildflycookbook`。域名必须在**rhcloud.com**的OpenShift
    Online中是唯一的。因此，请选择您自己的域名，所有您的应用程序名称都将属于该域名。
- en: For this very first try, leave all defaults as such and click the **Create Application**
    button. It will take a few minutes to do all that's necessary—it took me 4 minutes.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于这次第一次尝试，请保持所有默认设置不变，并点击**创建应用程序**按钮。完成所有必要的步骤可能需要几分钟时间——对我来说是4分钟。
- en: Then you will be asked if you will be changing the code:![How to do it…](img/3744_14_11.jpg)
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后您将被询问是否要更改代码：![如何操作…](img/3744_14_11.jpg)
- en: For the moment, we just skip this step and click on the link labeled **Not now,
    continue**—we will see the other option with a specific recipe, later in this
    chapter.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 目前，我们只需跳过此步骤，并点击标签为**现在不，继续**的链接——我们将在本章的后面看到具有特定食谱的另一个选项。
- en: The next page will be our recap page, which will give us all the information
    to manage our WildFly instance, such as deploying our applications.![How to do
    it…](img/3744_14_12.jpg)
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一页将是我们的总结页面，它将给我们提供所有管理WildFly实例的信息，例如部署我们的应用程序。![如何操作…](img/3744_14_12.jpg)
- en: The green box in the preceding screenshot, depicts the **Username** and **Password**
    of an administrator user—basically, a user bound to `ManagementRealm` with administrator
    privileges. By the way, in order to access the Web Console, we need to use a tool
    called RHC which can forward for us all requests to port 9990 of the Admin console
    present in our new OpenShift Online environment.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在前面的截图中的绿色框中，描述了管理员用户的**用户名**和**密码**——基本上，这是一个绑定到`ManagementRealm`并具有管理员权限的用户。顺便说一句，为了访问Web控制台，我们需要使用一个名为RHC的工具，它可以为我们转发所有请求到我们新OpenShift
    Online环境中的管理控制台的9990端口。
- en: There is one more thing to do which is to install the client tool named RHC,
    which will provide us with a command-line interface to manage the OSO locally
    from our PC.
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 还有一件事要做，那就是安装名为RHC的客户端工具，它将为我们提供一个命令行界面，以便从我们的PC上本地管理OSO。
- en: 'Open a terminal window and run the following commands:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口并运行以下命令：
- en: '[PRE1]'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now that whole software has been installed, we need to setup the RHC tool,
    as follows:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在所有软件都已安装，我们需要设置RHC工具，如下所示：
- en: '[PRE2]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: As you can see, the output fits my configuration. Yours should be similar, too.
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如您所见，输出符合我的配置。您的也应该类似。
- en: Okay, let's go back to where we were. We were ready to deploy our application,
    but we needed to access the management console.
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 好的，让我们回到我们之前的地方。我们准备部署我们的应用程序，但我们需要访问管理控制台。
- en: 'Now we can do it by first providing the following RHC command:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们可以通过首先提供以下RHC命令来完成它：
- en: '[PRE3]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: As described in the last line, keep this process running.
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如最后一行所述，请保持此过程运行。
- en: Now let's open a browser and point it to the OpenShift Online Admin Console,
    at `http://127.0.0.1:9990`.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们打开浏览器并将它指向OpenShift Online管理控制台，即`http://127.0.0.1:9990`。
- en: When requested, insert the credentials provided to you when we created our first
    application, in the green box.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当需要时，在绿色框中插入我们在创建第一个应用程序时提供的凭据。
- en: 'You should now see the following page:'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您现在应该看到以下页面：
- en: '![How to do it…](img/3744_14_13.jpg)'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作…](img/3744_14_13.jpg)'
- en: WildFly management console on OpenShift Online
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online上的WildFly管理控制台
- en: We can deploy our application by clicking on the **Deployments** tag:![How to
    do it…](img/3744_14_14.jpg)
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以通过点击**部署**标签来部署我们的应用程序：![如何操作…](img/3744_14_14.jpg)
- en: Deployments management
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 部署管理
- en: Click on the **Add** button, and choose the `openshift-welcome.war` artifact
    that we previously compiled with the maven command. Once we have chosen it, enable
    and confirm it as follows:![How to do it…](img/3744_14_15.jpg)
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加**按钮，选择我们之前使用maven命令编译的`openshift-welcome.war`工件。一旦我们选择了它，按照以下方式启用并确认：![如何做…](img/3744_14_15.jpg)
- en: Deploying the openshift-welcome.war application
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 部署`openshift-welcome.war`应用程序
- en: Once we have successfully deployed the application, let's try it by opening
    it at [http://openshiftwelcome-wildflycookbook.rhcloud.com](http://openshiftwelcome-wildflycookbook.rhcloud.com).
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦我们成功部署了应用程序，让我们通过在[http://openshiftwelcome-wildflycookbook.rhcloud.com](http://openshiftwelcome-wildflycookbook.rhcloud.com)打开它来尝试它。
- en: 'That''s our first application running on WildFly on OpenShift Online:'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这是我们首次在OpenShift Online上运行的WildFly应用：
- en: '![How to do it…](img/3744_14_16.jpg)'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做…](img/3744_14_16.jpg)'
- en: OpenShift-welcome application up and running
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift-welcome应用程序启动并运行
- en: The page is designed to be as comprehensive as possible; I've also used the
    bold font style!
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 该页面设计得尽可能全面；我还使用了粗体字体风格！
- en: How it works…
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作…
- en: Well, here the tough job is done by OpenShift Online. The only thing we have
    done essentially is install the Ruby programming language environment to be able
    to install and run the RHC tool, which is the client tool used to mange the OpenShift
    Online environment.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，这里由OpenShift Online完成了艰难的工作。我们本质上所做的唯一一件事是安装Ruby编程语言环境，以便能够安装和运行RHC工具，这是用于管理OpenShift
    Online环境的客户端工具。
- en: Let's recap what we have done during the deployment of our first application
    in the cloud.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下在云中部署我们的第一个应用程序期间我们所做的工作。
- en: 'First we have chosen the cartridge. As we have seen, there are many cartridges
    that we can use for our gear: WildFly, JBoss AS, Tomcat, Drupal, WordPress, Node.js,
    and **MongoDB Express Angular Node** (**MEAN**). There are many of them, and you
    can find them all at the OpenShift Online site at [https://openshift.redhat.com/app/console/application_types](https://openshift.redhat.com/app/console/application_types).'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们选择了卡式盒。正如我们所见，有许多卡式盒可供我们的齿轮使用：WildFly、JBoss AS、Tomcat、Drupal、WordPress、Node.js和**MongoDB
    Express Angular Node**（**MEAN**）。有很多，你可以在OpenShift Online网站上找到它们，网址为[https://openshift.redhat.com/app/console/application_types](https://openshift.redhat.com/app/console/application_types)。
- en: 'Once we have selected the WildFly cartridge, the platform asked us the **Public
    URL** to be used to publish our application, as shown in the following image:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们选择了WildFly卡式盒，平台会要求我们提供用于发布应用程序的**公共URL**，如下图所示：
- en: '![How it works…](img/3744_14_17.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![如何工作…](img/3744_14_17.jpg)'
- en: The Public URL to publish the application
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 发布应用程序的公共URL
- en: The URL, besides the suffix **.rhcloud.com**, is composed using the application
    name and a namespace. The last one is essentially your domain, the one where all
    your applications reside. Remember, it has to be unique! In my case, I've chosen
    the namespace `wildflycookbook`.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: URL，除了后缀**.rhcloud.com**之外，是由应用程序名称和命名空间组成的。最后一个基本上是你的域名，所有应用程序都驻留在那里。记住，它必须是唯一的！在我的情况下，我选择了命名空间`wildflycookbook`。
- en: 'As a matter of fact, the next time you create an application, you will be asked
    to give just the application name, as follows:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，下次你创建应用程序时，你将只被要求提供应用程序名称，如下所示：
- en: '![How it works…](img/3744_14_18.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![如何工作…](img/3744_14_18.jpg)'
- en: Defining your application name to be used into the public URL
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 定义要用于公共URL的应用程序名称
- en: 'Still remaining on the same page, there was another option we could have chosen—scaling—as
    shown in the following image:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 仍然停留在同一页面上，我们还可以选择另一个选项——扩展，如下图所示：
- en: '![How it works…](img/3744_14_19.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![如何工作…](img/3744_14_19.jpg)'
- en: Scaling option in OpenShift Online
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift Online中的扩展选项
- en: This option would have given us the capability to automatically scale the application.
    In few words, as already mentioned in the introduction, OpenShift will create
    additional WildFly gears (as long as they are available in your plan) and a balancer
    gear, to scale horizontally, when the incoming traffic increases.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这个选项将使我们能够自动扩展应用程序。简而言之，如介绍中已提到的，当传入流量增加时，OpenShift将创建额外的WildFly齿轮（只要它们在你的计划中可用）和一个均衡器齿轮，以实现水平扩展。
- en: 'The next option would have been the **Region**, which is the location where
    the server would have run your gears: US, Europe, or Asia.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个选项将是**区域**，即服务器将运行您的齿轮的位置：美国、欧洲或亚洲。
- en: All gears of any size can be run in the **US**; only production gears can be
    deployed to the **EU** region (small.highcpu, medium, and large). The **Asia**
    region is reserved for dedicated node service.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 任何大小的所有齿轮都可以在**美国**运行；只有生产齿轮可以部署到**欧洲**地区（small.highcpu、medium和large）。**亚洲**地区保留用于专用节点服务。
- en: So, with the free plan, we can only choose the **US** region, which is fine.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在免费计划下，我们只能选择**美国**地区，这没问题。
- en: As you may have guessed from the name of the region (`aws-us-east-1`), OpenShift
    relies on the Amazon AWS, to create the servers. Because of the Amazon "pay-only-for-what-you-use"
    policy, whenever the incoming traffic to your site decreases, OpenShift gets back
    the extra resources.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所猜测的地区名称（`aws-us-east-1`）所示，OpenShift依赖于Amazon AWS来创建服务器。由于Amazon的“只为你使用的付费”政策，每当你的网站流量减少时，OpenShift就会收回额外的资源。
- en: 'Apart from the configuration settings, there was one setting I put into the
    application through the `WEB-INF/jboss-web.xml` JBoss specific descriptor file,
    which looks like this:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 除了配置设置之外，我还通过`WEB-INF/jboss-web.xml` JBoss特定描述符文件将一个设置放入了应用程序中，它看起来像这样：
- en: '[PRE4]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The preceding configuration sets the context root of the application to `/`,
    so we can access it by just providing the URL [http://openshiftwelcome-wildflycookbook.rhcloud.com](http://openshiftwelcome-wildflycookbook.rhcloud.com),
    without any additional context path.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 上述配置将应用程序的上下文根设置为`/`，因此我们可以通过只提供URL [http://openshiftwelcome-wildflycookbook.rhcloud.com](http://openshiftwelcome-wildflycookbook.rhcloud.com)
    来访问它，而不需要任何额外的上下文路径。
- en: There's more…
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: 'This recipe was a little long, and you have probably found yourself doing it
    in different ways. If so, you may have encountered this:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这个菜谱有点长，你可能已经以不同的方式完成了它。如果是这样，你可能遇到过这种情况：
- en: '![There''s more…](img/3744_14_20.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多…](img/3744_14_20.jpg)'
- en: Application in the idle state
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 空闲状态中的应用程序
- en: 'This basically means that your WildFly instance has stopped. Your application
    will not receive incoming traffic, and even the access to the WildFly management
    console will not work:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上意味着你的WildFly实例已经停止。你的应用程序将不会收到流量，甚至WildFly管理控制台的访问也将无法工作：
- en: '[PRE5]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The only way to move ahead is to restart the application.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 前进唯一的方法是重新启动应用程序。
- en: Tip
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Keep in mind that after 48 hours of inactivity, or no-traffic at all, OpenShift
    Online puts your application back to the idle state. To keep your application
    away from the idle state, you can have a kind of cron job doing a simple HTTP
    GET to your site, once a day.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，在48小时的不活跃状态或完全没有流量后，OpenShift Online会将你的应用程序恢复到空闲状态。为了防止你的应用程序进入空闲状态，你可以设置一个类型的cron作业，每天对你的网站进行一次简单的HTTP
    GET请求。
- en: See also
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For all the services that OpenShift Online provides and how it works, please
    refer to the documentation at [https://www.openshift.com/walkthrough/how-it-works](https://www.openshift.com/walkthrough/how-it-works)
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于OpenShift Online提供的服务及其工作原理，请参阅[https://www.openshift.com/walkthrough/how-it-works](https://www.openshift.com/walkthrough/how-it-works)文档。
- en: If you are looking for documentation from a developer's point of view, go to
    [https://developers.openshift.com](https://developers.openshift.com)
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你正在寻找从开发者的角度的文档，请访问[https://developers.openshift.com](https://developers.openshift.com)。
- en: Taking control of your WildFly server via SSH
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过SSH控制你的WildFly服务器
- en: In this recipe, you will learn how to access the server where your WildFly is
    running. Accessing the server gives you some kind of comfort because, I guess,
    it's the way we usually work. There, you can see the WildFly process, its logs,
    its directory structures, and so on.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，你将学习如何访问运行WildFly的服务器。访问服务器会让你感到一种安心，因为我想，这是我们通常工作的方式。在那里，你可以看到WildFly进程、其日志、其目录结构等等。
- en: Getting ready
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Before you can effectively go through this recipe, you should have an active
    OpenShift Online account, along with an application. In case you need to, you
    can follow recipe one for the registration process, and follow *Installing the
    WildFly cartridge for our first deployment* recipe of this chapter to create your
    first application.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在你能够有效地完成这个菜谱之前，你应该有一个活跃的OpenShift Online账户以及一个应用程序。如果你需要，你可以按照第一个菜谱进行注册过程，并按照本章的*为首次部署安装WildFly卡顿*菜谱创建你的第一个应用程序。
- en: In this recipe, I will use the environment generated while creating the application
    `openshiftwelcome`; yours might be different but would conceptually be the same.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，我将使用在创建应用程序 `openshiftwelcome` 时生成的环境；你的可能不同，但概念上应该是相同的。
- en: How to do it…
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做…
- en: First, let's log in to your OSO account, at [https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console).
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们登录到你的OSO账户，在[https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console)。
- en: Then enter the username and password that you chose during the registration
    process.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后输入你在注册过程中选择的用户名和密码。
- en: Once logged in, select the application that you have created, or create a new
    one as described in the second recipe. I'll select my `openshiftwelcome` application.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录后，选择你创建的应用程序，或者根据第二个菜谱创建一个新的应用程序。我将选择我的`openshiftwelcome`应用程序。
- en: 'The following are my application details:'
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下是我的申请详情：
- en: '![How to do it…](img/3744_14_21.jpg)'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作…](img/3744_14_21.jpg)'
- en: Application details
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 申请详情
- en: In the preceding screenshot, there are two sections on the right named **Source
    Code** and **Remote Access**.
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前面的屏幕截图中，右侧有两个名为**源代码**和**远程访问**的部分。
- en: In the **Remote** **Access** section, click on the **Want to log in to your
    application?** label. It describes how to log in to the server which is hosting
    your application, obviously along with its cartridge.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**远程访问**部分，点击**想要登录到你的应用程序？**标签。它描述了如何登录到托管你的应用程序的服务器，显然还包括它的卡式盒。
- en: 'Open a terminal window and copy-paste the `ssh` command that the page is providing
    you. Mine is as follows:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口，复制粘贴页面提供的`ssh`命令。我的如下所示：
- en: '[PRE6]'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Once there, you can view the WildFly logs and see everything else that you want
    to.
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 到那里后，你可以查看WildFly日志并查看你想要查看的一切。
- en: Note
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Be careful, if you delete something that you shouldn't, you will need to create
    your application again.
  id: totrans-162
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 小心，如果你删除了不应该删除的东西，你需要重新创建你的应用程序。
- en: Let's take a look at the WildFly logs.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看WildFly的日志。
- en: 'Execute the following:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行以下操作：
- en: '[PRE7]'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Obviously, you are not limited to the logs; you can see the process, as follows:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显然，你不仅限于查看日志；你可以查看过程，如下所示：
- en: '[PRE8]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Or you can see the server resources by executing the `htop` command:![How to
    do it…](img/3744_14_22.jpg)
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 或者，你可以通过执行`htop`命令来查看服务器资源：![如何操作…](img/3744_14_22.jpg)
- en: Keep in mind that you can see and control everything as long as your user (the
    hash that identifies your application; mine is `54c0350afcf933691e0000dc`) has
    permissions.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，只要你的用户（标识应用程序的哈希值；我的为`54c0350afcf933691e0000dc`）有权限，你就可以查看和控制一切。
- en: How it works…
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: Whenever you create an application, you are actually creating an environment
    along with a cartridge that enables your application. OpenShift Online creates
    everything for you, assigning the whole process a hash. That hash will be your
    username to log in to your server, and it also identifies your application. The
    rest of the process of how OpenShift creates things is out of the scope of this
    book.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 每次你创建一个应用程序时，实际上你是在创建一个环境，以及一个允许你的应用程序运行的卡式盒。OpenShift Online为你创建一切，并为整个过程分配一个哈希值。这个哈希值将成为你登录服务器的用户名，它也标识了你的应用程序。OpenShift创建事物的其余过程超出了本书的范围。
- en: 'If you want to learn more about how things work under the hood, I suggest you
    start with this book: *Learning OpenShift*, *Grant Shipley*, *Packt Publishing*.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解更多关于内部工作原理的信息，我建议你从这本书开始：*Learning OpenShift*，*Grant Shipley*，*Packt Publishing*。
- en: See also
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: Make it a point to always refer to the official documentation, which, in this
    case, can be found at [https://docs.openshift.org/](https://docs.openshift.org/)
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请务必参考官方文档，在这种情况下，可以在[https://docs.openshift.org/](https://docs.openshift.org/)找到。
- en: Deploying your code to OpenShift Online
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将你的代码部署到OpenShift Online
- en: In this recipe, you will learn how to re-deploy an application whenever the
    source code updates happen. This is done automatically for you by OpenShift Online,
    which triggers compilation and deployment every time a commit is applied to your
    code.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，你将学习如何在源代码更新时重新部署应用程序。OpenShift Online会自动为你完成这项工作，每次将提交应用到你的代码时，都会触发编译和部署。
- en: Getting ready
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: First of all, we need a project on GitHub that we can use for our test. For
    this reason, I've created a project called `openshiftcoding-wildflycookbook` on
    my GitHub repository, available at [https://github.com/foogaro/openshiftcoding-wildflycookbook](https://github.com/foogaro/openshiftcoding-wildflycookbook).
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要一个GitHub上的项目，我们可以用它来进行测试。因此，我在我的GitHub仓库中创建了一个名为`openshiftcoding-wildflycookbook`的项目，可在[https://github.com/foogaro/openshiftcoding-wildflycookbook](https://github.com/foogaro/openshiftcoding-wildflycookbook)找到。
- en: If you do not have an account on GitHub, this might be a good reason to have
    one. Sooner or later you will need one. To get started quickly, go to the GitHub
    site at [https://github.com](https://github.com) and sign up. Once the registration
    process is complete, you will be ready to create a repository, which will host
    the source code of your application. If you don't have an application, you can
    borrow mine.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您在GitHub上没有账户，这可能是一个注册账户的好理由。迟早您都会需要它。为了快速开始，请访问GitHub网站[https://github.com](https://github.com)并注册。注册过程完成后，您将准备好创建一个仓库，该仓库将托管您应用程序的源代码。如果您没有应用程序，您可以借用我的。
- en: 'Anyway, this time you don''t have to download or `git-clone` my GitHub repository
    locally, as it will be used to feed the next OpenShift application. But we do
    need to install the `git` client tool. If you are using an OS similar to Red Hat,
    run the following command:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不管怎样，这次您不需要下载或`git-clone`我的GitHub仓库到本地，因为它将被用于为下一个OpenShift应用程序提供数据。但我们需要安装`git`客户端工具。如果您使用的是类似Red
    Hat的操作系统，请运行以下命令：
- en: '[PRE9]'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Once done, you can check that everything is installed successfully, by issuing
    the following command:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后，您可以通过以下命令检查是否已成功安装所有内容：
- en: '[PRE10]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Okay, now we are ready to begin!
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，现在我们准备开始了！
- en: How to do it…
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: First of all, you need to access your OpenShift Online account at the following
    address [https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console).
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，您需要访问以下地址的OpenShift Online账户[https://openshift.redhat.com/app/console](https://openshift.redhat.com/app/console)。
- en: Use the e-mail and the password chosen at the time of registration, as depicted
    in the following screenshot:![How to do it…](img/3744_14_23.jpg)
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用注册时选择的电子邮件和密码，如下面的截图所示：![如何操作…](img/3744_14_23.jpg)
- en: OpenShift Online login form
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: OpenShift Online登录表单
- en: Tip
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: If you don't have an OpenShift Online account yet, follow the registration process
    described in the first recipe of this chapter.
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您还没有OpenShift Online账户，请遵循本章第一道菜谱中描述的注册过程。
- en: Once you log in, on the main page, click the **Add Application…** button to
    create a new application:![How to do it…](img/3744_14_24.jpg)
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录后，在主页上，点击**添加应用程序…**按钮创建一个新的应用程序：![如何操作…](img/3744_14_24.jpg)
- en: OpenShift Online initial console for adding a new application
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 添加新应用程序的OpenShift Online初始控制台
- en: Next we need to select the WildFly cartridge. As there are tens of cartridges,
    we can search for it by providing a criteria filter, as depicted in the following
    screenshot:![How to do it…](img/3744_14_25.jpg)
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要选择WildFly卡顿。由于有数十种卡顿，我们可以通过提供标准筛选器来搜索它，如下面的截图所示：![如何操作…](img/3744_14_25.jpg)
- en: Selecting the WildFly cartridge by filtering it
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过筛选选择WildFly卡顿
- en: Afterwards, select the cartridge and fill in the form with the details of our
    application, as follows:![How to do it…](img/3744_14_26.jpg)
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 之后，选择卡顿并填写以下详细信息的表单：![如何操作…](img/3744_14_26.jpg)
- en: Setting application details
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置应用程序详情
- en: In my case, I've called my application `openshiftcoding`. This time I've specified
    my GitHub repository, where my application is available, that is, at [https://github.com/foogaro/openshiftcoding-wildflycookbook.git](https://github.com/foogaro/openshiftcoding-wildflycookbook.git).
    You will need to specify yours.
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在我的情况下，我把我应用程序命名为`openshiftcoding`。这次我指定了我的GitHub仓库，其中包含我的应用程序，即[https://github.com/foogaro/openshiftcoding-wildflycookbook.git](https://github.com/foogaro/openshiftcoding-wildflycookbook.git)。您需要指定您的。
- en: Complete the form by leaving the other default values as such and by clicking
    the **Create Application** button. It may take few minutes to complete.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过保留其他默认值并点击**创建应用程序**按钮完成表单。完成可能需要几分钟。
- en: Once the process is complete, you should see a page like the following:![How
    to do it…](img/3744_14_27.jpg)
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦过程完成，您应该会看到一个像下面的页面：![如何操作…](img/3744_14_27.jpg)
- en: Recap of the newly created application
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 新创建的应用程序概览
- en: As you can see from the preceding image, there is a section labeled **Making
    code changes**, that describes what we need to do in order to modify the source
    of our application, and have it automatically updated whenever we modify the code.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，有一个标记为**制作代码更改**的部分，它描述了我们需要做什么来修改我们应用程序的源代码，并在我们修改代码时自动更新。
- en: Therefore, open a terminal window and issue the `git clone` command identifying
    your application repository in OpenShift Online—it is not the one on GitHub, but
    will be cloned locally into the server that OpenShift will create for you.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，打开一个终端窗口并输入`git clone`命令，指定你的OpenShift Online应用程序仓库——它不是GitHub上的那个，但会被克隆到OpenShift为你创建的服务器上。
- en: 'These are the commands that I enter now:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是我现在输入的命令：
- en: '[PRE11]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: We are now ready to change our source code, commit it, and see OpenShift compiling
    and deploying our application directly to our WildFly instance. To see all this
    beauty, we need to look at the logs.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以更改源代码，提交它，并查看OpenShift直接编译和部署我们的应用程序到我们的WildFly实例。为了看到这一切，我们需要查看日志。
- en: 'Open a terminal window and issue the following command:'
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口并输入以下命令：
- en: '[PRE12]'
  id: totrans-207
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: As you can see from the preceding log that has been emphasized, our application
    is already there; in fact, if we open the public URL that we specified while creating
    the application, we can see it working, as follows:![How to do it…](img/3744_14_28.jpg)
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如您从前面强调的日志中看到的，我们的应用程序已经在那里；实际上，如果我们打开创建应用程序时指定的公共URL，我们可以看到它正在工作，如下所示：![如何操作…](img/3744_14_28.jpg)
- en: The application needs to be updated
  id: totrans-209
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 应用程序需要更新
- en: 'Okay, let''s update the source code. In my case, I only have a JSP, and its
    code is the following:'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 好的，让我们更新源代码。在我的情况下，我只有一个JSP，其代码如下：
- en: '[PRE13]'
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Let''s add some color to the text as follows:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在文本中添加一些颜色，如下所示：
- en: '[PRE14]'
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now, we can update our code to the Git repository from the first terminal window
    (where we cloned the Git repository from OpenShift), as follows:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以从第一个终端窗口（我们从OpenShift克隆Git仓库的地方）更新我们的代码到Git仓库，如下所示：
- en: '[PRE15]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Now, we need to push everything. Before doing that, let's grab the other terminal
    with the visible WildFly log. Now we can do the magic…
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要推送一切。在这样做之前，让我们获取另一个带有可见WildFly日志的终端。现在我们可以进行魔法操作…
- en: '[PRE16]'
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'If you are familiar with `git`, you''ll know that this push took a little longer
    than expected, but it did a lot of things:'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你熟悉`git`，你会知道这次推送比预期的要长一些，但它做了很多事情：
- en: It stopped our WildFly
  id: totrans-219
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 停止了我们的WildFly
- en: It updated the code
  id: totrans-220
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它更新了代码
- en: It issued a maven compilation, packaged our application as a `war`
  id: totrans-221
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它执行了maven编译，将我们的应用程序打包为`war`
- en: It copied our new application into the WildFly `deployments` folder
  id: totrans-222
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它将我们的新应用程序复制到了WildFly的`deployments`文件夹
- en: It started WildFly
  id: totrans-223
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动了WildFly
- en: 'And if you have looked at the WildFly logs too, you should have noticed the
    following entries:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你已经查看了WildFly日志，你应该已经注意到了以下条目：
- en: '[PRE17]'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Let's see if everything worked correctly. Open the browser and go to [http://openshiftcoding-wildflycookbook.rhcloud.com](http://openshiftcoding-wildflycookbook.rhcloud.com).
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看看一切是否正常工作。打开浏览器并访问[http://openshiftcoding-wildflycookbook.rhcloud.com](http://openshiftcoding-wildflycookbook.rhcloud.com)。
- en: 'You should see something like the following page:'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该看到如下页面：
- en: '![How to do it…](img/3744_14_29.jpg)'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作…](img/3744_14_29.jpg)'
- en: Application updated through a git push
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 应用程序通过git push更新
- en: Great, it worked!
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了，它成功了！
- en: How it works…
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: OpenShift Online hides and does a lot of things under the hood, making our lives
    easier, much easier. The only thing that we actually did was on the development
    side.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift Online在幕后隐藏并做了很多事情，使我们的生活更加轻松，容易得多。我们实际上在开发方面所做的只是很小的一部分。
- en: To let OpenShift Online easily compile, package, and deploy our application,
    we need to instruct it about how to compile the source, how to package it, and
    where to deploy it. We can give these directives through the maven project file,
    the `pom.xml`.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 为了让OpenShift Online轻松编译、打包和部署我们的应用程序，我们需要指导它如何编译源代码、如何打包它以及部署到何处。我们可以通过maven项目文件`pom.xml`给出这些指令。
- en: 'The following is the complete `pom.xml` file of the `openshiftcoding-wildflycookbook`
    project (also available at [https://github.com/foogaro/openshiftcoding-wildflycookbook/blob/master/pom.xml](https://github.com/foogaro/openshiftcoding-wildflycookbook/blob/master/pom.xml)):'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在`openshiftcoding-wildflycookbook`项目中的完整`pom.xml`文件（也可在[https://github.com/foogaro/openshiftcoding-wildflycookbook/blob/master/pom.xml](https://github.com/foogaro/openshiftcoding-wildflycookbook/blob/master/pom.xml)找到）：
- en: '[PRE18]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The key point here is the profile named `openshift`. By default, OSO uses Maven
    to compile the source code, asking to use the `openshift` profile. The profile
    that it finds will be used along with its settings; otherwise, the code will be
    just compiled and packaged, but OSO will not know where to deploy it.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的关键是名为`openshift`的配置文件。默认情况下，OSO使用Maven编译源代码，并要求使用`openshift`配置文件。它找到的配置文件将与其设置一起使用；否则，代码将被编译和打包，但OSO将不知道部署到何处。
- en: The `openshift` profile that I've provided, defines (with the `build` tag )
    the settings to be used during Maven's build phase. Particularly, I've used the
    standard `maven-war-plugin` and set the `outputDirectory` to `deployments`, which
    is the one that WildFly uses.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 我提供的`openshift`配置文件，定义了（使用`build`标签）在Maven构建阶段要使用的设置。特别是，我使用了标准的`maven-war-plugin`并将`outputDirectory`设置为`deployments`，这是WildFly使用的目录。
- en: See also
  id: totrans-238
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: 'From a developer''s point of view, I recommend that you refer to the official
    documentation at the following sites:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 从开发者的角度来看，我建议您参考以下网站上的官方文档：
- en: '[https://docs.openshift.com](https://docs.openshift.com)'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://docs.openshift.com](https://docs.openshift.com)'
- en: '[https://developers.openshift.com/en/managing-modifying-applications.html](https://developers.openshift.com/en/managing-modifying-applications.html)'
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://developers.openshift.com/en/managing-modifying-applications.html](https://developers.openshift.com/en/managing-modifying-applications.html)'
