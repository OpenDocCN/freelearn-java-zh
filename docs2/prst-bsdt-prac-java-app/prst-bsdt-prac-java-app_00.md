# 前言

一个稳固的软件架构结合了将技术解决方案付诸实施所需的每一个构建块。在应用程序生命的早期阶段，设计和实践就已经确立：微服务或单体架构、事件驱动方法、集成和交付应用程序生命周期、容器化等。在应用程序方面，特别是在 Java 环境中，框架和执行运行时也被定义。像那些古老的遗留系统一样，大多数现代云原生解决方案依赖于数据，通常在数据存储（例如，数据库）中。不幸的是，持久层往往被忽视，没有得到与其他主题相同的重要性。对于依赖于有状态服务的场景，这是走向终结的开始——全新的解决方案注定要经历性能挣扎和维护性降低，甚至更糟，可能会植入导致数据不一致的杂草。维护性降低是持久层设计和定义忽视的结果，因为方案和数据模型在信息不足的基础上实施得不好。在这种情况下，即使是微不足道的数据库重构也是残酷且耗时的。

对持久层、技术和现有方法的挑战、解决方案和最佳实践的全面理解，是走出这些棘手场景以及许多与应用程序和数据存储相关的场景的出路。

本书介绍了在 Java 解决方案中可以使用的成熟模式和标准，并详细阐述了在面临良好的 Java 编码实践时，用于云原生微服务的流行技术和框架的优缺点。由于 Java 技术已经广泛使用超过二十年了，云的采用带来了额外的挑战，例如通过堆栈现代化降低成本的需求日益增长。因此，你将学习关于应用现代化策略的知识，并深入了解企业数据集成模式和事件驱动架构如何使现代化过程平稳进行，对现有遗留堆栈的影响降至最低或为零。

阅读本书后，你的下一个架构决策将更加稳固，并基于对数据存储选项及其相应推荐使用场景的全面解释，涵盖了 SQL、NoSQL 和新 SQL 等技术。当在 Java 生态系统背景下讨论与数据相关的内容时，关于 MicroProfile 和 Jakarta EE 如何工作；数据库模式（如 Active Record 和**数据访问对象**（DAO）；**命令和查询责任分离**（CQRS）；内存持久化；以及对象映射框架等主题，都有大量信息可供参考。

如果您此时已经理解了为什么谨慎处理数据存储对于系统和架构至关重要，并相信它对整个组织有直接影响，以至于到了通过采用以数据为中心的战略来击败竞争对手的程度，那么这本书就是为您准备的。准备好加入我们在这段激动人心的旅程中，探索数据、其奥秘及其在云驱动时代中的宝藏。

# 本书面向的对象

本书主要面向具有强大 Java 背景、专注于构建 Java 解决方案的资深开发者、工程师和软件架构师。它旨在满足那些已经对 Java 开发有扎实理解并希望增强其在持久化方面的知识和技能的个人。

本书的内容假设读者对 Java 编程概念、面向对象设计原则和企业级应用开发有一定的熟悉程度。它深入探讨高级主题，并探索现代 Java 解决方案中持久化的各个方面。

无论您是一位希望深化对持久化技术理解的资深 Java 开发者，还是一位寻求优化 Java 应用程序性能和可扩展性的工程师，亦或是一位负责设计稳健持久层的软件架构师，本书都提供了有价值的见解、最佳实践和实用指导，以满足您的需求。

通过利用本书中分享的专业知识和经验，您可以提升在 Java 项目中设计、实施和优化持久化解决方案的能力，最终使您能够开发出高性能、可扩展和易于维护的 Java 应用程序。

# 本书涵盖的内容

*第一章*，*从洞穴到云端的数据存储*，您将获得为书中后续内容所需的基础知识，所以请系好安全带。您将了解存储数据的挑战，这些挑战催生了最初的数据存储解决方案。随着技术的进步，数据库演变成了稳健和可靠的解决方案。Java 生态系统对此做出了良好的反应，并与数据生态系统同步增长，为用户提供框架、应用服务器等，以简化开发者的体验并实现高性能的数据库集成。

*第二章*，*提炼多种数据库风味*，讨论了随着解耦和独立服务的增长和个体需求，多语言持久化策略如何自然地显现。您将探索不同的数据存储方式，市场数据管理系统（例如，关系型、NoSQL 和新 SQL），它们各自的语言，以及最重要的是，每个系统的用例场景。过度设计是系统设计中的恶棍，所以这一章将为您提供知识，以使它远离您的持久化层。

*第三章*，*探索架构策略和云使用*，将使你熟悉并帮助你回忆起关于多种架构解决方案的概念。你将了解单体、微服务和事件驱动解决方案之间的关系，以及这些方法如何推动不同云服务提供的日益普及。你将学习如何识别使用本地和云解决方案混合使用的利弊，这种混合使用导致组织解决方案建立在混合和/或多云模型之上。

*第四章*，*在云原生应用中充分利用数据管理设计模式*，深入探讨了云原生应用中的数据管理领域，并探讨了如何有效地利用设计模式。随着云技术的日益普及，开发者优化数据管理策略以最大化云原生架构的益处变得至关重要。

*第五章*，*雅加达 EE 和 JPA：现状*，提供了对雅加达 EE 和 MicroProfile 生态系统中持久性的全面概述。持久性是企业应用开发的基本方面，了解这些框架如何处理持久性对于开发者来说是至关重要的。

*第六章*，*Java 中 NoSQL 的神秘面纱：一个 API 统治一切*，讨论了 NoSQL 数据库如何为企业应用和系统打开各种能力的大门。如今，甚至更加保守的市场，如金融业，也开始考虑非关系型数据库解决方案。是时候熟悉 NoSQL 数据库及其类型了，了解如何将它们与 Java 服务集成，以及它们可能适合数据存储的用例。

*第七章*，*jOOQ 采用指南的缺失部分*，讨论了面向对象查询，通常称为 jOOQ，这是一个在 Java 中实现 Active Record 模式的轻量级数据库映射软件库。其目的是通过提供基于数据库模式自动生成的类来构建查询的**领域特定语言**（**DSL**），实现关系型和面向对象。

*第八章*，*使用 Eclipse Store 实现超快内存持久性*，探讨了 Eclipse Store，它通过纯 Java 提供超快的内存数据处理。它提供微秒级查询时间、低延迟数据访问、巨大的数据吞吐量和工作负载。因此，它节省了大量 CPU 功率、CO2 排放和数据中心成本。

*第九章*，*持久化实践：探索多语言持久化*，深入探讨了在 Jakarta 数据生态系统中的多语言持久化概念。多语言持久化指的是在应用程序中使用多种数据存储技术以优化不同的数据需求。

*第十章*，*构建分布式系统：挑战和反模式*，探讨了构建分布式系统的复杂性，并检查了在过程中可能出现的挑战和反模式。分布式系统在现代软件架构中越来越普遍，但它们也带来了一组自己的复杂性。

*第十一章*，*现代化策略和数据集成*，探讨了现代化策略和数据集成技术，以帮助组织适应其现有系统以满足现代技术景观的需求。随着技术的快速发展，企业现代化其遗留系统并将它们无缝集成到新技术中变得至关重要。

*第十二章*，*现代 Java 解决方案中持久化的最终考虑*，是最后一章，我们提供了关于现代 Java 解决方案中持久化的重要考虑和见解。随着 Java 开发领域的演变，了解持久化的最佳实践和新兴趋势至关重要。

# 为了充分利用这本书

在您开始阅读这本书并深入研究软件需求之前，了解以下技术至关重要：Java 17、Maven、Git 和 Docker。假设您熟悉 Java 17，包括其语法和面向对象编程概念，以及核心库和框架的熟悉度。了解 Maven 将有益，因为它是一个流行的构建自动化工具，用于管理依赖关系和构建 Java 项目。Git，一个版本控制系统，对于有效地跟踪和管理源代码更改是必要的。最后，了解 Docker，一个容器化平台，将帮助您理解如何在隔离环境中打包和部署软件应用程序。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Java 17 | Windows、macOS 或 Linux |
| Maven |  |
| Git |  |
| Docker |  |

**如果您正在使用这本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件[`github.com/PacktPublishing/Persistence-Best-Practices-for-Java-Applications/`](https://github.com/PacktPublishing/Persistence-Best-Practices-for-Java-Applications/)。如果代码有更新，它将在 GitHub 仓库中更新。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“在这个领域，`Book`实体属性应该是`title`、`author`、`publisher`和`genre`。”

代码块设置如下：

```java
public class Book {    private final String title;
    private final String author;
    private final String publisher;
    private final String genre;
    // constructor method
    // builder inner class
}
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```java
public class Book {    private final String title;
    private final String author;
    private final String publisher;
    private final String genre;
    // constructor method
    // builder inner class
}
```

任何命令行输入或输出应如下编写：

```java
$ mkdir css$ cd css
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以粗体显示。以下是一个示例：“从**管理**面板中选择**系统信息**。”

小贴士或重要注意事项

它看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们非常感谢您能向我们报告。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上发现我们作品的任何非法副本，我们将非常感谢您能提供位置地址或网站名称。请通过 copyright@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《Java 应用程序持久性最佳实践》，我们很乐意听听您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1837631271)并分享您的反馈。

您的评论对我们和科技社区都非常重要，它将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但又无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

请放心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止这些，您还可以获得独家折扣、时事通讯和丰富的免费内容，每天直接发送到您的邮箱

按照以下简单步骤获取这些好处：

1.  扫描下面的二维码或访问以下链接

![下载此书的免费 PDF 副本](img/B19375_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781837631278`](https://packt.link/free-ebook/9781837631278)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的邮箱

# 第一部分：云计算中的持久性 – 在现代软件架构中存储和管理数据

在本书的这一部分，我们深入探讨了云计算环境中持久性的基本方面。随着云解决方案在现代软件架构中越来越普遍，了解如何有效地存储和管理数据在这个环境中至关重要。

本部分包括以下章节：

+   *第一章**，存储数据：从洞穴到云端*

+   *第二章**，提炼多种数据库风味*

+   *第三章**，探索架构策略和云使用*

+   *第四章**，在云原生应用中充分利用数据管理设计模式*
