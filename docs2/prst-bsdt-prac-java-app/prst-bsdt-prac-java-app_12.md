# 12

# 最终考虑事项

我们已经探讨了持久性的架构视角，深入研究了 Jakarta EE 和 MicroProfile，检查了现代持久性技术及其权衡，并讨论了云时代持久性的基本方面。这一章将反思我们在持久性旅程中收集到的关键见解和考虑因素。现在，让我们结合所学到的经验，得出一些结论：

+   **拥抱架构视角**：理解架构视角对于设计健壮和可伸缩的持久性解决方案至关重要。将持久性与整体系统架构相一致的整体方法确保我们可以有效地管理复杂性，并随着时间的推移发展我们的应用程序。通过考虑数据建模、事务管理、缓存和可伸缩性等因素，我们可以构建满足现代应用程序需求的系统。

+   **Jakarta EE 和 MicroProfile**：Jakarta EE 和 MicroProfile 规范为构建企业 Java 应用程序提供了一个标准化的基础。这些框架提供了许多与持久性相关的 API 和功能，简化了开发过程。通过遵循这些标准，我们可以从可移植性、互操作性和充满活力的兼容库和工具生态系统中获得益处。

+   **现代持久性技术和权衡**：持久性技术的领域已经发生了显著变化，为开发者提供了多样化的选择。我们探讨了与不同方法相关的权衡，例如关系数据库、NoSQL 数据库和对象关系映射框架。每种技术都有其优势和劣势，选择取决于具体的项目需求。了解权衡有助于我们做出明智的决定，并优化应用程序的持久性层。

+   **云时代持久性关键要素**：云计算的兴起在持久性领域带来了新的挑战和机遇。云原生持久性解决方案，如托管数据库服务、分布式缓存和事件驱动架构，使我们能够构建弹性、可伸缩和成本效益的应用程序。我们讨论了在云中实现持久性的基本考虑因素，包括可伸缩性、数据一致性、多区域部署和无服务器架构。

+   **持续学习的重要性**：持久性是动态的，新技术和方法不断涌现。作为开发者，培养持续学习的思维并跟上最新趋势至关重要。这包括监控 Jakarta EE 和 MicroProfile 的进步，探索新的数据库技术，以及了解云原生持久性的最佳实践。通过拥抱学习心态，我们可以适应不断变化的需求，并充分利用我们在应用程序中持久性的全部潜力。

在本章中，我们将进一步探讨以下主题：

+   测试的力量以及如何通过数据域测试进行领导

+   不要低估文档；这有助于可扩展性

+   软件架构无论是否有架构师都在那里

# 测试的力量——如何通过数据域测试进行领导

确保数据和行为的致性是构建稳健和可靠应用程序的关键方面。应用程序中的错误可能会在数据中引入不一致性，导致意外的行为和错误的结果。实施有效的测试策略可以帮助识别和预防此类问题。集成测试和数据驱动测试是验证应用程序行为正确性和一致性的有效方法。

集成测试涉及测试应用程序不同组件之间的交互，以确保它们按预期协同工作。当尝试持久化层时，它尤其相关，因为它允许您验证应用程序与底层数据存储系统之间的集成。

数据驱动测试通过不同的输入数据集验证应用程序的行为。通过系统地改变输入数据，并将预期结果与实际输出进行比较，您可以识别不一致性并检测可能影响数据一致性的潜在错误。

Java 拥有多个测试框架和工具，以促进集成和数据驱动测试。JUnit Jupiter 是一个流行的测试框架，它提供了一个强大且灵活的平台，用于编写和执行测试。它提供了各种注解、断言和测试执行生命周期回调，以支持集成测试场景。

AssertJ 是另一个强大的库，它增强了测试中断言的可读性和表达性。它提供了一个流畅的 API，用于对各种数据类型执行断言，使验证预期结果更加容易，并确保数据一致性。

Test Container 是一个 Java 库，它简化了依赖于外部资源（如数据库、消息代理或其他容器）的应用程序的测试。它允许您为集成测试定义和管理轻量级、隔离的容器，为与外部系统一起工作时确保一致行为提供了一种方便的方法。

记住，测试是开发过程中的关键部分，投资于坚实的测试实践将帮助您在早期识别和解决数据一致性问题时，从而构建更稳健和值得信赖的应用程序。测试之后，让我们转向软件开发中一个被低估的话题：文档。它减少了会议次数，打破了孤岛，并可以帮助您处理分布式系统。

# 不要低估文档的重要性

文档在软件开发中至关重要，它使团队能够实现可扩展性，简化入职流程，打破知识孤岛，并确保每个人都朝着正确的方向前进。

随着项目和团队的增长，可扩展性的需求变得明显。文档是一个知识库，使团队能够有效地共享信息和最佳实践。开发者可以通过记录架构决策、设计模式和编码约定，轻松理解系统的结构并高效协作。这种可扩展性确保了随着团队的扩大或新成员的加入，集体知识得到保留，入职过程更加顺畅。

招募新团队成员可能是一个耗时且具有挑战性的过程。文档为新开发者提供了一个资源，使他们能够快速熟悉项目的架构、设计原则和编码标准。它降低了学习曲线，使新来者能够快速学习。良好的文档系统也有助于在员工更替期间的知识转移，最小化人员变动对项目连续性的影响。

在许多组织中，知识孤岛会阻碍协作和生产力，并可能导致错误。当知识只存在于特定个人手中时，其他人难以访问并从中受益。文档通过在团队中捕捉和共享专业知识来帮助打破这些孤岛。通过记录架构决策、集成模式和实施细节，团队可以民主化知识，并使每个人都能够为项目的成功做出贡献。

文档就像是一张指南针，引导团队走向正确的方向。它捕捉了架构选择、设计决策和编码实践背后的“为什么”。通过记录这些理由，团队建立了对项目的共同理解和愿景。它确保每个人都与系统的目的、目标和期望结果保持一致。文档是一个参考点，使开发者能够做出明智的决定，避免走弯路。

文档在分布式系统的背景下发挥着至关重要的作用，它通过提供对系统架构、集成点和通信协议的清晰性和理解来发挥作用。它作为沟通系统结构、行为和依赖关系给所有利益相关者的手段，确保了有一个共同的语言和理解。

文档定义了集成点、数据格式和通信协议，促进了无缝互操作性。它捕捉了容错、弹性和可扩展性策略，使团队能够设计和实施能够优雅处理故障并优化性能的系统。详细的文档概述了部署架构、配置参数和故障排除步骤，有助于分布式系统的顺利设置、管理和维护。总的来说，分布式系统中的文档增强了理解、协作和有效的领导，从而提高了可靠性、性能和系统质量。

由西蒙·布朗普及的 C4 模型为记录软件架构提供了一个稳健的框架。它采用分层结构，允许团队放大和缩小，提供系统组件及其交互的高级概述和详细视图。C4 模型充当架构的“谷歌地图”，使团队能够有效地沟通和可视化复杂系统。

除了架构文档之外，关注代码级别的战术文档也非常关键。清晰的代码注释、描述性的函数和变量名提高了代码的可读性和可维护性。它包括良好记录的代码、信息丰富的 README 文件和全面的变更日志。README 文件提供了项目的概述、安装说明和使用示例，促进了与其他开发者的协作。变更日志跟踪版本历史，记录功能添加、错误修复和其他显著变化。

文档在软件开发中是一种强大的工具，有助于团队的可扩展性，促进入职，打破知识孤岛，并确保从记录架构决策到在代码级别提供战术文档，投入时间和精力创建全面且易于访问的文档。

如果在讨论文档和测试之后你仍然在这里，让我们以一个我们也不太喜欢的话题结束这一章，或者至少因为我们在过去遇到的不良实践而成为一个红旗：架构。

# 没有架构师的架构

在过去，公司常常将软件架构与一个集中的指挥和控制区域联系在一起，这可能并没有为工程师带来更好的体验。然而，认识到软件架构不仅仅是一个部门或团队的建设至关重要。它在整个组织的成功中发挥着重要作用。

软件架构包括系统的基本结构和设计，包括其组件、交互和整体组织。它是构建稳健、可扩展和可维护系统的蓝图。尽管有些人认为架构是一个可选的关注点，但架构始终存在，无论我们是否注意到它。

一个精心设计的软件架构提供了许多好处，尤其是在分布式系统中。好的架构在考虑分布式系统时特别有用，特别是考虑到分布式系统：

+   经常需要处理增加的负载并适应不断增长的用户群体。一个经过深思熟虑的架构考虑了可扩展性，使系统能够处理更高的流量并适应不断变化的需求。它通过在多个节点上分配组件并利用负载均衡技术实现水平扩展，从而提高性能和响应速度。

+   容易出现故障和网络中断。一个健壮的架构可以集成容错和弹性策略。这包括冗余、复制、错误处理机制以及从故障中优雅恢复的能力。通过设计弹性，你的系统可以在单个组件故障的情况下保持可用性并继续运行。

+   通常涉及多个组件和服务，这些组件和服务必须无缝协作。一个设计良好的架构促进了组件的模块化、封装和松散耦合。这种模块化方法使得单个组件的开发、测试、部署和演进更加容易，从而提高了灵活性并适应不断变化的企业需求。

+   经常与外部服务、API 和数据源交互。一个定义良好的架构促进了与这些外部系统的无缝集成和互操作性。通过明确定义通信协议、API 契约和集成模式，架构使得平滑交互成为可能，从而使得消费或暴露服务以及与外部实体交换数据变得更加容易。

+   必须设计成能够处理大规模数据处理和通信的需求。一个架构良好的系统可以通过考虑数据局部性、缓存策略、负载均衡和高效的通信协议来优化性能。通过仔细的架构选择，你可以最小化延迟、带宽使用和资源竞争，从而最终提高系统的整体性能。

总之，软件架构不仅仅是某个部门或团队，而是整个组织成功的关键方面。良好的架构有助于构建可扩展、弹性、灵活和性能优异的分布式系统。通过考虑可扩展性、弹性、灵活性、互操作性和性能优化等因素，一个设计良好的架构为构建满足现代软件开发挑战和复杂性的分布式系统奠定了基础。

# 摘要

总结来说，我们衷心感谢您，亲爱的读者，陪伴我们走完了这本书的最后一程。我们希望这些篇章中分享的知识和洞察对您来说，就像对我们一样有价值。在需要的时候，请将这本书作为理解软件开发复杂性的有益资源使用。请记住，这本书只是您作为软件工程师的持久之旅的开始。持久性领域持续发展，新技术、模式和权衡不断涌现。抓住这个学习和成长的机会，保持对持久性领域最新进展的好奇心和开放心态。通过应用本书中涵盖的原则和概念，并保持对进一步探索的热情，您将充分准备应对作为软件工程师旅程中的挑战和机遇。再次感谢，并祝愿您在持之以恒的努力中取得巨大成功。

# 进一步阅读

+   《有效软件测试：开发者指南》（*Effective Software Testing: A Developer’s Guide*）由*Maurizio Aniche*所著，旨在深入探讨有效的软件测试实践。本书提供了宝贵的见解和技术，用于提高您的测试技能，包括集成测试、数据驱动测试和其他基本测试概念。通过利用本书中分享的知识，您可以通过全面和有效的测试来提高软件的质量和可靠性。

+   《软件架构基础：工程方法》（*Fundamentals of Software Architecture an Engineering Approach*）由*Neal Ford*所著，是一本强烈推荐的书，提供了对软件架构原则、模式和最佳实践的宝贵见解。它涵盖了诸如架构风格、设计原则、可伸缩性、模块化等基本主题。通过学习这本书，您可以提高对软件架构的理解，并将其有效地应用于分布式系统。

+   《开发者文档：工程师技术写作指南》（*Docs for Developers: An Engineer’s Field Guide to Technical Writing*）由*Jared Bhatti*、*Sarah Corleissen*、*Jen Lambourne*和*David Nunez*合著，是一本全面且实用的书籍，对希望提高技术写作技能的开发者来说是无价之宝。这本书由该领域的专家撰写，深入探讨了实用文档的细微差别，提供了针对开发者需求的见解、策略和最佳实践。

+   《C4 模型可视化软件架构》（*The C4 Model for Visualising Software Architecture*）由*Simon Brown*所著，是一本变革性的书籍，为开发者提供了一个全面框架，用于有效地可视化和传达软件架构。本书由经验丰富的实践者撰写，介绍了 C4 模型——一种将复杂的架构设计简化为一系列分层图表的实用方法。通过提供一种清晰和一致的语言来表示软件系统、组件、容器和代码，C4 模型促进了开发者、架构师和利益相关者之间的有效沟通和协作。
